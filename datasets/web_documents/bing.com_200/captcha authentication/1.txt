<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
 <head> 
  <title>BotDetect JSP Login Form CAPTCHA Code Example</title> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
  <meta name="description" content="JSP Login Form Captcha validation - Java code example: BotDetect Java Captcha library example source code listing and explanation."> 
  <meta name="keywords" content="captcha, captcha java, captcha login form, java captcha, javaserver pages, javaserver pages login form, javaserver pages captcha, login form, examples, botdetect"> 
  <meta name="copyright" content="(C) Captcha, Inc."> 
  <meta name="robots" content="index, follow, noodp"> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <link href="../../../style/ethereal.css?t=1506517089" type="text/css" rel="stylesheet" media="screen"> 
  <link rel="apple-touch-icon" href="../../../images/apple-touch-icon.png"> 
  <link href="https://captcha.com/doc/java/examples/jsp-login-form-captcha-example.html" rel="canonical"> 
  <link href="https://captcha.com/" rel="home"> 
  <script async type="text/javascript" src="../../../script/scripts.js?t=1506517089"></script> 
 </head> 
 <body id="top"> 
  <div class="container"> 
   <div class="content"> 
    <div class="column" id="main"> 
     <h1>JavaServer Pages Login Form CAPTCHA Code Example</h1> 
     <div id="breadcrumbs">
      <a href="../../../documentation.html" title="BotDetect CAPTCHA Documentation Index">documentation</a> &gt; 
      <a href="../../../java-captcha.html" title="BotDetect Java CAPTCHA Library">java captcha</a> &gt; 
      <a href="../../../doc/java/jsp-captcha-quickstart.html" title="BotDetect JavaServer Pages CAPTCHA Integration">javaserver pages</a>
     </div> 
     <div class="spacerjavaalpha"></div> 
     <div class="tabstrip" data-tabstrip-group="traditionalapi-simpleapi" data-is-root-tabstrip> 
      <ul> 
       <li class="tabstrip_active"><a href="#traditional-api">Traditional API</a></li> 
       <li class="tabstrip_inactive"><a href="#simple-api">Simple API</a></li> 
      </ul> 
     </div> 
     <div id="traditional-api" data-tabstrip-group="traditionalapi-simpleapi" class="tab_content"> 
      <p>The JSP Login Form Captcha code example shows how to add <a href="../../../java-captcha.html" title="BotDetect Java CAPTCHA library">BotDetect CAPTCHA</a> protection to a typical JSP login form.</p> 
      <div class="bounded floater crash" style="margin-top: 15px;"> 
       <h3>First Time Here?</h3> 
       <p>Check the BotDetect <a href="../jsp-captcha-quickstart.html" title="BotDetect Java Server Pages CAPTCHA Integration Quickstart">JSP Captcha Quickstart</a> for key integration steps.</p> 
      </div> 
      <p>To prevent bots from trying to guess the login info by brute force submission of a large number of common values, the visitor first has to prove they are human (by solving the CAPTCHA), and only then is their username and password submission checked against the authentication data store.</p> 
      <p>Also, if they enter an invalid username + password combination three times, they have to solve the CAPTCHA again. This prevents attempts in which the attacker would first solve the CAPTCHA themselves, and then let a bot brute-force the authentication info.</p> 
      <p>To keep the example code simple, the example doesn't access a data store to authenticate the user, but <strong>accepts all logins with usernames and passwords at least 5 characters long as valid</strong>.</p> 
      <a class="download_free" href="../../../captcha-download.html?version=java" title="Download the BotDetect Java CAPTCHA Library Free Version">Download the BotDetect Java library and run this example</a> 
      <h3>Downloaded Location</h3> 
      <p>The JSP Login Form CAPTCHA code example is included in the <br> <code>examples/traditional-api/bdc4-traditional-api-jsp-login-form-captcha-example.war</code> file of the download package. Deploying (unpacking) the file will create a standard JSP directory tree.</p> 
      <ul class="sitemap"> 
       <li><a href="#index.jsp">index.jsp</a></li> 
       <li><a href="#LoginFormAction.java">WEB-INF/src/com/captcha/botdetect/examples/jsp/login_form/LoginFormAction.java</a></li> 
       <li><a href="#web.xml">WEB-INF/web.xml</a></li> 
      </ul> 
      <h3>Running Example</h3> 
      <p>This example's war file (in BotDetect download package) already embeds all dependencies.</p> 
      <p>In case you are making this example from scratch in your IDE, you need to ensure <code>botdetect.jar</code>, <code>botdetect-servlet.jar</code>, and <code>botdetect-jsp20.jar</code> are in the classpath.</p> 
      <h3 id="index.jsp">index.jsp</h3> 
      <pre class="hl"><span class="hl kwa">&lt;%@</span>page trimDirectiveWhitespaces<span class="hl opt">=</span><span class="hl str">"true"</span><span class="hl kwa">%&gt;</span>
<span class="hl kwa">&lt;%@</span>page contentType<span class="hl opt">=</span><span class="hl str">"text/html"</span> pageEncoding<span class="hl opt">=</span><span class="hl str">"UTF-8"</span><span class="hl kwa">%&gt;</span>
<strong><span class="hl kwa">&lt;%@</span>taglib prefix<span class="hl opt">=</span><span class="hl str">"botDetect"</span> uri<span class="hl opt">=</span><span class="hl str">"https://captcha.com/java/jsp"</span><span class="hl kwa">%&gt;</span></strong>
<span class="hl kwa">&lt;!DOCTYPE</span> html<span class="hl kwa">&gt;</span>
<span class="hl kwa">&lt;html&gt;</span>
<span class="hl kwa">&lt;head&gt;</span>
  <span class="hl kwa">&lt;meta</span> <span class="hl kwb">http-equiv</span>=<span class="hl str">"Content-Type"</span> <span class="hl kwb">content</span>=<span class="hl str">"text/html; charset=UTF-8"</span><span class="hl kwa">&gt;</span>
  <span class="hl kwa">&lt;title&gt;</span>BotDetect Java CAPTCHA Validation: JSP Login Form CAPTCHA Code Example<span class="hl kwa">&lt;/title&gt;</span>
  <span class="hl kwa">&lt;link</span> <span class="hl kwb">rel</span>=<span class="hl str">"stylesheet"</span> <span class="hl kwb">href</span>=<span class="hl str">"stylesheet.css"</span> <span class="hl kwb">type</span>=<span class="hl str">"text/css"</span> <span class="hl kwa">/&gt;</span>
<span class="hl kwa">&lt;/head&gt;</span>
<span class="hl kwa">&lt;body&gt;</span>
  <span class="hl kwa">&lt;form</span> <span class="hl kwb">method</span>=<span class="hl str">"post"</span> <span class="hl kwb">action</span>=<span class="hl str">"loginFormAction"</span> <span class="hl kwb">class</span>=<span class="hl str">"column"</span> <span class="hl kwb">id</span>=<span class="hl str">"form1"</span><span class="hl kwa">&gt;</span>
    <span class="hl kwa">&lt;h1&gt;</span>BotDetect Java CAPTCHA Validation:<span class="hl kwa">&lt;br&gt;</span> JSP Login Form CAPTCHA Code Example<span class="hl kwa">&lt;/h1&gt;</span>
    <span class="hl kwa">&lt;fieldset&gt;</span>
      <span class="hl kwa">&lt;legend&gt;</span>CAPTCHA included in JSP form validation<span class="hl kwa">&lt;/legend&gt;</span>
      
      <span class="hl kwa">&lt;div</span> <span class="hl kwb">class</span>=<span class="hl str">"input"</span><span class="hl kwa">&gt;</span>
        <span class="hl kwa">&lt;label</span> <span class="hl kwb">for</span>=<span class="hl str">"username"</span><span class="hl kwa">&gt;</span>Username:<span class="hl kwa">&lt;/label&gt;</span>
        <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"text"</span> <span class="hl kwb">name</span>=<span class="hl str">"username"</span> <span class="hl kwb">id</span>=<span class="hl str">"username"</span> <span class="hl kwb">class</span>=<span class="hl str">"textbox"</span> <span class="hl kwb">value</span>=<span class="hl str">"${param.username}"</span> <span class="hl kwa">/&gt;</span>
      <span class="hl kwa">&lt;/div&gt;</span>

      <span class="hl kwa">&lt;div</span> <span class="hl kwb">class</span>=<span class="hl str">"input"</span><span class="hl kwa">&gt;</span>
        <span class="hl kwa">&lt;label</span> <span class="hl kwb">for</span>=<span class="hl str">"Password"</span><span class="hl kwa">&gt;</span>Password:<span class="hl kwa">&lt;/label&gt;</span>
        <span class="hl kwa">&lt;%</span> <span class="hl kwa">if</span> <span class="hl opt">(</span>request<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">) ==</span> null<span class="hl opt">) {</span> <span class="hl kwa">%&gt;</span>
            <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"password"</span> <span class="hl kwb">name</span>=<span class="hl str">"password"</span> <span class="hl kwb">id</span>=<span class="hl str">"password"</span> <span class="hl kwb">class</span>=<span class="hl str">"textbox"</span> <span class="hl kwa">/&gt;</span>
        <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span> <span class="hl kwa">%&gt;</span>
            <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"text"</span> <span class="hl kwb">name</span>=<span class="hl str">"password"</span> <span class="hl kwb">id</span>=<span class="hl str">"password"</span> <span class="hl kwb">class</span>=<span class="hl str">"textbox"</span> <span class="hl kwb">value</span>=<span class="hl str">"${param.password}"</span> <span class="hl kwa">/&gt;</span>
        <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">%&gt;</span>
      <span class="hl kwa">&lt;/div&gt;</span>
      
      <span class="hl kwa">&lt;label</span> <span class="hl kwb">class</span>=<span class="hl str">"incorrect"</span><span class="hl kwa">&gt;</span>${messages.loginError}<span class="hl kwa">&lt;/label&gt;</span>

      <span class="hl kwa">&lt;%</span>
        <span class="hl kwa">if</span> <span class="hl opt">((</span>request<span class="hl opt">.</span><span class="hl kwd">getSession</span><span class="hl opt">().</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">) ==</span> null<span class="hl opt">)</span> 
            <span class="hl opt">&amp;&amp; (</span>request<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">) ==</span> null<span class="hl opt">)) {</span>
      <span class="hl kwa">%&gt;</span>
          <span class="hl kwa">&lt;label</span> <span class="hl kwb">for</span>=<span class="hl str">"captchaCode"</span> <span class="hl kwb">class</span>=<span class="hl str">"prompt"</span><span class="hl kwa">&gt;</span>Retype the characters from the picture:<span class="hl kwa">&lt;/label&gt;</span>

          <span class="hl com">&lt;!-- Adding BotDetect Captcha to the page --&gt;</span>
          <strong><span class="hl kwa">&lt;botDetect:captcha</span> <span class="hl kwb">id</span>=<span class="hl str">"loginCaptcha"</span> 
                <span class="hl kwb">userInputID</span>=<span class="hl str">"captchaCode"</span>
                <span class="hl kwb">codeLength</span>=<span class="hl str">"4"</span>
                <span class="hl kwb">imageWidth</span>=<span class="hl str">"200"</span>
                <span class="hl kwb">codeStyle</span>=<span class="hl str">"ALPHA"</span> <span class="hl kwa">/&gt;</span></strong>

          <span class="hl kwa">&lt;div</span> <span class="hl kwb">class</span>=<span class="hl str">"validationDiv"</span><span class="hl kwa">&gt;</span>
            <span class="hl kwa">&lt;input</span> <span class="hl kwb">id</span>=<span class="hl str">"captchaCode"</span> <span class="hl kwb">type</span>=<span class="hl str">"text"</span> <span class="hl kwb">name</span>=<span class="hl str">"captchaCode"</span> <span class="hl kwa">/&gt;</span>
            <span class="hl kwa">&lt;span</span> <span class="hl kwb">class</span>=<span class="hl str">"incorrect"</span><span class="hl kwa">&gt;</span>${messages.captchaIncorrect}<span class="hl kwa">&lt;/span&gt;</span>
          <span class="hl kwa">&lt;/div&gt;</span>
      <span class="hl kwa">&lt;%</span>
        <span class="hl opt">}</span>
      <span class="hl kwa">%&gt;</span>
      
      <span class="hl kwa">&lt;%</span> <span class="hl kwa">if</span> <span class="hl opt">(</span>request<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">) ==</span> null<span class="hl opt">) {</span> <span class="hl kwa">%&gt;</span>
          <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"submit"</span> <span class="hl kwb">name</span>=<span class="hl str">"submitButton"</span> <span class="hl kwb">id</span>=<span class="hl str">"submitButton"</span> <span class="hl kwb">value</span>=<span class="hl str">"Login"</span> <span class="hl kwa">/&gt;</span>
      <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span> <span class="hl kwa">%&gt;</span>
          <span class="hl kwa">&lt;a</span> <span class="hl kwb">href</span>=<span class="hl str">"index.jsp"</span><span class="hl kwa">&gt;</span>Back to login page.<span class="hl kwa">&lt;/a&gt;</span>
      <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">%&gt;</span>
    <span class="hl kwa">&lt;/fieldset&gt;</span>
  <span class="hl kwa">&lt;/form&gt;</span>
<span class="hl kwa">&lt;/body&gt;</span>
<span class="hl kwa">&lt;/html&gt;</span>
</pre> 
      <p>The example login form is simple, containing textboxes for username and password input. We <a href="../howto/jsp-captcha.html#display">add Captcha protection to the form</a> using the standard procedure.</p> 
      <p>Note that we check for request parameter <code>isCaptchaSolved</code> to only display Captcha protection if it hasn't already been solved.</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <h3 id="LoginFormAction.java">LoginFormAction.java</h3> 
      <pre class="hl"><span class="hl kwa">package</span> com<span class="hl opt">.</span>captcha<span class="hl opt">.</span>botdetect<span class="hl opt">.</span>examples<span class="hl opt">.</span>jsp<span class="hl opt">.</span>login_form<span class="hl opt">;</span>

<span class="hl kwa">import</span> java<span class="hl opt">.</span>io<span class="hl opt">.</span>IOException<span class="hl opt">;</span>
<span class="hl kwa">import</span> java<span class="hl opt">.</span>util<span class="hl opt">.</span>HashMap<span class="hl opt">;</span>
<span class="hl kwa">import</span> java<span class="hl opt">.</span>util<span class="hl opt">.</span>Map<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>RequestDispatcher<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>ServletException<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpServlet<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpServletRequest<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpServletResponse<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpSession<span class="hl opt">;</span>

<span class="hl kwa">import</span> com<span class="hl opt">.</span>captcha<span class="hl opt">.</span>botdetect<span class="hl opt">.</span>web<span class="hl opt">.</span>servlet<span class="hl opt">.</span>Captcha<span class="hl opt">;</span>

<span class="hl kwa">public class</span> LoginFormAction <span class="hl kwa">extends</span> HttpServlet <span class="hl opt">{</span>
  
  <span class="hl kwa">private</span> HttpSession session<span class="hl opt">;</span>

  <span class="hl kwc">@Override</span>
  <span class="hl kwa">protected</span> <span class="hl kwb">void</span> <span class="hl kwd">doPost</span><span class="hl opt">(</span>HttpServletRequest request<span class="hl opt">,</span> HttpServletResponse response<span class="hl opt">)</span>
      <span class="hl kwa">throws</span> ServletException<span class="hl opt">,</span> IOException <span class="hl opt">{</span>
    session <span class="hl opt">=</span> request<span class="hl opt">.</span><span class="hl kwd">getSession</span><span class="hl opt">(</span>true<span class="hl opt">);</span>
    Map<span class="hl opt">&lt;</span>String<span class="hl opt">,</span> String<span class="hl opt">&gt;</span> messages <span class="hl opt">=</span> <span class="hl kwa">new</span> HashMap<span class="hl opt">&lt;</span>String<span class="hl opt">,</span> String<span class="hl opt">&gt;();</span>
    request<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"messages"</span><span class="hl opt">,</span> messages<span class="hl opt">);</span>
    
    <span class="hl kwb">boolean</span> isCaptchaSolved <span class="hl opt">= (</span>session<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">) !=</span> null<span class="hl opt">);</span>
 
    <span class="hl slc">// CAPTCHA user input validation</span>
    <span class="hl kwa">if</span> <span class="hl opt">(!</span>isCaptchaSolved<span class="hl opt">) {</span>
      <strong>Captcha captcha <span class="hl opt">=</span> Captcha<span class="hl opt">.</span><span class="hl kwd">load</span><span class="hl opt">(</span>request<span class="hl opt">,</span> <span class="hl str">"loginCaptcha"</span><span class="hl opt">);</span>
      <span class="hl slc">// validate the Captcha to check we're not dealing with a bot</span>
      <span class="hl kwb">boolean</span> isHuman <span class="hl opt">=</span> captcha<span class="hl opt">.</span><span class="hl kwd">validate</span><span class="hl opt">(</span>request<span class="hl opt">.</span><span class="hl kwd">getParameter</span><span class="hl opt">(</span><span class="hl str">"captchaCode"</span><span class="hl opt">));</span></strong>
      <span class="hl kwa">if</span> <span class="hl opt">(!</span>isHuman<span class="hl opt">) {</span>
        <span class="hl slc">// Captcha validation failed, show error message</span>
        messages<span class="hl opt">.</span><span class="hl kwd">put</span><span class="hl opt">(</span><span class="hl str">"captchaIncorrect"</span><span class="hl opt">,</span> <span class="hl str">"Incorrect code"</span><span class="hl opt">);</span>
      <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span>
        isCaptchaSolved <span class="hl opt">=</span> true<span class="hl opt">;</span>
        session<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">,</span> true<span class="hl opt">);</span>
      <span class="hl opt">}</span>
    <span class="hl opt">}</span>
    
    <span class="hl slc">// Captcha validation passed, only now do we perform the protected action </span>
    <span class="hl slc">// (try to authenticate the user)</span>
    <span class="hl kwa">if</span> <span class="hl opt">(</span>isCaptchaSolved<span class="hl opt">) {</span>
      <span class="hl slc">// sumbitted login data</span>
      String username <span class="hl opt">=</span> request<span class="hl opt">.</span><span class="hl kwd">getParameter</span><span class="hl opt">(</span><span class="hl str">"username"</span><span class="hl opt">);</span>
      String password <span class="hl opt">=</span> request<span class="hl opt">.</span><span class="hl kwd">getParameter</span><span class="hl opt">(</span><span class="hl str">"password"</span><span class="hl opt">);</span>

      <span class="hl slc">// check login format</span>
      <span class="hl kwb">boolean</span> isValidLoginFormat <span class="hl opt">=</span> <span class="hl kwd">validateLogin</span><span class="hl opt">(</span>username<span class="hl opt">,</span> password<span class="hl opt">);</span>
   
      <span class="hl kwa">if</span> <span class="hl opt">(!</span>isValidLoginFormat<span class="hl opt">) {</span>
        <span class="hl slc">// invalid login format, show error message</span>
        messages<span class="hl opt">.</span><span class="hl kwd">put</span><span class="hl opt">(</span><span class="hl str">"loginError"</span><span class="hl opt">,</span> <span class="hl str">"Invalid authentication info"</span><span class="hl opt">);</span>
      <span class="hl opt">}</span>
      
      <span class="hl slc">// authenticate the user</span>
      <span class="hl kwa">if</span> <span class="hl opt">(</span>isValidLoginFormat<span class="hl opt">) {</span>
        <span class="hl kwb">boolean</span> isAuthenticated <span class="hl opt">=</span> <span class="hl kwd">authenticate</span><span class="hl opt">(</span>username<span class="hl opt">,</span> password<span class="hl opt">);</span>
        <span class="hl kwa">if</span> <span class="hl opt">(!</span>isAuthenticated<span class="hl opt">) {</span>
          <span class="hl slc">// failing authentication 3 times shows the Captcha again</span>
          <span class="hl kwb">int</span> count <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>
          <span class="hl kwa">if</span> <span class="hl opt">(</span>session<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"failedAuthCount"</span><span class="hl opt">) !=</span> null<span class="hl opt">) {</span>
            count <span class="hl opt">= (</span>Integer<span class="hl opt">)</span> session<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"failedAuthCount"</span><span class="hl opt">);</span>
          <span class="hl opt">}</span>
          count<span class="hl opt">++;</span>
          <span class="hl kwa">if</span> <span class="hl opt">(</span>count <span class="hl opt">&gt;</span> <span class="hl num">2</span><span class="hl opt">) {</span>
            session<span class="hl opt">.</span><span class="hl kwd">removeAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">);</span>
            count <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>
          <span class="hl opt">}</span>
          session<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"failedAuthCount"</span><span class="hl opt">,</span> count<span class="hl opt">);</span>
          
          messages<span class="hl opt">.</span><span class="hl kwd">put</span><span class="hl opt">(</span><span class="hl str">"loginError"</span><span class="hl opt">,</span> <span class="hl str">"Authentication failed"</span><span class="hl opt">);</span>
        <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span>
          request<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">,</span> true<span class="hl opt">);</span>
          session<span class="hl opt">.</span><span class="hl kwd">removeAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">);</span>
        <span class="hl opt">}</span>
      <span class="hl opt">}</span>
    <span class="hl opt">}</span>
 
    RequestDispatcher dispatcher <span class="hl opt">=</span> <span class="hl kwd">getServletContext</span><span class="hl opt">().</span><span class="hl kwd">getRequestDispatcher</span><span class="hl opt">(</span><span class="hl str">"/index.jsp"</span><span class="hl opt">);</span>
    dispatcher<span class="hl opt">.</span><span class="hl kwd">forward</span><span class="hl opt">(</span>request<span class="hl opt">,</span> response<span class="hl opt">);</span>
  <span class="hl opt">}</span>

  <span class="hl kwa">private</span> <span class="hl kwb">boolean</span> <span class="hl kwd">validateLogin</span><span class="hl opt">(</span>String username<span class="hl opt">,</span> String password<span class="hl opt">) {</span>
    String pattern <span class="hl opt">=</span> <span class="hl str">"^[a-zA-Z0-9_]+$"</span><span class="hl opt">;</span> <span class="hl slc">// alphanumeric chars and underscores only</span>
    <span class="hl kwa">if</span> <span class="hl opt">((</span>username <span class="hl opt">!=</span> null<span class="hl opt">) &amp;&amp; (</span>password <span class="hl opt">!=</span> null<span class="hl opt">)) {</span>
      <span class="hl kwa">return</span> <span class="hl opt">(</span>username<span class="hl opt">.</span><span class="hl kwd">matches</span><span class="hl opt">(</span>pattern<span class="hl opt">) &amp;&amp;</span> password<span class="hl opt">.</span><span class="hl kwd">matches</span><span class="hl opt">(</span>pattern<span class="hl opt">));</span>
    <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span>
      <span class="hl kwa">return</span> false<span class="hl opt">;</span>
    <span class="hl opt">}</span>
  <span class="hl opt">}</span>

  <span class="hl kwa">private</span> <span class="hl kwb">boolean</span> <span class="hl kwd">authenticate</span><span class="hl opt">(</span>String username<span class="hl opt">,</span> String password<span class="hl opt">) {</span>
    <span class="hl kwa">return</span> <span class="hl opt">(</span>username<span class="hl opt">.</span><span class="hl kwd">length</span><span class="hl opt">() &gt;</span> <span class="hl num">4</span><span class="hl opt">) &amp;&amp; (</span>password<span class="hl opt">.</span><span class="hl kwd">length</span><span class="hl opt">() &gt;</span> <span class="hl num">4</span><span class="hl opt">);</span>
  <span class="hl opt">}</span>
<span class="hl opt">}</span>
</pre> 
      <p>We need to include the BotDetect Captcha library, and create a Captcha object with the same <code>id</code> (<code><span class="hl str">"loginCaptcha"</span></code>) and <code>userInputID</code> (<code><span class="hl str">"captchaCode"</span></code>) values as were used to show the Captcha on the login form.</p> 
      <p>Since we want to reset the Captcha status after 3 failed authentications, we keep the related counter in the <code>failedAuthCount </code> session value.</p> 
      <p>This allows us to implement the proper Login form workflow: </p>
      <ul class="continued"> 
       <li>The user must first solve the Captcha to prove they are human. This keeps the bots away from the authentication code, both conserving its resources and improving its security (since usernames and passwords will not be forwarded to the underlying data store if the Captcha is not solved first).</li> 
       <li>When the user has proven they are human, they get 3 authentication attempts without new Captcha tests, which allows them to remember the right combination in most cases.</li> 
       <li>If the user fails three authentication requests, they are shown a new Captcha which they must solve before continuing. This throttles authentication access, ensuring username + password combinations cannot be brute-forced, while real human users get theoretically unlimited authentication attempts (as long as they don't mind solving further Captchas).</li> 
      </ul> 
      <p>As previously mentioned, the actual authentication code is not implemented, but the example code should demonstrate the underlying principles adequately.</p> 
      <p>After successful authentication, the example just displays the user input (while a real login form would set an auth cookie and redirect the user to actual functionality).</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <h3 id="web.xml">web.xml</h3> 
      <pre class="hl"><span class="hl kwa">&lt;?xml</span> <span class="hl kwb">version</span>=<span class="hl str">"1.0"</span> <span class="hl kwb">encoding</span>=<span class="hl str">"UTF-8"</span><span class="hl kwa">?&gt;</span>
<span class="hl kwa">&lt;web-app</span> <span class="hl kwb">version</span>=<span class="hl str">"2.5"</span> <span class="hl kwb">xmlns</span>=<span class="hl str">"http://java.sun.com/xml/ns/javaee"</span> xmlns:<span class="hl kwb">xsi</span>=<span class="hl str">"http://www.w3.org/2001/XMLSchema-instance"</span> xsi:<span class="hl kwb">schemaLocation</span>=<span class="hl str">"http://java.sun.com/xml/ns/javaee                 http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span><span class="hl kwa">&gt;</span>
  <span class="hl kwa">&lt;session-config&gt;</span>
    <span class="hl kwa">&lt;session-timeout&gt;</span>
      <span class="hl num">30</span>
    <span class="hl kwa">&lt;/session-timeout&gt;</span>
  <span class="hl kwa">&lt;/session-config&gt;</span>
  
  <strong><span class="hl kwa">&lt;servlet&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>BotDetect Captcha<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;servlet-class&gt;</span>com.captcha.botdetect.web.servlet.CaptchaServlet<span class="hl kwa">&lt;/servlet-class&gt;</span>
  <span class="hl kwa">&lt;/servlet&gt;</span>
  <span class="hl kwa">&lt;servlet-mapping&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>BotDetect Captcha<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;url-pattern&gt;</span>/botdetectcaptcha<span class="hl kwa">&lt;/url-pattern&gt;</span>
  <span class="hl kwa">&lt;/servlet-mapping&gt;</span>
  
  <span class="hl kwa">&lt;servlet&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>LoginFormAction<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;servlet-class&gt;</span>com.captcha.botdetect.examples.jsp.login_form.LoginFormAction<span class="hl kwa">&lt;/servlet-class&gt;</span>
  <span class="hl kwa">&lt;/servlet&gt;</span>
  <span class="hl kwa">&lt;servlet-mapping&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>LoginFormAction<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;url-pattern&gt;</span>/loginFormAction<span class="hl kwa">&lt;/url-pattern&gt;</span>
  <span class="hl kwa">&lt;/servlet-mapping&gt;</span></strong>
  
  <span class="hl kwa">&lt;welcome-file-list&gt;</span>
    <span class="hl kwa">&lt;welcome-file&gt;</span>index.jsp<span class="hl kwa">&lt;/welcome-file&gt;</span>
  <span class="hl kwa">&lt;/welcome-file-list&gt;</span>
<span class="hl kwa">&lt;/web-app&gt;</span>
</pre> 
      <p>In <code>WEB-INF/web.xml</code> file we register <code>CaptchaServlet</code> used for BotDetect Captcha requests and register <code>LoginFormAction</code> servlet used for authenticating users.</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <br> 
     </div>
     <!-- end traditional-api --> 
     <div id="simple-api" data-tabstrip-group="traditionalapi-simpleapi" class="tab_content" style="display: none"> 
      <p>The JSP Login Form Captcha code example shows how to add <a href="../../../java-captcha.html" title="BotDetect Java CAPTCHA library">BotDetect CAPTCHA</a> protection to a typical JSP login form.</p> 
      <div class="bounded floater crash" style="margin-top: 15px;"> 
       <h3>First Time Here?</h3> 
       <p>Check the BotDetect <a href="../jsp-captcha-quickstart.html#simple-api" title="BotDetect Java Server Pages CAPTCHA Integration Quickstart">JSP Captcha Quickstart</a> for key integration steps.</p> 
      </div> 
      <p>To prevent bots from trying to guess the login info by brute force submission of a large number of common values, the visitor first has to prove they are human (by solving the CAPTCHA), and only then is their username and password submission checked against the authentication data store.</p> 
      <p>Also, if they enter an invalid username + password combination three times, they have to solve the CAPTCHA again. This prevents attempts in which the attacker would first solve the CAPTCHA themselves, and then let a bot brute-force the authentication info.</p> 
      <p>To keep the example code simple, the example doesn't access a data store to authenticate the user, but <strong>accepts all logins with usernames and passwords at least 5 characters long as valid</strong>.</p> 
      <a class="download_free" href="../../../captcha-download.html?version=java" title="Download the BotDetect Java CAPTCHA Library Free Version">Download the BotDetect Java library and run this example</a> 
      <h3>Downloaded Location</h3> 
      <p>The JSP Login Form CAPTCHA code example is included in the <br> <code>examples/simple-api/bdc4-simple-api-jsp-login-form-captcha-example.war</code> file of the download package. Deploying (unpacking) the file will create a standard JSP directory tree.</p> 
      <ul class="sitemap"> 
       <li><a href="#simple-api:index.jsp">index.jsp</a></li> 
       <li><a href="#simple-api:LoginFormAction.java">WEB-INF/src/com/captcha/botdetect/examples/jsp/login_form/LoginFormAction.java</a></li> 
       <li><a href="#simple-api:botdetect.xml">WEB-INF/botdetect.xml</a></li> 
       <li><a href="#simple-api:web.xml">WEB-INF/web.xml</a></li> 
      </ul> 
      <h3>Running Example</h3> 
      <p>This example's war file (in BotDetect download package) already embeds all dependencies.</p> 
      <p>In case you are making this example from scratch in your IDE, you need to ensure <code>botdetect.jar</code>, <code>botdetect-servlet.jar</code>, <code>simple-botdetect-jsp20.jar</code>, and <code>hsqldb.jar</code> (HyperSQL DB library) are in the classpath.</p> 
      <h3 id="simple-api:index.jsp">index.jsp</h3> 
      <pre class="hl"><span class="hl kwa">&lt;%@</span>page trimDirectiveWhitespaces<span class="hl opt">=</span><span class="hl str">"true"</span><span class="hl kwa">%&gt;</span>
<span class="hl kwa">&lt;%@</span>page contentType<span class="hl opt">=</span><span class="hl str">"text/html"</span> pageEncoding<span class="hl opt">=</span><span class="hl str">"UTF-8"</span><span class="hl kwa">%&gt;</span>
<strong><span class="hl kwa">&lt;%@</span>taglib prefix<span class="hl opt">=</span><span class="hl str">"botDetect"</span> uri<span class="hl opt">=</span><span class="hl str">"https://captcha.com/java/jsp"</span><span class="hl kwa">%&gt;</span></strong>
<span class="hl kwa">&lt;!DOCTYPE</span> html<span class="hl kwa">&gt;</span>
<span class="hl kwa">&lt;html&gt;</span>
<span class="hl kwa">&lt;head&gt;</span>
  <span class="hl kwa">&lt;meta</span> <span class="hl kwb">http-equiv</span>=<span class="hl str">"Content-Type"</span> <span class="hl kwb">content</span>=<span class="hl str">"text/html; charset=UTF-8"</span><span class="hl kwa">&gt;</span>
  <span class="hl kwa">&lt;title&gt;</span>BotDetect Java CAPTCHA Validation: JSP Login Form CAPTCHA Code Example<span class="hl kwa">&lt;/title&gt;</span>
  <span class="hl kwa">&lt;link</span> <span class="hl kwb">rel</span>=<span class="hl str">"stylesheet"</span> <span class="hl kwb">href</span>=<span class="hl str">"stylesheet.css"</span> <span class="hl kwb">type</span>=<span class="hl str">"text/css"</span> <span class="hl kwa">/&gt;</span>
<span class="hl kwa">&lt;/head&gt;</span>
<span class="hl kwa">&lt;body&gt;</span>
  <span class="hl kwa">&lt;form</span> <span class="hl kwb">method</span>=<span class="hl str">"post"</span> <span class="hl kwb">action</span>=<span class="hl str">"loginFormAction"</span> <span class="hl kwb">class</span>=<span class="hl str">"column"</span> <span class="hl kwb">id</span>=<span class="hl str">"form1"</span><span class="hl kwa">&gt;</span>
    <span class="hl kwa">&lt;h1&gt;</span>BotDetect Java CAPTCHA Validation:<span class="hl kwa">&lt;br&gt;</span> JSP Login Form CAPTCHA Code Example<span class="hl kwa">&lt;/h1&gt;</span>
    <span class="hl kwa">&lt;fieldset&gt;</span>
      <span class="hl kwa">&lt;legend&gt;</span>CAPTCHA included in JSP form validation<span class="hl kwa">&lt;/legend&gt;</span>
      
      <span class="hl kwa">&lt;div</span> <span class="hl kwb">class</span>=<span class="hl str">"input"</span><span class="hl kwa">&gt;</span>
        <span class="hl kwa">&lt;label</span> <span class="hl kwb">for</span>=<span class="hl str">"username"</span><span class="hl kwa">&gt;</span>Username:<span class="hl kwa">&lt;/label&gt;</span>
        <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"text"</span> <span class="hl kwb">name</span>=<span class="hl str">"username"</span> <span class="hl kwb">id</span>=<span class="hl str">"username"</span> <span class="hl kwb">class</span>=<span class="hl str">"textbox"</span> <span class="hl kwb">value</span>=<span class="hl str">"${param.username}"</span> <span class="hl kwa">/&gt;</span>
      <span class="hl kwa">&lt;/div&gt;</span>

      <span class="hl kwa">&lt;div</span> <span class="hl kwb">class</span>=<span class="hl str">"input"</span><span class="hl kwa">&gt;</span>
        <span class="hl kwa">&lt;label</span> <span class="hl kwb">for</span>=<span class="hl str">"Password"</span><span class="hl kwa">&gt;</span>Password:<span class="hl kwa">&lt;/label&gt;</span>
        <span class="hl kwa">&lt;%</span> <span class="hl kwa">if</span> <span class="hl opt">(</span>request<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">) ==</span> null<span class="hl opt">) {</span> <span class="hl kwa">%&gt;</span>
            <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"password"</span> <span class="hl kwb">name</span>=<span class="hl str">"password"</span> <span class="hl kwb">id</span>=<span class="hl str">"password"</span> <span class="hl kwb">class</span>=<span class="hl str">"textbox"</span> <span class="hl kwa">/&gt;</span>
        <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span> <span class="hl kwa">%&gt;</span>
            <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"text"</span> <span class="hl kwb">name</span>=<span class="hl str">"password"</span> <span class="hl kwb">id</span>=<span class="hl str">"password"</span> <span class="hl kwb">class</span>=<span class="hl str">"textbox"</span> <span class="hl kwb">value</span>=<span class="hl str">"${param.password}"</span> <span class="hl kwa">/&gt;</span>
        <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">%&gt;</span>
      <span class="hl kwa">&lt;/div&gt;</span>
      
      <span class="hl kwa">&lt;label</span> <span class="hl kwb">class</span>=<span class="hl str">"incorrect"</span><span class="hl kwa">&gt;</span>${messages.loginError}<span class="hl kwa">&lt;/label&gt;</span>

      <span class="hl kwa">&lt;%</span>
        <span class="hl kwa">if</span> <span class="hl opt">((</span>request<span class="hl opt">.</span><span class="hl kwd">getSession</span><span class="hl opt">().</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">) ==</span> null<span class="hl opt">)</span> 
            <span class="hl opt">&amp;&amp; (</span>request<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">) ==</span> null<span class="hl opt">)) {</span>
      <span class="hl kwa">%&gt;</span>
          <span class="hl kwa">&lt;label</span> <span class="hl kwb">for</span>=<span class="hl str">"captchaCode"</span> <span class="hl kwb">class</span>=<span class="hl str">"prompt"</span><span class="hl kwa">&gt;</span>Retype the characters from the picture:<span class="hl kwa">&lt;/label&gt;</span>

          <span class="hl com">&lt;!-- Adding BotDetect Captcha to the page --&gt;</span>
          <strong><span class="hl kwa">&lt;botDetect:simpleCaptcha</span> <span class="hl kwb">styleName</span>=<span class="hl str">"loginCaptcha"</span></strong>

          <span class="hl kwa">&lt;div</span> <span class="hl kwb">class</span>=<span class="hl str">"validationDiv"</span><span class="hl kwa">&gt;</span>
            <span class="hl kwa">&lt;input</span> <span class="hl kwb">id</span>=<span class="hl str">"captchaCode"</span> <span class="hl kwb">type</span>=<span class="hl str">"text"</span> <span class="hl kwb">name</span>=<span class="hl str">"captchaCode"</span> <span class="hl kwa">/&gt;</span>
            <span class="hl kwa">&lt;span</span> <span class="hl kwb">class</span>=<span class="hl str">"incorrect"</span><span class="hl kwa">&gt;</span>${messages.captchaIncorrect}<span class="hl kwa">&lt;/span&gt;</span>
          <span class="hl kwa">&lt;/div&gt;</span>
      <span class="hl kwa">&lt;%</span>
        <span class="hl opt">}</span>
      <span class="hl kwa">%&gt;</span>
      
      <span class="hl kwa">&lt;%</span> <span class="hl kwa">if</span> <span class="hl opt">(</span>request<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">) ==</span> null<span class="hl opt">) {</span> <span class="hl kwa">%&gt;</span>
          <span class="hl kwa">&lt;input</span> <span class="hl kwb">type</span>=<span class="hl str">"submit"</span> <span class="hl kwb">name</span>=<span class="hl str">"submitButton"</span> <span class="hl kwb">id</span>=<span class="hl str">"submitButton"</span> <span class="hl kwb">value</span>=<span class="hl str">"Login"</span> <span class="hl kwa">/&gt;</span>
      <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span> <span class="hl kwa">%&gt;</span>
          <span class="hl kwa">&lt;a</span> <span class="hl kwb">href</span>=<span class="hl str">"index.jsp"</span><span class="hl kwa">&gt;</span>Back to login page.<span class="hl kwa">&lt;/a&gt;</span>
      <span class="hl kwa">&lt;%</span> <span class="hl opt">}</span> <span class="hl kwa">%&gt;</span>
    <span class="hl kwa">&lt;/fieldset&gt;</span>
  <span class="hl kwa">&lt;/form&gt;</span>
<span class="hl kwa">&lt;/body&gt;</span>
<span class="hl kwa">&lt;/html&gt;</span>
</pre> 
      <p>The example login form is simple, containing textboxes for username and password input. We <a href="../howto/jsp-captcha.html#display">add Captcha protection to the form</a> using the standard procedure.</p> 
      <p>Note that we check for request parameter <code>isCaptchaSolved</code> to only display Captcha protection if it hasn't already been solved.</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <h3 id="simple-api:LoginFormAction.java">LoginFormAction.java</h3> 
      <pre class="hl"><span class="hl kwa">package</span> com<span class="hl opt">.</span>captcha<span class="hl opt">.</span>botdetect<span class="hl opt">.</span>examples<span class="hl opt">.</span>jsp<span class="hl opt">.</span>login_form<span class="hl opt">;</span>

<span class="hl kwa">import</span> java<span class="hl opt">.</span>io<span class="hl opt">.</span>IOException<span class="hl opt">;</span>
<span class="hl kwa">import</span> java<span class="hl opt">.</span>util<span class="hl opt">.</span>HashMap<span class="hl opt">;</span>
<span class="hl kwa">import</span> java<span class="hl opt">.</span>util<span class="hl opt">.</span>Map<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>RequestDispatcher<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>ServletException<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpServlet<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpServletRequest<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpServletResponse<span class="hl opt">;</span>
<span class="hl kwa">import</span> javax<span class="hl opt">.</span>servlet<span class="hl opt">.</span>http<span class="hl opt">.</span>HttpSession<span class="hl opt">;</span>

<span class="hl kwa">import</span> com<span class="hl opt">.</span>captcha<span class="hl opt">.</span>botdetect<span class="hl opt">.</span>web<span class="hl opt">.</span>servlet<span class="hl opt">.</span>SimpleCaptcha<span class="hl opt">;</span>

<span class="hl kwa">public class</span> LoginFormAction <span class="hl kwa">extends</span> HttpServlet <span class="hl opt">{</span>
  
  <span class="hl kwa">private</span> HttpSession session<span class="hl opt">;</span>

  <span class="hl kwc">@Override</span>
  <span class="hl kwa">protected</span> <span class="hl kwb">void</span> <span class="hl kwd">doPost</span><span class="hl opt">(</span>HttpServletRequest request<span class="hl opt">,</span> HttpServletResponse response<span class="hl opt">)</span>
      <span class="hl kwa">throws</span> ServletException<span class="hl opt">,</span> IOException <span class="hl opt">{</span>
    session <span class="hl opt">=</span> request<span class="hl opt">.</span><span class="hl kwd">getSession</span><span class="hl opt">(</span>true<span class="hl opt">);</span>
    Map<span class="hl opt">&lt;</span>String<span class="hl opt">,</span> String<span class="hl opt">&gt;</span> messages <span class="hl opt">=</span> <span class="hl kwa">new</span> HashMap<span class="hl opt">&lt;</span>String<span class="hl opt">,</span> String<span class="hl opt">&gt;();</span>
    request<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"messages"</span><span class="hl opt">,</span> messages<span class="hl opt">);</span>
    
    <span class="hl kwb">boolean</span> isCaptchaSolved <span class="hl opt">= (</span>session<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">) !=</span> null<span class="hl opt">);</span>
 
    <span class="hl slc">// CAPTCHA user input validation</span>
    <span class="hl kwa">if</span> <span class="hl opt">(!</span>isCaptchaSolved<span class="hl opt">) {</span>
      <strong>SimpleCaptcha captcha <span class="hl opt">=</span> SimpleCaptcha<span class="hl opt">.</span><span class="hl kwd">load</span><span class="hl opt">(</span>request<span class="hl opt">,</span> <span class="hl str">"loginCaptcha"</span><span class="hl opt">);</span>
      <span class="hl slc">// validate the Captcha to check we're not dealing with a bot</span>
      <span class="hl kwb">boolean</span> isHuman <span class="hl opt">=</span> captcha<span class="hl opt">.</span><span class="hl kwd">validate</span><span class="hl opt">(</span>request<span class="hl opt">.</span><span class="hl kwd">getParameter</span><span class="hl opt">(</span><span class="hl str">"captchaCode"</span><span class="hl opt">));</span></strong>
      <span class="hl kwa">if</span> <span class="hl opt">(!</span>isHuman<span class="hl opt">) {</span>
        <span class="hl slc">// Captcha validation failed, show error message</span>
        messages<span class="hl opt">.</span><span class="hl kwd">put</span><span class="hl opt">(</span><span class="hl str">"captchaIncorrect"</span><span class="hl opt">,</span> <span class="hl str">"Incorrect code"</span><span class="hl opt">);</span>
      <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span>
        isCaptchaSolved <span class="hl opt">=</span> true<span class="hl opt">;</span>
        session<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">,</span> true<span class="hl opt">);</span>
      <span class="hl opt">}</span>
    <span class="hl opt">}</span>
    
    <span class="hl slc">// Captcha validation passed, only now do we perform the protected action </span>
    <span class="hl slc">// (try to authenticate the user)</span>
    <span class="hl kwa">if</span> <span class="hl opt">(</span>isCaptchaSolved<span class="hl opt">) {</span>
      <span class="hl slc">// sumbitted login data</span>
      String username <span class="hl opt">=</span> request<span class="hl opt">.</span><span class="hl kwd">getParameter</span><span class="hl opt">(</span><span class="hl str">"username"</span><span class="hl opt">);</span>
      String password <span class="hl opt">=</span> request<span class="hl opt">.</span><span class="hl kwd">getParameter</span><span class="hl opt">(</span><span class="hl str">"password"</span><span class="hl opt">);</span>

      <span class="hl slc">// check login format</span>
      <span class="hl kwb">boolean</span> isValidLoginFormat <span class="hl opt">=</span> <span class="hl kwd">validateLogin</span><span class="hl opt">(</span>username<span class="hl opt">,</span> password<span class="hl opt">);</span>
   
      <span class="hl kwa">if</span> <span class="hl opt">(!</span>isValidLoginFormat<span class="hl opt">) {</span>
        <span class="hl slc">// invalid login format, show error message</span>
        messages<span class="hl opt">.</span><span class="hl kwd">put</span><span class="hl opt">(</span><span class="hl str">"loginError"</span><span class="hl opt">,</span> <span class="hl str">"Invalid authentication info"</span><span class="hl opt">);</span>
      <span class="hl opt">}</span>
      
      <span class="hl slc">// authenticate the user</span>
      <span class="hl kwa">if</span> <span class="hl opt">(</span>isValidLoginFormat<span class="hl opt">) {</span>
        <span class="hl kwb">boolean</span> isAuthenticated <span class="hl opt">=</span> <span class="hl kwd">authenticate</span><span class="hl opt">(</span>username<span class="hl opt">,</span> password<span class="hl opt">);</span>
        <span class="hl kwa">if</span> <span class="hl opt">(!</span>isAuthenticated<span class="hl opt">) {</span>
          <span class="hl slc">// failing authentication 3 times shows the Captcha again</span>
          <span class="hl kwb">int</span> count <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>
          <span class="hl kwa">if</span> <span class="hl opt">(</span>session<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"failedAuthCount"</span><span class="hl opt">) !=</span> null<span class="hl opt">) {</span>
            count <span class="hl opt">= (</span>Integer<span class="hl opt">)</span> session<span class="hl opt">.</span><span class="hl kwd">getAttribute</span><span class="hl opt">(</span><span class="hl str">"failedAuthCount"</span><span class="hl opt">);</span>
          <span class="hl opt">}</span>
          count<span class="hl opt">++;</span>
          <span class="hl kwa">if</span> <span class="hl opt">(</span>count <span class="hl opt">&gt;</span> <span class="hl num">2</span><span class="hl opt">) {</span>
            session<span class="hl opt">.</span><span class="hl kwd">removeAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">);</span>
            count <span class="hl opt">=</span> <span class="hl num">0</span><span class="hl opt">;</span>
          <span class="hl opt">}</span>
          session<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"failedAuthCount"</span><span class="hl opt">,</span> count<span class="hl opt">);</span>
          
          messages<span class="hl opt">.</span><span class="hl kwd">put</span><span class="hl opt">(</span><span class="hl str">"loginError"</span><span class="hl opt">,</span> <span class="hl str">"Authentication failed"</span><span class="hl opt">);</span>
        <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span>
          request<span class="hl opt">.</span><span class="hl kwd">setAttribute</span><span class="hl opt">(</span><span class="hl str">"isLoggedIn"</span><span class="hl opt">,</span> true<span class="hl opt">);</span>
          session<span class="hl opt">.</span><span class="hl kwd">removeAttribute</span><span class="hl opt">(</span><span class="hl str">"isCaptchaSolved"</span><span class="hl opt">);</span>
        <span class="hl opt">}</span>
      <span class="hl opt">}</span>
    <span class="hl opt">}</span>
 
    RequestDispatcher dispatcher <span class="hl opt">=</span> <span class="hl kwd">getServletContext</span><span class="hl opt">().</span><span class="hl kwd">getRequestDispatcher</span><span class="hl opt">(</span><span class="hl str">"/index.jsp"</span><span class="hl opt">);</span>
    dispatcher<span class="hl opt">.</span><span class="hl kwd">forward</span><span class="hl opt">(</span>request<span class="hl opt">,</span> response<span class="hl opt">);</span>
  <span class="hl opt">}</span>

  <span class="hl kwa">private</span> <span class="hl kwb">boolean</span> <span class="hl kwd">validateLogin</span><span class="hl opt">(</span>String username<span class="hl opt">,</span> String password<span class="hl opt">) {</span>
    String pattern <span class="hl opt">=</span> <span class="hl str">"^[a-zA-Z0-9_]+$"</span><span class="hl opt">;</span> <span class="hl slc">// alphanumeric chars and underscores only</span>
    <span class="hl kwa">if</span> <span class="hl opt">((</span>username <span class="hl opt">!=</span> null<span class="hl opt">) &amp;&amp; (</span>password <span class="hl opt">!=</span> null<span class="hl opt">)) {</span>
      <span class="hl kwa">return</span> <span class="hl opt">(</span>username<span class="hl opt">.</span><span class="hl kwd">matches</span><span class="hl opt">(</span>pattern<span class="hl opt">) &amp;&amp;</span> password<span class="hl opt">.</span><span class="hl kwd">matches</span><span class="hl opt">(</span>pattern<span class="hl opt">));</span>
    <span class="hl opt">}</span> <span class="hl kwa">else</span> <span class="hl opt">{</span>
      <span class="hl kwa">return</span> false<span class="hl opt">;</span>
    <span class="hl opt">}</span>
  <span class="hl opt">}</span>

  <span class="hl kwa">private</span> <span class="hl kwb">boolean</span> <span class="hl kwd">authenticate</span><span class="hl opt">(</span>String username<span class="hl opt">,</span> String password<span class="hl opt">) {</span>
    <span class="hl kwa">return</span> <span class="hl opt">(</span>username<span class="hl opt">.</span><span class="hl kwd">length</span><span class="hl opt">() &gt;</span> <span class="hl num">4</span><span class="hl opt">) &amp;&amp; (</span>password<span class="hl opt">.</span><span class="hl kwd">length</span><span class="hl opt">() &gt;</span> <span class="hl num">4</span><span class="hl opt">);</span>
  <span class="hl opt">}</span>
<span class="hl opt">}</span>
</pre> 
      <p>We need to include the BotDetect Captcha library, and create a <code>SimpleCaptcha</code> object with the same captcha style name <code>("loginCaptcha")</code> and retreive user code from <code>captchaCode</code> name of captcha input field.</p> 
      <p>Since we want to reset the Captcha status after 3 failed authentications, we keep the related counter in the <code>failedAuthCount </code> session value.</p> 
      <p>This allows us to implement the proper Login form workflow: </p>
      <ul class="continued"> 
       <li>The user must first solve the Captcha to prove they are human. This keeps the bots away from the authentication code, both conserving its resources and improving its security (since usernames and passwords will not be forwarded to the underlying data store if the Captcha is not solved first).</li> 
       <li>When the user has proven they are human, they get 3 authentication attempts without new Captcha tests, which allows them to remember the right combination in most cases.</li> 
       <li>If the user fails three authentication requests, they are shown a new Captcha which they must solve before continuing. This throttles authentication access, ensuring username + password combinations cannot be brute-forced, while real human users get theoretically unlimited authentication attempts (as long as they don't mind solving further Captchas).</li> 
      </ul> 
      <p>As previously mentioned, the actual authentication code is not implemented, but the example code should demonstrate the underlying principles adequately.</p> 
      <p>After successful authentication, the example just displays the user input (while a real login form would set an auth cookie and redirect the user to actual functionality).</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <h3 id="simple-api:botdetect.xml">botdetect.xml</h3> 
      <pre class="hl"><span class="hl kwa">&lt;?xml</span> <span class="hl kwb">version</span>=<span class="hl str">"1.0"</span> <span class="hl kwb">encoding</span>=<span class="hl str">"UTF-8"</span><span class="hl kwa">?&gt;</span>
<span class="hl kwa">&lt;botdetect</span> <span class="hl kwb">xmlns</span>=<span class="hl str">"https://captcha.com/schema/java"</span> 
    xmlns:<span class="hl kwb">xsi</span>=<span class="hl str">"http://www.w3.org/2001/XMLSchema-instance"</span>
    xsi:<span class="hl kwb">schemaLocation</span>=<span class="hl str">"https://captcha.com/schema/java </span>
<span class="hl str">      https://captcha.com/schema/java/botdetect-4.0.beta3.xsd"</span><span class="hl kwa">&gt;</span>

  <span class="hl kwa">&lt;captchaStyles&gt;</span>
    <span class="hl kwa">&lt;captchaStyle&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>loginCaptcha<span class="hl kwa">&lt;/name&gt;</span>
      <span class="hl kwa">&lt;userInputID&gt;</span>captchaCode<span class="hl kwa">&lt;/userInputID&gt;</span>
      <span class="hl kwa">&lt;codeLength&gt;</span><span class="hl num">4</span>-<span class="hl num">6</span><span class="hl kwa">&lt;/codeLength&gt;</span>
      <span class="hl kwa">&lt;imageWidth&gt;</span><span class="hl num">200</span><span class="hl kwa">&lt;/imageWidth&gt;</span>
      <span class="hl kwa">&lt;imageStyle&gt;</span>ALPHA<span class="hl kwa">&lt;/imageStyle&gt;</span>
    <span class="hl kwa">&lt;/captchaStyle&gt;</span>
  <span class="hl kwa">&lt;/captchaStyles&gt;</span>

<span class="hl kwa">&lt;/botdetect&gt;</span>
</pre> 
      <p>In <code>WEB-INF/botdetect.xml</code>, we configure captcha options for the <code>loginCaptcha</code> captcha style name. You can find a full list of available Captcha configuration options and related instructions at the <a href="../captcha-options.html#simple-api">Captcha configuration options</a> page.</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <h3 id="simple-api:web.xml">web.xml</h3> 
      <pre class="hl"><span class="hl kwa">&lt;?xml</span> <span class="hl kwb">version</span>=<span class="hl str">"1.0"</span> <span class="hl kwb">encoding</span>=<span class="hl str">"UTF-8"</span><span class="hl kwa">?&gt;</span>
<span class="hl kwa">&lt;web-app</span> <span class="hl kwb">version</span>=<span class="hl str">"2.5"</span> <span class="hl kwb">xmlns</span>=<span class="hl str">"http://java.sun.com/xml/ns/javaee"</span> xmlns:<span class="hl kwb">xsi</span>=<span class="hl str">"http://www.w3.org/2001/XMLSchema-instance"</span> xsi:<span class="hl kwb">schemaLocation</span>=<span class="hl str">"http://java.sun.com/xml/ns/javaee                 http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span><span class="hl kwa">&gt;</span>
  <span class="hl kwa">&lt;session-config&gt;</span>
    <span class="hl kwa">&lt;session-timeout&gt;</span>
      <span class="hl num">30</span>
    <span class="hl kwa">&lt;/session-timeout&gt;</span>
  <span class="hl kwa">&lt;/session-config&gt;</span>
  
  <strong><span class="hl kwa">&lt;servlet&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>BotDetect Captcha<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;servlet-class&gt;</span>com.captcha.botdetect.web.servlet.SimpleCaptchaServlet<span class="hl kwa">&lt;/servlet-class&gt;</span>
  <span class="hl kwa">&lt;/servlet&gt;</span>
  <span class="hl kwa">&lt;servlet-mapping&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>BotDetect Captcha<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;url-pattern&gt;</span>/botdetectcaptcha<span class="hl kwa">&lt;/url-pattern&gt;</span>
  <span class="hl kwa">&lt;/servlet-mapping&gt;</span>
  
  <span class="hl kwa">&lt;servlet&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>LoginFormAction<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;servlet-class&gt;</span>com.captcha.botdetect.examples.jsp.login_form.LoginFormAction<span class="hl kwa">&lt;/servlet-class&gt;</span>
  <span class="hl kwa">&lt;/servlet&gt;</span>
  <span class="hl kwa">&lt;servlet-mapping&gt;</span>
    <span class="hl kwa">&lt;servlet-name&gt;</span>LoginFormAction<span class="hl kwa">&lt;/servlet-name&gt;</span>
    <span class="hl kwa">&lt;url-pattern&gt;</span>/loginFormAction<span class="hl kwa">&lt;/url-pattern&gt;</span>
  <span class="hl kwa">&lt;/servlet-mapping&gt;</span></strong>
  
  <span class="hl kwa">&lt;welcome-file-list&gt;</span>
    <span class="hl kwa">&lt;welcome-file&gt;</span>index.jsp<span class="hl kwa">&lt;/welcome-file&gt;</span>
  <span class="hl kwa">&lt;/welcome-file-list&gt;</span>
<span class="hl kwa">&lt;/web-app&gt;</span>
</pre> 
      <p>In <code>WEB-INF/web.xml</code> file we register <code>SimpleCaptchaServlet</code> used for BotDetect Captcha requests and register <code>LoginFormAction</code> servlet used for authenticating users.</p> 
      <p class="toplink"><a href="#top" title="BotDetect JSP Login Form CAPTCHA Code Example">[back to top]</a></p> 
      <br> 
     </div>
     <!-- end simple-api --> 
     <div class="bounded important_note" style="position: absolute; top: 75px;"> 
      <h3>Please Note</h3> 
      <p>BotDetect Java Captcha Library v4.0.Beta3 is an in-progress port of BotDetect 4 Captcha, and we need you to guide our efforts towards a polished product. Please <a href="../../../contact.html?topic=java">let us know</a> if you encounter any bugs, implementation issues, or a usage scenario you would like to discuss.</p> 
     </div> 
    </div> 
    <div class="column" id="left"> 
     <div> 
      <ul class="navigation navlevel0"> 
       <li class="first expanded"> <a href="../../../" title="BotDetect CAPTCHA Generator Homepage">CAPTCHA Generator Home</a> 
        <ul class="navigation navlevel1"> 
         <li class="first"> <a href="../../../references.html" title="BotDetect CAPTCHA Customer References">Customer References</a> </li> 
         <li> <a href="../../../demos/features/captcha-demo.aspx" title="BotDetect CAPTCHA Online Demos">CAPTCHA Demo</a> </li> 
         <li> <a href="../../../captcha-download.html?version=java" title="Download BotDetect CAPTCHA Free Version">CAPTCHA Download</a> </li> 
         <li> <a href="../../../captcha-examples.html" title="BotDetect CAPTCHA Image &amp; Audio CAPTCHA Samples">CAPTCHA Samples</a> </li> 
         <li> <a href="../../../captcha-localizations.html" title="BotDetect CAPTCHA Localization Details &amp; Downloads Page">CAPTCHA Localizations</a> </li> 
         <li> <a href="../../../asp.net-captcha.html" title="BotDetect ASP.NET CAPTCHA Control">ASP.NET CAPTCHA Control</a> </li> 
         <li class="expanded"> <a href="../../../java-captcha.html" title="BotDetect Java CAPTCHA library">Java CAPTCHA Library <span class="alpha">Beta</span></a> 
          <ul class="navigation navlevel2"> 
           <li class="first"> <a href="../../../doc/java/captcha-getting-started.html" title="Getting Started with BotDetect Java CAPTCHA">Getting Started</a> </li> 
           <li class="expanded"> <a href="../../../doc/java/jsp-captcha-quickstart.html" title="BotDetect JavaServer Pages CAPTCHA">JSP CAPTCHA</a> 
            <ul class="navigation navlevel3"> 
             <li class="first"> <a href="../../../doc/java/jsp-captcha-quickstart.html" title="BotDetect JavaServer Pages CAPTCHA Quickstart">JSP CAPTCHA Quickstart</a> </li> 
             <li> <a href="../../../doc/java/howto/jsp-captcha.html" title="How To Add BotDetect CAPTCHA Protection to JavaServer Pages Forms">JSP CAPTCHA Integration Guide</a> </li> 
             <li> <a href="../../../doc/java/examples/jsp-basic-captcha-example.html" title="JavaServer Pages Basic CAPTCHA Code Example">JSP Basic CAPTCHA Example</a> </li> 
             <li> <a href="../../../doc/java/examples/jsp-captcha-tag-example.html" title="JavaServer Pages CAPTCHA Tag Code Example">JSP CAPTCHA Tag Example</a> </li> 
             <li> <a href="../../../doc/java/examples/jsp-form-captcha-example.html" title="JavaServer Pages Form CAPTCHA Code Example">JSP Form CAPTCHA Example</a> </li> 
             <li> <span>JSP Login Form CAPTCHA Example</span> </li> 
             <li class="last"> <a href="../../../doc/java/examples/jsp-jquery-captcha-example.html" title="JavaServer Pages jQuery CAPTCHA Code Example">JSP jQuery CAPTCHA Example</a> </li> 
            </ul> </li> 
           <li> <a href="../../../doc/java/howto/jsf-captcha.html" title="BotDetect JavaServer Faces CAPTCHA">JSF CAPTCHA</a> </li> 
           <li> <a href="../../../doc/java/howto/springmvc-captcha.html" title="BotDetect Spring MVC CAPTCHA">Spring MVC CAPTCHA</a> </li> 
           <li> <a href="../../../doc/java/struts-captcha-quickstart.html" title="BotDetect Struts CAPTCHA">Struts CAPTCHA</a> </li> 
           <li> <a href="../../../doc/java/maven-captcha.html" title="Setting BotDetect CAPTCHA Java Build Dependencies">Build (Maven, Gradle, Ant, Ivy)</a> </li> 
           <li> <a href="../../../doc/java/captcha-options.html" title="BotDetect CAPTCHA Java Configuration Guides &amp; Examples">Configuration</a> </li> 
           <li> <a href="../../../doc/java/howto/captcha-deployment.html" title="BotDetect Java CAPTCHA Deployment Guides">Deployment</a> </li> 
           <li> <a href="../../../doc/java/captcha-faq.html" title="BotDetect CAPTCHA Java Technical FAQ">Technical FAQ</a> </li> 
           <li class="last"> <a href="../../../doc/java/captcha-api-reference.html" title="BotDetect Java CAPTCHA API Reference">API Reference</a> </li> 
          </ul> </li> 
         <li> <a href="../../../php-captcha.html" title="BotDetect PHP CAPTCHA Library">PHP CAPTCHA Library</a> </li> 
         <li> <a href="../../../asp-captcha.html" title="BotDetect ASP Classic CAPTCHA Component">Classic ASP CAPTCHA</a> </li> 
         <li> <a href="../../../angular-captcha.html" title="BotDetect CAPTCHA Angular Module">Angular CAPTCHA Module</a> </li> 
         <li> <a href="../../../captcha-faq.html" title="BotDetect CAPTCHA General FAQ">BotDetect General FAQ</a> </li> 
         <li> <a href="../../../captcha-roadmap-and-release-notes.html" title="BotDetect CAPTCHA Release Notes">Roadmap &amp; Release Notes</a> </li> 
         <li> <a href="../../../captcha-migration-guides.html" title="BotDetect CAPTCHA Migration Guides">Migration Guides</a> </li> 
         <li class="last"> <a href="../../../captcha-known-issues.html" title="BotDetect CAPTCHA Known Issues">Known Issues</a> </li> 
        </ul> </li> 
       <li> <a href="../../../shop.html" title="BotDetect CAPTCHA Online Store">Shop</a> </li> 
       <li> <a href="../../../documentation.html" title="BotDetect CAPTCHA Documentation Index">Documentation</a> </li> 
       <li> <a href="../../../captcha-accessibility.html" title="Strict Standards - Introduction to CAPTCHA Accessibility">Captcha Accessibility</a> </li> 
       <li> <a href="../../../articles/can-captcha-be-broken.html" title="CAPTCHA Articles">Articles</a> </li> 
       <li class="last"> <a href="../../../about/captcha-inc.html" title="About Captcha, Inc">About</a> </li> 
      </ul> 
     </div> 
     <div id="current_versions"> 
      <h3>Current BotDetect Versions</h3> 
      <ul> 
       <li> <span style="font-family:Arial;font-size:12px;padding-left:0">BotDetect ASP.NET CAPTCHA</span><br> <a href="../../../captcha-roadmap-and-release-notes.html#aspnet-release-notes" title="BotDetect ASP.NET CAPTCHA Control Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2017-04-29</span>
         </div> 
         <div style="display:inline;">
          v4.2.0
         </div> </a><br> <a href="../../../captcha-roadmap-and-release-notes.html#aspnet-release-notes" title="BotDetect ASP.NET CAPTCHA Control Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2015-12-03</span>
         </div> 
         <div style="display:inline;">
          v3.0.18
         </div> </a> </li> 
       <li> <span style="font-family:Arial;font-size:12px;padding-left:0">BotDetect Java CAPTCHA</span><br> <a href="../../../captcha-roadmap-and-release-notes.html#java-release-notes" title="BotDetect Java CAPTCHA Library Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2017-05-18</span>
         </div> 
         <div style="display:inline;">
          v4.0.Beta3
         </div> </a><br> <a href="../../../captcha-roadmap-and-release-notes.html#java-release-notes" title="BotDetect Java CAPTCHA Library Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2015-12-03</span>
         </div> 
         <div style="display:inline;">
          v3.0.Alpha3
         </div> </a> </li> 
       <li> <span style="font-family:Arial;font-size:12px;padding-left:0">BotDetect ASP Classic CAPTCHA</span><br> <a href="../../../captcha-roadmap-and-release-notes.html#asp-release-notes" title="BotDetect ASP Classic CAPTCHA Component Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2016-07-25</span>
         </div> 
         <div style="display:inline;">
          v4.1.0
         </div> </a><br> <a href="../../../captcha-roadmap-and-release-notes.html#asp-release-notes" title="BotDetect ASP Classic CAPTCHA Component Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2015-12-03</span>
         </div> 
         <div style="display:inline;">
          v3.0.18
         </div> </a> </li> 
       <li> <span style="font-family:Arial;font-size:12px;padding-left:0">BotDetect PHP CAPTCHA</span><br> <a href="../../../captcha-roadmap-and-release-notes.html#php-release-notes" title="BotDetect PHP CAPTCHA Library Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2016-06-08</span>
         </div> 
         <div style="display:inline;">
          v4.1.0
         </div> </a><br> <a href="../../../captcha-roadmap-and-release-notes.html#php-release-notes" title="BotDetect PHP CAPTCHA Library Release Notes"> 
         <div style="display:inline;">
          <span style="padding-left:0;padding-right:15px;">2015-12-03</span>
         </div> 
         <div style="display:inline;">
          v3.0.4
         </div> </a> </li> 
      </ul> 
     </div> 
     <div class="extra"> 
      <h3>Popular Content</h3>
      <ul>
       <li><a href="../../../angular-captcha.html" title="Angular Captcha">Angular Captcha</a></li>
       <li><a href="../../../articles/audio-captcha.html" title="Sound Advice: All About Audio CAPTCHA">Audio Captcha</a></li>
       <li><a href="../../../captcha-accessibility.html" title="Strict Standards: Introduction to CAPTCHA Accessibility">Captcha Accessibility</a></li>
       <li><a href="../../../accessibility/section508-captcha.html" title="Section 508 CAPTCHA: How to Make CAPTCHA Comply with Access Board Section 508 Standards">Section 508 Captcha</a></li>
       <li><a href="../../../accessibility/wcag-captcha.html" title="WCAG CAPTCHA: How to Make CAPTCHA Conform to W3C WCAG 2.0 Standards">WCAG Captcha</a></li>
       <li><a href="../../../accessibility/ada-captcha.html" title="ADA CAPTCHA: Does CAPTCHA Need to Comply with the ADA Standards?">ADA Captcha</a></li>
       <li><a href="../../../mvc-captcha.html" title="BotDetect MVC CAPTCHA Documentation">MVC Captcha</a></li>
       <li><a href="../../../javascript-captcha.html" title="BotDetect JavaScript CAPTCHA Documentation">JavaScript Captcha</a></li>
       <li><a href="../../../ajax-captcha.html" title="BotDetect Ajax CAPTCHA Documentation">Ajax Captcha</a></li>
       <li><a href="../../../jquery-captcha.html" title="BotDetect jQuery CAPTCHA Documentation">jQuery Captcha</a></li>
       <li><a href="../../.././#recaptcha_vs_botdetect_captcha" title="BotDetect Captcha vs. Recaptcha">BotDetect Captcha vs.<br>Recaptcha the Stalker</a></li>
      </ul> 
     </div> 
    </div> 
    <div class="column" id="right"> 
     <div class="references_movie"> 
      <a href="../../../references.html" title="BotDetect Captcha Customer References">BotDetect Captcha Customer References</a> 
      <div id="references_movie_container"></div> 
     </div> 
     <div class="action">
      <a href="../../../demos/features/captcha-demo.aspx" title="Run the BotDetect CAPTCHA Online Demo"><img src="../../../images/demo.png" alt="Run the BotDetect CAPTCHA Online Demo"><span><strong class="highlight">Live</strong> BotDetect Captcha <strong>Demo</strong></span></a>
     </div> 
     <div class="action">
      <a href="../../../captcha-download.html?version=java" title="Download the BotDetect CAPTCHA Free Version"><img src="../../../images/download.png" alt="Download the BotDetect CAPTCHA  Free Version"><span><strong class="highlight">Free</strong> BotDetect Captcha <strong>Download</strong></span></a>
     </div> 
     <div class="action">
      <a href="../../../shop.html" title="Purchase BotDetect CAPTCHA  License Upgrades"><img src="../../../images/shop.png" alt="Purchase BotDetect CAPTCHA  License Upgrades"><span><strong class="highlight">Full</strong> BotDetect Captcha <strong>Purchase</strong></span></a>
     </div> 
     <div id="image_examples"> 
      <h3>BotDetect Captcha Image Samples</h3>
      <!-- Set3--> 
      <img src="../../../images/captcha/180/botdetect-captcha-ripple.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <img src="../../../images/captcha/180/botdetect-captcha-thickthinlines2.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <img src="../../../images/captcha/180/botdetect-captcha-halo.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <a href="../../../localizations/russian-captcha.html" title="Russian Captcha "><img src="../../../images/captcha/180/cyrillic/botdetect-captcha-cyrillic-graffiti.jpg" alt="BotDetect Russian CAPTCHA  image style screenshot"> </a> 
      <img src="../../../images/captcha/180/botdetect-captcha-stitch.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <!-- Set12--> 
      <img src="../../../images/captcha/180/botdetect-captcha-chess.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <a href="../../../localizations/greek-captcha.html" title="Greek Captcha "><img src="../../../images/captcha/180/greek/botdetect-captcha-greek-caughtinthenet2.jpg" alt="BotDetect Greek CAPTCHA  image style screenshot"> </a> 
      <img src="../../../images/captcha/180/botdetect-captcha-graffiti2.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <img src="../../../images/captcha/180/botdetect-captcha-neon.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <img src="../../../images/captcha/180/botdetect-captcha-sunrays.jpg" alt="BotDetect CAPTCHA  image style screenshot"> 
      <p><a href="../../../captcha-examples.html" title="View all BotDetect CAPTCHA  image screenshots">More CAPTCHA image samples...</a></p> 
     </div> 
     <div id="sound_examples"> 
      <h3>BotDetect Audio Captcha Sound Samples</h3>
      <a class="sample" href="../../../sounds/radio.wav" title="Play BotDetect Audio CAPTCHA sound Sample" onclick="l_PlaySound('../../../sounds/radio.wav', 'radio_sample_placeholder'); return false;">Radio</a>
      <div class="placeholder" id="radio_sample_placeholder">
       &nbsp;
      </div>
      <a class="sample" href="../../../sounds/hivemind.wav" title="Play BotDetect Audio CAPTCHA sound Sample" onclick="l_PlaySound('../../../sounds/hivemind.wav', 'hivemind_sample_placeholder'); return false;">HiveMind</a>
      <div class="placeholder" id="hivemind_sample_placeholder">
       &nbsp;
      </div>
      <a class="sample" href="../../../sounds/robot.wav" title="Play BotDetect Audio CAPTCHA sound Sample" onclick="l_PlaySound('../../../sounds/robot.wav', 'robot_sample_placeholder'); return false;">Robot</a>
      <div class="placeholder" id="robot_sample_placeholder">
       &nbsp;
      </div>
      <a class="sample" href="../../../sounds/pulse.wav" title="Play BotDetect Audio CAPTCHA sound Sample" onclick="l_PlaySound('../../../sounds/pulse.wav', 'pulse_sample_placeholder'); return false;">Pulse</a>
      <div class="placeholder" id="pulse_sample_placeholder">
       &nbsp;
      </div>
      <a class="sample" href="../../../sounds/dispatch.wav" title="Play BotDetect Audio CAPTCHA sound Sample" onclick="l_PlaySound('../../../sounds/dispatch.wav', 'dispatch_sample_placeholder'); return false;">Dispatch</a>
      <div class="placeholder" id="dispatch_sample_placeholder">
       &nbsp;
      </div>
      <p><a href="../../../audio-captcha-examples.html" title="View all BotDetect audio CAPTCHA sound samples">More audio CAPTCHA sound samples...</a></p> 
     </div> 
    </div> 
    <div class="pagecontrols-top"> 
     <div class="print"> 
      <span class="print_icon"> <a class="stbutton ptico_default" href="#" onclick="l_PrintPage();"></a> </span> 
     </div> 
     <div class="searchbox"> 
      <form id="cse-search-box" action="../../../search-results.html"> 
       <input class="searchInactive" type="text" name="q" id="query"> 
      </form> 
     </div> 
    </div> 
    <div class="pagecontrols-bottom"> 
     <div class="print"> 
      <span class="print_icon"> <a class="stbutton ptico_default" href="#" onclick="l_PrintPage();"></a> </span> 
     </div> 
    </div> 
   </div> 
   <div class="header"> 
    <div class="header_inner"> 
     <div class="logocontainer"> 
      <a href="../../../" title="BotDetect CAPTCHA Homepage"><span class="logo">&nbsp;</span></a> 
     </div> 
     <div class="topmenu"> 
      <ul class="links"> 
       <li style="width: 91px"><a style="width: 91px" id="home" accesskey="1" href="../../../" title="BotDetect CAPTCHA Generator Homepage">Home</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="angular-captcha" href="../../../angular-captcha.html" title="BotDetect ASP.NET CAPTCHA Control">Angular Captcha</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="dotnet-captcha" href="../../../asp.net-captcha.html" title="BotDetect ASP.NET CAPTCHA Control">.NET Captcha</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="java-captcha" href="../../../java-captcha.html" title="BotDetect Java CAPTCHA Library">Java Captcha<span class="alpha">Beta</span></a></li> 
       <li style="width: 91px"><a style="width: 91px" id="php-captcha" href="../../../php-captcha.html" title="BotDetect PHP CAPTCHA Library">PHP Captcha</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="asp-captcha" href="../../../asp-captcha.html" title="BotDetect ASP Classic CAPTCHA Component">ASP Captcha</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="documentation" href="../../../documentation.html" title="BotDetect CAPTCHA Documentation Index">Documentation</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="downloads" href="../../../captcha-download.html" title="Download BotDetect CAPTCHA Free Version">Download</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="demo" href="../../../demos/features/captcha-demo.aspx" title="BotDetect CAPTCHA Features Demo">Demo</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="support" href="../../../contact.html" title="Contact Captcha, Inc Support Department">Support</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="shop" href="../../../shop.html" title="Buy BotDetect CAPTCHA Licenses">Shop</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="references" href="../../../references.html" title="BotDetect CAPTCHA Customer References">References</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="contact" accesskey="9" href="../../../contact.html" title="Contact Captcha, Inc.">Contact</a></li> 
       <li style="width: 91px"><a style="width: 91px" id="about" href="../../../about/captcha-inc.html" title="About Captcha, Inc.">About</a></li> 
      </ul> 
     </div> 
    </div> 
   </div> 
   <div class="footer"> 
    <div class="navigation"> 
     <ul class="links"> 
      <li><a href="../../../asp.net-captcha.html" title="BotDetect ASP.NET CAPTCHA Control">.NET Captcha</a></li> 
      <li><a href="../../../java-captcha.html" title="BotDetect Java CAPTCHA Control">Java Captcha</a></li> 
      <li><a href="../../../php-captcha.html" title="BotDetect PHP CAPTCHA Library">PHP Captcha</a></li> 
      <li><a href="../../../asp-captcha.html" title="BotDetect ASP Classic CAPTCHA Component">ASP Captcha</a></li> 
      <li><a href="../../../mvc-captcha.html" title="BotDetect MVC CAPTCHA Documentation">MVC Captcha</a></li> 
      <li><a href="../../../javascript-captcha.html" title="BotDetect JavaScript CAPTCHA Documentation">JavaScript Captcha</a></li> 
      <li><a href="../../../ajax-captcha.html" title="BotDetect Ajax CAPTCHA Documentation">Ajax Captcha</a></li> 
      <li><a href="../../../jquery-captcha.html" title="BotDetect jQuery CAPTCHA Documentation">jQuery Captcha</a></li> 
      <li><a href="../../../captcha-download.html" title="Download BotDetect CAPTCHA Free Version">Download</a></li> 
      <li><a href="../../../demos/features/captcha-demo.aspx" title="BotDetect CAPTCHA Features Demo">Demo</a></li> 
      <li><a href="../../../" title="BotDetect CAPTCHA Generator Homepage">Captcha Generator</a></li> 
      <li><a href="../../../documentation.html" title="BotDetect CAPTCHA Documentation Index">Documentation</a></li> 
      <li><a href="../../../contact.html" title="Contact Captcha, Inc Support Department">Support</a></li> 
      <li><a href="../../../shop.html" title="Buy BotDetect CAPTCHA Licenses">Shop</a></li> 
      <li><a href="../../../references.html" title="BotDetect CAPTCHA Customer References">References</a></li> 
      <li><a href="../../../about/captcha-inc.html" title="About Captcha, Inc.">About</a></li> 
      <li><a href="../../../contact.html" title="captcha.com Webmaster Contact">Contact</a></li> 
      <li><a href="../../../privacy.html" title="captcha.com Privacy Policy">Privacy</a></li> 
      <li><a href="../../../terms.html" title="captcha.com Terms of Use">Terms</a></li> 
     </ul> 
    </div> 
    <div class="legal"> 
     <p> Captcha, Inc. 2004-2017. All rights reserved.</p> 
     <p>BotDetect, BotDetect CAPTCHA, Lanap, Lanap CAPTCHA, Lanap BotDetect, Lanap BotDetect CAPTCHA, Lanapsoft, Lanapsoft CAPTCHA, Lanapsoft BotDetect, Lanapsoft BotDetect CAPTCHA, and Lanap Software are trademarks of Captcha, Inc. All other product, brand, and company names are mentioned for identification purposes only and are trademarks or registered trademarks of their respective owners.</p> 
     <p>Captcha, Inc. -- formerly: Lanapsoft, Inc. / Lanap, Inc.</p> 
    </div> 
   </div> 
  </div> 
  <div class="footer_outer"></div> 
  <br> 
  <script type="text/javascript">
/* <![CDATA[ */
var google_conversion_id = 989336542;
var google_conversion_language = "en";
var google_conversion_format = "3";
var google_conversion_color = "ffffff";
var google_conversion_label = "N3WACJrTiAgQ3qfg1wM";
var google_conversion_value = 0;
var google_remarketing_only = false;
/* ]]> */
</script> 
  <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js?t=1506517089">
</script> 
  <noscript> 
   <div style="display:inline;"> 
    <img height="1" width="1" style="border-style:none;" alt="" src="//www.googleadservices.com/pagead/conversion/989336542/?value=0&amp;label=N3WACJrTiAgQ3qfg1wM&amp;guid=ON&amp;script=0"> 
   </div> 
  </noscript> 
  <script type="text/javascript">
try{if(typeof(Storage)!=='undefined')localStorage.setItem('ZZZZZga','UA-221733-4');}catch(e){};
try {
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-221733-4', 'auto');
ga('send', 'pageview');
}catch(err){
window.addEventListener('load', function() {
try {
jQuery.post('https://captcha.com/forms/js-error-logger.php',
{msg: 'Analytics error: '+err,
url: 'nourl',
line: 'noline',
window: window.location.href});
}catch(e){};})};

</script> 
  <script src="../../../script/tabstrip.min.js?t=1506517089"></script> 
  <script type="text/javascript">
window.addEventListener('load', function() {
  new TabStrip();
});
</script>   
 </body>
</html>