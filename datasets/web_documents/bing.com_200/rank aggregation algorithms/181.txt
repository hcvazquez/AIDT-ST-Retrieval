<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
 <head> 
  <title>Clustering - K-means</title> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
 </head> 
 <body> 
  <p align="center"><strong><font size="+3" face="Times New Roman, Times, serif"><em>A Tutorial on Clustering Algorithms</em> </font></strong></p> 
  <hr> 
  <strong><font size="+2"> </font> </strong> 
  <p align="center"><font face="Times New Roman, Times, serif"><a href="index.html">Introduction</a> | K-means | <a href="cmeans.html">Fuzzy C-means</a> | <a href="hierarchical.html">Hierarchical</a> | <a href="mixture.html">Mixture of Gaussians</a> | <a href="links.html">Links</a></font></p> 
  <hr> 
  <p align="center"><font size="+2" face="Arial, Helvetica, sans-serif"><strong>K-Means Clustering</strong></font><br> </p> 
  <p align="justify"><font size="+1" face="Arial, Helvetica, sans-serif"><em>The Algorithm</em></font><font face="Times New Roman, Times, serif"><br> K-means (<a href="#macqueen">MacQueen, 1967</a>) is one of the simplest unsupervised learning algorithms that solve the well known clustering problem. The procedure follows a simple and easy way to classify a given data set through a certain number of clusters (assume k clusters) fixed a priori. The main idea is to define k centroids, one for each cluster. These centroids shoud be placed in a cunning way because of different location causes different result. So, the better choice is to place them as much as possible far away from each other. The next step is to take each point belonging to a given data set and associate it to the nearest centroid. When no point is pending, the first step is completed and an early groupage is done. At this point we need to re-calculate k new centroids as barycenters of the clusters resulting from the previous step. After we have these k new centroids, a new binding has to be done between the same data set points and the nearest new centroid. A loop has been generated. As a result of this loop we may notice that the k centroids change their location step by step until no more changes are done. In other words centroids do not move any more.<br> Finally, this algorithm aims at minimizing an <em>objective function</em>, in this case a squared error function. The objective function</font></p> 
  <p align="center"><img src="images/image009.gif" align="absmiddle"> ,</p> 
  <p align="justify"><font face="Times New Roman, Times, serif">where <img src="images/image011.gif" align="absmiddle"> is a chosen distance measure between a data point <img src="images/image013.gif" align="absmiddle"> and the cluster centre <img src="images/image015.gif" align="absmiddle">, is an indicator of the distance of the <em>n</em> data points from their respective cluster centres.</font></p> 
  <p align="justify"><font face="Times New Roman, Times, serif">The algorithm is composed of the following steps:</font></p> 
  <p> </p> 
  <table width="75%" border="1" align="center"> 
   <tbody>
    <tr> 
     <td>
      <ol> 
       <li><em><font face="Times New Roman, Times, serif"> Place K points into the space represented by the objects that are being clustered. These points represent initial group centroids.<br> </font></em></li> 
       <li><font face="Times New Roman, Times, serif"><em>Assign each object to the group that has the closest centroid.<br> </em></font></li> 
       <li><font face="Times New Roman, Times, serif"><em>When all objects have been assigned, recalculate the positions of the K centroids.<br> </em></font></li> 
       <li><font face="Times New Roman, Times, serif"><em>Repeat Steps 2 and 3 until the centroids no longer move. This produces a separation of the objects into groups from which the metric to be minimized can be calculated.</em></font></li> 
      </ol></td> 
    </tr> 
   </tbody>
  </table> 
  <p align="justify"><font face="Times New Roman, Times, serif">Although it can be proved that the procedure will always terminate, the k-means algorithm does not necessarily find the most optimal configuration, corresponding to the global objective function minimum. The algorithm is also significantly sensitive to the initial randomly selected cluster centres. The k-means algorithm can be run multiple times to reduce this effect.</font></p> 
  <p align="justify"><font face="Times New Roman, Times, serif">K</font><font face="Times New Roman, Times, serif">-means is a simple algorithm that has been adapted to many problem domains. As we are going to see, it is a good candidate for extension to work with fuzzy feature vectors. </font></p> 
  <p align="justify"> </p> 
  <p align="justify"><font size="+1" face="Arial, Helvetica, sans-serif"><em>An example</em></font><br> <font face="Times New Roman, Times, serif">Suppose that we have n sample feature vectors <strong>x</strong><sub>1</sub>, <strong>x</strong><sub>2</sub>, ..., <strong>x</strong><sub>n</sub> all from the same class, and we know that they fall into k compact clusters, k &lt; n. Let <strong>m</strong><sub>i</sub> be the mean of the vectors in cluster i. If the clusters are well separated, we can use a minimum-distance classifier to separate them. That is, we can say that <strong>x</strong> is in cluster i if || <strong>x</strong> - <strong>m</strong><sub>i</sub> || is the minimum of all the k distances. This suggests the following procedure for finding the k means:</font></p> 
  <ul> 
   <li> 
    <div align="justify">
     <font face="Times New Roman, Times, serif">Make initial guesses for the means <strong>m</strong><sub>1</sub>, <strong>m</strong><sub>2</sub>, ..., <strong>m</strong><sub>k</sub></font>
    </div> </li> 
   <li> 
    <div align="justify">
     <font face="Times New Roman, Times, serif">Until there are no changes in any mean</font>
    </div> 
    <ul> 
     <li> 
      <div align="justify">
       <font face="Times New Roman, Times, serif">Use the estimated means to classify the samples into clusters </font> 
      </div> </li> 
    </ul> 
    <ul> 
     <li><font face="Times New Roman, Times, serif">For i from 1 to k</font> 
      <ul> 
       <li><font face="Times New Roman, Times, serif">Replace <strong>m</strong><sub>i</sub> with the mean of all of the samples for cluster i</font></li> 
      </ul> </li> 
     <li><font face="Times New Roman, Times, serif">end_for</font></li> 
    </ul> </li> 
   <li> 
    <div align="justify">
     <font face="Times New Roman, Times, serif">end_until </font> 
    </div> </li> 
  </ul> 
  <p align="justify"><font face="Times New Roman, Times, serif">Here is an example showing how the means <strong>m</strong><sub>1</sub> and <strong>m</strong><sub>2</sub> move into the centers of two clusters. </font></p> 
  <p align="center"><img src="images/image016.gif"></p> 
  <p align="justify"><font face="Times New Roman, Times, serif"><strong>Remarks</strong><br> This is a simple version of the k-means procedure. It can be viewed as a greedy algorithm for partitioning the n samples into k clusters so as to minimize the sum of the squared distances to the cluster centers. It does have some weaknesses:</font></p> 
  <ul> 
   <li><font face="Times New Roman, Times, serif" align="justify">The way to initialize the means was not specified. One popular way to start is to randomly choose k of the samples.</font></li> 
   <li><font face="Times New Roman, Times, serif">The results produced depend on the initial values for the means, and it frequently happens that suboptimal partitions are found. The standard solution is to try a number of different starting points.</font></li> 
   <li><font face="Times New Roman, Times, serif">It can happen that the set of samples closest to <strong>m</strong><sub>i</sub> is empty, so that <strong>m</strong><sub>i</sub> cannot be updated. This is an annoyance that must be handled in an implementation, but that we shall ignore.</font></li> 
   <li><font face="Times New Roman, Times, serif">The results depend on the metric used to measure || <strong>x</strong> - <strong>m</strong><sub>i</sub> ||. A popular solution is to normalize each variable by its standard deviation, though this is not always desirable.</font></li> 
   <li><font face="Times New Roman, Times, serif">The results depend on the value of k.</font></li> 
  </ul> 
  <p align="justify"><font face="Times New Roman, Times, serif">This last problem is particularly troublesome, since we often have no way of knowing how many clusters exist. In the example shown above, the same algorithm applied to the same data produces the following 3-means clustering. Is it better or worse than the 2-means clustering</font>?</p> 
  <p align="center"><img src="images/image017.gif"></p> 
  <p align="justify"><font face="Times New Roman, Times, serif"> Unfortunately there is no general theoretical solution to find the optimal number of clusters for any given data set. A simple approach is to compare the results of multiple runs with different k classes and choose the best one according to a given criterion (for instance the Schwarz Criterion - see <a href="#moore">Moore's slides</a>), but we need to be careful because increasing k results in smaller error function values by definition, but also an increasing risk of overfitting.</font></p> 
  <p> </p> 
  <p align="justify"><font size="+1" face="Arial, Helvetica, sans-serif"><em>Bibliography</em></font></p> 
  <div align="justify"> 
   <ul> 
    <li><font face="Times New Roman, Times, serif"><a name="macqueen"></a>J. B. MacQueen (1967): "Some Methods for classification and Analysis of Multivariate Observations, <em>Proceedings of 5-th Berkeley Symposium on Mathematical Statistics and Probability"</em>, Berkeley, University of California Press, 1:281-297</font></li> 
    <li><a name="moore"></a><font face="Times New Roman, Times, serif">Andrew Moore: &#x201c;K-means and Hierarchical Clustering - Tutorial Slides&#x201d;<br> <a href="http://www-2.cs.cmu.edu/%7Eawm/tutorials/kmeans.html">http://www-2.cs.cmu.edu/~awm/tutorials/kmeans.html</a></font></li> 
    <li> <font face="Times New Roman, Times, serif">Brian T. Luke: &#x201c;K-Means Clustering&#x201d;<br> <a href="http://fconyx.ncifcrf.gov/%7Elukeb/kmeans.html">http://fconyx.ncifcrf.gov/~lukeb/kmeans.html</a></font></li> 
    <li><font face="Times New Roman, Times, serif">Tariq Rashid: &#x201c;Clustering&#x201d;<br> <a href="http://www.cs.bris.ac.uk/home/tr1690/documentation/fuzzy_clustering_initial_report/node11.html">http://www.cs.bris.ac.uk/home/tr1690/documentation/fuzzy_clustering_initial_report/node11.html</a></font></li> 
    <li><font face="Times New Roman, Times, serif">Hans-Joachim Mucha and Hizir Sofyan: &#x201c;Nonhierarchical Clustering&#x201d;<br> <a href="http://www.quantlet.com/mdstat/scripts/xag/html/xaghtmlframe149.html">http://www.quantlet.com/mdstat/scripts/xag/html/xaghtmlframe149.ht</a></font></li> 
   </ul> 
  </div> 
  <hr> 
  <p align="center"><font size="+1" face="Times New Roman, Times, serif"><a href="AppletKM.html">K-means interactive demo</a></font></p> 
  <hr> 
  <p align="center"><a href="index.html">Previous page</a> | <a href="cmeans.html">Next page</a></p>   
 </body>
</html>