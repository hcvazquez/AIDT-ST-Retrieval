<!doctype html>
<html class="ltr en_US legacy responsive" dir="ltr" lang="en-US">
 <head> 
  <meta charset="utf-8"> 
  <meta content="minimum-scale=1.0, width=device-width" name="viewport"> 
  <meta content="liferay" property="fb:admins"> 
  <meta content="" property="og:description"> 
  <meta content="https://web.liferay.com/osb-community-theme/images/custom/open_graph_image.png" property="og:image"> 
  <meta content="Blog - Liferay.com" property="og:title"> 
  <meta content="website" property="og:type"> 
  <meta content="https://web.liferay.com/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" property="og:url"> 
  <title>Blog</title> 
  <script type="text/javascript" src="/dtagent_ICA23bqrx_6000500251013.js" data-dtconfig="rid=RID_-1672512650|rpid=1623290589|bandwidth=300|async=1|tp=500,50,0,1|reportUrl=dynaTraceMonitor|domain=liferay.com|agentUri=/dtagent_ICA23bqrx_6000500251013.js"></script>
  <script src="//use.typekit.net/see0ypk.js" type="text/javascript"></script> 
  <script type="text/javascript">/*<![CDATA[*/try{Typekit.load()}catch(e){};/*]]>*/</script> 
  <meta content="text/html; charset=UTF-8" http-equiv="content-type"> 
  <link href="https://web.liferay.com/osb-community-theme/images/favicon.ico" rel="Shortcut Icon"> 
  <link href="https://web.liferay.com/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" rel="canonical"> 
  <link href="https://web.liferay.com/zh/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="zh-CN" rel="alternate"> 
  <link href="https://web.liferay.com/fr/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="fr-FR" rel="alternate"> 
  <link href="https://web.liferay.com/de/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="de-DE" rel="alternate"> 
  <link href="https://web.liferay.com/it/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="it-IT" rel="alternate"> 
  <link href="https://web.liferay.com/ja/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="ja-JP" rel="alternate"> 
  <link href="https://web.liferay.com/pt/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="pt-BR" rel="alternate"> 
  <link href="https://web.liferay.com/es/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_state_rcv=1&amp;_58_struts_action=%252Flogin%252Flogin" hreflang="es-ES" rel="alternate"> 
  <link href="/html/css/main.css?browserId=other&amp;themeId=osbcommunity_WAR_osbcommunitytheme&amp;minifierType=css&amp;languageId=en_US&amp;b=6120&amp;t=1341589290000" rel="stylesheet" type="text/css"> 
  <link href="https://web.liferay.com/osb-portlet/profile_navigation/css/main.css?browserId=other&amp;themeId=osbcommunity_WAR_osbcommunitytheme&amp;minifierType=css&amp;languageId=en_US&amp;b=6120&amp;t=1506730383000" rel="stylesheet" type="text/css"> 
  <link href="https://web.liferay.com/html/portlet/blogs/css/main.css?browserId=other&amp;themeId=osbcommunity_WAR_osbcommunitytheme&amp;minifierType=css&amp;languageId=en_US&amp;b=6120&amp;t=1506730292000" rel="stylesheet" type="text/css"> 
  <script type="text/javascript">/*<![CDATA[*/var Liferay={Browser:{acceptsGzip:function(){return true},getMajorVersion:function(){return 45},getRevision:function(){return"537.36"},getVersion:function(){return"45.0.2454.101"},isAir:function(){return false},isChrome:function(){return true},isFirefox:function(){return false},isGecko:function(){return true},isIe:function(){return false},isIphone:function(){return false},isLinux:function(){return false},isMac:function(){return false},isMobile:function(){return false},isMozilla:function(){return false},isOpera:function(){return false},isRtf:function(){return true},isSafari:function(){return true},isSun:function(){return false},isWap:function(){return false},isWapXhtml:function(){return false},isWebKit:function(){return true},isWindows:function(){return true},isWml:function(){return false}},Data:{isCustomizationView:function(){return false},notices:[null]},ThemeDisplay:{getCDNDynamicResourcesHost:function(){return""},getCDNBaseURL:function(){return"https://web.liferay.com"},getCDNHost:function(){return""},getCompanyId:function(){return"1"},getCompanyGroupId:function(){return"8431626"},getUserId:function(){return"5"},getDoAsUserIdEncoded:function(){return""},getPlid:function(){return"50657388"},getLayoutId:function(){return"14"},getLayoutURL:function(){return"/web/user.26526/blog"},isPrivateLayout:function(){return"false"},getParentLayoutId:function(){return"13"},getScopeGroupId:function(){return"26528"},getScopeGroupIdOrLiveGroupId:function(){return"26528"},getParentGroupId:function(){return"26528"},isImpersonated:function(){return false},isSignedIn:function(){return false},getDefaultLanguageId:function(){return"en_US"},getLanguageId:function(){return"en_US"},isAddSessionIdToURL:function(){return false},isFreeformLayout:function(){return false},isStateExclusive:function(){return false},isStateMaximized:function(){return false},isStatePopUp:function(){return false},getPathContext:function(){return""},getPathImage:function(){return"/image"},getPathJavaScript:function(){return"/html/js"},getPathMain:function(){return"/c"},getPathThemeImages:function(){return"https://web.liferay.com/osb-community-theme/images"},getPathThemeRoot:function(){return"/osb-community-theme/"},getURLControlPanel:function(){return"/group/control_panel?doAsGroupId=26528&refererPlid=50657388"},getURLHome:function(){return"https://web.liferay.comwww.liferay.com"},getSessionId:function(){return""},getPortletSetupShowBordersDefault:function(){return false}},PropsValues:{NTLM_AUTH_ENABLED:false}};var themeDisplay=Liferay.ThemeDisplay;Liferay.AUI={getBaseURL:function(){return"https://web.liferay.com/html/js/aui/"},getCombine:function(){return true},getComboPath:function(){return"/combo/?browserId=other&minifierType=&languageId=en_US&b=6120&t=1506730428000&"},getFilter:function(){return"min"},getJavaScriptRootPath:function(){return"/html/js"},getLangPath:function(){return"aui_lang.jsp?browserId=other&themeId=osbcommunity_WAR_osbcommunitytheme&colorSchemeId=01&minifierType=js&languageId=en_US&b=6120&t=1506730428000"},getRootPath:function(){return"/html/js/aui/"}};window.YUI_config={base:Liferay.AUI.getBaseURL(),comboBase:Liferay.AUI.getComboPath(),fetchCSS:true,filter:Liferay.AUI.getFilter(),root:Liferay.AUI.getRootPath(),useBrowserConsole:false};Liferay.authToken="1n2PXpxZ";Liferay.currentURL="\x2fweb\x2fuser\x2e26526\x2fblog\x3fp_p_id\x3d58\x26p_p_lifecycle\x3d0\x26p_p_state\x3dnormal\x26p_p_state_rcv\x3d1\x26_58_struts_action\x3d\x25252Flogin\x25252Flogin";Liferay.currentURLEncoded="%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin";/*]]>*/</script> 
  <script src="/html/js/barebone.jsp?browserId=other&amp;themeId=osbcommunity_WAR_osbcommunitytheme&amp;colorSchemeId=01&amp;minifierType=js&amp;minifierBundleId=javascript.barebone.files&amp;languageId=en_US&amp;b=6120&amp;t=1506730428000" type="text/javascript"></script> 
  <script type="text/javascript">/*<![CDATA[*/Liferay.Portlet.list=["1_WAR_samlportlet","13_WAR_osbportlet","114","33"];/*]]>*/</script> 
  <link href="https://web.liferay.com/web/user.26526/blog/-/blogs/rss" rel="alternate" title="RSS" type="application/rss+xml"> 
  <link class="lfr-css-file" href="https://web.liferay.com/osb-community-theme/css/main.css?browserId=other&amp;themeId=osbcommunity_WAR_osbcommunitytheme&amp;minifierType=css&amp;languageId=en_US&amp;b=6120&amp;t=1506729969000" rel="stylesheet" type="text/css"> 
  <style type="text/css"></style> 
  <script src="https://web.liferay.com/osb-community-theme/js/event-onscreen.js" type="text/javascript"></script> 
 </head> 
 <body class=" controls-hidden signed-out public-page user-site lfr-dockbar-pinned"> 
  <style type="text/css">.taglib-discussion .add-comment .aui-fieldset-content>a:first-of-type,.taglib-discussion .add-comment .aui-fieldset-content>span:first-of-type,.taglib-discussion .lfr-discussion-actions .lfr-discussion-reply-to{display:none}</style> 
  <noscript> 
   <iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-TS5JTP" style="display:none;visibility:hidden" width="0"></iframe> 
  </noscript> 
  <script>/*<![CDATA[*/(function(b,m,h,a,g){b[a]=b[a]||[];b[a].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var k=m.getElementsByTagName(h)[0],e=m.createElement(h),c=a!="dataLayer"?"&l="+a:"";e.async=true;e.src="//www.googletagmanager.com/gtm.js?id="+g+c;k.parentNode.insertBefore(e,k)})(window,document,"script","dataLayer","GTM-TS5JTP");(function(g,b,a,c){if(g.getElementById(a)){return}var h=g.createElement(b),f=g.getElementsByTagName(b)[0];h.id=a;h.src="//js.hubspot.com/analytics/"+(Math.ceil(new Date()/c)*c)+"/252686.js";f.parentNode.insertBefore(h,f)})(document,"script","hs-analytics",300000);AUI().ready("aui-base",function(a){a.on("load",function(){if(window.ga){}})});/*]]>*/</script> 
  <div id="wrapper"> 
   <div class="content"> 
    <svg display="none" height="0" version="1.1" width="0" xmlns:xlink="http://www.w3.org/1999/xlink"> 
     <symbol id="caret" viewbox="0 0 7 12"> 
      <polyline fill="none" points="1.211,1 6.07,5.86 0.93,11 " stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="1.5" /> 
     </symbol> 
     <symbol id="closeIcon" viewbox="0 0 25.102 25.145"> 
      <path d="M24.573 24.614L.53.572M.53 24.572L24.573.53" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="1.5" /> 
     </symbol> 
     <symbol id="defaultUserIcon" viewbox="0 0 31.5 31.5"> 
      <path d="M7.65 28.183c.47-2.558 2.126-4.7 4.377-5.84l-.09-.627c-2.383-1.33-3.993-3.877-3.993-6.798 0-4.297 3.483-7.78 7.78-7.78 4.294 0 7.776 3.483 7.776 7.78 0 2.888-1.573 5.408-3.91 6.75l-.157.677c2.317 1.17 4.008 3.41 4.416 6.074" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="1.5" /> 
      <circle cx="15.75" cy="15.75" fill="none" r="15" stroke="currentColor" stroke-miterlimit="10" stroke-width="1.5" /> 
      <path d="M0 0h31.5v31.5H0z" fill="none" /> 
     </symbol> 
     <symbol id="facebookSocialIcon" viewbox="0 0 20 20"> 
      <path d="M18.9 0H1.1C.5 0 0 .5 0 1.1v17.8c0 .6.5 1.1 1.1 1.1h9.6v-7.7H8.1v-3h2.6V7c0-2.6 1.6-4 3.9-4 1.1 0 2.1.1 2.3.1v2.7h-1.6c-1.3 0-1.5.6-1.5 1.5v1.9h3l-.4 3h-2.6V20h5.1c.6 0 1.1-.5 1.1-1.1V1.1c0-.6-.5-1.1-1.1-1.1z" /> 
     </symbol> 
     <symbol id="githubSocialIcon" viewbox="0 0 20 20"> 
      <path d="M10 0C4.5 0 0 4.5 0 10c0 4.4 2.9 8.2 6.8 9.5.5.1.7-.2.7-.5v-1.7c-2.8.6-3.4-1.3-3.4-1.3-.4-1.2-1.1-1.5-1.1-1.5-.9-.6.1-.6.1-.6 1 .1 1.5 1 1.5 1 .9 1.6 2.4 1.1 2.9.9.1-.6.3-1.1.6-1.3-2.1-.3-4.5-1.2-4.5-5 0-1.1.4-2 1-2.7-.1-.3-.4-1.3.1-2.7 0 0 .8-.3 2.7 1 .9-.1 1.8-.3 2.6-.3s1.7.1 2.5.3c1.9-1.3 2.7-1 2.7-1 .5 1.4.2 2.4.1 2.6.6.7 1 1.6 1 2.7 0 3.8-2.3 4.7-4.6 4.9.4.3.7.9.7 1.9v2.7c0 .3.2.6.7.5 4-1.3 6.8-5.1 6.8-9.5C20 4.5 15.5 0 10 0z" /> 
     </symbol> 
     <symbol id="instagramSocialIcon" viewbox="0 0 20 20"> 
      <path d="M20 2.6v14.8c0 .7-.3 1.3-.8 1.8s-1.1.8-1.8.8H2.6c-.7 0-1.3-.3-1.8-.8-.5-.6-.8-1.2-.8-1.9V2.6C0 1.9.3 1.3.8.8S1.9 0 2.6 0h14.9c.7 0 1.3.3 1.8.8.4.5.7 1.1.7 1.8zm-2.3 14.2V8.5H16c.2.5.3 1.1.3 1.7 0 1.1-.3 2.1-.8 3-.6.9-1.3 1.7-2.3 2.2s-2 .8-3.1.8c-1.7 0-3.2-.6-4.4-1.8s-1.8-2.6-1.8-4.3c0-.6.1-1.2.3-1.7h-2v8.3c0 .2.1.4.2.6.2.2.3.2.6.2h13.9c.2 0 .4-.1.6-.2s.2-.3.2-.5zm-4.8-4.1C13.6 12 14 11 14 10s-.4-2-1.2-2.8-1.7-1.1-2.8-1.1-2 .4-2.8 1.1C6.4 8 6 8.9 6 10s.4 2 1.2 2.8 1.7 1.1 2.8 1.1c1.1 0 2.1-.4 2.9-1.2zm4.8-7.4V3.1c0-.2-.1-.5-.3-.6-.2-.2-.4-.3-.6-.3h-2.3c-.3 0-.5.1-.6.3-.2.2-.3.4-.3.6v2.1c0 .3.1.5.3.6.2.2.4.3.6.3h2.3c.3 0 .5-.1.6-.3.2-.1.3-.3.3-.5z" /> 
     </symbol> 
     <symbol id="liferayLogo-liferay"> 
      <path d="M150.198 28.583c0-.416-.245-.623-.76-.623h-.826v2.182h.338v-.94h.346l.598.94h.352l-.623-.965c.32-.034.575-.197.575-.594zm-.91.35h-.338v-.705h.43c.226 0 .485.037.485.338 0 .353-.288.367-.576.367zm.038-1.74c-1.027 0-1.862.796-1.862 1.863 0 1.056.835 1.86 1.862 1.86 1.015 0 1.86-.805 1.86-1.86.002-1.067-.845-1.863-1.86-1.863zm0 3.45c-.855 0-1.532-.69-1.532-1.586 0-.904.677-1.595 1.532-1.595.853 0 1.53.69 1.53 1.595 0 .897-.677 1.587-1.53 1.587zM53.68 28.855h-7.59V6.685c0-.35.043-.723.122-1.108l.103-.49h-3.613l.103.49c.08.386.12.762.12 1.107v22.708c0 .322-.04.668-.12 1.03l-.108.495h12.448v-2.325l-.52.15c-.262.076-.58.113-.946.113zM61.17 29.335V6.665c0-.456.04-.81.112-1.053l.163-.526H57.78l.105.492c.08.375.12.74.12 1.087v22.67c0 .348-.04.714-.12 1.088l-.105.493h3.665l-.163-.527c-.073-.242-.112-.597-.112-1.055zM66.56 5.578c.08.375.122.734.122 1.07v22.687c0 .348-.042.714-.12 1.088l-.106.493h3.617l-.105-.493c-.08-.374-.12-.74-.12-1.088V18.69h6.312c.456 0 .846.04 1.16.117l.506.125V16.62l-.498.113c-.4.09-.78.137-1.133.137h-6.348V7.02h7.274c.446 0 .885.033 1.305.104l.474.078V5.085H66.455l.105.493zM92.683 16.76h-7.478V7.02h7.757c.332 0 .663.052.977.16l.54.185v-2.28H81.77l.156.523c.076.255.112.617.112 1.075v22.65c0 .345-.028.72-.087 1.113l-.07.47H94.5V28.6l-.47.076c-.858.133-1.19.17-1.29.178h-7.533v-10.27h7.514c.555 0 .99.026 1.296.082l.48.09v-2.317l-.52.15c-.382.113-.816.17-1.293.17zM135.777 29.413L127.06 5.976c-.053-.142-.097-.326-.13-.545l-.053-.344h-2.853l-.047.352c-.054.4-.108.59-.147.688l-8.4 23.282c-.05.126-.126.295-.22.498-.245-.18-.458-.364-.626-.547l-9.342-10.425c2.31-.25 4.126-.91 5.407-1.955 1.462-1.19 2.206-2.862 2.206-4.96 0-1.425-.407-2.714-1.207-3.83-.72-1.01-1.696-1.778-2.894-2.28-1.27-.546-2.733-.822-4.362-.822h-6.02l.106.492c.08.375.12.74.12 1.087v22.67c0 .348-.04.714-.12 1.088l-.107.493h3.618l-.103-.493c-.08-.373-.122-.74-.122-1.088v-9.664l8.968 10.1c.306.346.52.652.64.91l.11.235h5.722l.012-.396c.012-.477.064-.713.105-.825l2.66-7.283h9.815l2.676 7.27c.098.3.16.588.182.858l.032.375h3.972l-.403-.628c-.244-.38-.405-.673-.48-.877zm-6.73-8.824h-8.456l4.15-11.464 4.308 11.463zM101.766 7.02h1.76c1.746 0 3.1.325 4.025.97.643.447 1.15 1.044 1.513 1.772.366.734.55 1.542.55 2.402 0 1.925-.78 3.308-2.383 4.227-.994.562-2.116.846-3.334.846h-2.13V7.02zM148.546 5.085l-.09.286c-.09.295-.213.587-.358.865l-5.747 10.74-5.617-10.658c-.308-.604-.392-.842-.415-.93l-.08-.302h-3.975l.506.655c.145.19.32.48.517.86l6.783 12.775v9.958c0 .35-.04.715-.12 1.088l-.105.494h3.618l-.104-.493c-.08-.372-.123-.74-.123-1.087v-9.958l6.872-12.88c.14-.252.305-.51.49-.762l.476-.648h-2.53z" /> 
     </symbol> 
     <symbol id="liferayLogo-logoBorder"> 
      <path d="M2.295 34.847c-.818 0-1.483-.666-1.483-1.483V2.638c0-.818.665-1.485 1.483-1.485H33.02c.818 0 1.484.667 1.484 1.485v30.726c0 .817-.666 1.483-1.483 1.483H2.296z" /> 
     </symbol> 
     <symbol id="liferayLogo-gradientLightest"> 
      <path d="M33.944 33.364c0 .507-.416.923-.922.923H2.295c-.507 0-.922-.416-.922-.923V2.638c0-.507.415-.923.922-.923H33.02c.507 0 .923.416.923.923v30.726z" /> 
     </symbol> 
     <symbol id="liferayLogo-gradientLight"> 
      <path d="M18.22 5.085h5.617V10.7H18.22zM4.744 18.563h5.616v5.615H4.744z" /> 
      <path d="M11.482 11.823h5.616v5.616h-5.616z" /> 
      <path d="M11.482 25.3h5.616v5.616h-5.616zM24.96 11.823h5.614v5.616H24.96z" /> 
      <path d="M18.22 18.563h5.615v5.615H18.22z" /> 
     </symbol> 
     <symbol id="liferayLogo-gradientDark"> 
      <path d="M11.482 5.085h5.616V10.7h-5.616z" /> 
      <path d="M4.744 11.823h5.616v5.616H4.744z" /> 
      <path d="M18.22 25.3h5.615v5.616H18.22z" /> 
      <path d="M24.96 18.563h5.614v5.615H24.96z" /> 
     </symbol> 
     <symbol id="liferayLogo-gradientDarkest"> 
      <path d="M4.744 5.085h5.616V10.7H4.744z" /> 
      <path d="M24.96 25.3h5.614v5.616H24.96z" /> 
     </symbol> 
     <symbol id="linkedinSocialIcon" viewbox="0 0 20 20"> 
      <path d="M18.5 0h-17C.7 0 0 .6 0 1.4v17.1c0 .9.7 1.5 1.5 1.5h17c.8 0 1.5-.6 1.5-1.4V1.4c0-.8-.7-1.4-1.5-1.4zM5.9 17H3V7.5h3V17zM4.4 6.2c-1 0-1.7-.8-1.7-1.7s.8-1.7 1.7-1.7c.9 0 1.7.8 1.7 1.7s-.7 1.7-1.7 1.7zM17 17h-3v-4.6c0-1.1 0-2.5-1.5-2.5s-1.8 1.2-1.8 2.5V17h-3V7.5h2.8v1.3c.4-.8 1.4-1.5 2.8-1.5 3 0 3.6 2 3.6 4.5V17z" /> 
     </symbol> 
     <symbol id="searchIcon" viewbox="0 0 36 36"> 
      <circle cx="15" cy="15" fill="transparent" r="8" stroke="currentColor" stroke-miterlimit="10" stroke-width="1.5" /> 
      <path d="M23.3 23.3L29 29" fill="transparent" stroke="currentColor" stroke-miterlimit="10" stroke-width="1.5" /> 
     </symbol> 
     <symbol id="twitterSocialIcon" viewbox="0 0 20 20"> 
      <path d="M20 3.8c-.7.3-1.5.5-2.4.6.8-.5 1.5-1.3 1.8-2.3-.8.5-1.7.8-2.6 1-.7-.8-1.8-1.3-3-1.3-2.3 0-4.1 1.8-4.1 4.1 0 .3 0 .6.1.9-3.4-.1-6.4-1.7-8.4-4.2C1 3.2.8 3.9.8 4.7c0 1.4.7 2.7 1.8 3.4-.6 0-1.2-.2-1.8-.5v.1c0 2 1.4 3.6 3.3 4-.3.1-.7.1-1.1.1-.3 0-.5 0-.8-.1.5 1.6 2 2.8 3.8 2.8-1.4 1.1-3.2 1.8-5.1 1.8-.3 0-.7 0-1-.1 1.8 1.2 4 1.8 6.3 1.8 7.5 0 11.7-6.3 11.7-11.7v-.5c.9-.5 1.5-1.2 2.1-2z" /> 
     </symbol> 
     <symbol id="youtubeSocialIcon" viewbox="0 0 20 20"> 
      <path d="M19.8 6s-.2-1.4-.8-2c-.8-.8-1.6-.8-2-.8-2.8-.2-7-.2-7-.2s-4.2 0-7 .2c-.4 0-1.2 0-2 .8-.6.6-.8 2-.8 2S0 7.6 0 9.2v1.5c0 1.7.2 3.3.2 3.3s.2 1.4.8 2c.8.8 1.8.8 2.2.9 1.6.1 6.8.1 6.8.1s4.2 0 7-.2c.4 0 1.2-.1 2-.8.6-.6.8-2 .8-2s.2-1.6.2-3.2V9.2c0-1.6-.2-3.2-.2-3.2zM7.9 12.6V7l5.4 2.8-5.4 2.8z" /> 
     </symbol> 
    </svg> 
    <header class="doc-header on-screen-helper" id="banner" role="banner"> 
     <div class="banner-content"> 
      <a class="aui-helper-clearfix doc-heading" href="/"> <img alt="Liferay" height="36" src="https://web.liferay.com/osb-community-theme/images/custom/heading.png"> </a> 
      <div class="class-toggle responsive-only" data-target-node="#navigationContainer" id="navigationToggle"></div> 
      <div class="responsive-content-height" id="navigationContainer"> 
       <div id="mainNavigation"> 
        <nav class="sort-pages modify-pages"> 
         <ul class="nav-menu"> 
          <li class="nav-item root-item selected first"> <a href="https://web.liferay.com/web/user.26526/profile" onclick="ga('send', 'event', 'Navigation Clicks', 'Community Navigation', 'Profile');"> <span>Profile</span> </a> </li> 
         </ul> 
        </nav> 
       </div> 
       <div class="class-toggle-off-click" id="mainSearch"> 
        <div id="mainSearchContent"> 
         <span class="class-toggle-off-click-content"> 
          <form action="https://web.liferay.com/web/user.26526/blog" class="doc-search" method="get" name="_1_WAR_googlesearchapplianceportlet_INSTANCE_0000_themeFm" onSubmit="event.preventDefault(); _1_WAR_googlesearchapplianceportlet_INSTANCE_0000_themeSearch();"> 
           <input name="p_p_id" type="hidden" value="1_WAR_googlesearchapplianceportlet_INSTANCE_0000"> 
           <input name="p_p_lifecycle" type="hidden" value="0"> 
           <input name="p_p_state" type="hidden" value="maximized"> 
           <input class="doc-search-input" name="_1_WAR_googlesearchapplianceportlet_INSTANCE_0000_keywords" placeholder="" value=""> 
          </form> <script type="text/javascript">/*<![CDATA[*/function _1_WAR_googlesearchapplianceportlet_INSTANCE_0000_themeSearch(){var a=document._1_WAR_googlesearchapplianceportlet_INSTANCE_0000_themeFm._1_WAR_googlesearchapplianceportlet_INSTANCE_0000_keywords.value;if(a!=""){document._1_WAR_googlesearchapplianceportlet_INSTANCE_0000_themeFm.submit()}};/*]]>*/</script> </span> 
        </div> 
       </div> 
       <div class="class-toggle-off-click" id="mainMenu"> 
        <ul class="class-toggle-off-click-content drop-down-menu responsive-content-height"> 
         <li class="class-toggle language-toggle parent-item"> <a href="javascript:;"> Language </a> <span class="children-marker"></span> 
          <ul class="taglib-settings"> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=de_DE" lang="de-DE"> Deutsch </a> </li> 
           <li class="selected"> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=en_US" lang="en-US"> English </a> </li> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=es_ES" lang="es-ES"> Español </a> </li> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=fr_FR" lang="fr-FR"> Français </a> </li> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=it_IT" lang="it-IT"> Italiano </a> </li> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=pt_BR" lang="pt-BR"> Português </a> </li> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=zh_CN" lang="zh-CN"> ?? </a> </li> 
           <li> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=82&amp;p_p_lifecycle=1&amp;p_p_state=normal&amp;p_p_mode=view&amp;_82_struts_action=%2Flanguage%2Fview&amp;_82_redirect=%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D58%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_state_rcv%3D1%26_58_struts_action%3D%25252Flogin%25252Flogin&amp;languageId=ja_JP" lang="ja-JP"> ??? </a> </li> 
          </ul> </li> 
         <li id="registerBtn"> <a href="https://web.liferay.com/web/user.26526/blog?p_p_id=58&amp;p_p_lifecycle=0&amp;p_p_state=maximized&amp;p_p_mode=view&amp;saveLastPath=0&amp;_58_struts_action=%2Flogin%2Fcreate_account"> Register </a> </li> 
         <li class="sign-in-button" id="signInBtn"> <a href="https://web.liferay.com/c/portal/login?p_l_id=50657388">Sign In</a> </li> 
        </ul> 
       </div> 
      </div> 
     </div> 
    </header> 
    <div class="portlet-boundary portlet-boundary_103_ portlet-static portlet-static-end portlet-borderless " id="p_p_id_103_"> 
     <span id="p_103"></span> 
     <div class="portlet-body"> 
     </div> 
    </div> 
    <!-- Split Frame, 50-50 --> 
    <div class="aui-helper-clearfix sub-grid" id="main-content" role="main"> 
     <div class="aui-w25 portlet-column" id="column-1"> 
      <div class="portlet-dropzone left-column portlet-column-content" id="layout-column_column-1"> 
       <div class="portlet-boundary portlet-boundary_13_WAR_osbportlet_ portlet-static portlet-static-start portlet-borderless osb-portlet-profile-navigation " id="p_p_id_13_WAR_osbportlet_"> 
        <span id="p_13_WAR_osbportlet"></span> 
        <div class="portlet-body"> 
         <div class="portlet-borderless-container" style=""> 
          <div class="portlet-body"> 
           <nav class="doc-sub-nav"> 
            <div class="user-profile-image" style="background: url(/image/user_male_portrait?img_id=3641453&amp;t=1506785509634) no-repeat center;"></div> 
            <h1> David H Nebinger </h1> 
            <ul class="navigation"> 
             <li> 
              <ul class="navigation"> 
               <li> <a href="/web/user.26526/blog">Blog</a> </li> 
              </ul> </li> 
            </ul> 
           </nav> 
          </div> 
         </div> 
        </div> 
       </div> 
       <div class="portlet-boundary portlet-boundary_114_ portlet-static portlet-static-start portlet-borderless portlet-recent-bloggers " id="p_p_id_114_"> 
        <span id="p_114"></span> 
        <div class="portlet-body"> 
         <div class="portlet-borderless-container" style=""> 
          <div class="portlet-body"> 
           <style type="text/css">.portlet-recent-bloggers .author{margin-top:.75em;width:110px}.portlet-recent-bloggers .taglib-search-iterator td{padding:0}.vp320 #column-2,.vp480 #column-2{margin-bottom:800px}.vp320 #main-content,.vp480 #main-content{position:relative}.vp320 .portlet-recent-bloggers,.vp480 .portlet-recent-bloggers{bottom:0;position:absolute}</style> 
           <article class="responsive-hidden"> 
            <h1 class="entries-heading"> Recent Bloggers </h1> 
            <div class="lfr-search-container "> 
             <div class="results-grid" id="_114_ocerSearchContainerSearchContainer"> 
              <table class="taglib-search-iterator"> 
               <tbody>
                <tr class="portlet-section-body results-row"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-1"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=96085932&amp;showAllEntries=0"><img alt="Olaf Kock" src="/image/user_male_portrait?img_id=1355782&amp;t=1506819195976" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=96085932&amp;showAllEntries=0">Olaf Kock</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        120 Posts 
                      </div> 
                      <div class="last">
                        October 3, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-alternate results-row alt"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-2"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=96074155&amp;showAllEntries=0"><img alt="Ivan Zaera" src="/image/user_male_portrait?img_id=57326719&amp;t=1507012556533" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=96074155&amp;showAllEntries=0">Ivan Zaera</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        1 Posts 
                      </div> 
                      <div class="last">
                        October 2, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-body results-row"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-3"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=96058999&amp;showAllEntries=0"><img alt="Eduardo P. Garcia" src="/image/user_male_portrait?img_id=13257324&amp;t=1506962346509" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=96058999&amp;showAllEntries=0">Eduardo P. Garcia</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        12 Posts 
                      </div> 
                      <div class="last">
                        October 2, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-alternate results-row alt"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-4"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=95830578&amp;showAllEntries=0"><img alt="Christine Reyes" src="/image/user_female_portrait?img_id=67517778&amp;t=1506962346512" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=95830578&amp;showAllEntries=0">Christine Reyes</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        28 Posts 
                      </div> 
                      <div class="last">
                        September 29, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-body results-row"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-5"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=95856913&amp;showAllEntries=0"><img alt="Sandeep Sapra" src="/image/user_male_portrait?img_id=96137473&amp;t=1507009109835" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=95856913&amp;showAllEntries=0">Sandeep Sapra</a> 
                      </div> 
                      <div class="stream"> 
                      </div> 
                      <div class="count">
                        1 Posts 
                      </div> 
                      <div class="last">
                        September 29, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-alternate results-row alt"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-6"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=95536294&amp;showAllEntries=0"><img alt="Kyle Joseph Stiemann" src="/image/user_male_portrait?img_id=20806106&amp;t=1506962346518" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=95536294&amp;showAllEntries=0">Kyle Joseph Stiemann</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        10 Posts 
                      </div> 
                      <div class="last">
                        September 26, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-body results-row"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-7"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=94867838&amp;showAllEntries=0"><img alt="Manuel de la Peña" src="/image/user_male_portrait?img_id=10616613&amp;t=1506962346522" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=94867838&amp;showAllEntries=0">Manuel de la Peña</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        12 Posts 
                      </div> 
                      <div class="last">
                        September 20, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-alternate results-row alt"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-8"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=94910998&amp;showAllEntries=0"><img alt="Neil Griffin" src="/image/user_male_portrait?img_id=127882&amp;t=1506962346525" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=94910998&amp;showAllEntries=0">Neil Griffin</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        57 Posts 
                      </div> 
                      <div class="last">
                        September 13, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-body results-row"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-9"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=94669440&amp;showAllEntries=0"><img alt="David H Nebinger" src="/image/user_male_portrait?img_id=3641453&amp;t=1506785509634" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=94669440&amp;showAllEntries=0">David H Nebinger</a> 
                      </div> 
                      <div class="stream"> 
                      </div> 
                      <div class="count">
                        61 Posts 
                      </div> 
                      <div class="last">
                        September 8, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
                <tr class="portlet-section-alternate results-row alt last"> 
                 <td class="align-left col-1 col-1 only valign-middle" colspan="1" id="_114_ocerSearchContainer_col-1_row-10"> 
                  <div class="entry"> 
                   <div class="sub-grid"> 
                    <div class="unit"> 
                     <div class="unit-content"> 
                      <p class="user-image"> <a href="/c/blogs/find_entry?entryId=94595580&amp;showAllEntries=0"><img alt="Yanan Yuan" src="/image/user_female_portrait?img_id=11230747&amp;t=1506962346529" width="60" height="72" class="callout-image"></a> </p> 
                     </div> 
                    </div> 
                    <div class="unit"> 
                     <div class="aui-helper-clearfix unit-content"> 
                      <div class="author"> 
                       <a href="/c/blogs/find_entry?entryId=94595580&amp;showAllEntries=0">Yanan Yuan</a> 
                      </div> 
                      <div class="stream"> 
                       <span class="btn-d grey">Staff</span> 
                      </div> 
                      <div class="count">
                        5 Posts 
                      </div> 
                      <div class="last">
                        September 6, 2017 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> </td> 
                </tr> 
               </tbody>
              </table> 
             </div> 
            </div> 
            <input id="_114_ocerSearchContainerPrimaryKeys" name="ocerSearchContainerPrimaryKeys" type="hidden" value="1347007,30057465,13185723,95890919,95344673,44051682,10240956,218439,3569296,11116153"> 
           </article> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
     <div class="aui-w75 portlet-column"> 
      <div class="sub-grid"> 
       <div class="aui-w100 portlet-column" id="column-2"> 
        <div class="portlet-dropzone portlet-column-content" id="layout-column_column-2"> 
         <div class="portlet-boundary portlet-boundary_33_ portlet-static portlet-static-start portlet-borderless portlet-blogs " id="p_p_id_33_"> 
          <span id="p_33"></span> 
          <div class="portlet-body"> 
           <div class="portlet-borderless-container" style=""> 
            <div class="portlet-body"> 
             <form action="https://web.liferay.com/web/user.26526/blog?p_p_id=33&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_mode=view&amp;p_p_col_id=column-2&amp;p_p_col_count=1&amp;_33_struts_action=%2Fblogs%2Fsearch" class="aui-form " id="_33_fm1" method="get" name="_33_fm1"> 
              <input name="_33_formDate" type="hidden" value="1507036328468"> 
              <input name="p_p_id" type="hidden" value="33">
              <input name="p_p_lifecycle" type="hidden" value="0">
              <input name="p_p_state" type="hidden" value="normal">
              <input name="p_p_mode" type="hidden" value="view">
              <input name="p_p_col_id" type="hidden" value="column-2">
              <input name="p_p_col_count" type="hidden" value="1">
              <input name="_33_struts_action" type="hidden" value="/blogs/search"> 
              <input class="aui-field-input aui-field-input-text" id="_33_redirect" name="_33_redirect" type="hidden" value="https://web.liferay.com/web/user.26526/blog?p_p_id=33&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_mode=view&amp;p_p_col_id=column-2&amp;p_p_col_count=1"> 
              <input class="aui-field-input aui-field-input-text" id="_33_groupId" name="_33_groupId" type="hidden" value="26528"> 
              <div class="portlet-toolbar search-form"> 
               <div class="aui-search-bar"> 
                <span class="aui-field aui-field-text aui-field-inline"> <span class="aui-field-content"> <span class="aui-field-element "> <input class="aui-field-input aui-field-input-text" id="_33_keywords" name="_33_keywords" title="Search Entries" type="text" value="" size="30"> </span> </span> </span> 
                <span class="aui-button aui-button-submit"> <span class="aui-button-content"> <input class="aui-button-input aui-button-input-submit" type="submit" value="Search"> </span> </span> 
               </div> 
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/necessary-siteminder-configuration-?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Necessary SiteMinder Configuration...</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> September 8, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> A quick note for those using SiteMinder and Liferay...</p> 
                <p> Liferay likes the Tilde (~) character, and uses it quite often for friendly URLs and other reasons.</p> 
                <p> When fronting with SiteMinder, though, you may run into return code 500 for URLs with the tilde character in them.</p> 
                <p> This is actually a default SiteMinder configuration thing, SiteMinder treats tilde (and others) as "bad characters" and will return a 500 when they are found.</p> 
                <p> The default SiteMinder configuration has this setting:</p> 
                <pre>
<code>BadUrlChars       //,./,/.,/*,*.,<strong><span style="background-color: rgb(255,255,0);">~,</span></strong>\,%00-%1f,%7f-%ff,%25</code></pre> 
                <p> You want to override the default configuration to allow the tilde character:</p> 
                <pre>
<code>BadUrlChars       //,./,/.,/*,*.,\,%00-%1f,%7f-%ff,%25</code></pre> 
                <p> After making this change, restart the daemons and you should be back in business.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/necessary-siteminder-configuration-"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="ykmt_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Necessary SiteMinder Configuration..." data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/necessary-siteminder-configuration-" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/necessary-siteminder-configuration-" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/necessary-siteminder-configuration-" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/necessary-siteminder-configuration-?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">1 Comment</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/leveraging-maven-proxies?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Leveraging Maven Proxies</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> July 12, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> Taking a short break from the Vue.js portlet because I had to implement a repository proxy. Since I was implementing it, I wanted to blog about it and give you the option of implementing one too. Next blog post will be back to Vue.js, however...</p> 
                <h1> Introduction</h1> 
                <p> I love love love Maven repositories. I can distribute a small project w/o all of the dependencies included and trust that the receiver will be able to pull the dependencies when/if they do a build.</p> 
                <p> And I like downloading small project files such as the Liferay source separately from the multitude of dependencies that would otherwise make the download take forever.</p> 
                <p> But you know what I hate? Maven repositories. &nbsp;Well, downloading from remote Maven repositories. Especially if I have to pull the same file over and over. Or when the internet is slow or out and development grinds to a halt. Or maintenance on the remote Maven repositories makes them unavailable for some unknown period of time.</p> 
                <p> Now, of course the Maven (and Gradle and Ivy) tools know about remote repository download issues and will actually leverage a local repository cache so you really only have to download once. Except that they made this support optional, and frankly it gets overlooked a lot. The default Liferay Gradle repository references don't list mavenLocal() in the repo list and it is not used by default.</p> 
                <p> Enterprise or multi-system users (like myself) have additional remote repository issues. &nbsp;First, a local repo on one user's system is not shared w/ a team or multiple systems, so you end up having to pull the file to your internal network multiple times, even if it has already been pulled before.</p> 
                <p> A complete list of use cases would include:</p> 
                <ul> 
                 <li> Anyone developing behind an HTTP proxy (typical corporate users). Using a repository proxy removes all of the necessary proxy configuration from your development tools, the repository proxy needs to know how to connect through the HTTP proxy, but your dev tools don't.</li> 
                 <li> Anyone developing in teams. Using a repository proxy, you will only pay for downloading to your network once, then all developers will be able to access the artifact from the proxy and not have to download on their own.</li> 
                 <li> Anyone using an approved artifact list. Using a repository proxy populated with approved artifacts and versions, you have automatic control over the development environment to ensure that an unapproved version does not get through.</li> 
                 <li> Anyone developing in multiple workspaces, projects, or machines. Shares the benefits from the team development where you only download once, then share the artifact.</li> 
                 <li> Anyone who suffers network outages. Using a repository proxy, you can pull previously loaded artifacts even when the external network is down. You can't pull new artifacts, but you should have most of the ones you regularly use.</li> 
                 <li> Anyone who needs to publish team artifacts. A repository proxy can also hold your own published artifacts, so it is easy to share those with the team and use each others artifacts as dependencies.</li> 
                 <li> Anyone using a secured continuous integration server. CI servers should not have access to the interweb, but they still need to pull dependencies for builds. The repository proxy gives your CI server a repository to pull from without having direct internet access.</li> 
                 <li> Anyone behind a slow internet link. Your internal network is typically always faster than your uplink, so having a local proxy cache of artifacts reduces or eliminates lag issues from your uplink.</li> 
                 <li> Anyone interested in simplifying repository references. Liferay uses two repositories, a public mavenCentral mirror and a release repository. Then there's mavenCentral, of course, and there are other repositories out there too. By using a proxy, you can have a single repository reference in your development tools, but that reference could actually represent all of these separate repositories as a single entity.</li> 
                </ul> 
                <p> So I'm finally giving up the ghost, I'm moving to a repository proxy.</p> 
                <h1> What Is A Repository Proxy?</h1> 
                <p> For those that don't know, a repository proxy is basically a local service that you're going to run that proxies artifact requests to remote Maven repositories and caches the artifacts to serve back later on. It's not a full mirror of the external repositories because it doesn't pull and cache everything from the repository, only the artifacts and versions you use.</p> 
                <p> So for most of us, our internal network is usually significantly faster than the interweb link, so once the proxy cache is fully populated, you'll notice a big jump when building new projects. And for team development, the entire team can benefit from leveraging the cache.</p> 
                <h1> Setting Up A Repository Proxy</h1> 
                <p> There are actually a bunch of freely-available repository proxies you can use. One popular option is <a href="https://www.jfrog.com/open-source/">Artifactory</a>. &nbsp;But for my purposes, I'm going to set up <a href="http://archiva.apache.org/docs/2.2.3/">Apache Archiva</a>. It's a little lighter than Artifactory and can be easily deployed into an existing Tomcat container (Artifactory used to support that, but they've since buried or deprecated using a war deployment).</p> 
                <p> The proxy you choose is not so important, it will just impact how you go about configuring it for the various Liferay remote repositories.</p> 
                <p> Follow the instructions from the Archiva site to deploy and start your Archiva instance. In the example I'm showing below, I have a local Tomcat 7 instance running on port 888 and have deployed the Archiva war file per the site instructions. After starting it up, I created a new administrator account and was ready to move on to the next steps.</p> 
                <p> Once you're in, add two remote repositories:</p> 
                <ul> 
                 <li> <a href="https://cdn.lfrs.sl/repository.liferay.com/nexus/content/groups/public">https://cdn.lfrs.sl/repository.liferay.com/nexus/content/groups/public</a></li> 
                 <li> <a href="https://cdn.lfrs.sl/repository.liferay.com/nexus/content/repositories/liferay-public-releases">https://cdn.lfrs.sl/repository.liferay.com/nexus/content/repositories/liferay-public-releases</a></li> 
                </ul> 
                <p> <img alt="" src="/documents/26528/92065935/repo-list.jpg/340f5f0a-30d9-4854-9040-fef2fc00b583?t=1500584132676" style="width: 859.0px;height: 701.0px;"></p> 
                <p> These two repositories are used by Liferay for public and private artifacts. &nbsp;Order the liferay-public-releases guy first, then the public one second.</p> 
                <p> In Archiva, you also need to define proxy connectors:</p> 
                <p> <img alt="" src="/documents/26528/92065935/proxy-list.jpg/a6005e98-295a-4a28-875b-a66356f397ee?t=1500583938660" style="width: 859.0px;height: 701.0px;"></p> 
                <p> Once these are set, you can then define a local repository:</p> 
                <p> <img alt="" src="/documents/26528/92065935/repos.jpg/2c06c056-3ba6-43d7-87f4-83bbe6aa652a?t=1500584168312" style="width: 859.0px;height: 701.0px;"></p> 
                <p> Initially if you browse your artifacts, your list will be empty. Later, after using your repo proxy, when you browse you should see the artifacts.</p> 
                <table border="0" cellpadding="20" cellspacing="10" style="width: 500.0px;"> 
                 <tbody> 
                  <tr> 
                   <td> <img alt="" src="/documents/26528/92065935/no-artifacts.jpg/1e21ab5b-199b-4b18-b8ad-f03c661b4472?t=1500584150375" style="width: 450.0px;height: 317.0px;"></td> 
                   <td> <img alt="" src="/documents/26528/92065935/populated.jpg/78f89f4c-bece-4eb7-a98e-d9557738ce1c?t=1500584142623" style="width: 450.0px;height: 367.0px;"></td> 
                  </tr> 
                 </tbody> 
                </table> 
                <p> And finally you may want to use a repository group so you only need a single URL to access all of your individual repositories.</p> 
                <h1> Configuring Liferay Dev Tools For The Repository Proxy</h1> 
                <p> So this is really the meat of this post, how to configure all of the various Liferay development tools to leverage the repository proxy.</p> 
                <p> In all examples below, I'm just pointing at a service running on localhost port 888; for your own environment, you'll just make necessary changes to the URL for host/port details, but otherwise the changes will be similar.</p> 
                <h2> Liferay Gradle Workspace</h2> 
                <p> This is handled by changing the root settings.gradle file. &nbsp;You'll take out references to cdn.liferay.com and instead just point at your local proxy as such:</p> 
                <pre>
buildscript {
  dependencies {
    classpath group: "com.liferay", name: "com.liferay.gradle.plugins.workspace", version: "1.0.40"
  }

  repositories {
    maven {
      url "http://localhost:888/archiva/repository/liferay/"
    }
  }
}

apply plugin: "com.liferay.workspace"
</pre> 
                <p> Now if you happen to have other repositories listed, you may want to make sure that they too are pushed up to your repository proxy. No reason to not do so. And by using the repository group, we can simplify the repository list in the settings.gradle file.</p> 
                <p> This is the only file that typically has repositories listed, but if you have an existing workspace you might have added some references to the root build.gradle file or a build.gradle file in one of the subdirectories.</p> 
                <h2> Liferay Gradle Projects</h2> 
                <p> For standalone Liferay Gradle projects, your repositories are listed in the build.gradle file, these will also change to point at the repository proxy:</p> 
                <pre>
buildscript {
  dependencies {
    classpath group: "com.liferay", name: "com.liferay.gradle.plugins", version: "3.1.3"
  }

  repositories {
    mavenLocal()

    maven {
      url "http://localhost:888/archiva/repository/liferay/"
    }
  }
}

apply plugin: "com.liferay.plugin"

dependencies {
  compileOnly group: "org.osgi", name: "org.osgi.core", version: "6.0.0"
  compileOnly group: "org.osgi", name: "org.osgi.service.component.annotations", version: "1.3.0"
}

repositories {
  mavenLocal()

  maven {
    url "http://localhost:888/archiva/repository/liferay/"
  }
}
</pre> 
                <h2> Global Gradle Mirrors</h2> 
                <p> Gradle supports the concept of "init" scripts. &nbsp;These are global scripts that are executed before tasks and can tweak the build process that the build.gradle or settings.gradle might otherwise define. Create a file in your ~/.gradle directory called init.gradle and set it to the following:</p> 
                <pre>
allprojects {
  buildscript {
    repositories {
      mavenLocal()
      maven { url "http://localhost:888/archiva/repository/liferay" }
    }
  }
  repositories {
    mavenLocal()
    maven { url "http://localhost:888/archiva/repository/liferay" }
  }
}</pre> 
                <p> This should normally have all Gradle projects use your local Maven repository first and your new proxy repository second. &nbsp;Any repositories listed in the build.gradle or settings.gradle file will come after these. This also sets repository settings for both Gradle plugin lookups as well as general build dependency resolution.</p> 
                <h2> Liferay SDK</h2> 
                <p> The Liferay SDK leverages Ant and Ivy for remote repository access. Our change here is to point Ivy at our repository proxy.</p> 
                <p> Edit the main ivy-settings.xml file to point at the repository proxy:</p> 
                <pre>
&lt;ivysettings&gt;
  &lt;settings defaultResolver="default" /&gt;

  &lt;resolvers&gt;
    &lt;ibiblio m2compatible="true" name="liferay" root="http://localhost:888/archiva/repository/liferay/" /&gt;
    &lt;ibiblio m2compatible="true" name="local-m2" root="file://${user.home}/.m2/repository" /&gt;

    &lt;chain dual="true" name="default"&gt;
      &lt;resolver ref="local-m2" /&gt;

      &lt;resolver ref="liferay" /&gt;
    &lt;/chain&gt;
  &lt;/resolvers&gt;
&lt;/ivysettings&gt;
</pre> 
                <h2> Liferay Maven Projects</h2> 
                <p> For simple Liferay Maven projects, we just have to update the repository like we would for any normal pom.xml file:</p> 
                <pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;

  ...

  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;liferay&lt;/id&gt;
      &lt;url&gt;http://localhost:888/archiva/repository/liferay/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
</pre> 
                <p> <span style="font-size: 1.333em;">Liferay Maven Workspace</span></p> 
                <p> The Liferay Maven Workspace is a new workspace based on Maven instead of Gradle. You can learn more about it <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/maven-workspace">here</a>.</p> 
                <p> In the root pom.xml file, we're going to add our repository entry but we also want to disable using the Liferay CDN as the default repository:</p> 
                <pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;

  ...

  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;liferay&lt;/id&gt;
      &lt;url&gt;http://localhost:888/archiva/repository/liferay/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;

  &lt;properties&gt;
    &lt;liferay.workspace.default.repository.enabled&gt;false&lt;/liferay.workspace.default.repository.enabled&gt;
    &lt;liferay.modules.default.repository.enabled&gt;false&lt;/liferay.workspace.modules.repository.enabled&gt;
  &lt;/properties&gt;
</pre> 
                <h2> Global Maven Mirrors</h2> 
                <p> Maven supports the concept of mirrors, these can be local repositories that should be used in place of other commonly named repositories. &nbsp;Create (or update) your ~/.m2/settings.xml file and make sure you have the following:</p> 
                <pre>
&lt;settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
                          https://maven.apache.org/xsd/settings-1.0.0.xsd"&gt;

  &lt;mirrors&gt;
    &lt;mirror&gt;
      &lt;id&gt;repoproxy&lt;/id&gt;
      &lt;name&gt;Repo Proxy&lt;/name&gt;
      &lt;url&gt;http://localhost:888/archiva/repository/liferay&lt;/url&gt;
      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
    &lt;/mirror&gt;
  &lt;/mirrors&gt;
&lt;/settings&gt;
</pre> 
                <p> The &lt;mirrorOf /&gt; tag using the wildcard means that this repository is a mirror for all repositories and Maven builds will go to this repository proxy for all dependencies, build or otherwise.</p> 
                <h1> Configuring Liferay Source For The Repository Proxy</h1> 
                <p> We took care of all of your individual project builds, but what about if you have the source locally and want to build it using the repository proxy?</p> 
                <p> I actually combined a bunch of the previous listed techniques. For the maven portion of the build (if there is one), my settings.xml mirror declaration ensures that my repo proxy will be used. For the Gradle portion of the build, I used the init.gradle script (although I copied my ~/.gradle/init.gradle to the .gradle directory created inside of the folder as the ~/.gradle/init.gradle script was ignored).</p> 
                <p> In addition, in my build.&lt;username&gt;.properties file, I set basejar.url=http://localhost:888/archiva/repository/liferay.</p> 
                <p> And I also had to set my ANT_OPTS environment variable, so I used "-Xmx8192m -Drepository.url=http://localhost:888/archiva/repository/liferay".</p> 
                <p> With all of these changes, I was able to build the liferay-portal from master with all dependencies coming through my repository proxy.</p> 
                <p> You might be wondering why you would want to go through this exercise. For me, it seemed like an ideal way to pre-populate my proxy with most of the necessary public dependencies and Liferay modules. Sure this isn't necessary because, since we're using a proxy, if we need an updated version later on the proxy will happily fetch it for us. It's just a way to pre-populate with a lot of the artifacts that you'll be needing.</p> 
                <h1> Publishing Artifacts</h1> 
                <p> The other big reason to use a local repository service is the ability to publish your own artifacts into the repository. When you're working in teams, being able to publish artifacts into the repository so teammates can use the artifacts without building themselves can be quite valuable. This will also force you to address your versioning strategy since you need to bump versions when you publish; I see this as a good thing because it will force you to have a strategy going into a project rather than trying to create one in the middle or at the end of the project.</p> 
                <p> So next we'll look into the changes necessary to support publishing from each of the Liferay development environments to your new repository service.</p> 
                <p> Note that we're going to assume that you've set up users in the repository service to ensure you don't get uploads from unauthorized users, so these instructions will include the details for setting up the repository with authenticated access for publishing.</p> 
                <p> Finally, during the research for this blog post I have quickly come to find that there different ways to publish artifacts, sometimes even based on the repository proxy you're using. For example, the fine folks at JFrog actually have their own Gradle plugin to support Artifactory publication. I didn't try it since I'm currently targeting Archiva, but you might want to look it over if you are targeting Artifactory.</p> 
                <p> These instructions are staying with the generic plugins so they might work across repositories w/o much change, but obviously you should test them out for yourself.</p> 
                <h2> Liferay Gradle Workspace</h2> 
                <p> The Liferay workspace was actually the most challenging configuration out of all of these different methods if only because tweaking the various build.gradle files to support the subproject publication can take a while.</p> 
                <p> In fact, Gradle has an older uploadArchives() method that has since been replaced by a newer maven-publish plugin, but for the life of me I couldn't get the submodules to work right with it. I could get submodules to use maven-publish if each submodule build.gradle file had the full stanzas for individual publication, but then I couldn't get the gradlew publish command to work in the root project.</p> 
                <p> So the instructions here purposefully leverage the older uploadArchives() method because I could get it working with the bulk of the configuration and setup in the root build.gradle and minor updates to the submodule build.gradle files.</p> 
                <h3> Add Properties</h3> 
                <p> The first thing we will do is add properties to the root gradle.properties file. This will isolate the URL and publication credentials and keep them out of the build.gradle files. For SCM purposes, you would not want to check this file into revision control as it would expose the publishers credentials to those who have access to the revision control system.</p> 
                <pre>
# Define the URL we'll be publishing to
publishUrl=http://localhost:888/archiva/repository/liferay

# Define the username and password for authenticated publish
publishUsername=dnebing
publishPassword=dnebing1
</pre> 
                <h3> Root build.gradle Changes</h3> 
                <p> The root build.gradle file is where the bulk of the changes go. By adding the following content to this file, we are adding support for publishing to every submodule that might be added to the Liferay Workspace.</p> 
                <pre>
// define the publish for all subprojects
allprojects {

  // all of our artifacts in this workspace publish to same group id
  // set this to your own group or override in submodule build.gradle files
  // if they need to change in the submodules.
  group = 'com.dnebinger.gradle'
  
  apply plugin: 'java'
  apply plugin: 'maven'
  
  // define a task for the javadocs
  task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from 'build/docs/javadoc'
  }
  
  // define a task for the sources
  task sourcesJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.allSource
  }
  
  // list all of the artifacts that will be created and published
  artifacts {
    archives jar
    archives javadocJar
    archives sourcesJar
  }
  
  // configure the publication stuff
  uploadArchives {
    // disable upload, force each submodule to enable
    enabled false
    
    repositories.mavenDeployer {
      repository(url: project.publishUrl) {
        authentication(userName: project.publishUsername, password: project.publishPassword)
      }
    }
  }
}
</pre> 
                <p> The instructions in this file will have you building a source jar and a javadocs jar. These and the build artifacts will all be published to the repository from the gradle.properties file using the credentials from that file.</p> 
                <p> Note that by default the upload is disabled for all subprojects. This forces us to enable the upload in those individual submodules we want to set it up for.</p> 
                <h3> Submodule build.gradle Changes</h3> 
                <p> In each submodule where we want to publish to the repo, there are two sets of simple changes to make.</p> 
                <pre>
// define the version that we will publish to the repo as
version = '1.0.0'

// change group value here if must differ from the one in the root build.gradle.

dependencies {
  ...
}

// enable the upload
uploadArchives { enabled true }
</pre> 
                <p> We specify the version for publishing and enable the uploadArchives for the submodule.</p> 
                <h3> Publish Archives</h3> 
                <p> That's pretty much it. &nbsp;In both the root directory as well as in the individual module directories you can issue the command <strong>gradlew uploadArchives</strong> and (if you get a good build) the artifacts will be published to the repository.</p> 
                <h2> Liferay Gradle Projects</h2> 
                <p> Liferay gradle projects get a similar modification as the Liferay Gradle Workspace modifications, but they're a little easier since you don't have to worry about submodules.</p> 
                <p> From the previous Liferay Gradle Workspace section above, add the same property values to the gradle.properties file. If you don't have a gradle.properties file, you can create one with the listed properties.</p> 
                <h3> Build.gradle Changes</h3> 
                <p> The changes we make to the build.gradle file are similar, but are still different enough:</p> 
                <pre>
buildscript {
  dependencies {
    classpath group: "com.liferay", name: "com.liferay.gradle.plugins", version: "3.3.9"
  }

  repositories {
    maven {
      url "http://localhost:888/archiva/repository/liferay"
    }
  }
}

apply plugin: "com.liferay.plugin"
apply plugin: 'java'
apply plugin: 'maven'

repositories {
  mavenLocal()

  maven {
    url "http://localhost:888/archiva/repository/liferay"
  }
}

// define the group and versions for the artifacts
group = 'com.dnebinger.gradle'
version = '1.0.3'

dependencies {
  ...
}

// define a task for the javadocs
task javadocJar(type: Jar, dependsOn: javadoc) {
  classifier = 'javadoc'
  from 'build/docs/javadoc'
}

// define a task for the sources
task sourcesJar(type: Jar) {
  classifier = 'sources'
  from sourceSets.main.allSource
}

// list all of the artifacts
artifacts {
  archives jar
  archives javadocJar
  archives sourcesJar
}

// configure the publication stuff
uploadArchives {
  repositories.mavenDeployer {
    repository(url: project.publishUrl) {
      authentication(userName: project.publishUsername, password: project.publishPassword)
    }
  }
}
</pre> 
                <p> That's pretty much it. &nbsp;Like the previous section, this build.gradle file supports creating the javadoc and source jars and will upload those using the same <strong>gradlew uploadArchives</strong> command.</p> 
                <h2> Liferay SDK</h2> 
                <p> In the Liferay SDK we have to configure Ivy to support the artifact publication. And actually this is quite easy because Liferay has already configured ivy to support their internal deployments to an internal Sonatype server, we just have to override the properties.</p> 
                <p> In your build.username.properties file in the root of the SDK, you need to just add some property overrides:</p> 
                <pre>
sonatype.release.url=http://localhost:888/archiva/repository/liferay/
sonatype.release.hostname=localhost
sonatype.release.username=dnebing
sonatype.release.password=dnebing1
</pre> 
                <p> That is your configuration for publishing. After building your plugin, i.e. using the <strong>ant war</strong> command, just issue the <strong>ant publish</strong> command to push the artifact to the repository. If you run <strong>ant jar-javadoc</strong> before the <strong>ant publish</strong>, your javadocs will be generated so they'll be available for publishing too. There's also an <strong>ant jar-source</strong> target available, but I didn't see where it was being uploaded to the repository, so that might not be supported by the SDK scripts.</p> 
                <p> One thing I did find, though, is that in each plugin you plan on publishing, you should edit the ivy.xml file in the plugin directory. The ivy.xml file has, as the first tag element, the line:</p> 
                <pre>
&lt;info module="hello-portlet" organisation="com.liferay"&gt;</pre> 
                <p> The organisation attribute is actually going to be the group id used during publishing so, unless you want all of your plugins to be in the com.liferay group, you'll want to edit the file to set it to what you need it to be.</p> 
                <p> I did check the templates and there doesn't seem to be a way to configure it. &nbsp;The templates are all available in the SDK's tools/templates directory, so you could go into all of the individual ivy.xml files and set the value you want, that way as you create new plugins using the templates the default value will be your own.</p> 
                <p> Note that this only applies if you create plugins using the command line; I'm honestly not sure if you are using the Liferay IDE that the templates in the SDK folder are actually the ones the IDE uses for new plugin project creation.</p> 
                <h2> Liferay Maven Projects</h2> 
                <p> Liferay Maven projects are, well, simple projects based on Maven. &nbsp;I'm not going to dive into all of the files here, but suffice it to say you add your repository servers, usually in your settings.xml file, and then you add to the pom file:</p> 
                <pre>
&lt;distributionManagement&gt;
  &lt;repository&gt;
    &lt;id&gt;archiva.internal&lt;/id&gt;
    &lt;name&gt;Internal Release Repository&lt;/name&gt;
    &lt;url&gt;http://localhost:888/archiva/repository/internal&lt;/url&gt;
  &lt;/repository&gt;
  &lt;snapshotRepository&gt;
    &lt;id&gt;archiva.snapshots&lt;/id&gt;
    &lt;name&gt;Internal Snapshot Repository&lt;/name&gt;
    &lt;url&gt;http://localhost:888/archiva/repository/snapshots&lt;/url&gt;
  &lt;/snapshotRepository&gt;
&lt;/distributionManagement&gt;
</pre> 
                <p> With just this addition, you can use the <strong>mvn deploy</strong> command to push up your artifacts. Additionally, you can add support for publishing the javadocs and sources too:&nbsp;<a href="https://stackoverflow.com/questions/4725668/how-to-deploy-snapshot-with-sources-and-javadoc">https://stackoverflow.com/questions/4725668/how-to-deploy-snapshot-with-sources-and-javadoc</a></p> 
                <h2> Liferay Maven Workspace</h2> 
                <p> For publishing purposes, the Liferay Maven workspace is merely a collection of submodules. This means that Maven pretty much is going to support the publication of submodules after you complete the configuration and pom changes mentioned in the previous Liferay Maven Projects section.</p> 
                <p> Normally the mvn deploy command will publish all of the submodules, but you can selectively disable submodule publish by configuring the plugin in the submodule pom:&nbsp;<a href="http://maven.apache.org/plugins/maven-deploy-plugin/faq.html#skip">http://maven.apache.org/plugins/maven-deploy-plugin/faq.html#skip</a></p> 
                <h1> Conclusion</h1> 
                <p> This blog post ended up being a lot bigger than what I originally planned, but it does contain a great deal of information.</p> 
                <p> We reviewed how to set up an Archiva instance to use for your repository proxy.</p> 
                <p> We checked out the changes to make in each one of the Liferay development frameworks to leverage the repository proxy to pull all dependencies from the repository proxy, whether that proxy is Apache Archiva, Artifactory or Nexus.</p> 
                <p> We also learned how to configure each of the development frameworks to support publishing of the artifacts to share with the development team.</p> 
                <p> A lot of good stuff, if you ask me. I hope you find these details useful and, of course, if you have any comments leave them below and any questions, well post them to the forum and we'll help you out.</p> 
                <p> As a test, I timed the complete build of the&nbsp;<a href="https://github.com/liferay/liferay-blade-samples">https://github.com/liferay/liferay-blade-samples</a>&nbsp;after deleting my ~/.m2/repository folder (purging my local system repository). Without the repository proxy, downloading all of the dependencies and completing the build took 69 seconds (note I have gigabit ethernet at home, so your numbers are going to vary from that). After purging ~/.m2/repository again and configuring for the repository proxy (pre-populated with artifacts), downloading all of the dependencies and completing the build took 45 seconds.</p> 
                <p> That is almost a 35% reduction in build time, and it means that 35% of the total build is taken to download artifacts even over my gigabit ethernet.</p> 
                <p> If you do not have gigabit ethernet where you're at, it would not surprise me to see that time to download increase, taking the % of reduction up along with it.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/leveraging-maven-proxies"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="fnfp_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Leveraging Maven Proxies" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/leveraging-maven-proxies" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/leveraging-maven-proxies" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/leveraging-maven-proxies" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/leveraging-maven-proxies?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">0 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-2?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Building JS Portlets Part 2</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 27, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <h2> Introduction</h2> 
                <p> In <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-1">part 1 of the blog series</a>, we started a Vue.js portlet based in the Liferay Workspace, but actually there was no JS framework introduced just yet.</p> 
                <p> We're actually going to continue that trend here in part 2, but in this part we're going to tackle some of the important parts that we'll need in our JS portlets to fit them into Liferay.</p> 
                <h2> Passing Portlet Instance Configuration</h2> 
                <p> In part 1 our view.jsp page used the portlet instance configuration, displayed as two text lines:</p> 
                <pre>
&lt;%@ include file="/init.jsp" %&gt;

&lt;p&gt;
  &lt;b&gt;&lt;liferay-ui:message key="vue-portlet-1.caption"/&gt;&lt;/b&gt;
&lt;/p&gt;
&lt;p&gt;&lt;liferay-ui:message key="caption.flag.one"/&gt; &lt;%= 
  String.valueOf(portletInstanceConfig.flagOne()) %&gt;&lt;/p&gt;
&lt;p&gt;&lt;liferay-ui:message key="caption.flag.two"/&gt; &lt;%= 
  String.valueOf(portletInstanceConfig.flagTwo()) %&gt;&lt;/p&gt;</pre> 
                <p> We're actually going to continue this, but we're going to leverage our &lt;aui:script /&gt; tag to leverage it in a new addition to the JSP:</p> 
                <pre>
&lt;aui:script&gt;

var &lt;portlet:namespace/&gt;portletPreferences = {
	flag: {
		one: &lt;%= portletInstanceConfig.flagOne() %&gt;,
		two: &lt;%= portletInstanceConfig.flagTwo() %&gt;
	}
};

&lt;/aui:script&gt;</pre> 
                <p> Using &lt;aui:script /&gt;, we're embedding javascript into the JSP.</p> 
                <p> Inside of the script tag, we declare a new variable with the name portletPreferences (although this name is namespaced to prevent a name collision with another portlet on the page).</p> 
                <p> We initialize the variable as an object which contains our portlet preferences. In this example the individual flags have been set underneath a contained flag object, but the structure can be whatever you want.</p> 
                <p> The goal here is to create a unique Javascript object that will hold the portlet instance configuration values. We need to extract them in the JSP because once the code is over and running in the browser, it will not have access to the portlet config. Using this technique, we get all of the prefs in a Javascript variable so they will be available to the running JS portlet in the browser.</p> 
                <h2> Passing Permissions</h2> 
                <p> We're actually going to continue this technique to pass permissions from the back end to the JS portlet:</p> 
                <pre>
var &lt;portlet:namespace/&gt;permissions = {
	&lt;c:if test="Validator.isNotNull(permissionChecker)"&gt;
		isSignedIn: &lt;%= permissionChecker.isSignedIn() %&gt;,
		isOmniAdmin: &lt;%= permissionChecker.isOmniadmin() %&gt;,
		hasViewOrgPermission: &lt;%= permissionChecker.hasPermission(null, 
		  Organization.class.getName(), Organization.class.getName(), 
		  ActionKeys.VIEW) %&gt;
	&lt;/c:if&gt;
	&lt;c:if test="Validator.isNull(permissionChecker)"&gt;
		isSignedIn: false,
		isOmniAdmin: false,
		hasViewOrgPermission: false
	&lt;/c:if&gt;
};</pre> 
                <p> Here we're trying to use the permission checker added by the init.jsp's &lt;liferay-theme:defineObjects /&gt; tag.</p> 
                <p> Although I'm confident I should never get a null permission checker instance, I'm using defensive programming to ensure that I can populate my permissions object even if the checker is not available.</p> 
                <p> When it is, I'm basically populating the object with keys for the permissions and then a scriptlet to evaluate whether the current user has the permission details.</p> 
                <p> Since we are building this as a Javascript object, we will be able to collect all of the permissions when the JSP is rendering the initial HTML fragment and allows us to ship the permissions back to the browser so the portlet can use the permissions to make decisions on what to view and what to allow editing on.</p> 
                <p> The only thing you need to figure out is what permissions you will need on the front end; once you know that, you can use this technique to gather those permissions and ship them to the browser.</p> 
                <div class="portlet-msg-alert">
                  NOTE: This does not replace the full use of the permission checker on the back end when processing requests. This technique passes the permissions to the browser, but as we all know it is easy for hackers to adjust these settings once retrieved in order to try to circumvent the permissions. These should be used to manage the UI, but in no way, shape or form should the browser control permissions when invoking services on the backend.
                </div> 
                <h2> I18N</h2> 
                <p> The previous sections have been fairly straight-forward; we have data on the backend (prefs and permissions) we need to have on front end but really only one way to pass them.</p> 
                <p> Handling the I18N in the JS portlets comes with a couple of alternatives.</p> 
                <p> It would actually be quite easy to continue the technique we used above:</p> 
                <pre>
var &lt;portlet:namespace /&gt;languageKeys = {
	accessDenied: '&lt;liferay-ui:message key="access-denied" /&gt;',
	active: '&lt;liferay-ui:message key="active" /&gt;',
	localCustomMessage: '&lt;liferay-ui:message key="local-custom-message" /&gt;'
};</pre> 
                <p> I can tell you that this technique is extremely tedious. I mean, most apps have tens if not hundreds of language keys for buttons, messages, labels, etc. Itemizing them here will get the job done, but it is a lot of work.</p> 
                <p> Fortunately we have an alternative. Liferay actually provides the Liferay.Language.get(key) Javascript function. This function will conveniently call the back end to translate the given key parameter using the backend language bundle resolution. It is backed by a cache on the browser side so multiple calls for the same key will only call the backend once.</p> 
                <p> So, rather than passing the 'access-denied' message like we did above, we could just remember to replace hard-coded strings from our JS portlet's template code with calls like Liferay.Language.get('access-denied'). We would likely see the following for Vue templates:</p> 
                <pre>
var app5 = new Vue({
  el: '#app-5',
  data: {
    message: Liferay.Language.get('access-denied')
  },
  methods: {
    reverseMessage: function () {
      this.message = this.message.split('').reverse().join('')
    }
  }
})</pre> 
                <p> Although this is convenient, it too has a problem. Because of how the backend resolves keys, only resource bundles registered with the portal can be resolved. If you are only going after Liferay known keys, that's no problem. But to use your local resource bundle, you will need to register it into the portal per instructions available here:&nbsp;<a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/overriding-language-keys#modifying-liferays-language-keys">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/overriding-language-keys#modifying-liferays-language-keys</a>. Note that you're not overriding so much as adding your local resource bundle into the mix to expose your language bundle.</p> 
                <p> So actually to keep things simple I would recommend a mixed implementation. For existing Liferay keys, use the Liferay.Language.get() method to pull the value from the backend. But instead of registering an additional resource bundle in the portal, just use the script-based technique above to pass your local keys.</p> 
                <p> This will minimize your coding impact, but if your local bundle has tens or hundreds of your own keys, well you might find it easier to just register your language bundle and stick with Liferay.Language.get().</p> 
                <h2> Conclusion</h2> 
                <p> What what? We're at the end of part 2 and still no real Javascript framework integration?</p> 
                <p> That is correct, we haven't pulled in Vue.js yet, although we will be doing that in Part 3.</p> 
                <p> I think that it is important to note that from our original 6 prerequisites, we have already either fully or partially satisfied:</p> 
                <ul> 
                 <li> Prereq #1 - Using the Liferay Workspace.</li> 
                 <li> Prereq #6 - Using the Liferay Environment.</li> 
                </ul> 
                <p> The big conclusion here is that we can use this pattern to preload data from the portal side to include in the JS applications, data which is otherwise not available in the browser once the JS app is running. &nbsp;You can apply this pattern for collecting and passing data that you want available to the JS app w/o providing a runtime fetch mechanism or exposing portal/portlet data.</p> 
                <div class="portlet-msg-info">
                  Note: Of course in my JSP/Javascript stuff above, there is no verification of JS, no proper handling of string encoding and other protections you might use to ensure you are not serving up some sort of JS attack. Just because I didn't present it, doesn't mean that you shouldn't include it in your production apps.
                </div> 
                <p> See you in Part 3...</p> 
                <p> &nbsp;</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/building-js-portlets-part-2"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="sbja_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Building JS Portlets Part 2" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-2" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-2" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-2" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-2?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">0 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-1?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Building JS Portlets Part 1</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 27, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <h2> Introduction</h2> 
                <p> In Liferay 7 CE / Liferay DXP, there are new facilities in place to help us create JS portlets. In this blog series I'm going to present a new project to demonstrate how to build Vue.js portlets.</p> 
                <p> Vue.js is a lightweight JS framework similar to React or Angular or ... I'm actually picking Vue.js for this series not so much because I think it is better than the other frameworks, but mostly because I want to focus on building JS portlets and I don't want to get hung up on perfect React or Angular implementation. I figured that by picking a newer framework I could present topics that affect all implementations and avoid the framework debates.</p> 
                <p> And who knows, maybe this will start a big trend of adopting Vue.js in Liferay. We'll just see how it goes.</p> 
                <h2> Prerequisites</h2> 
                <p> So I'm going to lay down some prerequisites, but they are not requirements per se, they're just things that I want to have being a regular portlet developer.</p> 
                <p> So <strong>prereq #1</strong> is that the portlet has to fit into my Liferay Workspace. I mean, I'm building all kinds of modules in there: JSP fragment bundles, Service Builder modules, Liferay MVC portlet modules, etc. I don't want to maintain two separate repositories for normal stuff and JS stuff. So the JS portlets must fit into the Gradle-based Liferay Workspace for the general build process. I'm okay with the module leveraging other tools (gulp, npm, etc.) the portlets might need, but the Gradle build must rule them all.</p> 
                <p> <strong>Prereq #2</strong> is that I need open and unfettered access to the internet. I know a lot of developers sit behind proxies and that's okay, as long as they can get to the web for plugins and projects from GitHub, open maven repositories, NPM repositories, etc. If you find yourself in a secured environment that needs approval for all external tools, libraries, etc., you might want to stop now and rethink following along here. All of the JS-based portlets are going to leverage a lot of new stuff from NPM, new build tools such as Gulp, new build plugins from Liferay GitHub repositories, etc. &nbsp;There's going to be a long list of external sites to pull from, and if you need to get permissions for each one there is going to be a ton of red tape in your future. You might be better served just sticking with Liferay MVC portlet implementations and rely on the built-in SennaJS support to provide the ajaxy-sort of responsiveness we all expect now.</p> 
                <div class="portlet-msg-info">
                  For the record, there really is nothing wrong with sticking with Liferay MVC and SennaJS. When you do a Liferay DXP trial walkthru and use the portlets on a page, you'll see that there are few full page refreshes, and when there are they are usually a result of page navigation within the portal. The portlets themselves are still using the regular Portlet Lifecycle, they're just getting invoked via AJAX and the browser is going to be doing partial DOM updates in the page. So you can get most of the benefits from the new whiz-bang JS frameworks without retooling yourself or your team.
                </div> 
                <p> <strong>Prereq #3</strong> concerns deployment; I'd like to be able and build and deploy my portlet independently without requiring supporting theme work. As of right now I'm not 100% confident that will work or even that it is the best path, but it is something that I'd like to shoot for. To me, the more things that make a portlet deployment difficult, the more things there are that can go wrong during deployment.</p> 
                <p> <strong>Prereq #4</strong> is that I am really only targeting JS portlets. I have no plan on co-running my Vue.js apps as both portlets and straight-up web apps, so I have no plans on testing, styling or running these guys outside of the portal.</p> 
                <p> <strong>Prereq #5</strong> is that since they are running within the portal, I expect the UI to be consistent with the rest of the portal; buttons should look the same, fonts, etc. I don't want to have a portlet that stands out just because it is from some other framework type.</p> 
                <p> And finally, <strong>prereq #6</strong> is that they must take advantage of the Liferay environment. I expect them to support portlet preferences via the Configuration panel. I expect them to respect the Liferay permissioning framework. I expect them to support localization through standard Liferay techniques. After all, I don't want to be doing things one way for standard Liferay stuff and some other way for JS portlets.</p> 
                <p> So let's get started...</p> 
                <h2> Starting The Project</h2> 
                <p> As per usual I'm going to be sticking with the Blade CLI for everything to highlight that you don't need an IDE to get these things started.</p> 
                <pre>
blade init liferay-vuejs</pre> 
                <p> This will give me the new Liferay Workspace to build everything in. If you have an existing workspace, you're all good.</p> 
                <p> So this is really all you need to do from a workspace level. &nbsp;Everything else goes into the individual modules.</p> 
                <p> I am planning on demonstrating remote services in the JS portlet, so eventually our modules folder will contain some Service Builder modules as well as a REST module, but we'll worry about creating those later.</p> 
                <p> In our modules folder we want to start the JS portlet itself. &nbsp;Navigate to liferay-vuejs/modules to create the new module:</p> 
                <pre>
blade create -t mvc-portlet -p com.dnebinger.vue vue-portlet-1</pre> 
                <p> So you might be wondering why we're using the Liferay MVC portlet template since we're building a JS portlet.</p> 
                <p> We use the Liferay MVC portlet as a template because we need to be able to kick off the JS inside of our portlet frame, we need to be able to declare and pull in resources, etc. The Liferay MVC portlet template will give that to us, plus a lot more.</p> 
                <h2> Creating The Portlet Instance Preferences</h2> 
                <p> Since we have a new Liferay MVC portlet, let's take a moment to create a configuration page.</p> 
                <p> What? We're not starting with the JS directly?</p> 
                <p> Well, no. Like I said in the prereqs, one of my goals is to include portlet prefs in order to be a proper Liferay portlet. To support that, we'll create a simple JSP configuration page for our portlet and worry about wiring it into JS later on...</p> 
                <p> Our configuration is going to be pretty simple. We're just going to have a couple of checkboxes to capture two flag values. Here's the full src/main/resources/META-INF/resources/configuration.jsp file:</p> 
                <pre>
&lt;%@ include file="/init.jsp" %&gt;

&lt;%
  portletInstanceConfig = ConfigurationProviderUtil.getConfiguration(
      VuePortlet1PortletInstanceConfiguration.class,
      new ParameterMapSettingsLocator(request.getParameterMap(),
          new PortletInstanceSettingsLocator(themeDisplay.getLayout(), 
              portletDisplay.getPortletResource())));
%&gt;
&lt;liferay-portlet:actionURL portletConfiguration="&lt;%= true %&gt;" var="configurationActionURL" /&gt;

&lt;liferay-portlet:renderURL portletConfiguration="&lt;%= true %&gt;" var="configurationRenderURL" /&gt;

&lt;aui:form action="&lt;%= configurationActionURL %&gt;" method="post" name="fm"&gt;
  &lt;aui:input name="&lt;%= Constants.CMD %&gt;" type="hidden" value="&lt;%= Constants.UPDATE %&gt;" /&gt;
  &lt;aui:input name="redirect" type="hidden" value="&lt;%= configurationRenderURL %&gt;" /&gt;

  &lt;div class="portlet-configuration-body-content"&gt;
    &lt;div class="container-fluid-1280"&gt;
      &lt;aui:fieldset-group markupView="lexicon"&gt;
        &lt;aui:fieldset&gt;
          &lt;aui:input label="config.flag.one" name="preferences--flagOne--" 
              type="toggle-switch" value="&lt;%= portletInstanceConfig.flagOne() %&gt;" /&gt;
          &lt;aui:input label="config.flag.two" name="preferences--flagTwo--" 
              type="toggle-switch" value="&lt;%= portletInstanceConfig.flagTwo() %&gt;" /&gt;
        &lt;/aui:fieldset&gt;
      &lt;/aui:fieldset-group&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;aui:button-row&gt;
    &lt;aui:button cssClass="btn-lg" type="submit" /&gt;
  &lt;/aui:button-row&gt;
&lt;/aui:form&gt;</pre> 
                <p> This is going to give us two boolean portlet preferences leveraging the new Liferay Config Admin services. They will be instance parameters so, if we choose to create an instanceable portlet, each one will have its own preferences.</p> 
                <p> We will use our view.jsp page to show the values:</p> 
                <pre>
&lt;%@ include file="/init.jsp" %&gt;

&lt;p&gt;
  &lt;b&gt;&lt;liferay-ui:message key="vue-portlet-1.caption"/&gt;&lt;/b&gt;
&lt;/p&gt;
&lt;p&gt;&lt;liferay-ui:message key="caption.flag.one"/&gt; &lt;%= 
  String.valueOf(portletInstanceConfig.flagOne()) %&gt;&lt;/p&gt;
&lt;p&gt;&lt;liferay-ui:message key="caption.flag.two"/&gt; &lt;%= 
  String.valueOf(portletInstanceConfig.flagTwo()) %&gt;&lt;/p&gt;</pre> 
                <p> Since we're showing the JSP, here's the init.jsp:</p> 
                <pre>
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;
&lt;%@ taglib uri="http://java.sun.com/portlet_2_0" prefix="portlet" %&gt;
&lt;%@ taglib uri="http://liferay.com/tld/aui" prefix="aui" %&gt;
&lt;%@ taglib uri="http://liferay.com/tld/portlet" prefix="liferay-portlet" %&gt;
&lt;%@ taglib uri="http://liferay.com/tld/theme" prefix="liferay-theme" %&gt;
&lt;%@ taglib uri="http://liferay.com/tld/ui" prefix="liferay-ui" %&gt;
&lt;%@ taglib uri="http://liferay.com/tld/frontend" prefix="liferay-frontend" %&gt;

&lt;%@ page import="com.dnebinger.vue.portlet.configuration.VuePortlet1PortletInstanceConfiguration" %&gt;
&lt;%@ page import="com.liferay.portal.kernel.module.configuration.ConfigurationProviderUtil" %&gt;
&lt;%@ page import="com.liferay.portal.kernel.settings.PortletInstanceSettingsLocator" %&gt;
&lt;%@ page import="com.liferay.portal.kernel.util.Constants" %&gt;
&lt;%@ page import="com.liferay.portal.kernel.settings.ParameterMapSettingsLocator" %&gt;

&lt;liferay-frontend:defineObjects /&gt;

&lt;liferay-theme:defineObjects /&gt;

&lt;portlet:defineObjects /&gt;

&lt;%
  VuePortlet1PortletInstanceConfiguration portletInstanceConfig =
    ConfigurationProviderUtil.getConfiguration(VuePortlet1PortletInstanceConfiguration.class,
      new PortletInstanceSettingsLocator(themeDisplay.getLayout(), portletDisplay.getId()));
%&gt;</pre> 
                <p> Okay, so we now have basically a simple Liferay MVC portlet project that has portlet preferences and initial support for the language bundle (as seen in the view.jsp file).</p> 
                <p> If we build and deploy the portlet, this is what we currently will see (after changing one of the toggles on the configuration panel):</p> 
                <p style="text-align: center;"> <img alt="" src="/documents/26528/91158941/PortletPrefsView.png/aea976b7-878f-4f23-9881-0ad8b3fff365?t=1498616548504" style="width: 281.0px;height: 108.0px;"></p> 
                <h2> Conclusion</h2> 
                <p> Hey, wait a minute, there's no Javascript frameworks in here! I don't see any Vue.js stuff, no node, in fact this looks like a simple Liferay MVC portlet! What's going on here?</p> 
                <p> Well, I should have said that this is actually going to be a blog series. In this first post, we're basically going to stop here since our portlet is ready to start overlaying the key parts for building out our Javascript portlet.</p> 
                <p> You can find the sample project checked in here:&nbsp;<a href="https://github.com/dnebing/liferay-vuejs">https://github.com/dnebing/liferay-vuejs</a>.</p> 
                <p> See you in Part 2!</p> 
               </div> 
               <div class="entry-footer"> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="gpox_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Building JS Portlets Part 1" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-1" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-1" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-1" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/building-js-portlets-part-1?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">2 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/responsive-responsibility?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Responsive Responsibility</a> </h1> 
                <p class="details"> <span class="btn-d General">General Blogs</span> June 26, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> <a href="https://www.liferay.com/resources/l?title=digital-experience-platform">According to Liferay</a>:</p> 
                <p style="margin-left: 40.0px;"> <cite><b style="color: rgb(34,34,34);font-family: Roboto , arial , sans-serif;background-color: rgb(255,255,255);">Digital Experience Platform</b><span style="color: rgb(34,34,34);font-family: Roboto , arial , sans-serif;background-color: rgb(255,255,255);">&nbsp;(DXP) is an emerging category of enterprise software seeking to meet the needs of companies undergoing&nbsp;</span><b style="color: rgb(34,34,34);font-family: Roboto , arial , sans-serif;background-color: rgb(255,255,255);">digital</b><span style="color: rgb(34,34,34);font-family: Roboto , arial , sans-serif;background-color: rgb(255,255,255);">&nbsp;transformation, with the ultimate goal of providing better customer&nbsp;</span><b style="color: rgb(34,34,34);font-family: Roboto , arial , sans-serif;background-color: rgb(255,255,255);">experiences</b><span style="color: rgb(34,34,34);font-family: Roboto , arial , sans-serif;background-color: rgb(255,255,255);">.</span></cite></p> 
                <p> The focus here is the customer experience. &nbsp;Better experiences, regardless of whether they come to you from a desktop computer or a mobile device, lead to better outcomes (happier customers, returning viewers, more sales, etc.). That is why the DXP is garnering more focus from the enterprise than ever before.</p> 
                <p> So part of the better customer experience is the recognition that your site, whether as an intranet, extranet, corporate internet site or even a B2B bridge, must acknowledge the strength and reach of mobile as a platform, and mobile support must be considered as an unwritten requirement for our projects.</p> 
                <p> For most developers, this often gets reduced down to needing to support responsive in the website. &nbsp;If the website supports responsive design, as the screen size is reduced the view changes to better serve the device.</p> 
                <p> It is easy to assume that the theme and layout developer(s) are the only ones responsible for managing the responsive aspects of your website. After all, that is the primary place where your responsive design is implemented to manage how your navigation is presented, how the multi-column layout adjusts to the shrinking size, etc. That is handled by the theme and layout developers, so they are the only ones that have to worry about responsive design.</p> 
                <p> But that really isn't true. Responsive is a responsibility of content creators and portlet developers too.</p> 
                <p> As a content creator, you may have some fancy ADTs or web content templates that look great under the desktop view. You have your content, you have a side bar with some details, ... But here's a question - have you tried looking at your page on a mobile device? Does your side bar or localized grid look as good in the mobile view as it does on the desktop view?</p> 
                <p> As a content creator, it is your responsibility to incorporate responsive and mobile-first design rules into your ADTs and templates. After all, the theme/layout developer is only going to manage the outer column that your content is in, they will not have any responsibility for restructuring content within the column, that is your job.</p> 
                <p> And portlet authors are not off the hook here either. As a portlet developer it is easy to fall into a pattern of testing your portlet on the desktop and verifying it works there. Even the testing team, unless they have a mandate to test for mobile, can miss this kind of verification. But if you currently have mobile support requirements or you believe that will have mobile in your future, developing with responsive in mind and testing for responsive and a good mobile-friendly experience is important.</p> 
                <p> If you use the Liferay AUI tag framework appropriately, you're likely a good way towards being mobile friendly. If you're using another framework, well then responsive is totally up to you and your framework.</p> 
                <p> In either case, you should take some time to test your app, including your tables and forms, in a mobile view and verify that it is still usable. After all, a form that looks great and works great in a desktop orientation can easily become unusable in a mobile presentation. Take Liferay's OOTB login portlet - that portlet works whether shown in a full page view or if it is dropped in the small column of the 30/70 layout - it is fully responsive and adjusts to the space it has available. Are your portlets equally as responsive?</p> 
                <p> How do you know when responsive is your responsibility? There are some key indicators that you can look for. Are you using a one column layout? That is the clearest indication that you are taking over responsive since you are trying to take advantage of the full page width. Even if you are only targeting the large column (the 70 in the 70/30 or 30/70 layouts for example), you also have responsive aspects that you should consider.</p> 
                <p> So responsive is everyone's responsibility. It's also one that many of us forget to consider unless it is a requirement of the project that we're currently on.</p> 
                <p> Incorporating responsive tests and creating sites that are mobile-first/mobile-friendly in every phase of development or content creation is a key aspect of implementing your own digital experience platform.</p> 
                <p> Remember, this is all about the user's digital experience, not your development project convenience.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/responsive-responsibility"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="tjpo_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Responsive Responsibility" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/responsive-responsibility" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/responsive-responsibility" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/responsive-responsibility" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/responsive-responsibility?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">0 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/disabling-lpkg-index-validation?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Disabling LPKG Index Validation</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 21, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> Just a quick blog today...</p> 
                <p> When you start up LR 7 CE/LR DXP, you'll often see it stop while trying to validate LPKGs. This is a security measure which is used to verify that the LPKG files have not been tampered with.</p> 
                <p> In development, though, this delay is just painful.</p> 
                <p> Fortunately it can be disabled. Add the following line to portal-ext.properties:</p> 
                <pre>
module.framework.properties.lpkg.index.validator.enabled=false</pre> 
                <p> That's all there is to it.</p> 
                <p> Note that I probably would not do this in my production environments. It is, after all, in there to protect your environment. Disabling it in production removes that small bit of protection and doesn't seem wise.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/disabling-lpkg-index-validation"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="qdks_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Disabling LPKG Index Validation" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/disabling-lpkg-index-validation" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/disabling-lpkg-index-validation" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/disabling-lpkg-index-validation" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/disabling-lpkg-index-validation?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">6 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/fixing-module-package-access-modifiers?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Fixing Module Package Access Modifiers</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 16, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> If you're a Java Architect or Senior Developer, you know just how important the Java access modifiers are.</p> 
                <p> Each choice about what to make public, protected, private or package protected is important from an architectural perspective. If you make the wrong choices you can expose too much of your implementation or not enough, you can give subclasses unlimited ability to change internal functionality or little access at all.</p> 
                <p> If you've ever worked on a library or framework project, either public or a company internal project, you know that these decisions are even more important. With these types of projects, if you make the wrong decision about access modifiers you can end up with irate users or an unused library.</p> 
                <p> So there exists two different sets of rules, one for app developers and one for lib developers. &nbsp;App developers are going to use a lot of private to hide stuff and public to expose; they'll define pojos w/ getters but no setters and perhaps a package private constructor to initialize final fields. Methods are typically public or private and protected only comes into play if there are known plans to subclass.</p> 
                <p> Library developers swing the other way, allowing for every class to potentially be subclassed, extensive use of protected over private, no use of package protected, etc. Basically implementation details will be protected from those using the class yet exposed for subclasses to extend or override.</p> 
                <p> Rules for lib developers are not hard and fast, some libraries certainly do a better job than others for exposing necessary access points.</p> 
                <p> I'm sure most of us have been there... Using a class in someone's jar where they declare, for example, a private field with a public getter but no setter, resulting in a class that is difficult to extend and customize. Then we have to break out our Reflection skills to access the field, change the access and update the value. Obviously we don't want to do these things, but we get forced into it because the library developer used application developer rules when defining the access modifiers.</p> 
                <h2> OSGi Access Modifiers</h2> 
                <p> OSGi bundles has its own set of "access modifiers". &nbsp;We've seen those in the bnd.bnd files, at a package level you can choose to export packages or mark them as private.</p> 
                <p> Choices you make along these lines affect what you can extend/override in other bundles. If you mark a package as private, the classes are not available to another bundle to leverage and use.</p> 
                <p> Just like app vs lib developer access modifier rules, there is a similar distinction for OSGi application bundle developer rules and OSGi library bundle developer rules. &nbsp;For the app bundle developer, packages are exported if they can be used by other modules, otherwise they are private to protect them. For lib bundle developers, you're going to export pretty much every package because you can never know how your library module will be used.</p> 
                <h2> How Liferay Gets This Wrong</h2> 
                <p> Probably my biggest complaint with the Liferay 7 CE / Liferay DXP modules is that I believe the developers were creating modules as though they are app bundle developers when, in fact, they should have been library bundle developers.</p> 
                <p> For example, the Liferay chat portlet... The Liferay chat portlet does not export a single package; every package in the module is private. As an application portlet bundle developer, this is probably exactly the decision I would make to protect my code, it won't need to be extended or overridden, as the developer if that comes up in the future I can just do it.</p> 
                <p> But the Liferay developers, they should not have built it this way in my opinion. Me, I may have a need to make some significant changes to the chat portlet, not just for JSP changes but perhaps also some logic. From that point of view, the Liferay chat portlet is a library bundle, a "base" bundle that I want to be able to extend or override. The com.liferay.chat.web.portlet.ChatPortlet is not full Liferay MVC, so all business logic is tied up in that class. If I want to customize the chat portlet, I need to copy the class and make my change and hope that Liferay doesn't update the portlet.</p> 
                <p> In order to complete my customization, I might need to change a method in the ChatPortlet itself. Sure, with OSGi I can replace the OOTB portlet class with my own, but I really want to be able to do something like:</p> 
                <pre>
@Component(...)
public class MyChatPortlet extends ChatPortlet {...}</pre> 
                <p> This would allow me to replace the OOTB portlet using a higher service ranking for mine, yet I can keep as much of the original logic as-is without taking over responsibility for maintaining the full class myself.</p> 
                <p> For another concrete example, take the Liferay Login portlet. &nbsp;This portlet is full-on Liferay MVC so, if I want to override the create account action, I just need to register an instance of MVCActionCommand with the right mvc.command.name and a higher service ranking. But again, since most of the packages in the Liferay Login portlet are private, I cannot do something like:</p> 
                <pre>
@Component(...)
public class CustomCreateAcountMVCActionCommand extends CreateAccountMVCActionCommand {...}</pre> 
                <p> If my requirement is just to do some additional work in the addUser() method, I don't want to copy the whole Liferay class just to be able to tweak one method. &nbsp;What happens when the next release comes out? I'd have to copy the whole class in and release again. At least by extending I only have to worry about keeping in sync the stuff I change, everything else is extended.</p> 
                <h2> Can We Fix It?</h2> 
                <p> As Bob the Builder says, "Yes We Can!", and it turns out it is really, really easy!</p> 
                <p> Let's say we want to tackle being able to extend Liferay's CreateAccountMVCActionCommand class. Our requirement is that we need to log whenever an account is being created. I know, pretty lame, but the point here is to extend a class which Liferay didn't plan on our extending - once we're over that hump, any additional requirements will be easy to tackle.</p> 
                <p> So let's get started. The first thing we need is a Fragment bundle. That's right, you read correctly, a Fragment bundle.</p> 
                <pre>
blade create -t fragment -h com.liferay.login.web -H 1.0.0 open-liferay-web</pre> 
                <p> That gets us started. We need to open the bnd.bnd file and we're going to be doing two basic things:</p> 
                <ol> 
                 <li> Copy in most of the stuff from the original bnd.bnd file. The only change we want to make is with the exported packages, so we want to keep everything else.</li> 
                 <li> Change the exported package line (or add one) to include the packages we want to export, and we'll also change to a version range.</li> 
                </ol> 
                <p> I've gone ahead and done this, and here's what I ended up with:</p> 
                <pre>
Bundle-Name: Open Liferay Login Web
Bundle-SymbolicName: open.login.web
Bundle-Version: 1.1.19
Fragment-Host: com.liferay.login.web;bundle-version="[1.0.0,2.0.0)"

Export-Package: com.liferay.login.web.constants,\
	com.liferay.login.web.internal.portlet.action
Import-Package:\
	javax.net.ssl,\
	\
	*
Liferay-Releng-Module-Group-Description:
Liferay-Releng-Module-Group-Title:
</pre> 
                <p> So you can see that I satisfied #1 above, I've kept the import packages and the Liferay-Releng guys.</p> 
                <p> For #2, my export package statement was updated so now we're going to be exporting the com.liferay.login.web.internal.portlet.action package. This will allow us to subclass Liferay's action command by making it visible.</p> 
                <p> I also tweaked the Fragment-Host version. Instead of using a single version, I've changed it to a version range. Why? Because this fragment bundle doesn't care what version is actually deployed, we're just planning on exporting the package regardless of version.</p> 
                <p> And that's it! See, I said it was easy. You don't really need any other files, you're basically just going to be building and deploying a jar w/ the overriding OSGi manifest information.</p> 
                <h2> Testing</h2> 
                <p> Testing is also kind of easy. We know we want to extend the CreateAccountMVCActionCommand, so we just create a bundle and specify the contents. I did that already, too, and here's what I got:</p> 
                <pre>
@Component(
	property = {
		"javax.portlet.name=" + LoginPortletKeys.FAST_LOGIN,
		"javax.portlet.name=" + LoginPortletKeys.LOGIN,
		"mvc.command.name=/login/create_account",
		"service.ranking:Integer=100"
	},
	service = MVCActionCommand.class
)
public class CustomCreateAccountMVCActionCommand extends CreateAccountMVCActionCommand {

	@Override
	protected void addUser(ActionRequest actionRequest, ActionResponse actionResponse) throws Exception {
		_log.info("About to create a new account.");

		super.addUser(actionRequest, actionResponse);
	}

	@Reference(unbind = "-")
	protected void setLayoutLocalService(
		LayoutLocalService layoutLocalService) {
		super.setLayoutLocalService(layoutLocalService);
	}

	@Reference(unbind = "-")
	protected void setUserLocalService(UserLocalService userLocalService) {
		super.setUserLocalService(userLocalService);
	}

	@Reference(unbind = "-")
	protected void setUserService(UserService userService) {
		super.setUserService(userService);
	}

	@Reference(unbind = "-")
	protected void setAuthenticatedSessionManager(AuthenticatedSessionManager sessionMgr) {
		update("_authenticatedSessionManager", sessionMgr);
	}
	@Reference(unbind = "-")
	protected void setListTypeLocalService(ListTypeLocalService listTypeLocalService) {
		update("_listTypeLocalService", listTypeLocalService);
	}
	@Reference(unbind = "-")
	protected void setPortal(Portal portal) {
		update("_portal", portal);
	}

	protected void update(final String fieldName, final Object value) {
		try {
			Field f = getClass().getSuperclass().getDeclaredField(fieldName);

			f.setAccessible(true);

			f.set(this, value);
		} catch (IllegalAccessException e) {
			_log.error("Error updating " + fieldName, e);
		} catch (NoSuchFieldException e) {
			_log.error("Error updating " + fieldName, e);
		}
	}

	private static final Log _log = LogFactoryUtil.getLog(CustomCreateAccountMVCActionCommand.class);
}
</pre> 
                <p> Oh, crap. What is all of this junk?</p> 
                <p> Well, first let's get the necessary stuff out of the way. Our @Component reference has the necessary properties and service ranking so OSGi will use our action command class, which we are now extending Liferay's CreateAccountMVCActionCommand. We also have the overriding addUser() method to log when we are about to create an account, so we have satisfied our requirement.</p> 
                <p> The rest of the class, well that is necessary to inject the right OSGi references into the super class that it expects. Some of these are easy, such as the layout service and the two user services. The others are hard, the authenticated session manager, list type service and the portal instance.</p> 
                <p> Remember I started this blog saying that the rules for a library developer are different than an app developer, and when you have a bad library class you're left to using Reflection to update a super class? Yep, here's an example. Now, I can't really fault Liferay here for this because they created the module as though they were an app module developer, so the fact that they used app developer rules here is no surprise. Fortunately though I could use Reflection to get to the super field and update it appropriately.</p> 
                <h2> Conclusion</h2> 
                <p> So, when we build and deploy these two modules and create a new account, we find we have been successful:</p> 
                <pre>
13:30:31,360 INFO  [http-nio-8080-exec-6][CustomCreateAccountMVCActionCommand:39] About to create a new account.</pre> 
                <p> Through a simple (really simple) fragment bundle we were able to export a package that Liferay did not export. From there, we can extend classes from that package to introduce our own modifications without having to copy everything from the original.</p> 
                <p> It's important to note the hurdles we had to bypass for the OSGi stuff, especially the Reflection usage to update the super class.</p> 
                <p> If you're going to go down this path, you will be doing things like this. There's no way around it, not all @Reference usage in Liferay classes are tied to methods; when they are, great, but when they're not you'll have to peel them open yourself.</p> 
                <p> Hope this helps you on your Liferay 7 CE / Liferay DXP developer journey!</p> 
                <p> &nbsp;</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/fixing-module-package-access-modifiers"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="nmrl_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Fixing Module Package Access Modifiers" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/fixing-module-package-access-modifiers" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/fixing-module-package-access-modifiers" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/fixing-module-package-access-modifiers" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/fixing-module-package-access-modifiers?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">2 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/rest-custom-context-providers?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">REST Custom Context Providers</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 16, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> So a question came up today how to access the current user as part of a REST method body.</p> 
                <p> My friend, Andre Fabbro, was trying to build out the following application:</p> 
                <pre>
@ApplicationPath("/myapp")
@Component(immediate = true, service = Application.class)
public class MyApplication extends Application {

    @GET
    @Path("/whoami")
    @Produces(MediaType.APPLICATION_JSON)
    public String getUserFullName() {

        User user = ????;

        return user.getFullName();
    }
}</pre> 
                <p> He was stuck trying to get the current user in order to finish the whoami handler.</p> 
                <p> So, being a long-time Liferay guy, I fell back on what I knew, and I pointed him towards the PrincipalThreadLocal and the getName() method to get the current user id. &nbsp;Of course ThreadLocals kind of smell, they're almost like global variables, but I knew it would work.</p> 
                <p> My other friend, Rafael Oliveira, showed us both up and introduced me to the new concept of a custom context provider. You see, he knew that sometime soon a new module, com.liferay.portal.workflow.rest was coming and it was going to bring with it a new class, com.liferay.portal.workflow.rest.internal.context.provider.UserContextProvider. He did us one better by providing an implementation of Andre's app using @Context and the new UserContextProvider:</p> 
                <pre>
import javax.ws.rs.core.Context;

@ApplicationPath("/myapp")
@Component(immediate = true, service = Application.class)
public class MyApplication extends Application {

    @GET
    @Path("/whoami")
    @Produces(MediaType.APPLICATION_JSON)
    public String getUserFullName(@Context User user) {
        return user.getFullName();
    }
}</pre> 
                <p> I was kind of blown away having learned something completely new with DXP and I needed to know more.</p> 
                <p> Before going on, though, all credit for this blog post goes to Rafael, all I'm doing here is putting it to electronic paper for us all to use for Liferay REST application implementations.</p> 
                <h2> Basic @Context Usage</h2> 
                <p> So when you create a new module using "blade create -t rest myapp", BLADE is starting a new JAX-RS-based RESTful application that you can build and deploy as an OSGi module. Using JAX-RS standard conventions, you can build out your RESTful methods using common annotations and (hopefully) best practices.</p> 
                <p> JAX-RS actually provides the javax.ws.rs.core.Context annotation and is used to inject common servlet-based values. Using @Context, you can define a method parameter that is not part of the RESTful call but are injected by the JAX-RS framework, kind of like the automagic ServiceContext injection in ServiceBuilder remote services.</p> 
                <p> Out of the box, JAX-RS <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/Context.html">Context</a> annotation supports injecting the following parameters in methods:</p> 
                <table border="1" cellpadding="2" cellspacing="2" style="width: 100.0%;"> 
                 <thead> 
                  <tr> 
                   <th scope="col"> Type</th> 
                   <th scope="col"> Description</th> 
                  </tr> 
                 </thead> 
                 <tbody> 
                  <tr> 
                   <td> <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/Application.html">javax.ws.rs.core.Application</a></td> 
                   <td> Provides access to metadata information on the JAX-RS application.</td> 
                  </tr> 
                  <tr> 
                   <td> <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/UriInfo.html">javax.ws.rs.core.UriInfo</a></td> 
                   <td> Provides access to application and request URI information.</td> 
                  </tr> 
                  <tr> 
                   <td> <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/Request.html">javax.ws.rs.core.Request</a></td> 
                   <td> Provides access to the request used for the method.</td> 
                  </tr> 
                  <tr> 
                   <td> <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/HttpHeaders.html">javax.ws.rs.core.HttpHeaders</a></td> 
                   <td> Provides access to the HTTP header information for the request.</td> 
                  </tr> 
                  <tr> 
                   <td> <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/SecurityContext.html">javax.ws.rs.core.SecurityContext</a></td> 
                   <td> Provides access to the security-related information for the request.</td> 
                  </tr> 
                  <tr> 
                   <td> <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/ext/Providers.html">javax.ws.rs.ext.Providers</a></td> 
                   <td> Provides runtime lookup of provider instances.</td> 
                  </tr> 
                 </tbody> 
                </table> 
                <p> To use these, you just add appropriately decorated parameters to the REST method. If necessary, we could easily add a method to the application above such as:</p> 
                <pre>
@GET
@Path("/neato")
@Produces(MediaType.APPLICATION_JSON)
public String getStuff(@Context Application app, @Context UriInfo uriInfo, @Context Request request,
        @Context HttpHeaders httpHeaders, @Context SecurityContext securityContext, @Context Providers providers) {
    ....
}
</pre> 
                <p> The above getStuff() method will be handling all requests to the /neato path, but all of the parameters are injected, none are provided in the URL or as parameters; they are injected automagically by JAX-RS.</p> 
                <h2> Custom @Context Usage</h2> 
                <p> So these types are really nice, but they really don't do anything for our Liferay integration. What would be really cool is if we could use @Context to inject some Liferay parameters.</p> 
                <p> And we can! As Rafael pointed out, there is a new module in the pipeline for workflow to invoke RESTful methods on the backend. The new module is the <a href="https://github.com/liferay/liferay-portal/tree/master/modules/apps/forms-and-workflow/portal-workflow/portal-workflow-rest">portal-workflow-rest</a> project. I'm not sure, but I believe this is going to be part of the upcoming GA4 release, but don't hold me to that.</p> 
                <p> Once available, this project will provide three new types that can be injected into RESTful method parameters:</p> 
                <table border="1" cellpadding="2" cellspacing="2" style="width: 100.0%;"> 
                 <thead> 
                  <tr> 
                   <th scope="col"> Type</th> 
                   <th scope="col"> Description</th> 
                  </tr> 
                 </thead> 
                 <tbody> 
                  <tr> 
                   <td> com.liferay.portal.kernel.model.Company</td> 
                   <td> The Liferay Company associated with the request.</td> 
                  </tr> 
                  <tr> 
                   <td> java.util.Locale</td> 
                   <td> The locale associated with the request.</td> 
                  </tr> 
                  <tr> 
                   <td> com.liferay.portal.kernel.model.User</td> 
                   <td> The Liferay User associated with the request.</td> 
                  </tr> 
                 </tbody> 
                </table> 
                <p> So, like the out of the box parameters, we could extend our getStuff() method with these parameters too:</p> 
                <pre>
@GET
@Path("/neato")
@Produces(MediaType.APPLICATION_JSON)
public String getStuff(@Context Application app, @Context UriInfo uriInfo, @Context Request request,
        @Context HttpHeaders httpHeaders, @Context SecurityContext securityContext, @Context Providers providers,
        @Context Company company, @Context Locale locale, @Context User user) {
    ....
}
</pre> 
                <p> Just pick from all of these different available types to get the data you need and run with it.</p> 
                <div class="portlet-msg-info">
                  Remember these will not be available in GA3 nor in DXP just yet - I'm sure they'll make it in soon, but I'm not aware of the schedule for either product lines.
                </div> 
                <h2> Writing Custom Context Providers</h2> 
                <p> So to me, the biggest value of this new module is this package:&nbsp;<a href="https://github.com/liferay/liferay-portal/tree/master/modules/apps/forms-and-workflow/portal-workflow/portal-workflow-rest/src/main/java/com/liferay/portal/workflow/rest/internal/context/provider">https://github.com/liferay/liferay-portal/tree/master/modules/apps/forms-and-workflow/portal-workflow/portal-workflow-rest/src/main/java/com/liferay/portal/workflow/rest/internal/context/provider</a></p> 
                <p> Why? Because they expose how we can write our own custom context provider implementations so we can inject custom parameters into REST methods.</p> 
                <p> Say, for example, that we want to inject a ServiceContext instance. I'm not sure if the portal source already has one of these fellas, but if so let's pretend it doesn't exist and we want to write our own. Where are we going to start?</p> 
                <p> So first you need a project, we'll create a blade workspace:</p> 
                <pre>
blade init custom-context-provider</pre> 
                <p> We also need a new module to develop, so we'll change to the custom-context-provider/modules directory to create an initial module:</p> 
                <pre>
blade create -t api -p com.dnebinger.rest.internal.context.provider service-context-context-provider</pre> 
                <p> This will give us a nearly empty API module. We'll end up cleaning out most of the generated files, but we will end up with the com.dnebinger.rest.internal.context.provider.ServiceContextContextProvider class:</p> 
                <pre>
package com.dnebinger.rest.internal.context.provider;

import com.liferay.portal.kernel.exception.PortalException;
import com.liferay.portal.kernel.log.Log;
import com.liferay.portal.kernel.log.LogFactoryUtil;
import com.liferay.portal.kernel.service.ServiceContext;
import com.liferay.portal.kernel.service.ServiceContextFactory;
import org.apache.cxf.jaxrs.ext.ContextProvider;
import org.apache.cxf.message.Message;
import org.osgi.service.component.annotations.Component;

import javax.servlet.http.HttpServletRequest;
import javax.ws.rs.ext.Provider;

/**
 * class ServiceContextContentProvider: A custom context provider for ServiceContext instantiation.
 *
 * @author dnebinger
 */
@Component(immediate = true, service = ServiceContextContentProvider.class)
@Provider
public class ServiceContextContentProvider implements ContextProvider {
	/**
	 * Creates the context instance
	 *
	 * @param message the current message
	 * @return the context
	 */
	@Override
	public ServiceContext createContext(Message message) {
		ServiceContext serviceContext = null;

		// get the current HttpServletRequest for building the service context instance.
		HttpServletRequest request = (HttpServletRequest) message.getContextualProperty(PROPKEY_HTTP_REQUEST);

		try {
			// now we can create a service context
			serviceContext = ServiceContextFactory.getInstance(request);

			// done!
		} catch (PortalException e) {
			_log.warn("Failed creating service context: " + e.getMessage(), e);
		}

		// return the new instance.
		return serviceContext;
	}

	private static final String PROPKEY_HTTP_REQUEST = "HTTP.REQUEST";

	private static final Log _log = LogFactoryUtil.getLog(ServiceContextContentProvider.class);
}
</pre> 
                <p> So this is pretty much the whole module. Easy, huh?</p> 
                <h2> Conclusion</h2> 
                <p> Now that we can create custom context providers, we can use this one for example in the original code:</p> 
                <pre>
@ApplicationPath("/myapp")
@Component(immediate = true, service = Application.class)
public class MyApplication extends Application {

    @GET
    @Path("/whoami")
    @Produces(MediaType.APPLICATION_JSON)
    public String getUserFullName(@Context ServiceContext serviceContext) {

        User user = _userLocalService.fetchUser(serviceContext.getUserId());

        return user.getFullName();
    }

    @Reference
    private UserLocalService _userLocalService;
}</pre> 
                <p> These custom context providers become the key for being able to create and inject non-REST parameters into your REST methods.</p> 
                <p> Check out the code from GitHub:&nbsp;<a href="https://github.com/dnebing/custom-context-provider">https://github.com/dnebing/custom-context-provider</a></p> 
                <p> Enjoy!</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/rest-custom-context-providers"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="jfvs_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="REST Custom Context Providers" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/rest-custom-context-providers" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/rest-custom-context-providers" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/rest-custom-context-providers" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/rest-custom-context-providers?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">1 Comment</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/resolving-missing-components?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Resolving Missing Components</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 15, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> So if you've started developing for Liferay 7 CE / Liferay DXP, I'm sure you've been hit at one point or another with the old "unresolved reference" issue that prevents your bundle from starting.</p> 
                <p> You would have seen it by now, the Gogo shell where you list the beans and find your bean there stuck in the Installed state. You try starting it and Gogo tells you about the unresolved reference you have and you're stuck going back to your bnd.bnd file to resolve the dependency issue.</p> 
                <p> This is so common, in fact, that I wrote a blog post to help resolve them:&nbsp;<a href="https://web.liferay.com/web/user.26526/blog/-/blogs/osgi-module-dependencies">https://web.liferay.com/web/user.26526/blog/-/blogs/osgi-module-dependencies</a></p> 
                <p> While this will be your issue more often than not, there's another form of "unsatisfied reference" problem that leads to missing components rather than non-started bundles.</p> 
                <h2> The Case of the Missing Component</h2> 
                <p> You can have a case where your module starts but your component is not available. This sounds kind of strange, right? You've taken the time to resolve all of those 3rd party dependency jars, the direct and transitive ones, and your bean starts cleanly and there are no errors.</p> 
                <p> But your component is just not available. It seems to defy logic.</p> 
                <p> So, here's the skinny... Any time your component has an @Reference with default binding, you are basically telling OSGi that your component just has to have the reference injected or else it cannot be used.</p> 
                <p> That's where this comes from - you basically have an unsatisfied reference to some object that was supposed to be @Reference injected but could not be found; since the reference is missing, your component cannot start and it is therefore not available.</p> 
                <p> There's actually a bunch of different ways that this scenario can happen:</p> 
                <ul> 
                 <li> The @Reference refers to an object from another module that was not deployed or has not started (perhaps because of normal unresolved references). This is quite common if you deploy your Service Builder API module but forget to deploy the service module.</li> 
                 <li> You have built in circular references (more below).</li> 
                 <li> You use a target filter for the @Reference that is too narrow or incorrect, such that suitable candidates cannot be used.</li> 
                </ul> 
                <p> In all of these cases you'll be stuck with a clean component, just one that cannot activate because of unsatisfied references.</p> 
                <h2> Sewing (@Reference) Circles</h2> 
                <p> Reference circles are real pains to resolve but they rise out of your own code. Understanding reference circles is probably best started through an example.</p> 
                <p> Let's say we are building a school planning system. We focus on two major classes, a ClassroomManager and an InstructorManager. The ClassroomManager has visibility on all classrooms and is aware of the schedule and availability. The InstructorManager has the instructor roll and is aware of their schedule and availability.</p> 
                <p> It would be quite natural for a ClassroomManager to use an InstructorManager to perhaps find an available instructor to substitute in a class. Likewise it would be natural for an InstructorManager to need a ClassroomManager to try to reschedule a class to another time in an available room.</p> 
                <p> So you might find yourself creating the following classes:</p> 
                <pre>
@Component
public class ClassroomManager {

  @Reference
  private InstructorManager instructorManager;
}

@Component
public class InstructorManager {

  @Reference
  private ClassroomManager classroomManager;
}</pre> 
                <p> If you look at this code, it seems quite logical. &nbsp;Each class has a need for another component, so it has been @Reference injected. Should be fine, right?</p> 
                <p> Well actually this code has a problem - there's a circular reference.</p> 
                <p> When OSGi is processing the ClassroomManager class, it knows that the class cannot activate unless there's an available, activated InstructorManager instance to inject. Which there isn't yet, so this class cannot activate.</p> 
                <p> When OSGi is processing the InstructorManager class, it knows that the class cannot activate unless there's an available, activated ClassroomManager instance to inject. Which there isn't yet, so this class cannot activate.</p> 
                <p> But wait, you say, we just did the ClassroomManager, we should be fine! We're stuck, though, because the ClassroomManager could not activate because of the unsatisfied reference.</p> 
                <p> This is your reference circle - neither component can start because they are circularly dependent upon each other.</p> 
                <h2> Resolving Component Unsatisfied References</h2> 
                <p> Resolution is not going to be the same for every unsatisfied component reference.</p> 
                <p> If the problem is an undeployed module, resolving is as simple as deploying the missing module.</p> 
                <p> If the problem is an unstarted module, resolving is a matter of starting the module (perhaps fixing whatever problem that might be preventing it from starting in the first place).</p> 
                <p> For a reference target filter issue, well those are going to be challenging. You'll have to figure out if the target is not right or too narrow and make appropriate adjustments.</p> 
                <p> The circular reference resolutions can be resolved by refactoring code - instead of big ClassroomManager and InstructorManager classes, perhaps use a bunch of smaller classes that don't result in similar reference circles.</p> 
                <p> Another option is to use different ReferenceCardinality, ReferencePolicy and ReferencePolicyOption values (see <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-osgi-annotations-what-they-are-and-when-to-use-them">my blog post on annotations</a>, specifically the section on the @Reference annotation). You could switch both from MANDITORY to OPTIONAL ReferenceCardinalities, DYNAMIC for the ReferencePolicy, ... &nbsp;The right set is usually mandated by what the code can handle and requires, but the outcome would allow the components to activate without the initial references being satisfied, but once activated the references will be post-injected.</p> 
                <h2> How Do You Fix What You Can't Find?</h2> 
                <p> This, for me, has been kind of a challenge. Of course the answer lies within one of the Gogo shell commands, but I've always found it hard to separate the wheat (the components with unsatisfied references) from the chaff (the full output with all component status details from the bundle).</p> 
                <p> For me, I've found it easiest to use <a href="https://web.liferay.com/marketplace/-/mp/application/87693826">TripWire CE</a> or <a href="https://web.liferay.com/marketplace/-/mp/application/87618369">TripWire DXP</a>. After going to the TripWire panel in the control panel, click on the Take Snapshot card and you can actually drill into and view all unsatisfied references. &nbsp;The following screen capture is an actual view I used to resolve an unsatisfied reference issue:</p> 
                <p> <img alt="" src="/documents/26528/90730915/UnresolvedRefs.png/aefadba5-6e64-448c-b9d6-9b8d9de6236f?t=1497587696015" style="width: 863.0px;height: 749.0px;"></p> 
                <p> The issue I was looking at was the first unsatisfied reference line for my com.liferay.metrics.health.portal.layouts.LayoutHealthCheck component. It just wouldn't activate and I didn't know why; I knew it wasn't available, it wasn't doing its thing, but the module was successfully started so what could the problem be?</p> 
                <p> Well the value for the key spells it out - I have two unsatisfied references for two different gauge instances. And you know what? it is totally true. Those two missing references happen to be the 2nd and 3rd lines in the list above, and they in turn had unsatisfied references that needed to be resolved, ...</p> 
                <h2> Conclusion</h2> 
                <p> The point here is that in order to resolve unsatisfied references, you need to be able to identify them. Once you can identify the problem, you can resolve them and move on.</p> 
                <p> For me, I've found it easiest to use&nbsp;<a href="https://web.liferay.com/marketplace/-/mp/application/87693826">TripWire CE</a>&nbsp;or&nbsp;<a href="https://web.liferay.com/marketplace/-/mp/application/87618369">TripWire DXP</a>&nbsp;to identify the unsatisfied references, it does so quickly, easily, and doesn't require memorizing Gogo shell commands to get it done.</p> 
                <p> &nbsp;</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/resolving-missing-components"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="puzj_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Resolving Missing Components" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/resolving-missing-components" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/resolving-missing-components" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/resolving-missing-components" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/resolving-missing-components?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">0 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/securing-the-api-jsonws-ui?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Securing The /api/jsonws UI</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> June 12, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> The one thing I never understood was why the UI behind the /api/jsonws is publicly viewable.</p> 
                <p> I mean, there's lots of arguments for it to be secured:</p> 
                <ul> 
                 <li> Exposing all of your web service APIs exposes attack vectors to hackers. Security by obscurity is often one of the best and easiest form of security that you can have<sup>1</sup>.</li> 
                 <li> Just because users may have permission to do something, that doesn't mean you want them to. They might not be able to get to a portlet to delete some web content or document, but if they can get to /api/jsonws and know anything about Liferay web services and parameters, they might have fun trying to do it.</li> 
                 <li> It really isn't something that non-developers should ever be looking at.</li> 
                </ul> 
                <p> I'm sorry, but I've tried really hard and I can't think of a single use case where making the UI publicly available is a good thing. I guess there might be one, but at this point it seems like it should just be an edge case and not a primary design requirement.</p> 
                <p> A client recently asked about how to secure the UI, and although I had wondered why it wasn't secured, I decided it was time for me to figure out how to do it.</p> 
                <h2> The UI Implementation</h2> 
                <p> It was actually a heck of a lot easier than what I thought it was going to be.</p> 
                <p> I had in my head some sort of complicated machinery that was aware of all locally deployed remote services and perhaps was leveraging reflection and stuff to expose methods and parameters and ...</p> 
                <p> But it wasn't that complicated at all.</p> 
                <p> The UI is implemented as a basic JSP-based servlet. Whether in Liferay 6.2 or Liferay 7 CE or Liferay DXP, there are core JSPs in /html/portal/api/jsonws that implement the complete UI servlet code.</p> 
                <p> For incoming remote web service calls, the portal will look at the request URI - if it is targeting a specific remote service, the request is handed off to the service for handling. However, if it is just /api/jsonws, the portal passes the request to the /html/portal/api/jsonws/index.jsp page for presentation.</p> 
                <h2> Securing the UI</h2> 
                <p> All I'm going to do is tweak the JSP to make sure the current user is an OmniAdmin if they get to see the UI. Nothing fancy, I admit, but it gets the job done. If you have more complicated requirements, you're free to use this blog as a guide but you're on your own for implementing them.</p> 
                <p> My JSP change is basically going to be wrapping the content area to require OmniAdmin to view the content, otherwise you will see a permission failure. Here's what I came up with:</p> 
                <pre>
&lt;div id="content"&gt;
	<span style="color: rgb(238,130,238);"><strong>&lt;%-- Wrap content in a permission check --%&gt; &lt;c:if test="&lt;%= permissionChecker.isOmniadmin() %&gt;"&gt;</strong></span>
		&lt;div id="main-content"&gt;
			&lt;aui:row&gt;
				&lt;aui:col cssClass="lfr-api-navigation" width="&lt;%= 30 %&gt;"&gt;
					&lt;liferay-util:include page="/html/portal/api/jsonws/actions.jsp" /&gt;
				&lt;/aui:col&gt;

				&lt;aui:col cssClass="lfr-api-details" width="&lt;%= 70 %&gt;"&gt;
					&lt;liferay-util:include page="/html/portal/api/jsonws/action.jsp" /&gt;
				&lt;/aui:col&gt;
			&lt;/aui:row&gt;
		&lt;/div&gt;
	<span style="color: rgb(238,130,238);"><strong>&lt;/c:if&gt; &lt;c:if test="&lt;%= !permissionChecker.isOmniadmin() %&gt;"&gt; &lt;liferay-ui:message key="you-do-not-have-permission-to-view-this-page" /&gt; &lt;/c:if&gt;</strong></span>
&lt;/div&gt;
</pre> 
                <p> This code I took mostly from the DXP version of the file, so use the file from the version of Liferay you have so you don't introduce some sort of source issue. I've highlighted the real code that I added so you can work it into your override.</p> 
                <h2> Creating the Project</h2> 
                <p> So regardless of version, we're going to be doing a JSP hook, they just get implemented a little differently.</p> 
                <p> For Liferay 6.2, it is just a JSP hook. Build a JSP hook and pull in the original /html/portal/api/jsonws/index.jsp file and edit in the change outlined above. I'm not going to get into details for building a 6.2 JSP hook, those have been rehashed a number of times now, so there's no reason for me to rehash it again. Just build your JSP hook and deploy it and you should be fine.</p> 
                <p> For Liferay 7 CE, well let me just say that what I'm about to cover for DXP is how you will be doing it once GA4 is released. &nbsp;Until then, the path I'm using below won't be available to you.</p> 
                <p> For Liferay DXP (and CE GA4+), we'll follow the instructions from <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/overriding-core-jsps">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/overriding-core-jsps</a>&nbsp;to override the core JSPs using an OSGi module.</p> 
                <p> So first I created a new workspace using the command "blade init api-jsonws-override".</p> 
                <p> Then I entered the api-jsonws-override/modules directory and created my new module using the command "blade create -t service -p com.liferay.portal.jsonwebservice.override api-jsonws-override".</p> 
                <p> I don't like building code myself, so the first thing I did was add a dependency to a module which has a base implementation of the CustomJspBag in my build.gradle file:</p> 
                <pre>
dependencies {
    compileOnly group: "com.liferay.portal", name: "com.liferay.portal.impl", version: "2.0.0"
    compileOnly group: "com.liferay.portal", name: "com.liferay.portal.kernel", version: "2.6.0"
    compileOnly group: "com.liferay", name: "com.liferay.portal.custom.jsp.bag", version: "1.0.0"
    compileOnly group: "org.osgi", name: "org.osgi.core", version: "5.0.0"
    compileOnly group: "org.osgi", name: "org.osgi.service.component.annotations", version: "1.3.0"
}
</pre> 
                <p> It's actually that com.liferay.portal.custom.jsp.bag guy which makes my project not work for Liferay 7 CE, it's not available in GA3 but I expect it to be released with GA4. If you don't want to wait for GA4, you can of course not extend the BaseCustomJspBag class like I'm about to and can build out the complete CustomJspBag interface in your class.</p> 
                <div class="portlet-msg-info">
                  NOTE: I really, really dislike the fact that I have to pull in the com.liferay.portal.impl dependency above. I have to do that because for some reason the CustomJspBag interface is only in the portal-impl project and not portal-kernel as we would normally expect.
                </div> 
                <div class="portlet-msg-error">
                  Do not import this dependency yourself unless you are really, really, really sure that you gotta have it. 95% of the time you're actually going to be wrong, so if you think you need it you really have to question whether that is true or whether you're perhaps missing something.
                </div> 
                <p> Since I have the module with the base class, I can now write my JsonWsCustomJspBag class:</p> 
                <pre>
package com.liferay.portal.jsonwebservice.override;

import com.liferay.portal.custom.jsp.bag.BaseCustomJspBag;
import com.liferay.portal.deploy.hot.CustomJspBag;
import org.osgi.framework.BundleContext;
import org.osgi.service.component.annotations.Activate;
import org.osgi.service.component.annotations.Component;

/**
 * class JsonWsCustomJspBag: This is the custom jsp bag used to replace the core JSP files for the jsonws UI.
 *
 * @author dnebinger
 */
@Component(
	immediate = true,
	property = {
		"context.id=JsonWsCustomJspBag",
		"context.name=/api/jsonws Permissioning Custom JSP Bag",
		"service.ranking:Integer=20"
	}
)
public class JsonWsCustomJspBag extends BaseCustomJspBag implements CustomJspBag {

	@Activate
	protected void activate(BundleContext bundleContext) {
		super.activate(bundleContext);
	
		// we also want to include the jspf files in the list
		Enumeration enumeration = bundleContext.getBundle().findEntries(
			getCustomJspDir(), "*.jspf", true);
	
		while (enumeration.hasMoreElements()) {
			URL url = enumeration.nextElement();
	
			getCustomJsps().add(url.getPath());
		}
	}
}
</pre> 
                <p> Pretty darn simple, huh? That's because I could leverage the BaseCustomJspBag class. Without that, you need to implement the CustomJspBag interface and that makes this code a lot bigger. You'll find help for implementing the complete interface from&nbsp;<a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/overriding-core-jsps">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/overriding-core-jsps</a>.</p> 
                <p> Don't forget your override file in src/main/resources/META-INF/resources/custom_jsps/html/portal/api/jsonws/index.jsp file with the override code as discussed previously.</p> 
                <h2> Conclusion</h2> 
                <p> That's it. Build and deploy your new module and you can hit the page as a guest and you'll get the permission message. Hit the page as a non-OmniAdmin user and you get the same. Navigate there as the OmniAdmin and you see the UI so you can browse the services, try them out, etc. as though nothing changed.</p> 
                <p> I'm making the project available in GitHub:&nbsp;https://github.com/dnebing/api-jsonws-override</p> 
                <p> &nbsp;</p> 
                <p> &nbsp;</p> 
                <p> <sup>1</sup> A friend of mine called me out on the "security by obscurity" statement and thought that I was advocating for only this type of security. &nbsp;<strong>Security by obscurity should never, ever be your only barrier to prevent folks with malicious intent from hacking your site</strong>. I do see it as a first line of defense, one that can keep script kiddies or inexperienced hackers from discovering your remote APIs. But you should always be checking permissions, securing access, monitoring for intrusions, etc.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/securing-the-api-jsonws-ui"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="tbua_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Securing The /api/jsonws UI" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/securing-the-api-jsonws-ui" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/securing-the-api-jsonws-ui" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/securing-the-api-jsonws-ui" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/securing-the-api-jsonws-ui?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">1 Comment</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/servicebuilder-and-upgrade-processes?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">ServiceBuilder and Upgrade Processes</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> May 17, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <h2> Introduction</h2> 
                <p> Today I ran into someone having issues with ServiceBuilder and the creation of UpgradeProcess implementations. The doco is a little bit confusing, so I thought I'd do a quick blog post sharing how the pieces fit...</p> 
                <h2> Normal UpgradeProcess Implementations</h2> 
                <p> As a reminder, you register UpgradeProcess implementations to support upgrading from, say, 1.0.0 to 2.0.0, when there are things that you need to code to ensure when the upgrade is complete that the system is ready to use your module. Say, for example, that you're storing XML in a column in the DB and in 2.0.0 you've changed the DTD; for those folks that already have 1.0.0 deployed, your UpgradeProcess implementation would be responsible for processing each existing record in the database to change the contents over to the 2.0.0 version of the DTD. For non-ServiceBuilder modules, it is up to you to write the initial UpgradeProcess code for the 0.0.0 -&gt; 1.0.0 version.</p> 
                <p> Through the lifespan of your plugin, you continue to add in UpgradeProcess implementations to handle the automatic update for dot releases and major releases. The best part is that you don't have to care what version everyone is using, Liferay will apply the right upgrade processes to take the users from what version they're currently at all the way through to the latest version.</p> 
                <p> This is all good, of course, but ServiceBuilder, well it behaves a little differently.</p> 
                <h2> ServiceBuilder service.xml Development</h2> 
                <p> As you go through development and you change the entities in service.xml and rebuild services, ServiceBuilder will update the SQL files used to create the tables, indices, etc. When you deploy the service the first time, ServiceBuilder will happily identify the initial deployment and will use the SQL files to create the entities.</p> 
                <p> This is where things can go sideways... If I deploy version 1.0.0 of the service and version 2.0.0 comes out, the service developer needs to implement an UpgradeProcess that makes the necessary changes to the tables to get things ready for the current version of the service. If you did not deploy version 1.0.0 but are starting out on 2.0.0, you don't want to have to execute all of the upgrade processes individually, you want ServiceBuilder to do what it has always done and just use the SQL files to create the version 2.0.0 of the entities.</p> 
                <p> So how do you support both of these scenarios correctly?</p> 
                <p> By using the <strong>Liferay-Require-SchemaVersion</strong> header¹ in your bnd.bnd file, that's how.</p> 
                <h2> Supporting Both ServiceBuilder Upgrade Scenarios</h2> 
                <div>
                  The Liferay-Require-SchemaVersion header defines the current DB schema version number for your service modules. This version number should be incremented as you change your service.xml in preparation for a release.
                </div> 
                <p> There's code in the ServiceBuilder deployment which injects a hidden UpgradeProcess implementation that is defined to cover the "0.0.0" version (the version which represents the "new deployment") to the Liferay-Require-SchemaVersion version number. &nbsp;So your first release will have the header set to 1.0.0, next release might be 2.0.0, etc.</p> 
                <p> So in our previous example with the 2.0.0 service release, when you deploy the service Liferay will match the "0.0.0" to "2.0.0" hidden upgrade process implementation provided by ServiceBuilder and will invoke it to get the 2.0.0 version of the tables, indices, etc. created for you using the SQL files.</p> 
                <p> The service developer must also code and register the manual UpgradeProcess instances that support the incremental upgrade. So for the example, there would need to be a 1.0.0 -&gt; 2.0.0 UpgradeProcess implementation so when I deploy 2.0.0 to replace my 1.0.0 deployment, the UpgradeProcess will be used to modify my DB schema to get it up to version 2.0.0.</p> 
                <h2> Conclusion</h2> 
                <p> As long as you properly manage both the <strong>Liferay-Require-SchemaVersion</strong> header in the bnd.bnd file and provide your corresponding UpgradeProcess implementations, you will be able to easily handle the first time deployment as well as the upgrade deployments.</p> 
                <p> An important side effect to note here - you must manage your <strong>Liferay-Require-SchemaVersion</strong> correctly. &nbsp;If you set it initially to 1.0.0 and forget to update it on future releases, your users will have all kinds of issues. &nbsp;For initial deployments, the SQL scripts would create the entities using the latest SQL files and then try to apply UpgradeProcess implementations to get to new versions trying to make modifications they really don't have to worry about. For upgrade deployments, Liferay may not process upgrades because it believes the schema is already at the appropriate version.</p> 
                <p> ¹ <em><span style="font-size: 11.0px;">If the Liferay-Require-SchemaVersion header is missing, the value for the Bundle-Version will be used instead.</span></em></p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/servicebuilder-and-upgrade-processes"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="yewc_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="ServiceBuilder and Upgrade Processes" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/servicebuilder-and-upgrade-processes" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/servicebuilder-and-upgrade-processes" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/servicebuilder-and-upgrade-processes" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/servicebuilder-and-upgrade-processes?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">2 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/increasing-capacity-and-decreasing-response-times-using-a-tool-you-re-probably-not-familiar-with?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Increasing Capacity and Decreasing Response Times Using a Tool You're Probably Not Familiar With</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> May 7, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <h1> Introduction</h1> 
                <p> When it comes to Liferay performance tuning, there is one golden rule:</p> 
                <div class="portlet-msg-info" style="margin-left: 40.0px;">
                  The more you offload from the application server, the better your performance will be.
                </div> 
                <p> This applies to all aspects of Liferay. Using Solr/Elastic is always better than using the embedded Lucene. While PDFBox works, you get better performance by offloading that work to ImageMagick and GhostScript.</p> 
                <p> You can get even better results by offloading work before it gets to the application server. What I'm talking about here is caching, and one tool I like to recommend for this is <a href="https://varnish-cache.org/">Varnish</a>.</p> 
                <p> According to the Varnish site:</p> 
                <p style="margin-left: 40.0px;"> <cite>Varnish Cache is a web application accelerator also known as a caching HTTP reverse proxy. You install it in front of any server that speaks HTTP and configure it to cache the contents. Varnish Cache is really, really fast. It typically speeds up delivery with a factor of 300 - 1000x, depending on your architecture.</cite></p> 
                <p> So I've found the last claim to be a little extreme, but I can say for certain that it can offer significant performance improvement.</p> 
                <p> Basically Varnish is a caching appliance. &nbsp;When an incoming request hits Varnish, it will look at in it's cache to see if it has been rendered before. If it isn't in the cache, it will pass the request to the back end and store the response (if possible) in the cache before returning the response to the original requestor. &nbsp;As additional matching requests come in, Varnish will be able to serve the response from the cache instead of sending it to the back end for processing.</p> 
                <p> So there are two requirements that need to be met to get value out of the tool:</p> 
                <ol> 
                 <li> The responses have to be cacheable.</li> 
                 <li> The responses must take time for the backend to generate.</li> 
                </ol> 
                <p> As it turns out for Liferay, both of these are true.</p> 
                <p> So Liferay can actually benefit from Varnish, but we can't just make such a claim, we'll need to back it up w/ some testing.</p> 
                <h1> The Setup</h1> 
                <p> To complete the test I set up an Ubuntu VirtualBox instance w/ 12G of memory and 4 processors, and I pulled in a Liferay DXP FP 15 bundle (no performance tuning for JVM params, etc). I also compiled Varnish 4.1.6 on the system. For both tests, Tomcat will be running using 8G and Varnish will also be running w/ an allocation of 2G (even though varnish is not used for the Tomcat test, I think it is "fairer" to keep the tests as similar as possible).</p> 
                <p> In the DXP environment I'm using the embedded ElasticSearch and HSQL for the database (not a prod configuration but both tests will have the same bad baseline). I deployed the free <a href="https://web.liferay.com/marketplace/-/mp/application/81920471">Porygon theme from the Liferay Marketplace</a> and set up a site based on the theme. The home page for the Porygon demo site has a lot of graphics and stuff on it, so it's a really good site to look at from a general perspective.</p> 
                <p> The idea here was not to focus on Liferay tuning too much, to get a site up that was serving a bunch of mixed content. Then we measure a non-Varnish configuration against a Varnish config to see what impact Varnish can have in performance terms.</p> 
                <p> We're going to test the configuration using JMeter and we're going to hit the main page of the Porygon demo site.</p> 
                <h1> Testing And Results</h1> 
                <p> JMeter was configured to use 100 users and loop for 20 times. &nbsp;Each test would touch on the home page, the photography, science and review pages and would also visit 3 article pages. JMeter was configured to retrieve all related assets synchronously to exagerate the response time from the services.</p> 
                <h2> Response Times</h2> 
                <p> Let's dive right in with the response times for the test from the non-Varnish configuration:</p> 
                <p> <img alt="Response Times Without Varnish" src="/documents/26528/89163491/resp-wo-v.png/34c7344c-adf4-4e57-808d-ae8528bc1987?t=1494511747196" style="width: 1000.0px;height: 588.0px;"></p> 
                <p> The runtime for this test was 21 minutes, 20 seconds. The 3 article pages are the lines near the bottom of the graph, the lines in the middle are for the general pages w/ the asset publishers and all of the extra details.</p> 
                <p> Next graph is the response times from the Varnish configuration:</p> 
                <p> <img alt="Response Times With Varnish" src="/documents/26528/89163491/resp-w-v-size.png/82642aec-35aa-4269-8afe-1aba59738f3b?t=1494511796231" style="width: 1000.0px;height: 586.0px;"></p> 
                <p> The runtime for this test was 11 minutes, 58 seconds, a 44% reduction in test time, and it's easy to see that while the non-Varnish tests seem to float around the 14 second mark, the Varnish tests come in around 6 seconds.</p> 
                <p> If we rework the graph to adjust the y-axis to remove the extra whitespace we see:</p> 
                <p> <img alt="Response Times With Varnish" src="/documents/26528/89163491/resp-w-v-2.png/12d350c8-57ae-40fe-9bad-ba3cb8ca726e?t=1494512665107" style="width: 1000.0px;height: 585.0px;"></p> 
                <p> The important part here for me was the lines for the individual articles. In the non-Varnish test,&nbsp;<em>/web/porygon-demo/-/space-the-final-frontier?inheritRedirect=true&amp;redirect=%2Fweb%2Fporygon-demo</em> shows up around the 1 second response time, but with varnish it hovers at the 3 second response time. &nbsp;Keep that in mind when we discuss the custom VCL below.</p> 
                <h2> Aggregate Response Times</h2> 
                <p> Let's review the aggregate graphs from the tests. &nbsp;First the non-Varnish graph:</p> 
                <p> <img alt="Aggregate Without Varnish" src="/documents/26528/89163491/agg-wo-v.png/113a546e-1a5c-468a-be99-d562e8fca0c4?t=1494511779129" style="width: 1000.0px;height: 476.0px;"></p> 
                <p> This reflects what we've seen before; individual pages are served fairly quickly, pages w/ all of the mixed content take significantly longer to load.</p> 
                <p> And the graph for the Varnish tests:</p> 
                <p> <img alt="Aggregate With Varnish" src="/documents/26528/89163491/agg-w-v-size.png/41aa849e-2b91-4f82-bbe9-47524c81341d?t=1494511788840" style="width: 1000.0px;height: 473.0px;"></p> 
                <p> At the same scale, it is easy to see that Varnish has greatly reduced the response times. &nbsp;Adjusting the y-axis, we get the following:</p> 
                <p> <img alt="Aggregate With Varnish" src="/documents/26528/89163491/agg-w-v-low.png/84b1b383-36e1-456b-9cab-0a8cc30d5881?t=1494511763754" style="width: 1000.0px;height: 474.0px;"></p> 
                <h1> Analysis</h1> 
                <p> So there's a few parts that quickly jump out:</p> 
                <ul> 
                 <li> There was a 44% reduction in test runtime reflected by decreased response times.</li> 
                 <li> There was a measurable (but unmeasured) reduction in server CPU load since Liferay/Tomcat did not have to serve all traffic.</li> 
                 <li> Since work is offloaded from Liferay/Tomcat, overall capacity is increased.</li> 
                 <li> While some response times were greatly improved by using Varnish, others suffered.</li> 
                </ul> 
                <p> The first three bullets are easy to explain. &nbsp;As Varnish is able to cache "static" responses from Liferay/Tomcat, it can serve those responses from the cache instead of forcing Liferay/Tomcat to build a fresh response every time. &nbsp;Having Liferay/Tomcat rebuild responses each time requires CPU cycles, so returning a cached response reduces the CPU load. &nbsp;And since Liferay/Tomcat is not busy rebuilding the responses that now come from the cache, Liferay/Tomcat is free to handle responses that cannot be cached; basically the overall capacity of Liferay/Tomcat is increased.</p> 
                <p> So you might be asking that, since Varnish is so great, why do the single article pages suffer from a response time degradation? Well, that is due to the custom VCL script used to control the caching.</p> 
                <h1> The Varnish VCL</h1> 
                <p> So if you don't know about Varnish, you may not be aware that caching is controlled by a VCL (Varnish Configuration Language) file. This file is closer to a script than it is a configuration file.</p> 
                <p> Normally Varnish operates by checking the backend response cache control headers; if a response can be cached, it will be, and if the response cannot be cached it won't. The impact of Varnish is directly related to how many of the backend responses can be cached.</p> 
                <p> You don't have to rely solely on the cache control headers from the backend to determine cacheability; this is especially true for Liferay. Through the VCL, you can actually override the cache control headers and make some responses cachable that otherwise would not have been and make other responses uncacheable even when the backend says it is acceptable.</p> 
                <p> So now I want to share the VCL script used for the test, but I'll break it up into parts to discuss the reasons for the choices that I made. The whole script file will be attached to the blog for you to download.</p> 
                <p> In the sections below comments have been removed to save space, but in the full file the comments are embedded to explain everything in detail.</p> 
                <h2> Varnish Initialization</h2> 
                <pre>
probe company_logo {
  .request =
    "GET /image/company_logo HTTP/1.1"
    "Host: 192.168.1.46:8080"
    "Connection: close";
  .timeout = 100ms;
  .interval = 5s;
  .window = 5;
  .threshold = 3;
}

backend LIFERAY {
  .host = "192.168.1.46";
  .port = "8080";
  .probe = company_logo;
}

sub vcl_init {
  new dir = directors.round_robin();
  dir.add_backend(LIFERAY);
}
</pre> 
                <p> So in Varnish you need to declare your backends to connect to. &nbsp;In this example I've also defined a probe request used to verify health of the backend. &nbsp;For probes it is recommended to use a simple request that results in a small response; you don't want to overload the system with all of the probe requests.</p> 
                <h2> Varnish Request</h2> 
                <pre>
sub vcl_recv {
  ...
  if (req.url ~ "^/c/") {
    return (pass);
  }

  if (req.url ~ "/control_panel/manage") {
    return (pass);
  }
  ...
  if (req.url !~ "\?") {
    return (pass);
  }
  ...
}
</pre> 
                <p> The request handling basically determines whether to hash (lookup request from the cache) or pass (pass request directly to backend w/o caching).</p> 
                <p> For all requests that start with the "/c/..." URI, we pass those to the backend. &nbsp;They represent request for /c/portal/login or /c/portal/logout and the like, so we never want to cache those regardless of what the backend might say.</p> 
                <p> Also any control panel requests are also passed directly to the backend. We wouldn't want to accidentally expose any of our configuration details now would we?&nbsp;<img alt="cheeky" height="20" src="https://web.liferay.com/html/js/editor/ckeditor/plugins/smiley/images/tounge_smile.gif" title="cheeky" width="20"></p> 
                <p> Otherwise the code is trying to force hashing of binary files (mp3, image, etc) if possible and conforms to most average VCL implementations.</p> 
                <p> The last check of whether the URL contains a '?' character, well I'll be getting to that later in the conclusion...</p> 
                <h2> Varnish Response</h2> 
                <pre>
sub vcl_backend_response {

  if (bereq.url ~ "^/c/") {
    return (deliver);
  }
  
  if ( bereq.url ~ "\.(ico|css)(\?[a-z0-9=]+)?$") {
    set beresp.ttl = 1d;
  } else if (bereq.url ~ "^/documents/" &amp;&amp; beresp.http.content-type ~ "image/*") {
    if (std.integer(beresp.http.Content-Length,0) &lt; 10485760 ) {
      if (beresp.status == 200) {
        set beresp.ttl = 1d;
        unset beresp.http.Cache-Control;
        unset beresp.http.set-cookie;
      }
    }
  } else if (beresp.http.content-type ~ "text/javascript|text/css") {
    if (std.integer(beresp.http.Content-Length,0) &lt; 10485760 ) {
      if (beresp.status == 200) {
        set beresp.ttl = 1d;
      }
    }
  }
  ...
}
</pre> 
                <p> The response handling also passes the /c/ type URIs back to the client w/o caching.</p> 
                <p> The most interesting part of this section is the testing for content type and altering caching as a result. &nbsp;Normally VCL rules will look for some request for "/blah/blah/blah/my-javascript.js" by checking for the extension as part of the URI.</p> 
                <p> But Liferay really doesn't use these standard extensions. &nbsp;For example, with Liferay you'll see a lot of requests like <em>/combo/?browserId=other&amp;minifierType=&amp;languageId=en_US&amp;b=7010&amp;t=1494083187246&amp;/o/frontend-js-web/liferay/portlet_url.js&amp;...</em>. These kinds of requests do not have the standard extension on it so normal VCL matching patterns would discard this request as uncacheable. Using the VCL override logic above, the request will be treated as cacheable since it is just a request for some JS.</p> 
                <p> Same kind of logic applies to the /documents/ URI prefix; anything w/ this prefix is a fetch from the document library. &nbsp;Full URIs are similar to&nbsp;<em>/documents/24848/0/content_16.jpg/027082f1-a880-4eb7-0938-c9fe99cefc1a?t=1474371003732</em>. &nbsp;Again since it doesn't end w/ the standard extension, the image might not be cached. The override rule above will match on all /documents/ prefix and content types of images and treat the request as cacheable.</p> 
                <h1> Conclusion</h1> 
                <p> So let's start with the easy ones...</p> 
                <ul> 
                 <li> Adding Varnish can decrease your response times.</li> 
                 <li> Adding Varnish can reduce your server load.</li> 
                 <li> Adding Varnish can increase your overall capacity.</li> 
                </ul> 
                <p> Honestly I was expecting that to be the whole list of conclusions I was going to have to worry about. I had this sweet VCL script and performance times were just awesome. As a final test, I tried logging into my site with Varnish in place and, well, FAIL. &nbsp;I could log in, but I didn't get the top bar or access to the left or right sidebars or any of these things.</p> 
                <p> I realized that I was actually caching the response from the friendly URLs and, well, for Liferay those are typically dynamic pages. &nbsp;There is logic specifically in the theme template files that change the content depending upon whether you are logged in or not. &nbsp;Because my Varnish script was caching the pages when I was not logged in, after I logged in the page was coming from the cache and the necessary stuff I needed was now gone.</p> 
                <p> I had to add the check for the "?" character in the requests to determine if it was a friendly URL or not. &nbsp;If it was a friendly URL, I had to treat those as dynamic and had to send them to the backend for processing.</p> 
                <p> This leads to the poor performance, for example, on the single article display pages. &nbsp;My first VCL was great, but it cached too much. &nbsp;My addition for friendly URLs solved the login issue but now prevented caching pages that maybe could be pages so I swung too far again, but since the general results were still awesome I just went with what I had.</p> 
                <p> Now for the hard conclusions...</p> 
                <ul> 
                 <li> Adding Varnish requires you to know your portal.</li> 
                 <li> Adding Varnish requires you to know your use cases.</li> 
                 <li> Adding Varnish requires you to test all aspects of your portal.</li> 
                 <li> Adding Varnish requires you to learn how to write VCL.</li> 
                </ul> 
                <p> The VCL really isn't that hard to wrap your head around. &nbsp;Once you get familiar with it, you'll be able to customize the rules to increase your cacheability factor without sacraficing the dynamic nature of your portal. &nbsp;In the attached VCL, we add a response header for a cache HIT or MISS, and this is quite useful for reviewing the responses from Varnish to see if a particular response was cached or not (remember the first request will always be a MISS, so check again after a page refresh).</p> 
                <p> I can't emphasize the testing enough though. &nbsp;You want to manually test all of your pages a couple of times, logged in and not logged in, logged in as users w/ different roles, etc., to make sure each UX is correct and that you're not bleeding views that should not be shared.</p> 
                <p> You should also do your load testing. &nbsp;Make sure you're getting something out of Varnish and that it is worthwhile for your particular situation.</p> 
                <h2> Note About SSL</h2> 
                <p> Before I forget, it's important to know that Varnish doesn't really talk SSL, nor does it talk AJP. &nbsp;If you're using SSL, you're going to want to have a web server sitting in front of Varnish to handle SSL termination.</p> 
                <p> And Varnish doesn't talk AJP, so you will have to configure for HTTP connections from both the web server and the app server.</p> 
                <p> This points toward the reasoning behind my recent blog post about configuring Liferay to look at a header for the HTTP/HTTPS protocols. &nbsp;In my environ I was terminating SSL at Apache and needed to use the HTTP connectors to Varnish and again to Tomcat/Liferay.</p> 
                <p> Although it was suggested in a few of the comments that separate connections could be used to facilitate the HTTP and HTTPS traffic, etc., those options would defeat some of the Varnish caching capabilities. You'd either have separate caches for each connection type (or perhaps no cache on one of them) or other unforseen issues. Being able to route all traffic through a single pipe to Varnish will ensure Varnish can cache the response regardless of the incoming protocol.</p> 
                <h2> Update - 05/16/2017</h2> 
                <p> Small tweak to the VCL script attached to the blog, I added rules to exclude all URLs from /api/* from being cached. &nbsp;Those are basically your web service calls and rarely would you really want to cache those details. &nbsp;Find the file named localhost-2.vcl for the update.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/increasing-capacity-and-decreasing-response-times-using-a-tool-you-re-probably-not-familiar-with"> </p> 
                <div class="entry-links"> 
                 <div class="taglib-asset-links"> 
                  <h2 class="asset-links-title">Related Assets:</h2> 
                  <ul class="asset-links-list"> 
                   <li class="asset-links-list-item"> <span> <a class="taglib-icon" href="https://web.liferay.com/c/document_library/find_file_entry?p_l_id=50657388&amp;noSuchEntryRedirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_auth%3DcUaC4Us6%26p_p_id%3D101%26p_p_lifecycle%3D0%26p_p_state%3Dmaximized%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1%26_101_struts_action%3D%252Fasset_publisher%252Fview_content%26_101_assetEntryId%3D89331745%26_101_type%3Ddocument%26redirect%3D%252Fweb%252Fuser.26526%252Fblog%253Fp_p_id%253D58%2526p_p_lifecycle%253D0%2526p_p_state%253Dnormal%2526p_p_state_rcv%253D1%2526_58_struts_action%253D%2525252Flogin%2525252Flogin&amp;fileEntryId=89331742" id="_33_rjus"> <img class="icon" src="https://web.liferay.com/osb-community-theme/images/spacer.png" alt="" style="background-image: url('https://web.liferay.com/osb-community-theme/sprite/images/file_system/small/_sprite.png'); background-position: 50% -256px; background-repeat: no-repeat; height: 16px; width: 16px;"> <span class="taglib-text">localhost.vcl</span> </a> </span> </li> 
                   <li class="asset-links-list-item"> <span> <a class="taglib-icon" href="https://web.liferay.com/c/document_library/find_file_entry?p_l_id=50657388&amp;noSuchEntryRedirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_auth%3DcUaC4Us6%26p_p_id%3D101%26p_p_lifecycle%3D0%26p_p_state%3Dmaximized%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1%26_101_struts_action%3D%252Fasset_publisher%252Fview_content%26_101_assetEntryId%3D89511243%26_101_type%3Ddocument%26redirect%3D%252Fweb%252Fuser.26526%252Fblog%253Fp_p_id%253D58%2526p_p_lifecycle%253D0%2526p_p_state%253Dnormal%2526p_p_state_rcv%253D1%2526_58_struts_action%253D%2525252Flogin%2525252Flogin&amp;fileEntryId=89511241" id="_33_ctvk"> <img class="icon" src="https://web.liferay.com/osb-community-theme/images/spacer.png" alt="" style="background-image: url('https://web.liferay.com/osb-community-theme/sprite/images/file_system/small/_sprite.png'); background-position: 50% -256px; background-repeat: no-repeat; height: 16px; width: 16px;"> <span class="taglib-text">localhost-2.vcl</span> </a> </span> </li> 
                  </ul> 
                 </div> 
                </div> 
                <div class="taglib-social-bookmarks" id="hswh_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Increasing Capacity and Decreasing Response Times Using a Tool You're Probably Not Familiar With" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/increasing-capacity-and-decreasing-response-times-using-a-tool-you-re-probably-not-familiar-with" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/increasing-capacity-and-decreasing-response-times-using-a-tool-you-re-probably-not-familiar-with" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/increasing-capacity-and-decreasing-response-times-using-a-tool-you-re-probably-not-familiar-with" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/increasing-capacity-and-decreasing-response-times-using-a-tool-you-re-probably-not-familiar-with?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">8 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/revisiting-ssl-termination-at-apache-httpd?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Revisiting SSL Termination at Apache HTTPd</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> May 5, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> So I have a blog I created a long time ago dealing w/ <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-and-ssl">Liferay and SSL</a>. The foundation of that blog post was my <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/fronting-liferay-tomcat-with-apache-httpd-daemon">Fronting Liferay Tomcat with Apache HTTPd</a>&nbsp;post and added terminating SSL at HTTPd and configuring the Liferay instance running under Tomcat to use HTTPS for all of the communication.</p> 
                <p> If you tear into the second post, you'll find that I was using the AJP connector to join HTTPd and Tomcat together.</p> 
                <p> This is actually a key aspect for a working setup for SSL + HTTPd + Liferay/Tomcat.</p> 
                <p> Today I was actually working on a similar setup that used the HTTP connector for SSL + HTTPd + Liferay/Tomcat. Unauthenticated traffic worked just fine, but as soon as you would try to access a secured resource that required authentication, a redirect loop resulted with HTTPd finally terminating the loop.</p> 
                <p> The only info I had was the redirect URL, https://example.com/c/portal/login?null. There was no log messages in Liferay/Tomcat and repeated 302 messages in the HTTPd logs.</p> 
                <p> <span style="background-color: rgb(255,255,255);">My good friend and coworker&nbsp;</span><a href="https://web.liferay.com/web/nathan.shaw/profile" style="background-color: rgb(255,255,255);">Nathan Shaw</a><span style="background-color: rgb(255,255,255);">&nbsp;told me of a case he was aware of that was similar but was from Nginx; although different web servers, the 302 redirect loop on /c/portal/login?null was an exact match.</span></p> 
                <p> The crux of the issue is the setting of the&nbsp;company.security.auth.requires.https property in portal-ext.properties.</p> 
                <p> Basically when you set this property to true, you are saying that when a user logs in, you want to force them into the secure https side. Seems pretty simple, right?</p> 
                <p> So in this configuration, when a user on http:// wants to or needs to log in, they basically end up hitting http://.../c/portal/login. This is where a check for HTTPS is done and, since the connection is not yet HTTPS will issue a redirect back to https://.../c/portal/login to complete the login.</p> 
                <p> And this, in conjunction with the HTTP connector between HTTPd and Liferay/Tomcat, is what causes the redirect loop.</p> 
                <p> Liferay responds with the 302 to try and force you to https, you submit again but SSL terminates at HTTPd and the request is sent via the HTTP connector to Liferay/Tomcat. &nbsp;Well, Liferay/Tomcat sees the request came in on http:// and again issues the 302 redirect. You're now in redirect loop hell.</p> 
                <p> Fortunately, this is absolutely fixable.</p> 
                <p> Liferay has a set of portal-ext.properties settings to mitigate the SSL issue. They are:</p> 
                <pre>
#
# Set this to true to use the property "web.server.forward.protocol.header"
# to get the protocol. The property "web.server.protocol" must not have been
# overriden.
#
web.server.forwarded.protocol.enabled=false

#
# Set the HTTP header to use to get the protocol. The property
# "web.server.forwarded.protocol.enabled" must be set to true.
#
web.server.forwarded.protocol.header=X-Forwarded-Proto
</pre> 
                <p> The important property is the first one. &nbsp;When that property is true, Liferay will ignore the protocol (http vs https) of the incoming request and will instead use a request header to see what the original protocol for the request actually was.</p> 
                <p> The header name can be specified using the second property, but the default one works just fine. It's also how you google for an answer for your particular web server.</p> 
                <p> I'll save you the trouble for Apache HTTPd; you just need to add a couple of lines to your &lt;VirtualHost /&gt; elements:</p> 
                <pre>
&lt;VirtualHost *:80&gt;
    RequestHeader set X-Forwarded-Proto "http"
    ...
&lt;/VirtualHost&gt;

&lt;VirtualHost *:443&gt;
    RequestHeader set X-Forwarded-Proto "https"
    ...
&lt;/VirtualHost&gt;
</pre> 
                <p> That's it.</p> 
                <p> For every incoming request getting to HTTPd, a header is added with the request protocol. &nbsp;When the ProxyPass configuration forwards the requests to Liferay/Tomcat, Liferay will use the header for the check on https:// rather than the actual connection from HTTPd.</p> 
                <p> Some of you are going to be asking</p> 
                <p> Why are you using the HTTP connector to joing HTTPd to Liferay/Tomcat anyway? The AJP connector is the best connector to use in this configuration because it is better performing than the HTTP connector and avoids this and other issues that can happen by using the HTTP connector.</p> 
                <p> You would be, of course, absolutely right about that. For a simple configuration like this where you only have HTTPd &lt;-&gt; Liferay/Tomcat, using the HTTP connector is frowned upon.</p> 
                <p> That said, I've got another exciting blog post in the pipeline that will force moving to this configuration... I'm not getting into any details at this point, but suffice it to say that when you see the results that I've been gathering, you too will be looking at this configuration too.</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/revisiting-ssl-termination-at-apache-httpd"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="lfqd_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Revisiting SSL Termination at Apache HTTPd" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/revisiting-ssl-termination-at-apache-httpd" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/revisiting-ssl-termination-at-apache-httpd" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/revisiting-ssl-termination-at-apache-httpd" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/revisiting-ssl-termination-at-apache-httpd?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">5 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/tomcat-hikaricp?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Tomcat+HikariCP</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> May 3, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> In case you aren't aware, Liferay 7 CE and Liferay DXP default to using <a href="http://brettwooldridge.github.io/HikariCP/">Hikari CP</a> for the connection pools.</p> 
                <p> Why? &nbsp;Well here's a pretty good reason:</p> 
                <p> <img alt="" src="https://github.com/brettwooldridge/HikariCP/wiki/HikariCP-bench-2.6.0.png"></p> 
                <p> Hikari just kicks the pants of any other connection pool implementation.</p> 
                <p> So Liferay is using <a href="http://brettwooldridge.github.io/HikariCP/">Hikari CP</a>, and you should too.</p> 
                <p> I know what you're thinking. &nbsp;It's something along the lines of:</p> 
                <p style="margin-left: 40.0px;"> <cite>But Dave, we're following the best practice of defining our DB connections as Tomcat &lt;Resource /&gt; JNDI definitions so we don't expose our database connection details (URLs, usernames or passwords) to the web applications. &nbsp;So we're stuck with the crappy Tomcat connection pool implementation.</cite></p> 
                <p> You might be thinking that, but if you are thankfully you'd be wrong.</p> 
                <h2> Installing the Hikari CP Library for Tomcat</h2> 
                <p> So this is pretty easy, but you have two basic options.</p> 
                <p> First is to download the .zip or .tar.gz file from&nbsp;<a href="http://brettwooldridge.github.io/HikariCP/">http://brettwooldridge.github.io/HikariCP/</a>. &nbsp;This is actually a source release that you'll need to build yourself.</p> 
                <p> Second option is to download the built jar from a source like Maven Central,&nbsp;<a href="http://central.maven.org/maven2/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar">http://central.maven.org/maven2/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar</a>.</p> 
                <p> Once you have the jar, copy to the Tomcat lib/ext directory. &nbsp;Note that <a href="http://brettwooldridge.github.io/HikariCP/">Hikari CP</a> does have a dependency on SLF4J, so you'll need to put that jar into lib/ext too.</p> 
                <h2> Configuring the Tomcat &lt;Resource /&gt; Definitions</h2> 
                <p> Location of your JNDI datasource &lt;Resource /&gt; definitions depends upon the scope for the connections. &nbsp;You can define them globally by specifying them in Tomcat's conf/server.xml and conf/context.xml, or you can scope them to individual applications by defining them in conf/Catalina/localhost/WebAppContext.xml (where WebAppContext is the web application context for the app, basically the directory name from Tomcat's webapps directory).</p> 
                <p> For Liferay 7 CE and Liferay DXP, all of your plugins belong to Liferay, so it is usually recommended to put your definitions in conf/Catalina/localhost/ROOT.xml. &nbsp;The only reason to make the connections global is if you have other web applications deployed to the same Tomcat container that will be using the same database connections.</p> 
                <p> So let's define a JNDI datasource in ROOT.xml for a Postgres database...</p> 
                <p> Create the file conf/Catalina/localhost/ROOT.xml if it doesn't already exist. &nbsp;If you're using a Liferay bundle, you will already have this file.</p> 
                <p> <a href="http://brettwooldridge.github.io/HikariCP/">Hikari CP</a> supports two different ways to define your actual database connections. &nbsp;The first way is the one that they prefer and it's based upon using a DataSource instance (more standard way of establishing a connection with credentials) or the older way using a DriverManager instance (legacy way that has different ways of passing credentials to the DB driver).</p> 
                <p> We'll follow their advice and use the DataSource. &nbsp;Use the table from&nbsp;<a href="https://github.com/brettwooldridge/HikariCP#popular-datasource-class-names">https://github.com/brettwooldridge/HikariCP#popular-datasource-class-names</a>&nbsp;to find your data source class name, we'll need it when we define the &lt;Resource /&gt; element.</p> 
                <p> Gather up your JDBC url, username and password because we'll need those too.</p> 
                <p> Okay, so in ROOT.xml inside of the &lt;Context /&gt; tag, we're going to add our Liferay JNDI data source connection resource:</p> 
                <pre>
&lt;Resource name="jdbc/LiferayPool" auth="Container"
      factory="com.zaxxer.hikari.HikariJNDIFactory"
      type="javax.sql.DataSource"
      minimumIdle="5" 
      maximumPoolSize="10"
      connectionTimeout="300000"
      dataSourceClassName="org.postgresql.ds.PGSimpleDataSource"
      dataSource.url="jdbc:postgresql://localhost:5432/lportal"
      dataSource.implicitCachingEnabled="true" 
      dataSource.user="user"
      dataSource.password="pwd" /&gt;
</pre> 
                <p> So this is going to define our connection for Liferay and have it use the <a href="http://brettwooldridge.github.io/HikariCP/">Hikari CP</a> pool.</p> 
                <div>
                  Now if you really want to stick with the older driver-based configuration, then you're going to use something like this:
                </div> 
                <pre>
&lt;Resource name="jdbc/LiferayPool" auth="Container"
      factory="com.zaxxer.hikari.HikariJNDIFactory"
      type="javax.sql.DataSource"
      minimumIdle="5" 
      maximumPoolSize="10"
      connectionTimeout="300000"
      driverClassName="org.postgresql.Driver"
      jdbcUrl="jdbc:postgresql://localhost:5432/lportal"
      dataSource.implicitCachingEnabled="true" 
      dataSource.user="user"
      dataSource.password="pwd" /&gt;
</pre> 
                <h2> Conclusion</h2> 
                <p> Yep, that's pretty much it. &nbsp;When you restart Tomcat you'll be using your flashy new <a href="http://brettwooldridge.github.io/HikariCP/">Hikari CP</a> connection pool.</p> 
                <p> You'll want to take a look at&nbsp;<a href="https://github.com/brettwooldridge/HikariCP#frequently-used">https://github.com/brettwooldridge/HikariCP#frequently-used</a>&nbsp;to find additional tuning parameters for your connection pool as well as the info for the minimum idle, max pool size and connection timeout details.</p> 
                <p> And remember, this is going to be your best production configuration. &nbsp;If you're using portal-ext.properties to set up any of your database connection properties, you're not as secure as you can be. &nbsp;Remember, a hacker needs information to infiltrate your system; the more details of your infrastructure you expose, the more info you give a hacker to worm their way in. &nbsp;Using the portal-ext.properties approach, you're exposing your JDBC URL (so hostname and port as well as the DB server type) and the credentials (which will work for DB login but sometimes they might also be system login credentials). &nbsp;This kind of info is worth its weight in gold to a hacker trying to infiltrate you.</p> 
                <p> So follow the recommended practice of using your JNDI references for the database connections and keep this information out of the hackers hands.</p> 
                <p> &nbsp;</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/tomcat-hikaricp"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="wofn_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Tomcat+HikariCP" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/tomcat-hikaricp" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/tomcat-hikaricp" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/tomcat-hikaricp" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/tomcat-hikaricp?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">2 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/available-now-tripwire?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Available Now: TripWire</a> </h1> 
                <p class="details"> <span class="btn-d General">General Blogs</span> March 28, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> For the last few months as I've been working with Liferay 7 CE / Liferay DXP, I've been a little stymied trying to manage the complexities of the new OSGi universe.</p> 
                <p> In Liferay 6.x, for example, an OOTB demo setup of Liferay comes with like 5 or 6 war files. &nbsp;And when the portal starts up, they all start up.</p> 
                <p> But with Liferay 7 CE and Liferay DXP, there are a lot of bundles in the mix. Liferay 7 CE GA3, for example, has almost 2,500 bundles in OSGi.</p> 
                <p> And when the portal starts up, most of these will also start. Some will not. Some might not be able to. Some can't start because they have unsatisfied dependencies.</p> 
                <p> But you're not going to know it.</p> 
                <p> Seriously, you won't know if something has failed to start when you restart your environment. There may or may not be something in the log. Someone might have stopped a bundle intentionally (or unintentionally) in the gogo shell w/o telling you. And with almost 2,500 bundles in there, it's going to be really hard finding the needle in the haystack especially if you don't know if there's a needle in there at all.</p> 
                <p> So I've been working on a new utility over the past few months to resolve the situation - TripWire.</p> 
                <p style="text-align: center;"> <img alt="" src="/documents/26528/87718400/tripwire-05.jpg/2637c232-db28-45f9-8188-2a53d95ee7f2?t=1490761965370" style="width: 1080.0px;height: 675.0px;"></p> 
                <h2> Features</h2> 
                <p> TripWire actually scans the OSGi environment to gather information about deployed bundle statuses, bundle versions, and service components. Tripwire also scans the system and portal properties too.</p> 
                <p> This scanning is done at two points, the first is when an administrator takes a snapshot (basically to persist a baseline for all comparisons), and the second is a scheduled task that runs on the node to monitor for changes. The comparison scan can also be kicked off manually.</p> 
                <p> After installing TripWire and navigating to the TripWire control panel, you'll be prompted to capture an initial baseline scan:</p> 
                <p style="text-align: center;"> <img alt="" src="/documents/26528/87718400/tripwire-01.jpg/d0c9cb15-616c-479a-9a77-3676529821f4?t=1490761997145" style="width: 1080.0px;height: 675.0px;"></p> 
                <p> Click the <strong>Take Snapshot</strong> card to see the system snapshot:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-02a.jpg/30c0ba8a-509a-4335-b09c-2813237837e3?t=1490763013531" style="width: 1080.0px;height: 386.0px;"></p> 
                <p> You can save the new baseline (to be compared against in the automated scans), you can export the snapshot (downloads as an excel spreadsheet), or you can cancel.</p> 
                <p> Each section expands to show captured details:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-03a.jpg/04d9770a-95d6-4c6e-a9a5-b258323d6a62?t=1490763023566" style="width: 1080.0px;height: 474.0px;"></p> 
                <p> The funny looking hash keys at the top? Those are calculated hashes from the scanned areas, by comparing the baseline hash against the scanned hash, TripWire knows quickly if there is a variation between the baseline and the current scan.</p> 
                <p> When you save the new baseline, the main page will reflect that the server is currently consistent with the baseline:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-05.jpg/2637c232-db28-45f9-8188-2a53d95ee7f2?t=1490761965370" style="width: 1080.0px;height: 675.0px;"></p> 
                <p> You can test the server to force a scan by clicking on the <strong>Test Server</strong> card:</p> 
                <p style="text-align: center;"> <img alt="" src="/documents/26528/87718400/tripwire-04a.jpg/e2ad93f7-9ea2-4fce-a632-a7d3fa7811d9?t=1490763033400" style="width: 449.0px;height: 255.0px;"></p> 
                <h2> Exclusions</h2> 
                <p> TripWire supports dynamically creating exclusion rules to exclude items from being part of the scan. &nbsp;You might add an exclusion for a property value that you're not interested in monitoring, for example. Click on the <strong>Exclusions</strong> card and then on the <strong>Add New Exclusion Rule</strong> button:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-07a.jpg/950a884b-dbf1-4c41-a2ae-6d3644757686?t=1490763052149" style="width: 1069.0px;height: 439.0px;"></p> 
                <p> The Camera drop down lists all of the current cameras used when taking a snapshot. Choose either a specific camera or the <strong>Any Camera</strong> option to allow for a match to any camera.</p> 
                <p> The Type drop down allows you to select either a Match, a Starts With, a Contains or a Regular Expression type for the exclusion rule.</p> 
                <p> The value field is what to match against, and the Enabled slider allows you to disable a particular exclusion rule.</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-08a.jpg/2072437b-ccc6-4c0f-9aa5-222274d63ee9?t=1490763058391" style="width: 1080.0px;height: 174.0px;"></p> 
                <p> Modifying the exclusion rules will affect scans immediately resulting in failed scans:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-09a.jpg/a2af1086-7dbf-40d2-9037-a2211bb68e9a?t=1490763064923" style="width: 1080.0px;height: 421.0px;"></p> 
                <p> By adding the rule to exclude any System Property that starts with "catalina.", scans now show the server to be inconsistent when compared to the baseline. At this point you can take a new baseline snapshot to approve the change, or you could disable the exclusion rule (basically reverting the change to the system) to restore baseline consistency.</p> 
                <h2> Notifications</h2> 
                <p> TripWire uses Liferay notifications to alert subscribed administrators when the node is in an inconsistent state and when the node returns to a consistent state. For Liferay 7 CE, a subscribed administrator will only receive notifications about the single Liferay node. For Liferay DXP, subscribed administrators will receive notifications from every node that is out of sync with the baseline snapshot.</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-13a.jpg/10d64ed8-cfb8-417d-bc2e-1bcc53fdd305?t=1490763075456" style="width: 511.0px;height: 195.0px;"></p> 
                <p> Notifications will be issued for every failed scan on every node until consistency is restored.</p> 
                <p> To subscribe or unsubscribe to notifications, click on the <strong>Subscriptions</strong> card. If you are unsubscribed, the bell image will be grey, if you are subscribed the bell will be blue and have a red notification number on it. Note this number does not represent the number of notifications you might currently have, it is just a visual marker that you are subscribed for notifications.</p> 
                <h2> Configuration</h2> 
                <p> TripWire supports setting configuration for the scanning schedule. Click on the Configuration card:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-06a.jpg/41da16d3-96f7-47b5-ac5b-c650c0a1a2a5?t=1490763045313" style="width: 1080.0px;height: 324.0px;"></p> 
                <p> Using the Cameras tab, you can also choose the cameras to use in the snapshots and scans:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-16a.jpg/c6115a71-48fe-4215-ba4b-e4d8fcb9d700?t=1490763083051" style="width: 530.0px;height: 675.0px;"></p> 
                <p> Normally I recommend enabling all but the Separate Service Status Camera (because this camera is quite verbose in the details it captures).</p> 
                <p> The Bundle Status Camera captures status for each bundle.</p> 
                <p> The Bundle Version Camera captures versions of every bundle.</p> 
                <p> The Configuration Admin Camera captures configuration changes from the control panel. &nbsp;Note that CA only saves values that are different from the set of default values on each panel, so the details on this section will always be shorter than the actual set of configurations saved for the portal.</p> 
                <p> The Portal Properties Camera captures changes to known Liferay portal properties (unknown properties are ignored). In a Liferay DXP cluster, some properties will need to be excluded using the Exclusion Rules since nodes will have separate, unique values that will never match a baseline.</p> 
                <p> The Service Status Camera captures counts of OSGi DS Services and their statuses.</p> 
                <p> The System Properties Camera captures changes to system properties from the JVM. Like the portal properties, in a Liferay DXP cluster some properties will need to be excluded using Exclusion Rules since nodes will have separate, unique values that will never match a baseline.</p> 
                <p> The Unsatisfied References Camera captures the list of bundles with unsatisfied references (preventing the bundles from starting). Any time a bundle has an unsatisfied reference, the bundle and it's unsatisfied reference(s) will be captured by this camera.</p> 
                <p> The three email tabs configure who the notification emails are from and the consistent/inconsistent email templates.</p> 
                <h2> Liferay DXP</h2> 
                <p> For Liferay DXP clusters, TripWire uses the same baseline across all nodes in the cluster and reports on cluster node inconsistencies:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-11.jpg/e4cb5b65-4d2f-40fe-a998-af1af7a8c221?t=1490761914000" style="width: 1080.0px;height: 675.0px;"></p> 
                <p> Clicking on the server link in the status area, you can review the server's report to see where the problems are:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-12.jpg/b4174c3c-2652-4b2c-853b-f221294ecd92?t=1490761907000" style="width: 1080.0px;height: 675.0px;"></p> 
                <p> Some of the additions and changes are due to unique node values and should be handled by adding new Exclusion Rules.</p> 
                <p> The Removals above show that one node in the cluster has Audience Targeting deployed but the other node does not. These are the kinds of inconsistencies that you may not be aware of from a cluster perspective but would result in your DXP cluster not serving the right content to all users, and identifying this discrepancy once in your cluster in an easy and quick way will save you time, money and effort.</p> 
                <p> For your cluster Exclusion Rules, your rule list will be quite long:</p> 
                <p> <img alt="" src="/documents/26528/87718400/tripwire-15.jpg/52dc3fe4-390f-4ec3-8a0a-a80d00e94071?t=1490761886000" style="width: 1080.0px;height: 675.0px;"></p> 
                <h2> Conclusion</h2> 
                <p> That's TripWire.</p> 
                <p> It is available from the Liferay Marketplace:</p> 
                <ul> 
                 <li> TripWire CE:&nbsp;<a href="https://web.liferay.com/marketplace/-/mp/application/87693826">https://web.liferay.com/marketplace/-/mp/application/87693826</a></li> 
                 <li> TripWire DXP:&nbsp;<a href="https://web.liferay.com/marketplace/-/mp/application/87618369">https://web.liferay.com/marketplace/-/mp/application/87618369</a></li> 
                </ul> 
                <p> There is a cost for each version, but that is to offset the time and effort I have invested in this tool.</p> 
                <p> And while there may not seem to be an immediate return, the first time this tool saves you by identifying a node that is out of sync or an unauthorized change to your OSGi environment, it will save you time (in waiting for the change to be identified), effort (in having to sort through all of the gogo output and other details), user impressions (from cluster node sync issues) and most of all, money.</p> 
                <p> &nbsp;</p> 
                <p> &nbsp;</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/available-now-tripwire"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="pzji_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Available Now: TripWire" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/available-now-tripwire" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/available-now-tripwire" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/available-now-tripwire" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/available-now-tripwire?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">3 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-dxp-and-weblogic-?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Liferay DXP and WebLogic...</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> March 21, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> For those of you deploying Liferay DXP to WebLogic, you will need to add an override property to your portal-ext.properties file to allow the WebLogic JAXB implementation to peer inside the OSGi environment to create proxy instances.</p> 
                <p> I know, it's a mouthful, but it's all pretty darn technical. You'll know if you need this if you start seeing exceptions like:</p> 
                <pre>
java.lang.NoClassDefFoundError: org/eclipse/persistence/internal/jaxb/WrappedValue
	at java.lang.ClassLoader.defineClass1(Native Method)
	at java.lang.ClassLoader.defineClass(ClassLoader.java:763)
	at java.lang.ClassLoader.defineClass(ClassLoader.java:642)
	at org.eclipse.persistence.internal.jaxb.JaxbClassLoader.generateClass(JaxbClassLoader.java:124)
	at org.eclipse.persistence.jaxb.compiler.MappingsGenerator.generateWrapperClass(MappingsGenerator.java:3302)
	Truncated. see log file for complete stacktrace
Caused By: java.lang.ClassNotFoundException: org.eclipse.persistence.internal.jaxb.WrappedValue cannot be found by com.example.bundle_1.0.0
	at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:444)
	at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:357)
	at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:349)
	at org.eclipse.osgi.internal.loader.ModuleClassLoader.loadClass(ModuleClassLoader.java:160)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	Truncated. see log file for complete stacktrace
</pre> 
                <p> Suffice it to say that you need to override the module.framework.properties.org.osgi.framework.bootdelegation property to add the following two lines:</p> 
                <pre>
  org.eclipse.persistence.internal.jaxb,\
  org.eclipse.persistence.internal.jaxb.*,\
</pre> 
                <p> You have to include all of the packages from the value defined in portal.properties, so my entry actually looks like:</p> 
                <pre>
module.framework.properties.org.osgi.framework.bootdelegation=\
  __redirected,\
  com.liferay.aspectj,\
  com.liferay.aspectj.*,\
  com.liferay.portal.servlet.delegate,\
  com.liferay.portal.servlet.delegate*,\
  com.sun.ccpp,\
  com.sun.ccpp.*,\
  com.sun.crypto.*,\
  com.sun.image.*,\
  com.sun.jmx.*,\
  com.sun.jna,\
  com.sun.jndi.*,\
  com.sun.mail.*,\
  com.sun.management.*,\
  com.sun.media.*,\
  com.sun.msv.*,\
  com.sun.org.*,\
  com.sun.syndication,\
  com.sun.tools.*,\
  com.sun.xml.*,\
  com.yourkit.*,\
  org.eclipse.persistence.internal.jaxb,\
  org.eclipse.persistence.internal.jaxb.*,\
  sun.*
</pre> 
                <p> Enjoy</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/liferay-dxp-and-weblogic-"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="lkah_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Liferay DXP and WebLogic..." data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-dxp-and-weblogic-" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-dxp-and-weblogic-" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-dxp-and-weblogic-" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-dxp-and-weblogic-?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">1 Comment</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/creating-a-spring-mvc-portlet-war-in-the-liferay-workspace?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Creating a Spring MVC Portlet War in the Liferay Workspace</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> February 28, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <h1> Introduction</h1> 
                <p> So I've been working on some new <a href="https://github.com/liferay/liferay-blade-samples">Blade sample projects</a>, and one of those is the Spring MVC portlet example.</p> 
                <p> As pointed to in the Liferay documentation for Spring MVC portlets, these guys need to be built as war files, and the Liferay Workspace will actually help you get this work done. I'm going to share things that I learned while creating the sample which has not yet been merged, but hopefully will be soon.</p> 
                <h1> Creating The Project</h1> 
                <p> So your war projects need to go in the wars folder inside of your Liferay Workspace folder, basically at the same level as your modules directory. If you don't have a wars folder, go ahead and create one.</p> 
                <p> Next we're going to have to manually create the portlet project. Currently Blade does not have support for building a Spring MVC portlet war project; perhaps this is something that can change in the future.</p> 
                <p> Inside of the wars folder, you create a folder for each portlet WAR project that you are building. To be consistent, my project folder was named blade.springmvc.web, but your project folder can be named according to your standards.</p> 
                <p> Inside your project folder, you need to set up the folder structure for a Spring MVC project. Your project structure will resemble:</p> 
                <p style="text-align: center;"> <img alt="Spring MVC Project Structure" src="/documents/26528/86625796/FileStructure.png/7ddb5747-b74d-4da1-bb03-9a45bc8353ba?t=1488344335747" style="width: 368.0px;height: 547.0px;"></p> 
                <p> For the most part this structure is similar to what you would use in a Maven implementation. For those coming from a legacy SDK, the contents of the docroot folder go to the src/main/webapp folder, but the docroot/WEB-INF/src go in the src/main/java folder (or src/main/resources for non-java files).</p> 
                <p> Otherwise this structure is going to be extremely similar to legacy Spring MVC portlet wars, all of the old locations basically still apply.</p> 
                <h1> Build.gradle Contents</h1> 
                <p> The fun part for us is the build.gradle file. This file controls how Gradle is going to build your project into a war suitable for distribution.</p> 
                <p> Here's the contents of the build.gradle file for my blade sample:</p> 
                <pre>
buildscript {
  repositories {
    mavenLocal()
    maven {
      url "https://cdn.lfrs.sl/repository.liferay.com/nexus/content/groups/public"
    }
  }

  dependencies {
    classpath group: "com.liferay", name: "com.liferay.gradle.plugins.css.builder", version: "latest.release"
    classpath group: "com.liferay", name: "com.liferay.css.builder", version: "latest.release"
  }
}

apply plugin: "com.liferay.css.builder"

war {
  dependsOn buildCSS

  exclude('**/*.scss')

  filesMatching("**/.sass-cache/") {
    it.path = it.path.replace(".sass-cache/", "")
  }

  includeEmptyDirs = false
}

dependencies {
  compileOnly project(':modules:blade.servicebuilder.api')
  compileOnly 'com.liferay.portal:com.liferay.portal.kernel:2.6.0'
  compileOnly 'javax.portlet:portlet-api:2.0'
  compileOnly 'javax.servlet:javax.servlet-api:3.0.1'
  compileOnly 'org.osgi:org.osgi.service.component.annotations:1.3.0'
  compile group: 'aopalliance', name: 'aopalliance', version: '1.0'
  compile group: 'commons-logging', name: 'commons-logging', version: '1.2'
  compileOnly group: 'javax.servlet.jsp.jstl', name: 'jstl-api', version: '1.2'
  compileOnly group: 'org.glassfish.web', name: 'jstl-impl', version: '1.2'
  compile group: 'org.springframework', name: 'spring-aop', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-beans', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-context', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-core', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-expression', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-webmvc-portlet', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-webmvc', version: '4.1.9.RELEASE'
  compile group: 'org.springframework', name: 'spring-web', version: '4.1.9.RELEASE'
}
</pre> 
                <p> So first is the buildScript and the CSS builder apply line followed by war customization stanza.</p> 
                <p> These parts are currently necessary to support compiling the SCSS files into CSS and store the files in the right place in the WAR. Note that Liferay currently sees this manual execution of the CSS builder plugin as a bug and plan on fixing it sometime soon.</p> 
                <h1> Managing Dependencies</h1> 
                <p> The next part is the dependencies, and this will be the fun part for you as it was for me.</p> 
                <p> You're going to be picking from two different dependency types, <em><strong>compile</strong></em> and <em><strong>compileOnly</strong></em>. The big difference is whether the dependencies get included in the WEB-INF/lib directory (for <em><strong>compile</strong></em>) or just used for the project compile but not included (<em><strong>compileOnly</strong></em>).</p> 
                <p> Many of the Liferay or OSGi jars should not be included in your WEB-INF/lib directory such as portal-kernel or the servlet or portlet APIs, but they are needed for compiles so they are marked as <em><strong>compileOnly</strong></em>.</p> 
                <p> In Liferay 6.x development, we used to be able to use the portal-dependency-jars in liferay-plugin-package.properties to inject libraries into our wars at deployment time. But not for Liferay 7 CE/Liferay DXP development.</p> 
                <div class="portlet-msg-alert">
                  The portal-dependency-jars property in liferay-plugin-package.properties is deprecated in Liferay 7 CE/Liferay DXP. All dependencies must be included in the war at build time.
                </div> 
                <p> Since we cannot use the portal dependencies in liferay-plugin-package.properties, I had to manually include the Spring jars using the <em><strong>compile</strong></em> type.&nbsp;</p> 
                <h1> Conclusion</h1> 
                <p> Yep, that's pretty much it.</p> 
                <p> Since it's in the Liferay Workspace and is Gradle-built, you can use the gradle wrapper script at the root of the project to build everything, including the portlet wars.</p> 
                <p> Your built war will be in the build/libs directory in project, and this war file is ready to be deployed to Liferay by dropping it in the Liferay deploy folder.</p> 
                <p> Debugging "ClassNotFound" exceptions, etc, in your war file can be extremely challenging since Liferay doesn't really keep anything around from the WAR-&gt;WAB conversion process. If you add the following properties to portal-ext.properties, the WABs generated by Liferay will be saved so you can open the file and see what jars were injected and where the files are all found in the WAB.</p> 
                <pre>
module.framework.web.generator.generated.wabs.store=true
module.framework.web.generator.generated.wabs.store.dir=${module.framework.base.dir}/wabs
</pre> 
                <p> If you want to check out the project, it is currently live in the blade samples:&nbsp;<a href="https://github.com/liferay/liferay-blade-samples/tree/master/liferay-workspace/wars/blade.portlet.springmvc">https://github.com/liferay/liferay-blade-samples/tree/master/liferay-workspace/wars/blade.portlet.springmvc</a>.</p> 
               </div> 
               <div class="entry-footer"> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="nloq_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Creating a Spring MVC Portlet War in the Liferay Workspace" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/creating-a-spring-mvc-portlet-war-in-the-liferay-workspace" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/creating-a-spring-mvc-portlet-war-in-the-liferay-workspace" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/creating-a-spring-mvc-portlet-war-in-the-liferay-workspace" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/creating-a-spring-mvc-portlet-war-in-the-liferay-workspace?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">7 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/proper-portlet-name-for-your-portlet-components-?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Proper Portlet Name for your Portlet components...</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> February 28, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> Okay, this is probably going to be one of my shortest blog posts, but it's important.</p> 
                <p> Some releases of Liferay have code to "infer" a portlet name if it is not specified in the component properties. &nbsp;This actually conflicts with other pieces of code that also try to "infer" what the portlet name is.</p> 
                <p> The problem is that they sometimes have different requirements; in one case, periods are fine in the name so the full class name is used (in the portlet component), but in other cases periods are not allowed so it uses the class name with the periods replaced by underscores.</p> 
                <p> Needless to say, this can cause you problems if Liferay is trying to use two different portlet names for the same portlet, one that works and the other that doesn't.</p> 
                <p> So save yourself some headaches and always assign your portlet name in the properties for the Portlet component, and always use that same value for other components that also need the portlet name. &nbsp;And avoid periods since they cannot be used in all cases.</p> 
                <p> So here's an example for the portlet component properties from one of my previous blogs:</p> 
                <pre>
@Component(
  immediate = true,
  property = {
    "com.liferay.portlet.display-category=category.system.admin",
    "com.liferay.portlet.header-portlet-css=/css/main.css",
    "com.liferay.portlet.instanceable=false",
    "javax.portlet.name=" + FilesystemAccessPortletKeys.FILESYSTEM_ACCESS,
    "javax.portlet.display-name=Filesystem Access",
    "javax.portlet.init-param.template-path=/",
    "javax.portlet.init-param.view-template=/view.jsp",
    "javax.portlet.resource-bundle=content.Language",
    "javax.portlet.security-role-ref=power-user,user"
  },
  service = Portlet.class
)
public class FilesystemAccessPortlet extends MVCPortlet {}
</pre> 
                <p> Notice how I was explicit with the <strong>javax.portlet.name</strong>? &nbsp;That's the one you need, don't let Liferay assume what your portlet name is, be explicit with the value.</p> 
                <p> And the value that I used in the FilesystemAccessPortletKeys constants:</p> 
                <pre>
public static final String FILESYSTEM_ACCESS =
  "com_liferay_filesystemaccess_portlet_FilesystemAccessPortlet";</pre> 
                <p> No periods, but since I'm using the class name it won't have any collisions w/ other portlet classes...</p> 
                <p> Note that if you don't like long URLs, you might try shortening the name, but stick with something that avoids collisions, such as first letter of packages w/ class name, something like "clfp_FilesystemAccessPortlet" or something. Remember that collisions are bad things...</p> 
                <p> And finally, since I've put the name in an external PortletKeys constants file, any other piece of code that expects the portlet name can use the constant value too (i.e. for your config admin interfaces) and you'll know that all code is using the same constant value.</p> 
                <p> Enjoy!</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/proper-portlet-name-for-your-portlet-components-"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="bsle_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Proper Portlet Name for your Portlet components..." data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/proper-portlet-name-for-your-portlet-components-" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/proper-portlet-name-for-your-portlet-components-" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/proper-portlet-name-for-your-portlet-components-" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/proper-portlet-name-for-your-portlet-components-?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">1 Comment</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/service-builder-6-2-migration?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Service Builder 6.2 Migration</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> February 23, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <p> I'm taking a short hiatus from the design pattern series to cover a topic I've heard a lot of questions on lately - migrating 6.2 Service Builder wars to Liferay 7 CE / Liferay DXP.</p> 
                <p> Basically it seems you have two choices:</p> 
                <ol> 
                 <li> You can keep the Service Builder implementation in a portlet war. Any wars you keep going forward will have access to the service layer, but can you access the services from other OSGi components?</li> 
                 <li> You take the Service Builder code out into an OSGi module. With this path you'll be able to access the services from other OSGi modules, but will the services be available to the legacy portlet wars?</li> 
                </ol> 
                <p> So it's that mixed usage that leads to the questions. I mean, if all you have is either legacy wars or pure OSGi modules, the decision is easy - stick with what you've got.</p> 
                <p> But when you are in mixed modes, how do you deliver your Service Builder code so both sides will be happy?</p> 
                <h1> The Scenario</h1> 
                <p> So we're going to work from the following starting point. We have a 6.2 Service Builder portlet war following a recommendation that I frequently give, the war has only the Service Builder implementation in it and nothing else, no other portlets. I often recommend this as it gives you a working Service Builder implementation and no pollution from Spring or other libraries that can sometimes conflict with Service Builder. We'll also have a separate portlet war that leverages the Service Builder service.</p> 
                <p> Nothing fancy for the code, the SB layer has a simple entity, Course, and the portlet war will be a legacy Liferay MVC portlet that lists the courses.</p> 
                <p> We're tasked with upgrading our code to Liferay 7 CE or Liferay DXP (pick your poison <img alt="cheeky" height="20" src="https://web.liferay.com/html/js/editor/ckeditor/plugins/smiley/images/tounge_smile.gif" title="cheeky" width="20">), and as part of the upgrade we will have a new OSGi portlet component using the new Liferay MVC framework for adding a course.</p> 
                <p> To reduce our development time, we will upgrade our course list portlet to be compatible with Liferay 7 CE / Liferay DXP but keep it as a portlet war - basically the minimal effort needed to get it upgraded. We'll also have the new portlet module for adding a course.</p> 
                <p> But our big development focus, and the focus of this blog, will be choosing the right path for upgrading that Service Builder portlet war.</p> 
                <p> For evaluation purposes we're going to have to upgrade the SDK to a Liferay Workspace. Doing so will help get us some working 7.x portlet wars initially, and then when it comes time to do the testing for the module it should be easy to migrate.</p> 
                <h1> Upgrading to a Liferay Workspace</h1> 
                <p> So the Liferay IDE version 3.1 Milestone 2 is available, and it has the Code Upgrade Assistant to help take our SDK project and migrate it to a Liferay Workspace.</p> 
                <p> For this project, I've made the original 6.2 SDK project available at&nbsp;<a href="https://github.com/dnebing/sb-upgrade-62-sdk">https://github.com/dnebing/sb-upgrade-62-sdk</a>.</p> 
                <p> You can find an intro to the upgrade assistant in Greg Amerson's blog:&nbsp;<a href="https://web.liferay.com/web/gregory.amerson/blog/-/blogs/liferay-ide-3-1-milestone-1-released">https://web.liferay.com/web/gregory.amerson/blog/-/blogs/liferay-ide-3-1-milestone-1-released</a>&nbsp;and Andy Wu's blog:&nbsp;<a href="https://web.liferay.com/web/andy.wu/blog/-/blogs/liferay-ide-3-1-milestone-2-released">https://web.liferay.com/web/andy.wu/blog/-/blogs/liferay-ide-3-1-milestone-2-released</a>.</p> 
                <p> It is still a milestone release so it is still a work in progress, but it does work on upgrading my sample SDK. Just a note, though, it does take some processing time during the initial upgrade to a workspace; if you think it has locked up or is unresponsive, just have patience. It will come back, it will complete, you just have to give it time to do it's job.</p> 
                <h2> Checkpoint</h2> 
                <p> After you finish the upgrade, you should have a Liferay workspace w/ a plugins-sdk directory and inside there is the normal SDK directory structure. In the portlet directory the two portlet war projects are there and they are ready for deployment.</p> 
                <p> In fact, in the plugins-sdk/dist directory you should find both of the wars just waiting to be deployed. Deploy them to your new Liferay 7 CE or Liferay DXP environment, then spin out and drop the Course List portlet on a page and you should see the same result as the 6.2 version.</p> 
                <p> So what have we done so far? We upgraded our SDK to a Liferay Workspace and the Code Upgrade Assistant has upgraded our code to be ready for Liferay 7 CE / Liferay DXP. The two portlet wars were upgraded and built. When we deployed them to Liferay, the WAR -&gt; WAB conversion process converted our old wars into OSGi bundles.</p> 
                <p> However, if you go into the Gogo shell and start digging around, you won't find the services defined from our Service Builder portlet. Obviously they are there because the Course List portlet uses it to get the list of courses.</p> 
                <h2> War-Based Service Builder</h2> 
                <p> So how do these war-based Service Builder upgrades work? If you take a look at the CourseLocalServiceUtil's getService() method, you'll see that it uses the good ole' PortletBeanLocator and the registered Spring beans for the Service Builder implementation. The Util classes use the PortletBeanLocator to find the service implementations and may leverage the class loader proxies (CLP) if necessary to access the Spring beans from other contexts. From the service war perspective, it's going through Liferay's Spring bean registry to get access to the service implementations.</p> 
                <p> Long story short, our service jar is still a service jar. It is not a proper OSGi module and cannot be deployed as one. But the question is, can we still use it?</p> 
                <h1> OSGi Add Course Portlet</h1> 
                <p> So we need an OSGi portlet to add courses. Again this will be another simple portlet to show a form and process the submit. Creating the module is pretty straight forward, the challenge of course is including the service jar into the bundle.</p> 
                <p> First thing that is necessary is to include the jar into the build.gradle dependencies. Since it is not in a Maven-like repository, we'll need to use a slightly different syntax to include the jar:</p> 
                <pre>
dependencies {
  compileOnly group: "com.liferay.portal", name: "com.liferay.portal.kernel", version: "2.0.0"
  compileOnly group: "com.liferay.portal", name: "com.liferay.util.taglib", version: "2.0.0"
  compileOnly group: "javax.portlet", name: "portlet-api", version: "2.0"
  compileOnly group: "javax.servlet", name: "javax.servlet-api", version: "3.0.1"
  compileOnly group: "jstl", name: "jstl", version: "1.2"
  compileOnly group: "org.osgi", name: "osgi.cmpn", version: "6.0.0"
	
  compile files('../../plugins-sdk/portlets/school-portlet/docroot/WEB-INF/lib/school-portlet-service.jar')
}
</pre> 
                <p> The last line is the key; it is the syntax for including a local jar file, and in our case we're pointing at the service jar which is part of the plugins-sdk folder that we upgraded.</p> 
                <p> Additionally we need to add the stanza to the bnd.bnd file so the jar gets included into the bundle during the build:</p> 
                <pre>
Bundle-ClassPath:\
  .,\
  lib/school-portlet-service.jar

-includeresource:\
  lib/school-portlet-service.jar=school-portlet-service.jar
</pre> 
                <p> As you'll remember from my blog post on <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/osgi-module-dependencies">OSGi Module Dependencies</a>, this is option #4 to include the jar into the bundle itself and use it in the classpath for the bundle.</p> 
                <p> Now if you build and deploy this module, you can place the portlet on a page and start adding courses. &nbsp;It works!</p> 
                <p> By including the service jar into the module, we are leveraging the same PortletBeanLocator logic used in the Util class to get access to the service layer and invoke services via the static Util classes.</p> 
                <p> Now that we know that this is possible (we'll discuss whether to do it this way in the conclusion), let's now rework everything to move the Service Builder code into a set of standard OSGi modules.</p> 
                <p> <span style="font-size: 2.5em;">Migrating Service Builder War to Bundle</span></p> 
                <p> Our service builder code has already been upgraded when we upgraded the SDK, so all we need to do here is create the modules and then move the code.</p> 
                <h2> Creating the Clean Modules</h2> 
                <p> First step is to create a clean project in our Liferay workspace, a foundation for the Service Builder modules to build from.</p> 
                <p> Once again, I start with Blade since I'm an Intellij developer. In modules directory, we'll let Blade create our Service Builder projects:</p> 
                <pre>
blade create -t service-builder -p com.liferay.school school</pre> 
                <p> For the last argument, use something that reflects your current Service Builder project name.</p> 
                <p> This is the clean project, so let's start dirtying it up a bit.</p> 
                <p> Copy your legacy service.xml to the school/school-service directory.</p> 
                <p> Build the initial Service Builder code from the service XML. If you're on the command line, you'd do:</p> 
                <pre>
../../gradlew buildService</pre> 
                <p> Now we have unmodified, generated code. Layer in the changes from the legacy Service Builder portlet, including:</p> 
                <ul> 
                 <li> portlet-model-hints.xml</li> 
                 <li> service.properties</li> 
                 <li> Changes to any of the META-INF/spring xml files</li> 
                 <li> All of your Impl java classes</li> 
                </ul> 
                <p> Rebuild services again to get the working module code.</p> 
                <h2> Module-Based Service Builder</h2> 
                <p> So we reviewed how the CourseLocalServiceUtil's getService() method in the war-based service jar leveraged the PortletBeanLocator to find the Spring bean registered with Liferay to get the implementation class.</p> 
                <p> In our OSGi module-based version, the CourseLocalServiceUtil's getService() method is instead using an OSGi ServiceTracker to get access to the DS components registered in OSGi for the implementation class.</p> 
                <p> Again the service "jar" is still a service jar (well, module), but we also know that the add course portlet will be able to leverage the service (with some modifications), the question of course is whether we can also use the service API module in our legacy course list portlet.</p> 
                <h1> Fixing the Course List Portlet War</h1> 
                <p> So what remains is modifying the course list portlet so it can leverage the API module in lieu of the legacy Service Builder portlet service jar.</p> 
                <p> This change is actually quite easy...</p> 
                <p> The liferay-plugin-package.properties file changed from the upgrade assistant contains the following:</p> 
                <pre>
required-deployment-contexts=\
    school-portlet
</pre> 
                <p> This is the line used by the Liferay IDE to inject the service jar so the service will be available to the portlet war. We need to edit this line to strip out these two lines since we're not using the deployment context.</p> 
                <div class="portlet-msg-info">
                  If you have the school-portlet-service.jar file in docroot/WEB-INF/lib, go ahead and delete that file since it is no longer necessary.
                </div> 
                <p> Next comes the messy part; we need to copy in the API jar into the course list portlet's WEB-INF/lib directory. We have to do this so Eclipse will be happy and will be able to happily compile all of our code that uses the API. There's no easy way to do this, but I can think of the following options:</p> 
                <ol> 
                 <li> Manually copy the API jar over.</li> 
                 <li> Modify the Gradle build scripts to add support for the install of artifacts into the local Maven repo, then the Ivy configuration for the project can be adjusted to include the dependency. Not as messy as a manual file copy, but involves doing the install of the API jar so Ivy can find it.</li> 
                </ol> 
                <p> We're not done there... We actually cannot keep the jar in WEB-INF/lib otherwise at runtime you get class cast exceptions, so we need to exclude it during deployment. This is easily handled, however, by adding an exclusion to your portal-ext.properties file:</p> 
                <pre>
module.framework.web.generator.excluded.paths=&lt;CURRENT EXCLUSIONS&gt;,\
  WEB-INF/lib/com.liferay.school.api-1.0.0.jar</pre> 
                <p> When the WAR-&gt;WAB conversion is taking place, it will exclude this jar from being included. So you get to keep it in the project and let the WAB conversion strip it out during deployment.</p> 
                <div class="portlet-msg-alert">
                  Remember to keep all of the current excluded paths in the list, you can find them in the portal.properties file included in your Liferay source.
                </div> 
                <p> Build and deploy your new war and it should access the OSGi-based service API module.</p> 
                <h1> Conclusion</h1> 
                <p> Well, this ended up being a mixed bag...</p> 
                <p> On one hand I've shown that you can use the Service Builder portlet's service jar as a direct dependency in the module and it can invoke the service through the static Util classes defined within. The advantage of sticking with this path is that it really doesn't require much modification from your legacy code beyond completing the code upgrade, and the Liferay IDE's Code Upgrade Assistant gets you most of the way there. The obvious disadvantage is that you're now adding a dependency to the modules that need to invoke the service layer and the deployed modules include the service jar; so if you change the service layer, you're going to have to rebuild and redeploy all modules that have the service jar as an embedded dependency.</p> 
                <p> On the other hand I've shown that the migrated OSGi Service Builder modules can be used to eliminate all of the service jar replication and redeployment pain, but the hoops you have to jump through for the legacy portlet access to the services are a development-time pain.</p> 
                <p> It seems clear, at least to me, that the second option is the best. Sure you will incur some development-time pain to copy service API jars if only to keep the java compiler happy when compiling code, but it definitely has the least impact when it comes to service API modifications.</p> 
                <p> So my recommendations for migrating your 6.2 Service Builder implementations to Liferay 7 CE / Liferay DXP are:</p> 
                <ul> 
                 <li> Use the Liferay IDE's Code Upgrade Assistant to help migrate your code to be 7-compatible.</li> 
                 <li> Move the Service Builder code to OSGi modules.</li> 
                 <li> Add the API jars to the legacy portlet's WEB-INF/lib directory for those portlets which will be consuming the services.</li> 
                 <li> Add the module.framework.web.generator.excluded.paths entry to your portal-ext.properties to strip the jar during WAR-&gt;WAB conversion.</li> 
                </ul> 
                <p> If you follow these recommendations your legacy portlet wars will be able to leverage the services, any new OSGi-based portlets (or JSP fragments or ...) will be able to access the services, and your deployment impact for changes will be minimized.</p> 
                <p> My code for all of this is available in github:</p> 
                <ul> 
                 <li> Original 6.2 SDK:&nbsp;<a href="https://github.com/dnebing/sb-upgrade-62-sdk">https://github.com/dnebing/sb-upgrade-62-sdk</a></li> 
                 <li> SB Upgrade to 7 using the Service Builder portlet:&nbsp;<a href="https://github.com/dnebing/sb-upgrade-70/tree/SB-Portlet">https://github.com/dnebing/sb-upgrade-70/tree/SB-Portlet</a></li> 
                 <li> SB Upgrade to 7 using the Service Builder module:&nbsp;<a href="https://github.com/dnebing/sb-upgrade-70/tree/SB-Module">https://github.com/dnebing/sb-upgrade-70/tree/SB-Module</a></li> 
                </ul> 
                <p> Note that the upgraded code is actually in the same repo, they are just in different branches.</p> 
                <p> Good Luck!</p> 
                <h1> Update</h1> 
                <p> After thinking about this some more, there's actually another path that I did not consider...</p> 
                <p> For the Service Builder portlet service jar, I indicated you'd need to include this as a dependency on every module that needed to use the service, but I neglected to consider the global service jar option that we used for Liferay 6.x...</p> 
                <p> So you can keep the Service Builder implementation in the portlet, but move the service jar to the global class loader (Tomcat's lib/ext directory). Remember that with this option there can only be one service jar, the global one, so no other portlet war nor module (including the Service Builder portlet war) can have a service jar. Also remember that to update a global service jar, you can only do this while Tomcat is down.</p> 
                <p> The final step is to add the packages for the service interfaces to the module.framework.system.packages.extra property in portal-ext.properties. You want to add the packages to the current list defined in portal.properties, not replace the list with just your service packages.</p> 
                <p> Before starting Tomcat, you'll want to add the exception, model and service trio to the list. For the school service example, this would be something like:</p> 
                <pre>
module.framework.system.packages.extra=\
  &lt;ALL DEFAULT VALUES COPIED IN&gt;,\
  com.liferay.school.exception,\
  com.liferay.school.model,\
  com.liferay.school.service
</pre> 
                <p> This will make the contents of the packages available to the OSGi global class loader so, whether bundle or WAB, they will all have access to the interfaces and static classes.</p> 
                <p> This has a little bit of a deployment process change to go with it, but you might consider this the least impactful change of all. We tend to frown on the use of the global class loader because it may introduce transitive dependencies and does not support hot deployable updates, but this option might be lower development cost to offset the concern.</p> 
               </div> 
               <div class="entry-footer"> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="emli_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Service Builder 6.2 Migration" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/service-builder-6-2-migration" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/service-builder-6-2-migration" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/service-builder-6-2-migration" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/service-builder-6-2-migration?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">4 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="entry "> 
               <div class="entry-header taglib-header"> 
                <h1 class="heading"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-design-patterns-multi-scoped-data-logic?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1">Liferay Design Patterns - Multi-Scoped Data/Logic</a> </h1> 
                <p class="details"> <span class="btn-d Technical">Technical Blogs</span> February 17, 2017 By <a href="https://web.liferay.com/c/my_sites/view?groupId=26528&amp;privateLayout=0">David H Nebinger</a> </p> 
               </div> 
               <div class="entry-body"> 
                <h1> <strong>Pattern:</strong> Multi-Scoped Data/Logic</h1> 
                <h2> Intent</h2> 
                <p> The intent for this pattern is to support data/logic usage in multiple scopes. Liferay defines the scopes Global, Site and Page, but from a development perspective scope refers to Portal and individual OSGi Modules. Classic data access implementations do not support multi-scope access because of boundaries between the scopes.</p> 
                <p> The Multi-Scoped Data/Logic Liferay Design Pattern's intent is to define how data and logic can be designed to be accessable from all scopes in Liferay, either in the Portal layer or any other deployed OSGi Modules.</p> 
                <h2> Also Known As</h2> 
                <p> This pattern is implemented using the Liferay Service Builder tool.</p> 
                <h2> Motivation</h2> 
                <p> Standard ORM tools provide access to data for servlet-based web applications, but they are not a good fit in the portal because of the barriers between modules in the form of class loader and other kinds of boundaries. If a design starts from a standard ORM solution, it will be restricted to a single development scope. Often this may seem acceptable for an initial design, but in the portal world most single-scoped solutions often need to be changed to support multiple scopes. As the standard tools have no support for multiple scopes, developers will need to hand code bridge logic to add multi-scope support, and any hand coding increases development time, bug potential, and time to market.</p> 
                <p> The motivation for Liferay's Service Builder tool is to provide an ORM-like tool with built-in support for multi-scoped data access and business logic sharing. The tool transforms an XML-based entity definition file into layered code to support multiple scopes and is used throughout business logic creation to add multi-scope exposure for the business logic methods.</p> 
                <p> Additionally the tool is the foundation for adding portal feature support to custom entities, including:</p> 
                <ul> 
                 <li> Auto-populated entity audit columns.</li> 
                 <li> Asset framework support (comments, rankings, Asset Publisher support, etc).</li> 
                 <li> Indexing and Search support.</li> 
                 <li> Model listeners.</li> 
                 <li> Workflow support.</li> 
                 <li> Expando support.</li> 
                 <li> Dynamic Query support.</li> 
                 <li> Automagic JSON web service support.</li> 
                 <li> Automagic SOAP web service support.</li> 
                </ul> 
                <p> You're not going to get this kind of integration from your classic ORM tool...</p> 
                <p> And with Liferay 7 CE / Liferay DXP, additionally you also get an OSGi-compatible API and service bundle implementation ready for deployment.</p> 
                <h2> Applicability</h2> 
                <p> IMHO Service Builder applies when you are dealing with any kind of multi-scoped data entities and/or business logic; it also applies if you need to add any of the indicated portal features to your implementation.</p> 
                <h2> Participants</h2> 
                <p> The participants in this pattern are:</p> 
                <ul> 
                 <li> An XML file defining the entities.</li> 
                 <li> Spring configuration files.</li> 
                 <li> Implementation class methods to add business logic.</li> 
                 <li> Service consumers.</li> 
                </ul> 
                <p> The participants are used by the Service Builder tool to generate code for the service implementation details.</p> 
                <p> Details for working with Service Builder are covered in the following sections:</p> 
                <ul> 
                 <li> <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/what-is-service-builder">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/what-is-service-builder</a></li> 
                 <li> <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/running-service-builder-and-understanding-the-generated-code">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/running-service-builder-and-understanding-the-generated-code</a></li> 
                 <li> <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/defining-an-object-relational-map-with-service-builder">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/defining-an-object-relational-map-with-service-builder</a></li> 
                 <li> <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/creating-local-services">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/creating-local-services</a></li> 
                 <li> <a href="https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/service-builder-web-services">https://dev.liferay.com/develop/tutorials/-/knowledge_base/7-0/service-builder-web-services</a></li> 
                </ul> 
                <h2> Collaboration</h2> 
                <p> ServiceBuilder uses the entity definition XML file to generate the bulk of the code. Custom business methods are added to the ServiceImpl and LocalServiceImpl classes for the custom entities and ServiceBuilder will include them in the service API.</p> 
                <h2> Consequences</h2> 
                <p> By using Service Builder and generating entities, there is no real downside in the portal environment. Service Builder will generate an ORM layer and provide integration points for all of the core Liferay features.</p> 
                <p> There are three typical arguments used by architects and developers for not using Service Builder:</p> 
                <ul> 
                 <li> It is not a complete ORM. This is true, it does not support everything a full ORM does. It doesn't support Many To Many relationships and it also doesn't handle automatic parent-children relationships in One To Many. All that means is the code to handle many to many and even some one to many relationship handling will need to be hand-coded.</li> 
                 <li> It still uses old XML files instead of newer Annotations. This is also true, but this is more a reflection of Liferay generating all of the code including the interfaces. With Liferay adding portal features based upon the XML definitions, using annotations would require Liferay to modify the annotated interface and cause circular change effects.</li> 
                 <li> I already know how to develop using X, my project deadlines are too short to learn a new tool like Service Builder. Yes there is a learning curve with Service Builder, but this is nothing compared to the mountains of work it will take getting X working correctly in the portal and some Liferay features will just not be options for you without Service Builder's generated code.</li> 
                </ul> 
                <p> All of these arguments are weak in light of what you get by using Service Builder.</p> 
                <h2> Sample Usage</h2> 
                <p> Service Builder is another case of Liferay eating it's own dogfood. The entire portal is based on Service Builder for all of the entities in all of the portlets, the Liferay entities, etc.</p> 
                <p> Check out any of the Liferay modules from simple cases like Bookmarks through more complicated cases such as Workflow or the Asset Publisher.</p> 
                <h2> Conclusion</h2> 
                <p> Service Builder is a must-use if you are going to do any integrated portal development. You can't build the portal features into your portlets without Service Builder usage.</p> 
                <p> Seriously. You have no other choice. And I'm not saying this because I'm a fanboy or anything, I'm coming from a place of experience. My first project on Liferay dealt with a number of portlets using a service layer; I knew Hibernate but didn't want to take time out to learn Service Builder. That was a terrible mistake on my part. I never did deal with the multi-scoping well at all, never got the kind of Liferay integration that would have been great to have. Fortunately it was not a big problem to have made such a mistake, but I learned from it and use Service Builder all the time now in the portal.</p> 
                <p> So I share this experience with you in hopes that you too can avoid the mistakes I made. Use Service Builder for your own good!</p> 
               </div> 
               <div class="entry-footer"> 
                <p class="trackback"> Trackback URL: <input class="form-text lfr-input-resource " onClick="Liferay.Util.selectAndCopy(this);" readonly="true" type="text" value="https://web.liferay.com/web/user.26526/blog/-/blogs/trackback/liferay-design-patterns-multi-scoped-data-logic"> </p> 
                <div class="entry-links"> 
                </div> 
                <div class="taglib-social-bookmarks" id="mwoi_socialBookmarks"> 
                 <ul class="lfr-component"> 
                  <li class="taglib-social-bookmark-twitter"> <a class="twitter-share-button" data-count="horizontal" data-lang="English" data-text="Liferay Design Patterns - Multi-Scoped Data/Logic" data-url="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-design-patterns-multi-scoped-data-logic" href="http://twitter.com/share">Tweet</a> </li> 
                  <li class="taglib-social-bookmark-facebook"> 
                   <div id="fb-root"></div> 
                   <div class="fb-like" data-font="" data-height="20" data-href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-design-patterns-multi-scoped-data-logic" data-layout="button_count" data-send="false" data-show_faces="true"></div> </li> 
                  <li class="taglib-social-bookmark-plusone"> 
                   <g:plusone count="true" href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-design-patterns-multi-scoped-data-logic" size="medium"> 
                   </g:plusone> </li> 
                 </ul> 
                </div> 
                <p class="stats"> <a href="https://web.liferay.com/web/user.26526/blog/-/blogs/liferay-design-patterns-multi-scoped-data-logic?_33_redirect=https%3A%2F%2Fweb.liferay.com%2Fweb%2Fuser.26526%2Fblog%3Fp_p_id%3D33%26p_p_lifecycle%3D0%26p_p_state%3Dnormal%26p_p_mode%3Dview%26p_p_col_id%3Dcolumn-2%26p_p_col_count%3D1#_33_messageScroll0">4 Comments</a> </p> 
               </div> 
              </div> 
              <div class="separator">
               <!-- -->
              </div> 
              <div class="subscribe"> 
               <span> <a class="taglib-icon" href="https://web.liferay.com/web/user.26526/blog/-/blogs/rss" id="_33_suxb" target="_blank" title="(Opens New Window)"> <img class="icon" src="https://web.liferay.com/osb-community-theme/images/spacer.png" alt="" style="background-image: url('https://web.liferay.com/osb-community-theme/sprite/images/common/_sprite.png'); background-position: 50% -1118px; background-repeat: no-repeat; height: 16px; width: 16px;"> <span class="taglib-text">RSS</span> <span class="opens-new-window-accessible">(Opens New Window)</span></a> </span> 
              </div> 
              <div class="taglib-page-iterator" id="_33_ircfSearchContainerPageIterator"> 
               <div class="search-results">
                 Showing 1 - 20 of 61 results. 
               </div> 
               <div class="search-pages"> 
                <div class="delta-selector">
                  Items 20 
                </div> 
                <div class="page-selector"> 
                 <span class="aui-field aui-field-select aui-field-menu"> <span class="aui-field-content"> <label class="aui-field-label-inline-label" for="_33_ircfSearchContainerPageIterator_page"> Page <span class="aui-helper-hidden-accessible">(Changing the value of this field will reload the page.)</span> </label> <span class="aui-field-element "> <select class="aui-field-input aui-field-input-select aui-field-input-menu" id="_33_ircfSearchContainerPageIterator_page" name="_33_page" onchange="_33_curupdateCur(this);"> <option selected value="1"> 1 </option> <option value="2"> 2 </option> <option value="3"> 3 </option> <option value="4"> 4 </option> </select> </span> <span class="aui-suffix"> of 4 </span> </span> </span> 
                </div> 
                <div class="page-links"> 
                 <span class="first"> First </span> 
                 <span class="previous"> Previous </span> 
                 <a class="next" href="https://web.liferay.com/web/user.26526/blog?p_p_id=33&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_mode=view&amp;p_p_col_id=column-2&amp;p_p_col_count=1&amp;_33_struts_action=%2Fblogs%2Fview&amp;_33_delta=20&amp;_33_keywords=&amp;_33_advancedSearch=false&amp;_33_andOperator=true&amp;p_r_p_564233524_resetCur=false&amp;cur=2" target="_self"> Next </a> 
                 <a class="last" href="https://web.liferay.com/web/user.26526/blog?p_p_id=33&amp;p_p_lifecycle=0&amp;p_p_state=normal&amp;p_p_mode=view&amp;p_p_col_id=column-2&amp;p_p_col_count=1&amp;_33_struts_action=%2Fblogs%2Fview&amp;_33_delta=20&amp;_33_keywords=&amp;_33_advancedSearch=false&amp;_33_andOperator=true&amp;p_r_p_564233524_resetCur=false&amp;cur=4" target="_self"> Last </a> 
                </div> 
               </div> 
              </div> 
             </form> 
            </div> 
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sub-grid"> 
       <div class="aui-w50 portlet-column responsive720-w100" id="column-3"> 
        <div class="portlet-dropzone empty left-column portlet-column-content" id="layout-column_column-3"></div> 
       </div> 
       <div class="aui-w50 portlet-column responsive720-w100" id="column-4"> 
        <div class="portlet-dropzone empty portlet-column-content right-column" id="layout-column_column-4"></div> 
       </div> 
      </div> 
      <div class="sub-grid"> 
       <div class="aui-w100 portlet-column" id="column-5"> 
        <div class="portlet-dropzone empty portlet-column-content" id="layout-column_column-5"></div> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div class="portlet-boundary portlet-boundary_1_WAR_samlportlet_ portlet-static portlet-static-end portlet-borderless " id="p_p_id_1_WAR_samlportlet_"> 
     <span id="p_1_WAR_samlportlet"></span> 
     <div class="portlet-body"> 
     </div> 
    </div> 
    <form action="#" id="hrefFm" method="post" name="hrefFm"> 
     <span></span> 
    </form> 
    <div class="aui-helper-clearfix"></div> 
    <footer class="doc-footer" id="footer"> 
     <div class="aui-helper-clearfix bottom-navigation social-nav"> 
      <ul> 
       <li class="responsive-hidden"> <a href="/community/blogs"> <span class="rss social-img"></span> <span>Blogs</span> </a> </li> 
       <li> <a href="http://www.facebook.com/pages/Liferay/45119213107" target="_blank"> <span class="facebook social-img"></span> <span class="responsive-hidden">Facebook</span> </a> </li> 
       <li> <a href="http://www.linkedin.com/company/83609?trk=NUS_CMPY_TWIT" target="_blank"> <span class="linkedin social-img"></span> <span class="responsive-hidden">LinkedIn</span> </a> </li> 
       <li class="responsive-hidden"> <a href="/about-us/news"> <span class="news social-img"></span> <span>News</span> </a> </li> 
       <li> <a href="http://www.twitter.com/liferay" target="_blank"> <span class="social-img twitter"></span> <span class="responsive-hidden">Twitter</span> </a> </li> 
      </ul> 
     </div> 
     <div class="site-links"> 
      <nav class="sort-pages modify-pages bottom-navigation responsive-only"> 
       <ul class="nav-menu"> 
        <li class="nav-item nav-item-1 root-item"> <a href="/fnav/contact-us" onclick="ga('send', 'event', 'Navigation Clicks', 'Mobile Footer Navigation', 'Contact Us');">Contact Us</a> </li> 
        <li class="nav-item nav-item-2 root-item"> <a href="/fnav/privacy-policy" onclick="ga('send', 'event', 'Navigation Clicks', 'Mobile Footer Navigation', 'Privacy Policy');">Privacy Policy</a> </li> 
       </ul> 
      </nav> 
      <nav class="sort-pages modify-pages bottom-navigation responsive-hidden"> 
       <ul class="nav-menu"> 
        <li class="class-toggle-off-click nav-item nav-item-1 parent-item root-item"> <a href="javascript:;">Products</a> <span class="children-marker responsive-only"></span> 
         <ul class="child-menu class-toggle-off-click-content drop-down-menu"> 
          <li class="child-item child-item-1 nav-item" id="parent1childItem1"> <a href="https://www.liferay.com/digital-experience-platform" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Products - Liferay DXP');">Liferay DXP</a> </li> 
          <li class="child-item child-item-2 nav-item" id="parent1childItem2"> <a href="/fnav/social-office" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Products - Social Office');">Social Office</a> </li> 
          <li class="child-item child-item-3 nav-item" id="parent1childItem3"> <a href="/fnav/liferay-sync" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Products - Liferay Sync');">Liferay Sync</a> </li> 
         </ul> </li> 
        <li class="class-toggle-off-click nav-item nav-item-2 parent-item root-item"> <a href="javascript:;">Community</a> <span class="children-marker responsive-only"></span> 
         <ul class="child-menu class-toggle-off-click-content drop-down-menu"> 
          <li class="child-item child-item-1 nav-item" id="parent2childItem1"> <a href="/fnav/forums" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Community - Forums');">Forums</a> </li> 
          <li class="child-item child-item-2 nav-item" id="parent2childItem2"> <a href="/fnav/wiki" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Community - Wiki');">Wiki</a> </li> 
          <li class="child-item child-item-3 nav-item" id="parent2childItem3"> <a href="/fnav/blogs" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Community - Blogs');">Blogs</a> </li> 
         </ul> </li> 
        <li class="class-toggle-off-click nav-item nav-item-3 parent-item root-item"> <a href="javascript:;">Services</a> <span class="children-marker responsive-only"></span> 
         <ul class="child-menu class-toggle-off-click-content drop-down-menu"> 
          <li class="child-item child-item-1 nav-item" id="parent3childItem1"> <a href="/fnav/partners" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Services - Partners');">Partners</a> </li> 
          <li class="child-item child-item-2 nav-item" id="parent3childItem2"> <a href="/fnav/training" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Services - Training');">Training</a> </li> 
          <li class="child-item child-item-3 nav-item" id="parent3childItem3"> <a href="/fnav/consulting" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Services - Consulting');">Consulting</a> </li> 
         </ul> </li> 
        <li class="class-toggle-off-click nav-item nav-item-4 parent-item root-item"> <a href="javascript:;">About Us</a> <span class="children-marker responsive-only"></span> 
         <ul class="child-menu class-toggle-off-click-content drop-down-menu"> 
          <li class="child-item child-item-1 nav-item" id="parent4childItem1"> <a href="/fnav/newsroom" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'About Us - Newsroom');">Newsroom</a> </li> 
         </ul> </li> 
        <li class="class-toggle-off-click nav-item nav-item-5 parent-item root-item"> <a href="javascript:;">Contact</a> <span class="children-marker responsive-only"></span> 
         <ul class="child-menu class-toggle-off-click-content drop-down-menu"> 
          <li class="child-item child-item-1 nav-item" id="parent5childItem1"> <a href="https://www.liferay.com/contact-us" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Contact - Contact Us');">Contact Us</a> </li> 
          <li class="child-item child-item-2 nav-item" id="parent5childItem2"> <a href="/fnav/careers1" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Contact - Careers');">Careers</a> </li> 
         </ul> </li> 
        <li class="class-toggle-off-click nav-item nav-item-6 parent-item root-item"> <a href="javascript:;">Liferay Marketplace</a> <span class="children-marker responsive-only"></span> 
         <ul class="child-menu class-toggle-off-click-content drop-down-menu"> 
          <li class="child-item child-item-1 nav-item" id="parent6childItem1"> <a href="/fnav/marketplace" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Liferay Marketplace - Marketplace');">Marketplace</a> </li> 
          <li class="child-item child-item-2 nav-item" id="parent6childItem2"> <a href="https://dev.liferay.com/distribute/faq" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Liferay Marketplace - Marketplace FAQ');">Marketplace FAQ</a> </li> 
          <li class="child-item child-item-3 nav-item" id="parent6childItem3"> <a href="/fnav/marketplace-terms" onclick="ga('send', 'event', 'Navigation Clicks', 'Footer Navigation', 'Liferay Marketplace - Marketplace Terms');">Marketplace Terms</a> </li> 
         </ul> </li> 
       </ul> 
      </nav> 
     </div> 
     <nav class="sort-pages modify-pages bottom-navigation responsive-hidden social-media-panel"> 
      <div class="facebook-buttons"> 
       <script type="text/javascript">/*<![CDATA[*/(function(a,c){function b(){var e=document.getElementsByTagName(a)[0];var d=document.createElement(a);if(!document.getElementById(c)){d.id=c;d.src="//connect.facebook.net/en_US/all.js#xfbml=1";e.parentNode.insertBefore(d,e)}}AUI.Env.add(window,"load",b,false)}("script","facebook-jssdk"));/*]]>*/</script> 
       <div class="fb-like" data-action="like" data-href="https://www.facebook.com/liferay" data-layout="button_count" data-show-faces="true"></div> 
      </div> 
     </nav> 
     <p class="copyright"> © 2017 Liferay Inc. All Rights Reserved </p> 
    </footer> 
   </div> 
  </div> 
  <script type="text/javascript">/*<![CDATA[*/Liferay.Util.addInputFocus();Liferay.Portlet.runtimePortletIds=["103","1_WAR_samlportlet"];/*]]>*/</script> 
  <script type="text/javascript">/*<![CDATA[*/Liferay.Portlet.onLoad({canEditTitle:false,columnPos:0,isStatic:"end",namespacedId:"p_p_id_103_",portletId:"103",refreshURL:"\x2fc\x2fportal\x2frender_portlet\x3fp_l_id\x3d50657388\x26p_p_id\x3d103\x26p_p_lifecycle\x3d0\x26p_t_lifecycle\x3d0\x26p_p_state\x3dnormal\x26p_p_mode\x3dview\x26p_p_col_id\x3d\x26p_p_col_pos\x3d0\x26p_p_col_count\x3d0\x26p_p_isolated\x3d1\x26currentURL\x3d\x252Fweb\x252Fuser\x2e26526\x252Fblog\x253Fp_p_id\x253D58\x2526p_p_lifecycle\x253D0\x2526p_p_state\x253Dnormal\x2526p_p_state_rcv\x253D1\x2526_58_struts_action\x253D\x2525252Flogin\x2525252Flogin"});Liferay.Portlet.onLoad({canEditTitle:false,columnPos:1,isStatic:"start",namespacedId:"p_p_id_114_",portletId:"114",refreshURL:"\x2fc\x2fportal\x2frender_portlet\x3fp_l_id\x3d50657388\x26p_p_id\x3d114\x26p_p_lifecycle\x3d0\x26p_p_col_id\x3dcolumn-1\x26p_p_col_pos\x3d1\x26p_p_col_count\x3d2\x26p_t_lifecycle\x3d0\x26p_p_state\x3dnormal\x26p_p_mode\x3dview\x26p_p_col_id\x3dcolumn-1\x26p_p_col_pos\x3d1\x26p_p_col_count\x3d2\x26p_p_static\x3d1\x26p_p_static_start\x3d1\x26p_p_isolated\x3d1\x26currentURL\x3d\x252Fweb\x252Fuser\x2e26526\x252Fblog\x253Fp_p_id\x253D58\x2526p_p_lifecycle\x253D0\x2526p_p_state\x253Dnormal\x2526p_p_state_rcv\x253D1\x2526_58_struts_action\x253D\x2525252Flogin\x2525252Flogin"});Liferay.provide(window,"_33_curupdateCur",function(c){var a=AUI();var d=a.one(c).val();if(true){var b="https://web.liferay.com/web/user.26526/blog?p_p_id=33&p_p_lifecycle=0&p_p_state=normal&p_p_mode=view&p_p_col_id=column-2&p_p_col_count=1&_33_struts_action=%2Fblogs%2Fview&_33_delta=20&_33_keywords=&_33_advancedSearch=false&_33_andOperator=true&p_r_p_564233524_resetCur=false&_33_cur="+d+"";location.href=b}else{document._33_fm.cur.value=d}},["aui-base"]);Liferay.provide(window,"_33_deltaupdateDelta",function(c){var a=AUI();var d=a.one(c).val();if(true){var b="https://web.liferay.com/web/user.26526/blog?p_p_id=33&p_p_lifecycle=0&p_p_state=normal&p_p_mode=view&p_p_col_id=column-2&p_p_col_count=1&_33_struts_action=%2Fblogs%2Fview&_33_keywords=&_33_advancedSearch=false&_33_andOperator=true&p_r_p_564233524_resetCur=false&_33_delta="+d+"";location.href=b}else{document._33_fm.delta.value=d}},["aui-base"]);Liferay.Portlet.onLoad({canEditTitle:false,columnPos:0,isStatic:"start",namespacedId:"p_p_id_33_",portletId:"33",refreshURL:"\x2fc\x2fportal\x2frender_portlet\x3fp_l_id\x3d50657388\x26p_p_id\x3d33\x26p_p_lifecycle\x3d0\x26p_p_col_id\x3dcolumn-2\x26p_p_col_count\x3d1\x26p_t_lifecycle\x3d0\x26p_p_state\x3dnormal\x26p_p_mode\x3dview\x26p_p_col_id\x3dcolumn-2\x26p_p_col_pos\x3d0\x26p_p_col_count\x3d1\x26p_p_static\x3d1\x26p_p_static_start\x3d1\x26p_p_isolated\x3d1\x26currentURL\x3d\x252Fweb\x252Fuser\x2e26526\x252Fblog\x253Fp_p_id\x253D58\x2526p_p_lifecycle\x253D0\x2526p_p_state\x253Dnormal\x2526p_p_state_rcv\x253D1\x2526_58_struts_action\x253D\x2525252Flogin\x2525252Flogin"});Liferay.Portlet.onLoad({canEditTitle:false,columnPos:0,isStatic:"start",namespacedId:"p_p_id_13_WAR_osbportlet_",portletId:"13_WAR_osbportlet",refreshURL:"\x2fc\x2fportal\x2frender_portlet\x3fp_l_id\x3d50657388\x26p_p_id\x3d13_WAR_osbportlet\x26p_p_lifecycle\x3d0\x26p_p_col_id\x3dcolumn-1\x26p_p_col_count\x3d2\x26p_t_lifecycle\x3d0\x26p_p_state\x3dnormal\x26p_p_mode\x3dview\x26p_p_col_id\x3dcolumn-1\x26p_p_col_pos\x3d0\x26p_p_col_count\x3d2\x26p_p_static\x3d1\x26p_p_static_start\x3d1\x26p_p_isolated\x3d1\x26currentURL\x3d\x252Fweb\x252Fuser\x2e26526\x252Fblog\x253Fp_p_id\x253D58\x2526p_p_lifecycle\x253D0\x2526p_p_state\x253Dnormal\x2526p_p_state_rcv\x253D1\x2526_58_struts_action\x253D\x2525252Flogin\x2525252Flogin"});Liferay.Portlet.onLoad({canEditTitle:false,columnPos:0,isStatic:"end",namespacedId:"p_p_id_1_WAR_samlportlet_",portletId:"1_WAR_samlportlet",refreshURL:"\x2fc\x2fportal\x2frender_portlet\x3fp_l_id\x3d50657388\x26p_p_auth\x3d3vjOIewD\x26p_p_id\x3d1_WAR_samlportlet\x26p_p_lifecycle\x3d0\x26p_t_lifecycle\x3d0\x26p_p_state\x3dnormal\x26p_p_mode\x3dview\x26p_p_col_id\x3d\x26p_p_col_pos\x3d0\x26p_p_col_count\x3d0\x26p_p_isolated\x3d1\x26currentURL\x3d\x252Fweb\x252Fuser\x2e26526\x252Fblog\x253Fp_p_id\x253D58\x2526p_p_lifecycle\x253D0\x2526p_p_state\x253Dnormal\x2526p_p_state_rcv\x253D1\x2526_58_struts_action\x253D\x2525252Flogin\x2525252Flogin"});AUI().use("aui-base","liferay-form","liferay-icon","liferay-menu","liferay-notice","liferay-poller","liferay-search-container",function(a){(function(){new Liferay.SearchContainer({classNameHover:"hover",hover:true,id:"_114_ocerSearchContainer",rowClassNameAlternate:"portlet-section-alternate",rowClassNameAlternateHover:"portlet-section-alternate-hover",rowClassNameBody:"portlet-section-body",rowClassNameBodyHover:"portlet-section-body"}).render()})();(function(){Liferay.Icon.register({forcePost:true,id:"_33_rjus"})})();(function(){Liferay.Icon.register({forcePost:true,id:"_33_ctvk"})})();(function(){Liferay.Form.register({id:"_33_fm1",fieldRules:[]})})();(function(){Liferay.Util.addInputType();Liferay.Portlet.ready(function(b,c){Liferay.Util.addInputType(c)})})();(function(){new Liferay.Menu();var b=Liferay.Data.notices;for(var c=1;c<b.length;c++){new Liferay.Notice(b[c])}})()});/*]]>*/</script> 
  <script src="https://platform.twitter.com/widgets.js" type="text/javascript"></script> 
  <script src="https://connect.facebook.net/en_US/all.js#xfbml=1"></script> 
  <script src="https://apis.google.com/js/plusone.js" type="text/javascript">/*<![CDATA[*/lang:"English";/*]]>*/</script> 
  <script src="https://web.liferay.com/osb-community-theme/js/main.js?browserId=other&amp;minifierType=js&amp;languageId=en_US&amp;b=6120&amp;t=1506729969000" type="text/javascript"></script> 
  <script type="text/javascript"></script>   
 </body>
</html>