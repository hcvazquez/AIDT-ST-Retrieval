<!doctype html>
<!--[if IE 8]> <html class="ie8" lang="en"><![endif]-->
<!--[if IE 9]> <html class="ie9" lang="en"><![endif]-->
<!--[if gt IE 9]><!-->
<html lang="en">
 <!---->
 <!--[endif]---->
 <head>
  <title>Java-backed Web Scripts Samples | Alfresco Community</title>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="Obsolete Pages{{Obsolete}}   The official documentation is at: http://docs.alfresco.com     Web Scripts    Table of Contents  1 Overview  2 The Demo Web">
  <meta name="keywords" content="web scripts">
  <meta name="viewport" content="user-scalable=0, initial-scale=1.0"> 
  <script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script>
  <link rel="stylesheet" href="https://community.alfresco.com/2016.3.8.657a983/styles/jive-font-face.css" type="text/css" media="all">
  <!--[if IE]><link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/jive.ie.css" type="text/css" media="all"/><![endif]-->
  <!--[if !IE]> -->
  <link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/jive.css" type="text/css" media="all">
  <!-- <![endif]-->
  <link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/jive-visor.css" type="text/css" media="all">
  <!--[if IE]><link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/jive_content_redesign.ie.css" type="text/css" media="all"/><![endif]-->
  <!--[if !IE]> -->
  <link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/jive_content_redesign.css" type="text/css" media="all">
  <!-- <![endif]-->
  <!--[if IE]><link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/tiny_mce4/themes/advanced/skins/default/content.ie.css" type="text/css" media="all"/><![endif]-->
  <!--[if !IE]> -->
  <link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/tiny_mce4/themes/advanced/skins/default/content.css" type="text/css" media="all">
  <!-- <![endif]-->
  <link rel="search" href="/opensearch.xml" title="Alfresco Community" type="application/opensearchdescription+xml">
  <link rel="shortcut icon" type="image/x-icon" href="/resources/images/palette-1015/faviconImage-1473362516761-favicon.ico">
  <!--[if lt IE 9]><script src="https://assets2.jiveon.com/core/2016.3.8.0.657a983/resources/scripts/vendor/html5shiv/html5shiv.js"></script><![endif]-->
  <!--[if IE]><script>
            // Avoid 'console' errors in browsers that lack a console.
            (function() {
               var method;
               var noop = function () {};
               var methods = [
                   'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',
                   'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',
                   'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',
                   'timeStamp', 'trace', 'warn'
               ];
               var length = methods.length;
               var console = (window.console = window.console || {});

               while (length--) {
                   method = methods[length];

                   // Only stub undefined methods.
                   if (!console[method]) {
                       console[method] = noop;
                   }
               }
            }());
        </script><![endif]-->
  <script>(function() {var prepareUrl = function(url) {if (url.indexOf(";") > 0) {url = url.substring(0, url.indexOf(";"));}if (url.charAt(url.length - 1) == '/') {url = url.substring(0, url.length - 1);}return url;}; if (typeof(window._jive_base_url) == "undefined") {window._jive_base_url = prepareUrl("\/")}if (typeof(window._jive_base_absolute_url) == "undefined") {window._jive_base_absolute_url = prepareUrl("https:\/\/community.alfresco.com")}if (typeof(window._jive_resource_url) == "undefined") {window._jive_resource_url = prepareUrl("https:\/\/assets2.jiveon.com\/core\/2016.3.8.0.657a983\/")}if (typeof(window._jive_theme_url) == "undefined") {window._jive_theme_url = prepareUrl("\/themes\/\/")}if (typeof(window._jive_current_user) == "undefined") {window._jive_current_user = {anonymous: true, partner: false, visible: true, username: 'ANONYMOUS', ID: '-1', enabled: true, avatarID: '-1', displayName: 'ANONYMOUS'};}})(); var _jive_effective_user_id = "-1"; var _jive_auth_token ="no-user"; var _jive_locale = "en"; var _jive_translation_language = "en"; var _jive_display_language = "en"; var _jive_browser_event = {"providers":["activityStream.poll","appAlert.create","inboxCount.poll"],"since":1507049274868}; var _jive_browser_event_polling_delay =  30000.0 ; var _jive_socket_events = {"socketEvents":["activityStream.push","tiledata.push"]}; var _jive_realtime_push_enabled =  false ; var _jive_allstream_counts_enabled =  false ; var _jive_playbox_enabled =  true ;var _jive_timezoneoffset =  1.0 ; var _jive_server_timezoneoffset =  1.0 ; var _jive_timezone_id = 'Europe\/Dublin'; var _jive_enable_browserdb =  false ; var jive = jive || {}; jive.global = jive.global || {}; jive.global.instanceID = 'eabb85ec-a958-4a44-8dfd-b18b11ae0532'; jive.global.containerType = '14'; jive.global.containerID = '2004';jive.global.containerBrowseId = '1196';jive.global.subdomain = {}; jive.global.subdomain.mode = 'single'; jive.global.subdomain.template = 'https:\/\/app-community.alfresco.com%path%'; jive.global.extensions = {"386db4e0-3957-4e32-938d-197261c9d0b4":"e2e54915db","fde78d67-01d1-4c57-ba7f-4ee3c94234ab":"b6bc0d769f","185191ef-772a-4541-8b5a-411108dda0fa":"52416ce682"}; jive.global.galaEnabled =  false ; window.SPELL_LANGS = "English (Canada)\x3den_ca,English (United Kingdom)\x3den_gb,+English (United States)\x3den_us,French\x3dfr,French (Canada)\x3dfr_ca,German\x3dde,Italian\x3dit,Spanish\x3des"; window.CS_BASE_URL = ""; window.CS_RESOURCE_BASE_URL = "https:\/\/assets2.jiveon.com\/core\/2016.3.8.0.657a983"; window.CS_ABSOLUTE_RESOURCE_BASE_URL = "https:\/\/community.alfresco.com\/2016.3.8.657a983\/";window.tinyMCEPreInit = {suffix : "", base : CS_BASE_URL + "/resources/scripts/vendor/tinymce"};if (typeof(_jive_project_i18n) == "undefined") {var _jive_project_i18n = new Array(); _jive_project_i18n['project.calendar.task'] = "Task"; _jive_project_i18n['project.calendar.tasks'] = "Tasks"; _jive_project_i18n['project.calendar.checkpoint'] = "Checkpoint"; _jive_project_i18n['project.calendar.checkpoints'] = "Checkpoints"; _jive_project_i18n['global.edit'] = "Edit"; _jive_project_i18n['global.delete'] = "Delete"; _jive_project_i18n['project.task.mark.complete'] = "Mark complete"; _jive_project_i18n['project.task.assign.to.me'] = "Assign to me"; _jive_project_i18n['task.incomplete.link'] = "Incomplete"; _jive_project_i18n['project.checkPoint.create.link'] = "Create a checkpoint"; _jive_project_i18n['project.task.create.link'] = "Create a task";}</script>
  <script src="https://assets2.jiveon.com/core/2016.3.8.0.657a983/resources/scripts/gen/main.js?salt=749823749234"></script>
  <script>requirejs.config({baseUrl: 'https://assets2.jiveon.com/core/2016.3.8.0.657a983/resources/scripts/', paths: {'jiveCoreApiV3': '/resources/scripts/gen/v3/cf3810225d7e1dbc335fb91ca37b9c2b','shindig': '/gadgets/js/jive-core-container:container:core:rpc:open-views:selection:actions.js?c=1&container=default', 'plugins': 'https://community.alfresco.com/2016.3.8.657a983/plugins', 'dwr/interface' : 'https://community.alfresco.com/2016.3.8.657a983/dwr/interface', 'dwr'    : 'https://community.alfresco.com/2016.3.8.657a983/resources/scripts/dwr','tinyMCE': 'vendor/tinymce/tinymce'},bundles: {'gen/soy/eae/common': [ 'soy!jive.eae.common.activityAuthor', 'soy!jive.eae.common.activityAuthorAndOnBehalfOfNoVerb', 'soy!jive.eae.common.activityAuthorNoVerb', 'soy!jive.eae.common.activityContainer', 'soy!jive.eae.common.activityContainerJoSubject', 'soy!jive.eae.common.activityContentCommon', 'soy!jive.eae.common.activityContentText', 'soy!jive.eae.common.activityHeadingHref', 'soy!jive.eae.common.activityHeadingHrefWithReferringUser', 'soy!jive.eae.common.activityHelpfulCounts', 'soy!jive.eae.common.activityNavActions', 'soy!jive.eae.common.collapsedExcerptText', 'soy!jive.eae.common.contentTypeClassName', 'soy!jive.eae.common.contentTypeDisplayName', 'soy!jive.eae.common.contentTypeParentPreviewStylingClassName', 'soy!jive.eae.common.currentCountText', 'soy!jive.eae.common.digestSubItem', 'soy!jive.eae.common.displayParentAuthor', 'soy!jive.eae.common.embeddedPreview', 'soy!jive.eae.common.entryRepost', 'soy!jive.eae.common.formatMediaLinkUrl', 'soy!jive.eae.common.formatMediaLinkUrl__C2bf6', 'soy!jive.eae.common.generateUserMetaData', 'soy!jive.eae.common.groupedUsers', 'soy!jive.eae.common.jsI18nHelper', 'soy!jive.eae.common.loadingSpinner', 'soy!jive.eae.common.microRTEContainer', 'soy!jive.eae.common.parentPreviewLinks', 'soy!jive.eae.common.parentPreviewLinksInline', 'soy!jive.eae.common.readingPaneBottomReplyLinkKey', 'soy!jive.eae.common.renderStreamAttachments', 'soy!jive.eae.common.repliedToIcon', 'soy!jive.eae.common.replyCountText', 'soy!jive.eae.common.replyingToText', 'soy!jive.eae.common.repostModal', 'soy!jive.eae.common.repostModalSuccess', 'soy!jive.eae.common.rtePanel', 'soy!jive.eae.common.rteTextArea', 'soy!jive.eae.common.sharedVia', 'soy!jive.eae.common.streamImage', 'soy!jive.eae.common.subactivity' ]},urlArgs: 'salt=' + '749823749234',locale: 'en', config: {'l10n': {locale: 'en'}, 'soy': {baseUrl: 'https://community.alfresco.com/2016.3.8.657a983/resources/scripts/'}}});requirejs.config({paths: {'jiveCoreApiV3': 'https://community.alfresco.com/resources/scripts/gen/v3/cf3810225d7e1dbc335fb91ca37b9c2b','shindig': 'https://community.alfresco.com/gadgets/js/jive-core-container:container:core:rpc:open-views:selection:actions.js?c=1&container=default', 'gen/soy': 'https://community.alfresco.com/2016.3.8.657a983/resources/scripts/gen/soy', 'tinymce/i18n': 'https://community.alfresco.com/2016.3.8.657a983/resources/scripts/tinymce/i18n'}});</script>
  <script>requirejs.config({config: {'application/config': {'allStreamCountsEnabled':  false , 'anyAppsEnabled':  false , 'appsAvailable':  false , 'appsRteActionsAvailble':  false , 'authToken': 'no-user', 'browserDbEnabled':  false , 'browserEventQuery': JSON.parse('{\x22providers\x22:[\x22activityStream.poll\x22,\x22appAlert.create\x22,\x22inboxCount.poll\x22],\x22since\x22:1507049274868}'), 'browserEventsPollingDelay': '30000', 'containerBrowseId': '1196', 'communityName': 'Alfresco Community', 'containerId': '2004', 'containerType': '14', 'currentUser': JSON.parse('{\x22type\x22:3,\x22link\x22:\x22\/people\/ANONYMOUS\x22,\x22subject\x22:\x22ANONYMOUS\x22,\x22iconCss\x22:\x22jive-icon-profile\x22,\x22archetype\x22:\x22people\x22,\x22thumbnailTemplate\x22:\x22jive.browse.user.thumbnailUserItem\x22,\x22detailTemplate\x22:\x22jive.browse.user.detailUserItem\x22,\x22objectTypeName\x22:null,\x22objectTypeFeatureName\x22:null,\x22displayExternallyVisibleVisualCue\x22:false,\x22prop\x22:{\x22isVisibleToPartner\x22:false,\x22search\x22:{\x22defaultEnabled\x22:true},\x22avatarID\x22:\x22-1\x22,\x22profile\x22:{\x22lastLoggedInDate\x22:null,\x22primaryURL\x22:null,\x22expertise\x22:null,\x22homeAddress\x22:null,\x22biography\x22:null,\x22primaryEmailAddressVisible\x22:false,\x22mobilePhoneNumber\x22:null,\x22primaryPhoneNumber\x22:null,\x22initialLoginDate\x22:null,\x22title\x22:null,\x22primaryEmailAddress\x22:null,\x22strictJoinDate\x22:null,\x22department\x22:null,\x22faxNumber\x22:null,\x22alternateEmailAddress\x22:null,\x22alternatePhoneNumber\x22:null,\x22occupation\x22:null,\x22joinDate\x22:null,\x22pagerNumber\x22:null,\x22company\x22:null,\x22hireOrJoinDate\x22:null,\x22homePhoneNumber\x22:null,\x22address\x22:null,\x22location\x22:null,\x22url\x22:null,\x22timeZone\x22:null},\x22profileImage\x22:{\x22url\x22:\x22\/images\/jive-profile-default-portrait.png\x22,\x22highDensityURL\x22:null,\x22viewingSelf\x22:false,\x22profileEvolution\x22:true,\x22default\x22:true},\x22presence\x22:{\x22userExternalID\x22:null,\x22online\x22:false,\x22jsObject\x22:\x22null\x22}},\x22username\x22:\x22ANONYMOUS\x22,\x22displayName\x22:\x22ANONYMOUS\x22,\x22initialLoginDate\x22:null,\x22anonymous\x22:true,\x22enabled\x22:true,\x22external\x22:false,\x22partner\x22:false,\x22email\x22:null,\x22entitled\x22:true,\x22visible\x22:true,\x22avatarID\x22:\x22-1\x22,\x22id\x22:\x22-1\x22,\x22objectType\x22:3,\x22modificationTime\x22:null,\x22unmodified\x22:true,\x22modificationDate\x22:null,\x22creationTime\x22:null,\x22creationDate\x22:null}'), 'galaEnabled':  false , 'galaURL': '', 'instanceId': 'eabb85ec-a958-4a44-8dfd-b18b11ae0532', 'jqueryNoConflict':  true , 'locale': 'en', 'onboardingEnabled':  false , 'realtimeCommunicationsEnabled':  false , 'realtimeEnabled':  false , 'realtimePushEnabled':  false , 'realtimeStatsEnabled':  false , 'serverTimeZoneOffset':  1.0 , 'socketEvents': JSON.parse('{\x22socketEvents\x22:[\x22activityStream.push\x22,\x22tiledata.push\x22]}'), 'timezoneId': 'Europe\/Dublin', 'timezoneOffset':  1.0 , 'translationLanguage': 'en', 'integrationTranslationLanguage': 'en', 'tinymce4Enabled':  true , 'groupMembershipEvolutionEnabled':  true , 'workGroupsEnabled':  false , 'playboxEnabled':  true , 'playboxChallengeEnabled':  true , 'playboxChallengeTauntEnabled':  false , 'userPanelEnabled':  true , 'userBadgesEnabled':  true ,'jsPageController': 'page/content/controller','pageConfig': JSON.parse('{\x22containerId\x22:2004,\x22containerType\x22:14}'),'baseUrl': '/', 'absoluteBaseUrl': 'https://community.alfresco.com/', 'resourceUrl': 'https://assets2.jiveon.com/core/2016.3.8.0.657a983/', 'originResourceUrl': 'https://community.alfresco.com/2016.3.8.657a983/', 'themeUrl': '/themes/', 'cssUrl': 'https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/'}}});</script>
  <script>require(['main']);</script>
  <script>require(['apps/tips/main', 'domReady!'], function() {var tipsApp = new jive.Tips.Main({tipGroups:[], skippedTipGroupIDs: []});});</script>
  <link rel="stylesheet" href="https://assets2.jiveon.com/core/2016.3.8.0.657a983/styles/jive-responsive.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://community.alfresco.com/2016.3.8.657a983/plugins/gamification_2016.3.8.0/resources/styles/n4jive.concat.css" type="text/css" media="all">
  <link class="j-custom-theme" rel="stylesheet" href="https://community.alfresco.com/2016.3.8.657a983/resources/styles/palette-1015/1504696542226.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://community.alfresco.com/2016.3.8.657a983/resources/styles/exobjects-icons/jive-exobjects-icons.css" type="text/css" media="all">
 </head>
 <body class="jive-body-content j-design-latest j-content-document j-header-mode-custom  j-simple-homepage j-tinymce4-enabled ">
  <a id="top"></a>
  <a href="#j-main" class="j-508-label">Skip navigation</a>
  <div id="j-header-wrap" data-company-name="Alfresco" data-no-user-bar="false" role="banner">
   <header id="j-compact-header" class="clearfix">
    <!-- Customer generated HTML -->
    <div id="j-cust-head" class="clearfix">
     <div class="custom-header"> 
      <a class="logo" href="/"> <img src="/resources/images/palette-1015/logo.png"> </a> 
      <div id="spacer">
       &nbsp;
      </div> 
     </div>
    </div>
    <!-- Navigational buttons/links -->
    <nav id="j-globalNav-bg" role="navigation" aria-label="Jive" data-mode="custom">
     <ul id="j-globalNav" role="menubar" class="j-globalNav">
      <li id="mobile-menu" class="mobile-tool"><a class="" href="#"><span><i></i><i></i><i></i></span></a></li>
      <li class="j-simple-nav-logo j-globalNav-li"><a class="j-simple-logo js-logo j-globalNavLink" href="/"><img src="https://community.alfresco.com/2016.3.8.657a983/resources/images/palette-1015/customNavLogoImage-1473362516743-logo-icon.png"></a></li>
      <li id="jive-nav-link-home" class=" j-globalNav-li j-ui-elem"><a href="/welcome" class="j-globalNavLink j-ui-elem " role="menuitem"><span class="nav-link  ">Home</span></a></li>
      <li id="customLink0" aria-haspopup="true" class=" j-globalNav-li j-custom-link j-ui-elem"><a href="#" class="j-globalNavLink j-ui-elem " role="menuitem"><span class="nav-link   j-ui-elem">Alfresco Forums<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></span></a>
       <div id="customLink0-menu" class="j-pop-main j-menu j-quick-menu j-nav-menu-link-list" style="display: none;">
        <ul>
         <li><a id="customLink0-0" href="/community/ecm" class="j-ui-elem"><span class="lnk">Content Services (ECM)</span></a></li>
         <li><a id="customLink0-1" href="https://community.alfresco.com/community/bpm" class="j-ui-elem"><span class="lnk">Process Services (BPM)</span></a></li>
         <li><a id="customLink0-2" href="/community/application-development-framework" class="j-ui-elem"><span class="lnk">Application Development Framework</span></a></li>
         <li><a id="customLink0-3" href="https://community.alfresco.com/community/devops" class="j-ui-elem"><span class="lnk">DevOps</span></a></li>
         <li><a id="customLink0-4" href="https://community.alfresco.com/community/platform" class="j-ui-elem"><span class="lnk">Digital Business Platform</span></a></li>
        </ul>
       </div></li>
      <li id="customLink1" aria-haspopup="true" class=" j-globalNav-li j-custom-link j-ui-elem"><a href="#" class="j-globalNavLink j-ui-elem " role="menuitem"><span class="nav-link   j-ui-elem">Connect<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></span></a>
       <div id="customLink1-menu" class="j-pop-main j-menu j-quick-menu j-nav-menu-link-list" style="display: none;">
        <ul>
         <li><a id="customLink1-0" href="https://community.alfresco.com/people" class="j-ui-elem"><span class="lnk">Find People</span></a></li>
         <li><a id="customLink1-1" href="https://community.alfresco.com/rewards/leaderboards" class="j-ui-elem"><span class="lnk">Leaderboard</span></a></li>
         <li><a id="customLink1-2" href="/community/connect/pages/announcements-opportunities" class="j-ui-elem"><span class="lnk">Announcements &amp; Opportunities</span></a></li>
         <li><a id="customLink1-3" href="https://community.alfresco.com/community/collaborate" class="j-ui-elem"><span class="lnk">Collaborate</span></a></li>
         <li><a id="customLink1-4" href="https://community.alfresco.com/news" class="j-ui-elem"><span class="lnk">News</span></a></li>
         <li><a id="customLink1-5" href="https://community.alfresco.com/community/connect/blog" class="j-ui-elem"><span class="lnk">Featured Members</span></a></li>
         <li><a id="customLink1-6" href="https://community.alfresco.com/groups/alfresco-ambassador-program" class="j-ui-elem"><span class="lnk">Alfresco Ambassador Program</span></a></li>
        </ul>
       </div></li>
      <li id="customLink2" aria-haspopup="true" class=" j-globalNav-li j-custom-link j-ui-elem"><a href="#" class="j-globalNavLink j-ui-elem " role="menuitem"><span class="nav-link   j-ui-elem">Language Groups<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></span></a>
       <div id="customLink2-menu" class="j-pop-main j-menu j-quick-menu j-nav-menu-link-list" style="display: none;">
        <ul>
         <li><a id="customLink2-0" href="https://community.alfresco.com/groups/french-user-group" class="j-ui-elem"><span class="lnk">French</span></a></li>
         <li><a id="customLink2-1" href="https://community.alfresco.com/groups/portuguese-user-group" class="j-ui-elem"><span class="lnk">Portuguese</span></a></li>
         <li><a id="customLink2-2" href="https://community.alfresco.com/groups/spanish-user-group" class="j-ui-elem"><span class="lnk">Spanish</span></a></li>
         <li><a id="customLink2-3" href="https://community.alfresco.com/groups/italian-user-group" class="j-ui-elem"><span class="lnk">Italian</span></a></li>
         <li><a id="customLink2-4" href="https://community.alfresco.com/groups/german-user-group" class="j-ui-elem"><span class="lnk">German</span></a></li>
         <li><a id="customLink2-5" href="https://community.alfresco.com/groups/japanese-user-group" class="j-ui-elem"><span class="lnk">Japanese</span></a></li>
         <li><a id="customLink2-6" href="https://community.alfresco.com/groups/swedish-user-group" class="j-ui-elem"><span class="lnk">Swedish</span></a></li>
        </ul>
       </div></li>
      <li id="customLink3" class=" j-globalNav-li j-custom-link j-ui-elem"><a href="https://community.alfresco.com/community/about-this-community" class="j-globalNavLink j-ui-elem " role="menuitem"><span class="nav-link  ">Forum Help</span></a></li>
      <li id="customLink4" class=" j-globalNav-li j-custom-link j-ui-elem"><a href="https://community.alfresco.com/external-link.jspa?url=https%3A%2F%2Fwww.alfresco.com" class="j-globalNavLink j-ui-elem " target="_blank" role="menuitem"><span class="nav-link  ">Alfresco.com</span></a></li>
     </ul>
     <div id="j-links">
      <ul class="j-globalNav">
       <li class="j-nav-create j-nav-user j-globalNav-li js-satellite-nav-container" aria-haspopup="true">
        <ul id="j-satNav">
         <li class="login"><a href="#" class="login" id="navLogin" title="Log in">Log in</a></li>
         <li class="register"><a href="/login.jspa?registerOnly=true" class="register" title="Register" id="jive-nav-link-reg">Register</a></li>
        </ul>
        <div id="j-satNav-menu" class="clearfix" style="display:none;"></div><span data-count="0" tabindex="-1" aria-label="Inbox" class="j-js-update-indicator j-update-count zero  j-navbadge-count j-ui-elem" style="display:none;">0</span></li>
       <li id="j-nav-search-li" class="j-nav-open-visor j-globalNav-li js-nav-open-visor-container j-nav-create" aria-haspopup="true"><label for="j-nav-search" class="j-508-label">Search</label><a href="#" id="j-nav-search" class="j-globalNavLink j-ui-elem" role="menuitem" data-hideviews="bookmarks default history" data-hidetypes=""><span class="nav-link j-ui-elem"><i class="icon-search"></i></span><span class="j-508-label">Search</span></a></li>
       <li id="mobile-search" class="j-globalNav-li mobile-tool"><a class="j-globalNavLink" href="#"></a></li>
      </ul>
      <div id="j-spotlight-search" role="search" data-mode="custom">
       <span class="j-ui-elem j-search-left"><span id="searchpopupanchor"></span></span>
       <span><label for="autosearch" class="j-508-label">Search</label><input data-spotlight-enabled="false" id="autosearch" class="j-ui-elem" data-component="autosearch" data-popup-anchor="searchpopupanchor" placeholder="Search" type="text" role="combobox" aria-labelledby="autosearch" aria-expanded="false" data-hidetypes="bookmarks frequent recent " data-community-name="Alfresco Community" data-filters="" data-origin="spotlight" aria-hidden="true" aria-busy="true"><a href="#" id="mob-spotlight-cancel" title="Cancel"><span class="j-508-label">Cancel</span><span class="jive-icon-glyph icon-close-thin"></span></a></span>
       <span class="j-ui-elem j-search-right"></span>
       <span class="jive-icon-sml jive-glyph-delete" data-component="button" data-type="clear" data-field="autosearch"></span>
      </div>
     </div>
    </nav>
   </header>
   <noscript>
    <div class="j2-base-chrome-no-script">
     Error: You don't have JavaScript enabled. This tool uses JavaScript and much of it will not work correctly without it enabled. Please turn JavaScript back on and reload this page.
    </div>
   </noscript>
  </div>
  <div id="mobile-overlay"></div>
  <div class="j-breadcrumb-bar">
   <div class="j-wrap clearfix">
    <script>require([ 'apps/outcomes/badgeHelper', 'apps/outcomes/eventShim' ], function(badgeHelper) {badgeHelper.enableHeaderBadges();});</script>
    <div id="jive-breadcrumb" class="j-breadcrumb">
     <script>require(['breadcrumb', 'jive/contentplace_relationship']);</script>
     <span><a class="jive-breadcrumb-last" href="/places">All Places</a> &gt; <a href="/community/ecm">Alfresco Content Services (ECM)</a> &gt; <a class="jive-breadcrumb-last" href="/community/ecm/content?filterID=contentstatus%5Bpublished%5D~objecttype~objecttype%5Bdocument%5D">Documents</a><span id="js-place-link-breadcrumb" data-place-link-count="0" data-linked-content-id="5462" data-linked-content-type="102" data-legacy="true" data-place="true" data-parents="true"></span></span>
    </div>
    <nav class="j-content-actions">
     <ul class="clearfix" role="toolbar" aria-label="Social Actions"></ul>
    </nav>
    <div class="j-content-mobile-menu js-content-mobile-menu" data-jive-view="apps/content/menus/navbar">
     <a href="#" id="mobile-sidenav-btn"></a>
    </div>
   </div>
  </div>
  <div class="j-messages-wrapper j-content-info" role="status" aria-live="polite" aria-atomic="true" tabindex="-1">
   <ul class="js-outcome-badge-container js-outcome-badge-container-top j-outcome-badge-container j-outcome-badge-container-top-v2 js-ed-102-5462" data-object-type="102" data-object-id="5462" data-object-type-name="document" aria-label="Outcome badges" data-allowed-outcome-types="[&quot;finalized&quot;,&quot;outdated&quot;,&quot;official&quot;,&quot;wip&quot;]" data-use-v2-outcomes="true" aria-live="polite"></ul>
   <div class="j-content-info-item">
    <div class="j2-base-components-global-guest-call-to-action">
     <span><a id="jive-guest-link-auth" href="/login.jspa">Log in</a> to create and rate content, and to follow, bookmark, and share content with other members.&nbsp;Not a member? <a href="/login.jspa?registerOnly=true">Join Now!</a></span>
    </div>
   </div>
   <div class="j-content-info-item" aria-atomic="true" role="alert" aria-live="assertive" tabindex="-1" style="display:none;"></div>
   <div id="object-follow-notify" class="j-content-info-item" style="display:none" aria-live="polite" aria-atomic="true"></div>
   <div id="content-featured-notify" class="j-content-info-item" style="display:none" aria-live="polite" aria-atomic="true"></div>
  </div>
  <div id="j-main-wrapper" class="j2-base-chrome-main-wrapper">
   <section id="j-main" class="clearfix">
    <div id="jive-body" class="clearfix">
     <div id="jive-body-main" class="js-tlo js-ed-102-5462" data-object-id="5462" data-object-type="102">
      <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","headline":"Java-backed Web Scripts Samples","articleBody":"\u003cbody\u003e\u003c!-- [DocumentBodyStart:627d9009-01f6-477e-9cb8-eecf2ae2acc9] --\u003e\u003cdiv class\u003d\"jive-rendered-content\"\u003e\u003cp\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwiki.alfresco.com%2Fwiki%2FCategory%3AObsolete_Pages\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eObsolete Pages\u003c/a\u003e{{Obsolete}}\u003cbr/\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003cspan\u003eThe official documentation is at: \u003c/span\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"http://docs.alfresco.com\" rel\u003d\"nofollow\"\u003ehttp://docs.alfresco.com\u003c/a\u003e\u003c/strong\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp\u003e\u003cbr/\u003e\u003cbr/\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FCategory%3AWeb_Scripts\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eWeb Scripts\u003c/a\u003e\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cdiv\u003e\u003ch2\u003eTable of Contents\u003c/h2\u003e\u003cbr/\u003e\u003cul\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_overview\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e1\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eOverview\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_thedemowebscripts\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e2\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eThe Demo Web Scripts\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"\" href\u003d\"https://community.alfresco.com/#w_simplewebscript-java\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eSimpleWebScript.java\u003c/span\u003e\u003c/a\u003e\u003cbr/\u003e\u003cul\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_whyjson3f\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3.1\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eWhy JSON?\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_writingthewebscript28java29\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3.2\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eWriting the Web Script (Java)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_declaringthewebscript28spring29\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3.3\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDeclaring the Web Script (Spring)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_describingthewebscript28xml29\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3.4\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDescribing the Web Script (XML)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_tryitout\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3.5\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eTry it out\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_locationsofthefiles\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e3.6\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eLocations of the files\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003c/ul\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"\" href\u003d\"https://community.alfresco.com/#w_randomselectwebscript-java\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e4\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eRandomSelectWebScript.java\u003c/span\u003e\u003c/a\u003e\u003cbr/\u003e\u003cul\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_writingthewebscript28java29_2\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e4.1\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eWriting the Web Script (Java)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_declaringthewebscript28spring29_2\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e4.2\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDeclaring the Web Script (Spring)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_describingthewebscript28xml29_2\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e4.3\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDescribing the Web Script (XML)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_tryitout_2\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e4.4\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eTry it out\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003c/ul\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"\" href\u003d\"https://community.alfresco.com/#w_renditionwebscript-java\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eRenditionWebScript.java\u003c/span\u003e\u003c/a\u003e\u003cbr/\u003e\u003cul\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_customcontentmodel\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5.1\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eCustom Content Model\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_customtransformers\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5.2\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eCustom Transformers\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_writingthewebscript28java29_3\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5.3\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eWriting the Web Script (Java)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_declaringthewebscript28spring29_3\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5.4\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDeclaring the Web Script (Spring)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_describingthewebscript28xml29_3\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5.5\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDescribing the Web Script (XML)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_tryitout_3\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e5.6\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eTry it out\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003c/ul\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"\" href\u003d\"https://community.alfresco.com/#w_simpledeclarativewebscript-java\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e6\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eSimpleDeclarativeWebScript.java\u003c/span\u003e\u003c/a\u003e\u003cbr/\u003e\u003cul\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_writingthewebscript28java29_4\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e6.1\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eWriting the Web Script (Java)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_declaringthewebscript28spring29_4\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e6.2\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDeclaring the Web Script (Spring)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_describingthewebscript28xml29_4\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e6.3\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDescribing the Webscript (XML)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_describingthewebscript27srenditionstemplates28ftl29\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e6.4\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eDescribing the Webscript\u0027s renditions templates (FTL)\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-2\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_tryitout_4\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e6.5\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eTry it out\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003c/ul\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_troubleshooting\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e7\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eTroubleshooting\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003cli class\u003d\"toclevel-1\"\u003e\u003ca class\u003d\"jive-link-anchor-small\" href\u003d\"#w_questions3f\"\u003e\u003cspan class\u003d\"tocnumber\"\u003e8\u003c/span\u003e \u003cspan class\u003d\"toctext\"\u003eQuestions?\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\u003cbr/\u003e\u003c/ul\u003e\u003c/div\u003e\u003ch1\u003eOverview\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003eDuring the 2008 Alfresco Barcelona Community Conference, we had a chance to look at how Alfresco\u0027s \u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eWeb Scripts\u003c/a\u003e are used in a variety of interesting applications.\u0026#160; Most applications took advantage of an out-of-the-box Web Script implementation known as a declarative web script.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eTo keep things simple, we can think of a declarative web script as a web script whose implementation has been split into a JavaScript file and a FreeMarker template file.\u0026#160; It is implemented by a class called \u003ctt\u003eDeclarativeWebScript\u003c/tt\u003e.\u0026#160; For those with the source code at hand, you will see this file within the project called \u003ctt\u003eWeb Script Framework\u003c/tt\u003e.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eon Alfresco \u003ctt\u003eorg.alfresco.web.scripts.DeclarativeWebScript\u003c/tt\u003e\u003c/strong\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eon Alfresco 3.3 and beyond\u003c/strong\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp\u003e\u003ctt\u003eorg.springframework.extensions.webscripts.DeclarativeWebScript\u003c/tt\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eA declarative web script executes by making a few assumptions about naming conventions.\u0026#160; It first checks to see if there is a JavaScript file and if it finds one, it executes it.\u0026#160; The JavaScript file builds a model which is then processed by a FreeMarker template.\u0026#160; The \u003ctt\u003eDeclarativeWebScript\u003c/tt\u003e implementation is kind enough to resolve all this stuff for us so that things are pretty easy!\u0026#160; This is covered in greater depth under \u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eWeb Scripts\u003c/a\u003e.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eWhile declarative web scripts are very cool, they are by no means our only option when it comes to \u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eWeb Scripts\u003c/a\u003e.\u0026#160; In fact, with the Web Scripting engine, we can really put into place any kind of Web Script implementation that we would like.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eWhy would we want to do this?\u0026#160; Well, here are a couple of good reasons:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e You may want to have tighter control of the generated response.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e You may need access to the Alfresco Java API\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e You may wish your custom web scripts to be part of a formal build process (against which you can more readily test and automate)\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e You may simply prefer a stronger programming language like Java\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eFor any of these reasons and more, the Alfresco Web Script engine allows you to define your own Java Beans to implement your own \u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eWeb Scripts\u003c/a\u003e!\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch1\u003eThe Demo Web Scripts\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003eIn this section, we\u0027ll look at the Java-backed Web Scripts that were demonstrated during the Barcelona community conference.\u0026#160; You can see the source of these scripts further down on this page.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eFour Java-backed web scripts were built.\u0026#160; These are:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e \u003ctt\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23SimpleWebScript.java\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003e#SimpleWebScript.java\u003c/a\u003e\u003c/tt\u003e the world\u0027s simplest web script!\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e \u003ctt\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23RandomSelectWebScript.java\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003e#RandomSelectWebScript.java\u003c/a\u003e\u003c/tt\u003e\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e \u003ctt\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23RenditionWebScript.java\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003e#RenditionWebScript.java\u003c/a\u003e\u003c/tt\u003e\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e \u003ctt\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23SimpleDeclarativeWebScript.java\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003e#SimpleDeclarativeWebScript.java\u003c/a\u003e\u003c/tt\u003e replace the javascript controller with a java controller but keep FreeMarker templates for renditions\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThere also is a ready-to-run \u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttps%3A%2F%2Fgithub.com%2FOpenPj%2Falfresco-java-backed-webscripts-demo\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eAlfresco Java-Backed WebScripts Demo project\u003c/a\u003e on Github that allows you to run with an unique command a new Alfresco instance with all the examples installed. You can quickly identify the demo WebScripts under the family \u0027Alfresco Java-Backed WebScripts Demo\u0027.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch1\u003eSimpleWebScript.java\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003eWell, technically, this may not be the world\u0027 simplest web script.\u0026#160; It could have been, but we decided to soup it up a bit so that it handed back JSON instead of the usual \u0027Hello World\u0027.\u0026#160; After all, why not keep things a little interesting?\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eWhy JSON?\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eJSON is an increasingly popular format in the Web 2.0 world.\u0026#160; Its versatility makes it very adaptable to HTTP.\u0026#160; It has become de facto as a means of reading and writing data between services.\u0026#160; While Alfresco can already consume JSON, it is very convenient to use Web Scripts as a means for producing JSON for not only Alfresco applications but also other third-party applications in your business\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eWriting the Web Script (Java)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe code for \u003ctt\u003eSimpleWebScript\u003c/tt\u003e is provided here:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003epackage org.alfresco.module.demoscripts;\u003cbr/\u003e\u003cbr/\u003eimport java.io.IOException;\u003cbr/\u003e\u003cbr/\u003eimport org.springframework.extensions.webscripts.AbstractWebScript;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptException;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptRequest;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptResponse;\u003cbr/\u003eimport org.json.JSONException;\u003cbr/\u003eimport org.json.JSONObject;\u003cbr/\u003e\u003cbr/\u003epublic class SimpleWebScript extends AbstractWebScript\u003cbr/\u003e{\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; public void execute(WebScriptRequest req, WebScriptResponse res)\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; throws IOException\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; {\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; try\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; {\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; // build a json object\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; JSONObject obj \u003d new JSONObject();\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; // put some data on it\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; obj.put(\u0027field1\u0027, \u0027data1\u0027);\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; // build a JSON string and send it back\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; String jsonString \u003d obj.toString();\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; res.getWriter().write(jsonString);\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; }\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; catch(JSONException e)\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; {\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; throw new WebScriptException(\u0027Unable to serialize JSON\u0027);\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; }\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; }\u0026#160;\u0026#160;\u0026#160; \u003cbr/\u003e}\u003cbr/\u003e\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eAny Java-backed Web Script must implement the \u003ctt\u003eorg.springframework.extensions.webscripts.WebScript\u003c/tt\u003e interface.\u0026#160; Here, we do this by simply extending the \u003ctt\u003eAbstractWebScript\u003c/tt\u003e class with a class that is specifically provided so as to make building custom Web Scripts easier!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eBy extending \u003ctt\u003eAbstractWebScript\u003c/tt\u003e, we are left to implement one abstract method to execute.\u0026#160; Thus, that\u0027s the only thing we have to code.\u0026#160; We just have to tell our custom web script what to do when it is executed.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eIn this case, we build a JSON object and place some data onto it.\u0026#160; Nothing exciting.\u0026#160; Remember, we\u0027re trying to build the world simplest web script!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThe Web Script execute method builds the JSON string and then writes to the response.\u0026#160; This is the actual web script response that is sent straight out to the end user.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDeclaring the Web Script (Spring)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eIf you now take a look at the \u003ctt\u003eweb-scripts-application-context.xml\u003c/tt\u003e file, you\u0027ll see how we register the \u003ctt\u003eSimpleWebScript\u003c/tt\u003e with the Web Script engine.\u0026#160; \u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;bean id\u003d\u0027webscript.org.alfresco.demo.simple.get\u0027 \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; class\u003d\u0027org.alfresco.module.demoscripts.SimpleWebScript\u0027\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; parent\u003d\u0027webscript\u0027\u0026gt;\u003cbr/\u003e\u0026lt;/bean\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe naming convention for the bean id attribute of the Spring bean declaration is important.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e The prefix \u003ctt\u003ewebscript\u003c/tt\u003e is picked up by the Web Script engine.\u0026#160; In this way, it knows that the bean you are declaring is a web script implementation.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The ending \u003ctt\u003eget\u003c/tt\u003e is picked up by the Web Script engine.\u0026#160; It tells the Web Script engine which HTTP method to handle.\u0026#160; In this case, an HTTP GET.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The rest is then assumed to be the package and name of the Web Script.\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe Web Script engine determines the following:\u0026#160; There is a web script whose implementation class is \u003ctt\u003eorg.alfresco.module.demoscripts.SimpleWebScript\u003c/tt\u003e.\u0026#160; Its declared package name is \u003ctt\u003eorg.alfresco.demo\u003c/tt\u003e and its name is \u003ctt\u003esimple\u003c/tt\u003e.\u0026#160; It can receive HTTP GETs.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDescribing the Web Script (XML)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe final thing you need to then do is provide a Web Script descriptor file.\u0026#160; All web scripts need to have an XML-based descriptor file.\u0026#160; This descriptor file tells the framework some of the finer details about what it should do when it receives an HTTP GET call for this Web Script.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThe descriptor file is named \u003ctt\u003esimple.get.desc.xml\u003c/tt\u003e.\u0026#160; This is the descriptor file for the web script named \u003ctt\u003esimple\u003c/tt\u003e implementing the GET HTTP method.\u0026#160; You could have multiple descriptor files for multiple methods (i.e. PUT, POST, HEAD, etc).\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;webscript\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;shortname\u0026gt;The World\u0027s Simplest Webscript\u0026lt;/shortname\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;description\u0026gt;Hands back a little bit of JSON\u0026lt;/description\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;url\u0026gt;/demo/simple\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;authentication\u0026gt;none\u0026lt;/authentication\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;format default\u003d\u0027\u0027\u0026gt;argument\u0026lt;/format\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;family\u0026gt;Alfresco Java-Backed WebScripts Demo\u0026lt;/family\u0026gt;\u003cbr/\u003e\u0026lt;/webscript\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe descriptor file defines metadata for the Web Script registry as well as things like authentication and format.\u0026#160; Most importantly, it defines the URL that we will use to access it from the outside world.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eTry it out\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThat\u0027s it!\u0026#160; If you\u0027ve built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160;\u0026#160; http://localhost:8080/alfresco/service/demo/simple\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThis will return JSON:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160;\u0026#160; { \u0027field1\u0027\u0026#160;: \u0027data1\u0027 }\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThere you go.\u0026#160; Very cool.\u0026#160; Certainly not the most complex data structure, but this is just part 1.\u0026#160; We until you see the other web scripts we put together!\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eLocations of the files\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003e\u003cstrong\u003eOn Alfresco\u003c/strong\u003e\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e.jar file in \u0026lt;Alfresco\u0026gt;/tomcat/webapps/alfresco/WEB-INF/lib or class files in \u0026lt;Alfresco\u0026gt;/tomcat/webapps/alfresco/WEB-INF/classes\u003cbr/\u003eweb-scripts-application-context.xml - \u0026lt;Alfresco\u0026gt;/tomcat/webapps/alfresco/WEB-INF/classes/alfresco\u003cbr/\u003esimple.get.desc.xml\u0026#160; - \u0026lt;Alfresco\u0026gt;/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/demo\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003e\u003cstrong\u003eOn Alfresco Share Standalone (3.3 or greater)\u003c/strong\u003e\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e.jar file in \u0026lt;tomcat\u0026gt;/webapps/share/WEB-INF/lib or .class files in \u0026lt;Alfresco\u0026gt;/tomcat/webapps/alfresco/WEB-INF/classes/\u0026lt;class folder structure\u0026gt;\u003cbr/\u003eweb-scripts-application-context.xml - \u0026lt;tomcat\u0026gt;/webapps/share/WEB-INF/classes/org/springframework/extensions/webscripts\u003cbr/\u003esimple.get.desc.xml\u0026#160; - \u0026lt;tomcat\u0026gt;/webapps/share/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/demo\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003ch1\u003eRandomSelectWebScript.java\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003eFresh off our victory with the simple yet scrappy \u003ctt\u003eSimpleWebScript\u003c/tt\u003e, we now focus our attention on something a little more complex.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThe \u003ctt\u003eRandomSelectWebScript\u003c/tt\u003e demonstrates how you can stream non-text data from the Alfresco Repository to the response.\u0026#160; This means that non-text content is coming out of the Alfresco Repository and is being handed back to the browser in an optimal fashion.\u0026#160; This is ideal for heavy media types like audio or video!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThis web script demonstrates the following:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e It takes in the path to a space within the Alfresco Repository.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e It randomly selects one content object from that space.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e It streams the selected content object back to the browser.\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eHow would something like this be used?\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eIn the conference, we looked at how something like this can be used to produce a \u0027random image\u0027 on a web page.\u0026#160; All you would have to do is place an IMG tag onto a page:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u003cimg/\u003e\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eWith every browser refresh, a new image will appear.\u0026#160; The select images are drawn from the \u003ctt\u003e/Company Home/images\u003c/tt\u003e space.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eWriting the Web Script (Java)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe code for \u003ctt\u003eRandomWebScript\u003c/tt\u003e is provided here:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u003cbr/\u003epackage org.alfresco.module.demoscripts; \u003cbr/\u003e\u003cbr/\u003eimport java.io.IOException; \u003cbr/\u003eimport java.util.ArrayList;\u003cbr/\u003eimport java.util.List;\u003cbr/\u003eimport java.util.Random;\u003cbr/\u003eimport java.util.StringTokenizer;\u003cbr/\u003eimport javax.servlet.http.HttpServletRequest;\u003cbr/\u003eimport javax.servlet.http.HttpServletResponse;\u003cbr/\u003eimport org.alfresco.model.ContentModel;\u003cbr/\u003eimport org.alfresco.repo.model.Repository;\u003cbr/\u003eimport org.alfresco.service.ServiceRegistry;\u003cbr/\u003eimport org.alfresco.service.cmr.model.FileInfo;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.ContentReader;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.NodeRef;\u003cbr/\u003eimport org.springframework.extensions.webscripts.AbstractWebScript;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptException;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptRequest;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptResponse;\u003cbr/\u003eimport org.springframework.extensions.webscripts.servlet.WebScriptServletRequest;\u003cbr/\u003e\u003cbr/\u003epublic class RandomSelectWebScript extends AbstractWebScript {\u003cbr/\u003e private static Random gen \u003d new Random();\u003cbr/\u003e private ServiceRegistry registry;\u003cbr/\u003e private Repository repository;\u003cbr/\u003e\u003cbr/\u003e // for Spring injection \u003cbr/\u003e public void setRepository(Repository repository) {\u003cbr/\u003e\u0026#160; this.repository \u003d repository;\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e // for Spring injection \u003cbr/\u003e public void setServiceRegistry(ServiceRegistry registry) {\u003cbr/\u003e\u0026#160; this.registry \u003d registry;\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e public void execute(WebScriptRequest req, WebScriptResponse res) \u003cbr/\u003e\u0026#160;\u0026#160; throws IOException {\u003cbr/\u003e\u0026#160; // get the referenced incoming node\u003cbr/\u003e\u0026#160; NodeRef rootNodeRef \u003d getNodeRef(req);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // draw a random child \u003cbr/\u003e\u0026#160; NodeRef childNodeRef \u003d randomChild(rootNodeRef);\u003cbr/\u003e\u0026#160; // stream child back\u003cbr/\u003e\u0026#160; output(res, childNodeRef);\u003cbr/\u003e }\u003cbr/\u003e protected NodeRef randomChild(NodeRef rootNodeRef) {\u003cbr/\u003e\u0026#160; // count the number of children\u003cbr/\u003e\u0026#160; List\u0026lt;FileInfo\u0026gt; files \u003d registry.getFileFolderService().listFiles(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; rootNodeRef);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; int fileCount \u003d files.size();\u003cbr/\u003e\u0026#160; // draw random number\u003cbr/\u003e\u0026#160; int draw \u003d gen.nextInt(fileCount);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // our draw \u003cbr/\u003e\u0026#160; FileInfo fileInfo \u003d files.get(draw);\u003cbr/\u003e\u0026#160; NodeRef nodeRef \u003d fileInfo.getNodeRef();\u003cbr/\u003e\u0026#160; return nodeRef;\u003cbr/\u003e }\u003cbr/\u003e protected NodeRef getNodeRef(WebScriptRequest req) {\u003cbr/\u003e\u0026#160; // NOTE: This web script must be executed in a HTTP Servlet environment\u003cbr/\u003e\u0026#160; if (!(req instanceof WebScriptServletRequest)) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u0027Content retrieval must be executed in HTTP Servlet environment\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u003cbr/\u003e\u0026#160; HttpServletRequest httpReq \u003d ((WebScriptServletRequest) req) \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; .getHttpServletRequest();\u003cbr/\u003e\u0026#160; // locate the root path\u003cbr/\u003e\u0026#160; String path \u003d httpReq.getParameter(\u0027path\u0027);\u003cbr/\u003e\u0026#160; if (path \u003d\u003d null) {\u003cbr/\u003e\u0026#160;\u0026#160; path \u003d \u0027/images\u0027;\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u003cbr/\u003e\u0026#160; if (path.startsWith(\u0027/\u0027)) { \u003cbr/\u003e\u0026#160;\u0026#160; path \u003d path.substring(1);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; // build a path elements list\u003cbr/\u003e\u0026#160; List\u0026lt;String\u0026gt; pathElements \u003d new ArrayList\u0026lt;String\u0026gt;();\u003cbr/\u003e\u0026#160; StringTokenizer tokenizer \u003d new StringTokenizer(path, \u0027/\u0027);\u003cbr/\u003e\u0026#160; while (tokenizer.hasMoreTokens()) {\u003cbr/\u003e\u0026#160;\u0026#160; String childName \u003d tokenizer.nextToken();\u003cbr/\u003e\u0026#160;\u0026#160; pathElements.add(childName);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; // look up the child\u003cbr/\u003e\u0026#160; NodeRef nodeRef \u003d null;\u003cbr/\u003e\u0026#160; try {\u003cbr/\u003e\u0026#160;\u0026#160; NodeRef companyHomeRef \u003d repository.getCompanyHome();\u003cbr/\u003e\u0026#160;\u0026#160; nodeRef \u003d registry.getFileFolderService()\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; .resolveNamePath(companyHomeRef, pathElements).getNodeRef();\u003cbr/\u003e\u0026#160; } catch (Exception ex) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u0027Unable to locate path\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; if (nodeRef \u003d\u003d null) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u0027Unable to locate path\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; return nodeRef; \u003cbr/\u003e }\u003cbr/\u003e protected void output(WebScriptResponse res, NodeRef nodeRef) {\u003cbr/\u003e\u0026#160; // stream back \u003cbr/\u003e\u0026#160; try {\u003cbr/\u003e\u0026#160;\u0026#160; ContentReader reader \u003d registry.getContentService().getReader(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; nodeRef, ContentModel.PROP_CONTENT);\u003cbr/\u003e\u0026#160;\u0026#160; reader.getContent(res.getOutputStream());\u003cbr/\u003e\u0026#160; } catch (Exception ex) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(\u0027Unable to stream output\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e }\u003cbr/\u003e}\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eTo begin, the getNodeRef function is called to determine the folder that is being looked at.\u0026#160; \u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThe important thing to note here are the exception states.\u0026#160; If an exception happens, we are able to handle this gracefully by using the \u003ctt\u003eWebScriptException\u003c/tt\u003e class.\u0026#160; We can pass in \u003ctt\u003eHttpServletResponse\u003c/tt\u003e codes which will be handed back to the end-user.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eOnce we have the nodeRef for the space, we can do a random draw from the space. \u003cbr/\u003e\u003c/p\u003e\u003cp\u003eOnce we have the nodeRef for a random child, we can then stream that child back to the user.\u0026#160; We do this by performing an optimal stream of the content directly to the output stream.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eOnce again, if an error occurs, we are wise to throw a \u003ctt\u003eWebScriptException\u003c/tt\u003e.\u0026#160; This will result in proper error handling back to the caller (usually, the browser).\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDeclaring the Web Script (Spring)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eWithin the module-context file, you will see the registration for the \u003ctt\u003eRandomSelectWebScript\u003c/tt\u003e:\u0026#160; \u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;bean id\u003d\u0027webscript.org.alfresco.demo.random.get\u0027 \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; class\u003d\u0027org.alfresco.module.demoscripts.RandomSelectWebScript\u0027 \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; parent\u003d\u0027webscript\u0027\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;property name\u003d\u0027repository\u0027 ref\u003d\u0027repositoryHelper\u0027 /\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;property name\u003d\u0027serviceRegistry\u0027 ref\u003d\u0027ServiceRegistry\u0027 /\u0026gt;\u003cbr/\u003e\u0026lt;/bean\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eFor older Alfresco versions, use \u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e...\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;property name\u003d\u0027repository\u0027 ref\u003d\u0027webscripts.repo\u0027 /\u0026gt;\u003cbr/\u003e...\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eAs before, the naming convention of the Spring bean declaration is important.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e The prefix \u0027webscript\u0027 is picked up by the Web Script engine.\u0026#160; In this way, it knows that the bean you are declaring is a web script implementation.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The ending \u0027get\u0027 is picked up by the Web Script engine.\u0026#160; It tells the Web Script engine which HTTP method to handle.\u0026#160; In this case, an HTTP GET.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The rest is then assumed to be the package and name of the Web Script.\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe Web Script engine determines the following:\u0026#160; There is a web script whose implementation class is \u003ctt\u003eorg.alfresco.module.demoscripts.RandomWebScript\u003c/tt\u003e.\u0026#160; Its declared package name is \u003ctt\u003eorg.alfresco.demo\u003c/tt\u003e and its name is \u003ctt\u003erandom\u003c/tt\u003e.\u0026#160; It can receive HTTP GETs.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eNote that this Spring bean declaration is a little more interesting than the former as it takes arguments.\u0026#160; The Spring bean, upon instantiation, receives references to the Repository object (managed under id \u003ctt\u003erepositoryHelper\u003c/tt\u003e) and the Service Registry (managed under id \u003ctt\u003eServiceRegistry\u003c/tt\u003e).\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDescribing the Web Script (XML)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe XML-based descriptor file is named \u003ctt\u003erandom.get.desc.xml\u003c/tt\u003e.\u0026#160; This is the descriptor file for the web script named \u003ctt\u003erandom\u003c/tt\u003e which implements the method \u0027GET\u0027.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;webscript\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;shortname\u0026gt;Streams a random content item\u0026lt;/shortname\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;description\u0026gt;Streams a random content item\u0026lt;/description\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;url\u0026gt;/demo/random?path\u003d{path}\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;authentication\u0026gt;user\u0026lt;/authentication\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;transaction\u0026gt;none\u0026lt;/transaction\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;format default\u003d\u0027\u0027\u0026gt;argument\u0026lt;/format\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;family\u0026gt;Alfresco Java-Backed WebScripts Demo\u0026lt;/family\u0026gt;\u003cbr/\u003e\u0026lt;/webscript\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe descriptor file defines metadata for the Web Script registry as well as things like authentication and format.\u0026#160; In this case, the authentication is set to \u0027user\u0027 which means that we require user authentication before we can execute.\u0026#160; Is this necessary?\u0026#160; Not if we intend to run against folders and content that is Guest-friendly.\u0026#160; However, if the content is protected in any way, then we will need to be authenticated..\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eNote that this descriptor file also tells the developer that they should pass in a path argument on the request which identifies the folder from which a random select will occur.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eTry it out\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThat\u0027s it!\u0026#160; If you\u0027ve built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160;\u0026#160; http://localhost:8080/alfresco/service/demo/random?path\u003d/images\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eIf you have some content in the \u003ctt\u003e/images\u003c/tt\u003e directory, you should almost immediately experience it streaming back from the Alfresco Repository!\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch1\u003eRenditionWebScript.java\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003eBy now, we are quite good at writing Java-backed Web Scripts.\u0026#160; But we are not Jedi yet!\u0026#160; We have one example left this one combines streaming with the power of Alfresco\u0027s transformers!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eAlfresco provides transformers right within the repository.\u0026#160; This conceivably allows you to take any piece of content and quickly convert it into another preferable format.\u0026#160; For example, you might have a collection of TIF images that you would like to repurpose for the web.\u0026#160; However, TIF isn\u0027t ideal for the web due to its size.\u0026#160; You might prefer that they are JPGs.\u0026#160; Alfresco can do this kind of conversion for you!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eOne option would be to convert all of your TIF images to JPG ahead of time.\u0026#160; That way, when a request comes along for an image, you could just point them at the JPG.\u0026#160; Not a bad idea.\u0026#160; However, what if people are really only interested in 10% of the images that you have.\u0026#160; Aren\u0027t you wasting time, money and resources converting the other 90%?\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eAnother option is one that many would argue is better than is to consider the idea of doing a \u0027lazy transformation\u0027.\u0026#160; This implies nothing about work ethic.\u0026#160; Rather, it means that you put off doing the transformation until a request arrives.\u0026#160; The first user to request a particular image may have to wait just a little longer.\u0026#160; But then they\u0027ll get their JPG image.\u0026#160; And every other user after them who requests the same image will benefit.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eOn-demand content generation.\u0026#160; Pretty cool.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eWe provide just that with our third example is the \u003ctt\u003eRenditionWebScript\u003c/tt\u003e.\u0026#160; The \u003ctt\u003eRenditionWebScript\u003c/tt\u003e takes in a path to a content object and further lets you specify the format of the content that you would like to hand back.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eYou can do things like:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;A HREF\u003d\u0027http://localhost:8080/alfresco/service/demo/rendition\u003cbr/\u003e\u0026#160; \u0026#160;?path\u003d/images/myImage.tif\u0026amp;mimetype\u003djpg\u0027\u0026gt;Click here to view the image\u0026lt;/A\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe web script looks up the object and then checks to see whether a rendition of the given mimetype has already been generated.\u0026#160; If not, it generates one.\u0026#160; The rendition is then streamed back to the end user!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThis web script demonstrates the following:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e More of the Alfresco Java API\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e Example of performing transformations in Java\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e Working with content models within Java-backed Web Scripts\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e Streaming content optimally from the Alfresco Repository to the response\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003eCustom Content Model\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThis Web Script is the most complex of the three.\u0026#160; It involves some advanced things with the Alfresco Java API.\u0026#160; It also involves a custom content model.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThe custom content model is defined by the file \u003ctt\u003edemoscriptsModel.xml\u003c/tt\u003e.\u0026#160; This model defines a new content type called \u003ctt\u003edemo:rendition\u003c/tt\u003e.\u0026#160; It also defines a new aspect called \u003ctt\u003edemo:renditionable\u003c/tt\u003e.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eWhen a new rendition is created for an existing content item, the existing content item is assigned the \u003ctt\u003edemo:renditionable\u003c/tt\u003e aspect.\u0026#160; This aspect places new metadata onto the existing content item.\u0026#160; Specifically, this allows the existing content item to keep track of associations to its new renditions!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThe new renditions are stamped with the content type named \u003ctt\u003edemo:rendition\u003c/tt\u003e.\u0026#160; This provides the new renditions with a fixed type and fixed metadata.\u0026#160; The metadata includes notes and a timestamp.\u0026#160; These are not used by the sample code but are in place to provide an example of how you might model the renditions.\u0026#160; It would allow them to keep track of things like the time they were generated and information about how the transformation was performed.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eCustom Transformers\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eFor the demonstration in Barcelona, we also included a custom transformer.\u0026#160; Alfresco is fully extensible which means that you can add your own transformers pretty easily.\u0026#160; In this case, all it involved was the installation of \u003cstrong\u003eSWF Tools\u003c/strong\u003e and an XML file that tells Alfresco how to use SWF Tools.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eThis XML file is named \u003ctt\u003edemoscripts-transform-context.xml\u003c/tt\u003e.\u0026#160; It declares two transformers:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e A transformer named \u003ctt\u003etransformer.Pdf2swf\u003c/tt\u003e which uses SWF Tools to convert PDF files to SWF files.\u0026#160; This is the Flash format.\u0026#160; It means that we can now convert documents from PDF format to Flash!\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e A transformer named \u003ctt\u003etransformer.complex.OpenOffice.Pdf2swf\u003c/tt\u003e which is an instance of a \u003ctt\u003eComplexContentTransformer\u003c/tt\u003e.\u0026#160; This transformer lets you execute multiple transformers in sequence!\u0026#160; In this case, it is configured to first convert documents to PDF and then PDF documents to SWF!\u0026#160; This means that any file type that be converted to PDF can now additionally be converted to SWF!\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eTo get this working correctly, you should install SWF Tools onto your machine and then make sure that \u003ctt\u003epdf2swf\u003c/tt\u003e is accessible from your system path.\u0026#160; The easiest way to accomplish this is to copy the executable to your \u003ctt\u003e/alfresco/bin\u003c/tt\u003e directory.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eNote:\u0026#160; This demonstration was performed on Windows so installation on other platforms is unknown.\u0026#160; It essentially will amount to getting SWF Tools installed correctly on that platform and then tweaking the \u003ctt\u003edemoscripts-transform-context.xml\u003c/tt\u003e file to pick up the executable.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eWriting the Web Script (Java)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe code for \u003ctt\u003eRenditionWebScript\u003c/tt\u003e is provided here:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u003cbr/\u003epackage org.alfresco.module.demoscripts;\u003cbr/\u003e\u003cbr/\u003eimport java.io.IOException; \u003cbr/\u003eimport java.io.Serializable;\u003cbr/\u003eimport java.util.ArrayList; \u003cbr/\u003eimport java.util.HashMap;\u003cbr/\u003eimport java.util.List;\u003cbr/\u003eimport java.util.Map;\u003cbr/\u003eimport java.util.StringTokenizer;\u003cbr/\u003eimport javax.servlet.http.HttpServletRequest;\u003cbr/\u003eimport javax.servlet.http.HttpServletResponse;\u003cbr/\u003eimport org.alfresco.model.ContentModel;\u003cbr/\u003eimport org.alfresco.repo.content.transform.ContentTransformer;\u003cbr/\u003eimport org.alfresco.repo.model.Repository;\u003cbr/\u003eimport org.alfresco.service.ServiceRegistry;\u003cbr/\u003eimport org.alfresco.service.cmr.model.FileFolderService;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.AssociationRef;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.ContentReader;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.ContentService;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.ContentWriter;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.MimetypeService;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.NodeRef;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.NodeService;\u003cbr/\u003eimport org.alfresco.service.cmr.repository.TransformationOptions;\u003cbr/\u003eimport org.alfresco.service.namespace.QName;\u003cbr/\u003eimport org.springframework.extensions.webscripts.AbstractWebScript;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptException;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptRequest;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptResponse;\u003cbr/\u003eimport org.springframework.extensions.webscripts.servlet.WebScriptServletRequest;\u003cbr/\u003e\u003cbr/\u003epublic class RenditionWebScript extends AbstractWebScript {\u003cbr/\u003e static final String NAMESPACE \u003d \u0027http://www.alfresco.org/model/demoscripts/1.0\u0027; \u003cbr/\u003e static final QName TYPE_RENDITION \u003d QName.createQName(NAMESPACE, \u0027rendition\u0027);\u003cbr/\u003e static final QName PROP_NOTES \u003d QName.createQName(NAMESPACE, \u0027notes\u0027);\u003cbr/\u003e static final QName PROP_TIMESTAMP \u003d QName.createQName(NAMESPACE, \u0027timestamp\u0027);\u003cbr/\u003e static final QName ASPECT_RENDITIONABLE \u003d QName.createQName(NAMESPACE, \u0027renditionable\u0027);\u003cbr/\u003e static final QName PROP_ASSOC_RENDITIONS \u003d QName.createQName(NAMESPACE, \u0027assocRenditions\u0027);\u003cbr/\u003e\u003cbr/\u003e private ServiceRegistry registry; \u003cbr/\u003e private Repository repository;\u003cbr/\u003e // for Spring injection\u003cbr/\u003e public void setRepository(Repository repository) {\u003cbr/\u003e\u0026#160; this.repository \u003d repository;\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e // for Spring injection \u003cbr/\u003e public void setServiceRegistry(ServiceRegistry registry) {\u003cbr/\u003e\u0026#160; this.registry \u003d registry;\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e public void execute(WebScriptRequest req, WebScriptResponse res) \u003cbr/\u003e\u0026#160;\u0026#160; throws IOException {\u003cbr/\u003e\u0026#160; String targetMimetype \u003d req.getParameter(\u0027mimetype\u0027);\u003cbr/\u003e\u0026#160; if (targetMimetype \u003d\u003d null || \u0027\u0027.equals(targetMimetype)) {\u003cbr/\u003e\u0026#160;\u0026#160; targetMimetype \u003d \u0027application/x-shockwave-flash\u0027;\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; // get the referenced incoming node\u003cbr/\u003e\u0026#160; NodeRef nodeRef \u003d getNodeRef(req);\u003cbr/\u003e\u0026#160; // check to see if it has the \u0027demo:renditionable\u0027 aspect\u003cbr/\u003e\u0026#160; if (getNodeService().hasAspect(nodeRef, ASPECT_RENDITIONABLE)) {\u003cbr/\u003e\u0026#160;\u0026#160; // check to see if it has a rendition for this mimetype\u003cbr/\u003e\u0026#160;\u0026#160; List\u0026lt;AssociationRef\u0026gt; list \u003d getNodeService().getTargetAssocs(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; nodeRef, PROP_ASSOC_RENDITIONS);\u003cbr/\u003e\u0026#160;\u0026#160; for (AssociationRef x\u0026#160;: list) {\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; NodeRef childNodeRef \u003d x.getTargetRef();\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; if (targetMimetype.equals(guessMimetype(childNodeRef))) {\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; // stream back\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; output(res, childNodeRef);\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; return;\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; }\u003cbr/\u003e\u0026#160;\u0026#160; }\u003cbr/\u003e\u0026#160; } else {\u003cbr/\u003e\u0026#160;\u0026#160; // add the aspect\u003cbr/\u003e\u0026#160;\u0026#160; getNodeService().addAspect(nodeRef, ASPECT_RENDITIONABLE, null);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // now generate the rendition \u003cbr/\u003e\u0026#160; String sourceMimetype \u003d guessMimetype(nodeRef);\u003cbr/\u003e\u0026#160; // try to locate a transformer that will convert from this mimetype to\u003cbr/\u003e\u0026#160; // our intended type\u003cbr/\u003e\u0026#160; ContentTransformer transformer \u003d getContentService().getTransformer(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; sourceMimetype, targetMimetype);\u003cbr/\u003e\u0026#160; // if we don\u0027t have a transformer, throw an error\u003cbr/\u003e\u0026#160; if (transformer \u003d\u003d null) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(\u0027Unable to locate transformer\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; // determine properties about the new node\u003cbr/\u003e\u0026#160; NodeRef parentRef \u003d getNodeService().getPrimaryParent(nodeRef)\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; .getParentRef();\u003cbr/\u003e\u0026#160; String newNodeName \u003d getFilename(nodeRef) + \u0027.\u0027\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; + getMimetypeService().getExtension(targetMimetype);\u003cbr/\u003e\u0026#160; // create the new node\u003cbr/\u003e\u0026#160; NodeRef newNodeRef \u003d getNodeService().createNode(parentRef,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; ContentModel.ASSOC_CONTAINS,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; QName.createQName(NAMESPACE, newNodeName), TYPE_RENDITION)\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; .getChildRef();\u003cbr/\u003e\u0026#160; // set the name of the node\u003cbr/\u003e\u0026#160; getNodeService().setProperty(newNodeRef, ContentModel.PROP_NAME,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; newNodeName);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // add the titled aspect\u003cbr/\u003e\u0026#160; Map\u0026lt;QName, Serializable\u0026gt; aspectProperties \u003d new HashMap\u0026lt;QName, Serializable\u0026gt;();\u003cbr/\u003e\u0026#160; aspectProperties.put(ContentModel.PROP_TITLE, newNodeName);\u003cbr/\u003e\u0026#160; getNodeService().addAspect(newNodeRef, ContentModel.ASPECT_TITLED,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; aspectProperties);\u003cbr/\u003e\u0026#160; // set up transformation options\u003cbr/\u003e\u0026#160; TransformationOptions options \u003d new TransformationOptions();\u003cbr/\u003e\u0026#160; options.setSourceContentProperty(ContentModel.PROP_CONTENT);\u003cbr/\u003e\u0026#160; options.setSourceNodeRef(nodeRef);\u003cbr/\u003e\u0026#160; options.setTargetContentProperty(ContentModel.PROP_CONTENT);\u003cbr/\u003e\u0026#160; options.setTargetNodeRef(newNodeRef);\u003cbr/\u003e\u0026#160; // establish a content reader (from source)\u003cbr/\u003e\u0026#160; ContentReader contentReader \u003d getContentReader(nodeRef);\u003cbr/\u003e\u0026#160; contentReader.setMimetype(sourceMimetype);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // establish a content writer (to destination) \u003cbr/\u003e\u0026#160; ContentWriter contentWriter \u003d getContentWriter(newNodeRef);\u003cbr/\u003e\u0026#160; contentWriter.setMimetype(targetMimetype);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // do the transformation \u003cbr/\u003e\u0026#160; transformer.transform(contentReader, contentWriter, options);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // set up the association so that we don\u0027t do this more than once \u003cbr/\u003e\u0026#160; // it is remembered on the object and looked up next time\u003cbr/\u003e\u0026#160; getNodeService().createAssociation(nodeRef, newNodeRef,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; PROP_ASSOC_RENDITIONS);\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // stream the result back \u003cbr/\u003e\u0026#160; output(res, newNodeRef);\u003cbr/\u003e }\u003cbr/\u003e protected String guessMimetype(NodeRef nodeRef) {\u003cbr/\u003e\u0026#160; String filename \u003d getFilename(nodeRef);\u003cbr/\u003e\u0026#160; return getMimetypeService().guessMimetype(filename);\u003cbr/\u003e }\u003cbr/\u003e protected String getFilename(NodeRef nodeRef) {\u003cbr/\u003e\u0026#160; return getFileFolderService().getFileInfo(nodeRef).getName();\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e protected NodeRef getNodeRef(WebScriptRequest req) {\u003cbr/\u003e\u0026#160; // NOTE: This web script must be executed in a HTTP Servlet environment \u003cbr/\u003e\u0026#160; if (!(req instanceof WebScriptServletRequest)) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u0027Content retrieval must be executed in HTTP Servlet environment\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; HttpServletRequest httpReq \u003d ((WebScriptServletRequest) req)\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; .getHttpServletRequest();\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // locate the root path \u003cbr/\u003e\u0026#160; String path \u003d httpReq.getParameter(\u0027path\u0027);\u003cbr/\u003e\u0026#160; if (path \u003d\u003d null) {\u003cbr/\u003e\u0026#160;\u0026#160; path \u003d \u0027/images\u0027;\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; if (path.startsWith(\u0027/\u0027)) {\u003cbr/\u003e\u0026#160;\u0026#160; path \u003d path.substring(1);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; // build a path elements list\u003cbr/\u003e\u0026#160; List\u0026lt;String\u0026gt; pathElements \u003d new ArrayList\u0026lt;String\u0026gt;();\u003cbr/\u003e\u0026#160; StringTokenizer tokenizer \u003d new StringTokenizer(path, \u0027/\u0027);\u003cbr/\u003e\u0026#160; while (tokenizer.hasMoreTokens()) {\u003cbr/\u003e\u0026#160;\u0026#160; String childName \u003d tokenizer.nextToken();\u003cbr/\u003e\u0026#160;\u0026#160; pathElements.add(childName);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u003cbr/\u003e\u0026#160; // look up the child \u003cbr/\u003e\u0026#160; NodeRef nodeRef \u003d null;\u003cbr/\u003e\u0026#160; try {\u003cbr/\u003e\u0026#160;\u0026#160; NodeRef companyHomeRef \u003d repository.getCompanyHome();\u003cbr/\u003e\u0026#160;\u0026#160; nodeRef \u003d registry.getFileFolderService()\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; .resolveNamePath(companyHomeRef, pathElements).getNodeRef();\u003cbr/\u003e\u0026#160; } catch (Exception ex) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u0027Unable to locate path\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; if (nodeRef \u003d\u003d null) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u0027Unable to locate path\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e\u0026#160; return nodeRef;\u003cbr/\u003e }\u003cbr/\u003e protected void output(WebScriptResponse res, NodeRef nodeRef) {\u003cbr/\u003e\u0026#160; // stream back\u003cbr/\u003e\u0026#160; try {\u003cbr/\u003e\u0026#160;\u0026#160; ContentReader reader \u003d registry.getContentService().getReader(\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160; nodeRef, ContentModel.PROP_CONTENT);\u003cbr/\u003e\u0026#160;\u0026#160; reader.getContent(res.getOutputStream());\u003cbr/\u003e\u0026#160; } catch (Exception ex) {\u003cbr/\u003e\u0026#160;\u0026#160; throw new WebScriptException(\u0027Unable to stream output\u0027);\u003cbr/\u003e\u0026#160; }\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e private ContentService getContentService() { \u003cbr/\u003e\u0026#160; return this.registry.getContentService();\u003cbr/\u003e }\u003cbr/\u003e private NodeService getNodeService() {\u003cbr/\u003e\u0026#160; return this.registry.getNodeService();\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e private MimetypeService getMimetypeService() { \u003cbr/\u003e\u0026#160; return this.registry.getMimetypeService();\u003cbr/\u003e }\u003cbr/\u003e private FileFolderService getFileFolderService() {\u003cbr/\u003e\u0026#160; return this.registry.getFileFolderService();\u003cbr/\u003e }\u003cbr/\u003e\u003cbr/\u003e private ContentReader getContentReader(NodeRef nodeRef) { \u003cbr/\u003e\u0026#160; return this.registry.getContentService().getReader(nodeRef,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; ContentModel.PROP_CONTENT);\u003cbr/\u003e }\u003cbr/\u003e private ContentWriter getContentWriter(NodeRef nodeRef) {\u003cbr/\u003e\u0026#160; return this.registry.getContentService().getWriter(nodeRef,\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; ContentModel.PROP_CONTENT, true);\u003cbr/\u003e }\u003cbr/\u003e}\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe code this time around is a little more complex.\u0026#160; In essence, it figures out what mimetype you would like to convert to and then tries to look up the content item (using getNodeRef, as before).\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eOnce it has the node, it then works with the content model to make sure that the content item has the \u003ctt\u003edemo:renditionable\u003c/tt\u003e aspect applied.\u0026#160; If not, the aspect is applied.\u0026#160; It then figures out the node\u0027s mimetype and looks up the transformer to use.\u0026#160; If an appropriate transformer is not found, the code elegantly throws a WebScriptException.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eA new rendition node is then created and the transformation begins.\u0026#160; Once the transformation is completed, the rendition is associated up to the original content item.\u0026#160; In this way, the original content item always knows where all of its renditions are!\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDeclaring the Web Script (Spring)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eWithin the \u003ctt\u003emodule-context.xml\u003c/tt\u003e file, you will see the registration for the \u003ctt\u003eRenditionSelectWebScript\u003c/tt\u003e:\u0026#160; \u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;bean id\u003d\u0027webscript.org.alfresco.demo.rendition.get\u0027 \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; class\u003d\u0027org.alfresco.module.demoscripts.RenditionWebScript\u0027 \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; parent\u003d\u0027webscript\u0027 \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; depends-on\u003d\u0027webscripts.repo\u0027\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;property name\u003d\u0027repository\u0027 ref\u003d\u0027repositoryHelper\u0027 /\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;property name\u003d\u0027serviceRegistry\u0027 ref\u003d\u0027ServiceRegistry\u0027 /\u0026gt;\u003cbr/\u003e\u0026lt;/bean\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eAs before, the naming convention of the Spring bean declaration is important.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e The prefix \u0027webscript\u0027 is picked up by the Web Script engine.\u0026#160; In this way, it knows that the bean you are declaring is a web script implementation.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The ending \u0027get\u0027 is picked up by the Web Script engine.\u0026#160; It tells the Web Script engine which HTTP method to handle.\u0026#160; In this case, an HTTP GET.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The rest is then assumed to be the package and name of the Web Script.\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe Web Script engine determines the following:\u0026#160; There is a web script whose implementation class is \u003ctt\u003eorg.alfresco.module.demoscripts.RenditionWebScript\u003c/tt\u003e.\u0026#160; Its declared package name is \u003ctt\u003eorg.alfresco.demo\u003c/tt\u003e and its name is \u003ctt\u003erendition\u003c/tt\u003e.\u0026#160; It can receive HTTP GETs.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDescribing the Web Script (XML)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe XML-based descriptor file is named \u003ctt\u003erendition.get.desc.xml\u003c/tt\u003e.\u0026#160; This is the descriptor file for the web script named \u003ctt\u003erandom\u003c/tt\u003e which implements the method \u0027GET\u0027.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;webscript\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;shortname\u0026gt;Streams back a rendition for a content item\u0026lt;/shortname\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;description\u0026gt;Streams back a rendition for a content item\u0026lt;/description\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;url\u0026gt;/demo/rendition?path\u003d{path}\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;authentication\u0026gt;user\u0026lt;/authentication\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;format default\u003d\u0027\u0027\u0026gt;argument\u0026lt;/format\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;family\u0026gt;Alfresco Java-Backed WebScripts Demo\u0026lt;/family\u0026gt;\u003cbr/\u003e\u0026lt;/webscript\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe descriptor file defines metadata for the Web Script registry as well as things like authentication and format.\u0026#160; In this case, the authentication is set to \u0027user\u0027 which means that we require user authentication before we can execute.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eNote that this descriptor file also tells the developer that they should pass in a path argument on the request which identifies the source content item for which a source item should be generated.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eNote also that the mimetype argument is not specified.\u0026#160; It is not required.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eTry it out\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThat\u0027s it!\u0026#160; If you\u0027ve built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160;\u0026#160; http://localhost:8080/alfresco/service/demo/rendition?path\u003d/pdfs/myPdf.pdf\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe web script should find PDF and kick off a transformation of the PDF to Flash.\u0026#160; If the transformation has been performed previously, it will not be done a second time.\u0026#160; The previously generated transformation will be streamed back to the end user!\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eYou can also fire in a request for a specific mimetype:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160; http://localhost:8080/alfresco/service/demo/rendition\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; \u0026#160;?path\u003d/images/myImage.tif\u0026amp;mimetype\u003djpg\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eIf your Alfresco installation knows how to convert TIF to JPG, you should immediately see a JPG file stream your way!\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch1\u003eSimpleDeclarativeWebScript.java\u003c/h1\u003e\u003cbr/\u003e\u003ch2\u003eWriting the Web Script (Java)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe code for \u003cem\u003eSimpleDeclarativeWebScript.java\u003c/em\u003e on \u003cstrong\u003eAlfresco v3.3 and beyond\u003c/strong\u003e is provided here:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003epackage org.alfresco.demo;\u003cbr/\u003e\u003cbr/\u003eimport java.util.HashMap;\u003cbr/\u003eimport java.util.Map;\u003cbr/\u003eimport org.springframework.extensions.webscripts.Cache;\u003cbr/\u003eimport org.springframework.extensions.webscripts.DeclarativeWebScript;\u003cbr/\u003eimport org.springframework.extensions.webscripts.Status;\u003cbr/\u003eimport org.springframework.extensions.webscripts.WebScriptRequest;\u003cbr/\u003e\u003cbr/\u003epublic class SimpleDeclarativeWebscript extends DeclarativeWebScript {\u003cbr/\u003e\u003cbr/\u003e\u0026#160;\u0026#160; @Override\u003cbr/\u003e\u0026#160;\u0026#160; protected Map\u0026lt;String, Object\u0026gt; executeImpl(WebScriptRequest req, Status status, Cache cache) {\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; //put all the objects that you need in renditions to the model map\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; Map\u0026lt;String, Object\u0026gt; model \u003d new HashMap\u0026lt;String, Object\u0026gt;();\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; model.put(\u0027demo\u0027, \u0027Happy coding!\u0026#160;:D\u0027);\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; return model;\u003cbr/\u003e\u0026#160;\u0026#160; }\u003cbr/\u003e\u003cbr/\u003e}\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eYou can use the \u003cem\u003eexecuteImpl\u003c/em\u003e method to do your business logic and produce a custom model that will be available in the FreeMarker renditions:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e \u003cem\u003eWebScriptRequest req\u003c/em\u003e can be used to extract URL paths, arguments and headers\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e \u003cem\u003eStatus status\u003c/em\u003e can be used to handle the HTTP status response and eventually the error message\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e \u003cem\u003eCache cache\u003c/em\u003e can be used to cache and retrieve values\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e \u003cem\u003eMap\u0026lt;String, Object\u0026gt; model\u003c/em\u003e can be used to create a model that fit your needs.\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003eDeclaring the Web Script (Spring)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eWithin the module-context file, you will see the registration for the SimpleDeclarativeWebscript.java:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;bean id\u003d\u0027webscript.org.alfresco.demo.declarative.get\u0027\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; class\u003d\u0027org.alfresco.module.demoscripts.SimpleDeclarativeWebscript\u0027\u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160;\u0026#160;\u0026#160; parent\u003d\u0027webscript\u0027\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;/bean\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eAs before, the naming convention of the Spring bean declaration is important.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e The prefix \u0027webscript\u0027 is picked up by the Web Script engine.\u0026#160; In this way, it knows that the bean you are declaring is a web script implementation.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The ending \u0027get\u0027 is picked up by the Web Script engine.\u0026#160; It tells the Web Script engine which HTTP method to handle.\u0026#160; In this case, an HTTP GET.\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e The rest is then assumed to be the package and name of the Web Script.\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe Web Script engine determines the following:\u0026#160; There is a web script whose implementation class is \u003ctt\u003eorg.alfresco.demo.SimpleDeclarativeWebscript\u003c/tt\u003e.\u0026#160; Its declared package name is \u003ctt\u003eorg.alfresco.demo\u003c/tt\u003e and its name is \u003ctt\u003edeclarative\u003c/tt\u003e.\u0026#160; It can receive HTTP GETs.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDescribing the Webscript (XML)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe XML-based descriptor file is named declarative.get.desc.xml. This is the descriptor file for the web script named random which implements the method \u0027GET\u0027.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;webscript\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;shortname\u0026gt;Streams a declarative content item\u0026lt;/shortname\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;description\u0026gt;Streams a declarative content item\u0026lt;/description\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;url\u0026gt;/demo/declarative\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;url\u0026gt;/demo/declarative.xml\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;url\u0026gt;/demo/declarative.json\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;url\u0026gt;/demo/declarative.html\u0026lt;/url\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;authentication\u0026gt;user\u0026lt;/authentication\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;format default\u003d\u0027html\u0027\u0026gt;extension\u0026lt;/format\u0026gt;\u003cbr/\u003e\u0026#160;\u0026#160; \u0026lt;family\u0026gt;Alfresco Java-Backed WebScripts Demo\u0026lt;/family\u0026gt;\u003cbr/\u003e\u0026lt;/webscript\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe descriptor file defines metadata for the Web Script registry as well as things like authentication and format. In this case, the authentication is set to \u0027user\u0027.\u003cbr/\u003eNote that this descriptor file also tells the developer that the rendered format can be specified with the \u003cem\u003eformat\u003c/em\u003e URL argument or with the \u003cem\u003eAccept Http Header\u003c/em\u003e and it does support Html, Xml and Json.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch2\u003eDescribing the Webscript\u0027s renditions templates (FTL)\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThe Html FreeMarker rendition file \u003cem\u003edeclarative.get.html.ftl\u003c/em\u003e:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u003cbr/\u003e\u0026#160; \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; \u003cbr/\u003e\u0026#160; \u003cbr/\u003e\u0026#160; \u003cbr/\u003e\u0026#160;\u0026#160;\u0026#160; \u003cp\u003eHello ${person.properties.userName}: ${demo}\u003c/p\u003e\u003cbr/\u003e\u0026#160; \u003cbr/\u003e\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe XML FreeMarker rendition file \u003cem\u003edeclarative.get.xml.ftl\u003c/em\u003e:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e\u0026lt;root\u0026gt;\u003cbr/\u003e\u0026#160; \u0026lt;msg\u0026gt;\u0026lt;/msg\u0026gt;\u003cbr/\u003e\u0026lt;/root\u0026gt;\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003eThe Json FreeMarker rendition file \u003cem\u003edeclarative.get.json.ftl\u003c/em\u003e:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003e{\u0026#160;\u0026#160; \u0027msg\u0027: \u0027Hello ${person.properties.userName}: ${demo}\u0027}\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003ch2\u003eTry it out\u003c/h2\u003e\u003cbr/\u003e\u003cp\u003eThat\u0027s it! If you\u0027ve built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out to perform a request for an HTML output:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003ehttp://localhost:8080/alfresco/service/demo/declarative\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003e\u003cbr/\u003e\u003cbr/\u003eIf you want to get a JSON response, you can invoke the following call:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003ehttp://localhost:8080/alfresco/service/demo/declarative.json\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003cp\u003e\u003cbr/\u003e\u003cbr/\u003eIf you want to get an XML response, you can invoke the following call:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cpre\u003e\u003cbr/\u003ehttp://localhost:8080/alfresco/service/demo/declarative.xml\u003cbr/\u003e\u003c/pre\u003e\u003cbr/\u003e\u003ch1\u003eTroubleshooting\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003e\u003cstrong\u003eI am getting: Cannot locate template processor for template ...\u003c/strong\u003e\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eIf you are extending the AbstractWebScript class then it is most likely that your bean definition file is either in the wrong place, or has the wrong content. \u003cbr/\u003e\u003cspan\u003eDouble check this by visiting the following link \u003c/span\u003e\u003ca class\u003d\"jive-link-external-small\" href\u003d\"http://localhost:8080/share/page/script/org/alfresco/module/demoscripts/simple.get\" rel\u003d\"nofollow\"\u003ehttp://localhost:8080/share/page/script/org/alfresco/module/demoscripts/simple.get\u003c/a\u003e\u003cspan\u003e (for the first example) and look at the Implementation line.\u0026#160; If the implementation is not the class you created, but is the default class (DeclaritiveWebScript), then your class is not being loaded properly.\u003c/span\u003e\u003cbr/\u003eStop Tomcat and remove your class.\u0026#160; Then start tomcat again.\u0026#160; If you do not see any class loading errors then that means your bean definition file is not correct.\u0026#160; Move it to the correct location and restart tomcat until you are getting a class loading error.\u0026#160; Then move your java class file (or jar) into the correct place and restart tomcat again.\u0026#160; Visit the page above to make sure the implementation is correct.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eIf you are extending the DeclarativeWebScript class then you are most likely missing your freemarker template, or it is in an incorrect location.\u0026#160; Verify the location and filename are correct.\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003ch1\u003eQuestions?\u003c/h1\u003e\u003cbr/\u003e\u003cp\u003eThat\u0027s it for the Java-backed web scripts.\u0026#160; They\u0027re pretty simple to write and deploy.\u0026#160; Bear in mind that much of what we\u0027ve seen here are some pretty complex examples that make pretty good use of the Alfresco Repository Services Java API.\u003cbr/\u003e\u003c/p\u003e\u003cp\u003eFor further information on Alfresco\u0027s JAVA API, please see the following Wiki articles:\u003cbr/\u003e\u003c/p\u003e\u003cbr/\u003e\u003cul\u003e\u003cli\u003e Alfresco \u003ca class\u003d\"jive-link-external-small\" href\u003d\"https://community.alfresco.com/external-link.jspa?url\u003dhttp%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FServices_Framework\" rel\u003d\"nofollow\" target\u003d\"_blank\"\u003eServices Framework\u003c/a\u003e\u003cbr/\u003e\u003c/li\u003e\u003cli\u003e More to come...\u003cbr/\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cspan\u003eIf you have any questions on Alfresco Java-backed Web Scripts or Alfresco in general, please post your question to our community forums or write to \u003c/span\u003e\u003ca class\u003d\"jive-link-email-small\" href\u003d\"mailto:info@alfresco.com\"\u003einfo@alfresco.com\u003c/a\u003e\u003cspan\u003e for formal support options!\u003c/span\u003e\u003cbr/\u003e\u003c/p\u003e\u003c/div\u003e\u003c!-- [DocumentBodyEnd:627d9009-01f6-477e-9cb8-eecf2ae2acc9] --\u003e\u003c/body\u003e","author":{"@context":"http://schema.org","@type":"Person","name":"openpj","image":"https://community.alfresco.com/api/core/v3/people/107678/avatar?a\u003d1084"},"dateModified":"Dec 28, 2015 3:40:40 AM","datePublished":"Dec 28, 2015 3:40:40 AM","dateCreated":"Dec 28, 2015 3:40:40 AM","commentCount":0,"interactionStatistic":{"@context":"http://schema.org","@type":"InteractionCounter","interactionType":"http://schema.org/LikeAction","userInteractionCount":0},"image":"http://localhost","isPartOf":{"@context":"http://schema.org","@type":"Blog","url":"https://community.alfresco.com/api/core/v3/places/1196"},"keywords":["Archive","web scripts"],"version":1}</script>
      <!-- BEGIN Body region -->
      <!-- BEGIN guided nav -->
      <div class="j-guided-nav js-guided-nav" style="display: none;">
       <div class="j-header js-header j-rc-none-bottom"></div>
       <div class="j-navbar js-navbar"></div>
      </div>
      <!-- END guided nav -->
      <div class="j-content clearfix" aria-labelledby="main-doc-header" role="main">
       <header class="j-content-header" data-jive-view="apps/content/documents/affix_header">
        <h1>Java-backed Web Scripts Samples</h1>
        <div class="j-doc-meta-wrap clearfix">
         <div class="j-content-header-author font-color-meta">
          <span role="img" title="Document" class="jive-icon-glyph icon-j-document"></span>Document created by 
          <a href="/people/openpj" data-username="openpj" data-userid="107678" class="jive-username-link  jiveTT-hover-user  ">openpj</a> 
          <img src="/resources/statics/rolebadges/roleBadge-4-1004-1479735707524.png?a=1479735707542" title="Moderator" alt="Moderator" height="16" width="16" class="j-role-badge"> on Dec 28, 2015
         </div>
         <span class="j-version js-version"><span class="jive-icon-glyph icon-stack"></span>Version 1</span>
         <span class="j-version j-showdoc js-showdoc"><span class="js-show font-color-link" aria-hidden="false">Show Document</span><span class="js-hide font-color-link" aria-hidden="true">Hide Document</span></span>
        </div>
        <ul class="j-item-actions">
         <li class="j-item-action j-js-follow-controls"><span id="acclaim-container-102-5462" data-type="medium" data-can-apply="false" data-acclaim-type="like" data-bullet="true" data-acclaim-count="0" class="js-acclaim-container acclaim-container acclaim-like-container j-disabled"><span class="j-social-action"><span class="jive-icon-glyph icon-thumbs-up3"><span class="icon-variant-unlike"></span><span class="icon-variant-disabled"></span></span>Like</span><span class="j-action-bullet">  </span><label class="j-508-label" id="showAcclaim-5462-102-count-label">Show 0 Likes</label><a class="j-people-count j-rc3 jive-acclaim-likedlink" data-command="showAcclaim" data-acclaim-type="like" data-object-id="5462" data-object-type="102" data-count="0" href="#" role="button" aria-labelledby="showAcclaim-5462-102-count-label" title="Show 0 Likes">0</a> </span></li>
         <li class="j-item-action jive-comment-link" data-jive-view="apps/content/region/comment_link_region_view"><span><span class="jive-icon-glyph icon-comment3"></span>Comment</span><span class="j-action-bullet">  </span><a class="js-view-comments" href="#comments"><span class="js-comment-link-count jive-comment-link-count">0</span></a></li>
         <li class="j-item-action j-fullscreen-action">
          <div aria-role="button" id="js-fullScreenButton" class="j-fullscreen-button" data-jive-view="apps/content/full_screen_view">
           <div class="j-fullscreen-label j-fullscreen-expanded j-btn-global" aria-hidden="false">
            <span class="jive-icon-glyph icon-expand"></span>
            <span class="j-508-label">View in full screen mode</span>
           </div>
           <div class="j-fullscreen-label j-fullscreen-normal j-btn-global" aria-hidden="true">
            <span class="jive-icon-glyph icon-retract"></span>
            <span class="j-508-label">View in normal mode</span>
           </div>
          </div></li>
        </ul>
       </header>
       <section class="j-content-body">
        <!-- [DocumentBodyStart:627d9009-01f6-477e-9cb8-eecf2ae2acc9] -->
        <div class="jive-rendered-content">
         <p><a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwiki.alfresco.com%2Fwiki%2FCategory%3AObsolete_Pages" rel="nofollow" target="_blank">Obsolete Pages</a>{{Obsolete}}<br></p>
         <p><strong><span>The official documentation is at: </span><a class="jive-link-external-small" href="http://docs.alfresco.com" rel="nofollow">http://docs.alfresco.com</a></strong><br></p>
         <p><br><br><a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FCategory%3AWeb_Scripts" rel="nofollow" target="_blank">Web Scripts</a><br></p>
         <br>
         <div>
          <h2>Table of Contents</h2>
          <br>
          <ul>
           <br>
           <li class="toclevel-1"><a class="jive-link-anchor-small" href="#w_overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
           <br>
           <li class="toclevel-1"><a class="jive-link-anchor-small" href="#w_thedemowebscripts"><span class="tocnumber">2</span> <span class="toctext">The Demo Web Scripts</span></a></li>
           <br>
           <li class="toclevel-1"><a class="" href="https://community.alfresco.com/#w_simplewebscript-java"><span class="tocnumber">3</span> <span class="toctext">SimpleWebScript.java</span></a><br>
            <ul>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_whyjson3f"><span class="tocnumber">3.1</span> <span class="toctext">Why JSON?</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_writingthewebscript28java29"><span class="tocnumber">3.2</span> <span class="toctext">Writing the Web Script (Java)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_declaringthewebscript28spring29"><span class="tocnumber">3.3</span> <span class="toctext">Declaring the Web Script (Spring)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_describingthewebscript28xml29"><span class="tocnumber">3.4</span> <span class="toctext">Describing the Web Script (XML)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_tryitout"><span class="tocnumber">3.5</span> <span class="toctext">Try it out</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_locationsofthefiles"><span class="tocnumber">3.6</span> <span class="toctext">Locations of the files</span></a></li>
             <br>
            </ul></li>
           <br>
           <li class="toclevel-1"><a class="" href="https://community.alfresco.com/#w_randomselectwebscript-java"><span class="tocnumber">4</span> <span class="toctext">RandomSelectWebScript.java</span></a><br>
            <ul>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_writingthewebscript28java29_2"><span class="tocnumber">4.1</span> <span class="toctext">Writing the Web Script (Java)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_declaringthewebscript28spring29_2"><span class="tocnumber">4.2</span> <span class="toctext">Declaring the Web Script (Spring)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_describingthewebscript28xml29_2"><span class="tocnumber">4.3</span> <span class="toctext">Describing the Web Script (XML)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_tryitout_2"><span class="tocnumber">4.4</span> <span class="toctext">Try it out</span></a></li>
             <br>
            </ul></li>
           <br>
           <li class="toclevel-1"><a class="" href="https://community.alfresco.com/#w_renditionwebscript-java"><span class="tocnumber">5</span> <span class="toctext">RenditionWebScript.java</span></a><br>
            <ul>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_customcontentmodel"><span class="tocnumber">5.1</span> <span class="toctext">Custom Content Model</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_customtransformers"><span class="tocnumber">5.2</span> <span class="toctext">Custom Transformers</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_writingthewebscript28java29_3"><span class="tocnumber">5.3</span> <span class="toctext">Writing the Web Script (Java)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_declaringthewebscript28spring29_3"><span class="tocnumber">5.4</span> <span class="toctext">Declaring the Web Script (Spring)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_describingthewebscript28xml29_3"><span class="tocnumber">5.5</span> <span class="toctext">Describing the Web Script (XML)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_tryitout_3"><span class="tocnumber">5.6</span> <span class="toctext">Try it out</span></a></li>
             <br>
            </ul></li>
           <br>
           <li class="toclevel-1"><a class="" href="https://community.alfresco.com/#w_simpledeclarativewebscript-java"><span class="tocnumber">6</span> <span class="toctext">SimpleDeclarativeWebScript.java</span></a><br>
            <ul>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_writingthewebscript28java29_4"><span class="tocnumber">6.1</span> <span class="toctext">Writing the Web Script (Java)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_declaringthewebscript28spring29_4"><span class="tocnumber">6.2</span> <span class="toctext">Declaring the Web Script (Spring)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_describingthewebscript28xml29_4"><span class="tocnumber">6.3</span> <span class="toctext">Describing the Webscript (XML)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_describingthewebscript27srenditionstemplates28ftl29"><span class="tocnumber">6.4</span> <span class="toctext">Describing the Webscript's renditions templates (FTL)</span></a></li>
             <br>
             <li class="toclevel-2"><a class="jive-link-anchor-small" href="#w_tryitout_4"><span class="tocnumber">6.5</span> <span class="toctext">Try it out</span></a></li>
             <br>
            </ul></li>
           <br>
           <li class="toclevel-1"><a class="jive-link-anchor-small" href="#w_troubleshooting"><span class="tocnumber">7</span> <span class="toctext">Troubleshooting</span></a></li>
           <br>
           <li class="toclevel-1"><a class="jive-link-anchor-small" href="#w_questions3f"><span class="tocnumber">8</span> <span class="toctext">Questions?</span></a></li>
           <br>
          </ul>
         </div>
         <h1>Overview</h1>
         <br>
         <p>During the 2008 Alfresco Barcelona Community Conference, we had a chance to look at how Alfresco's <a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts" rel="nofollow" target="_blank">Web Scripts</a> are used in a variety of interesting applications.&nbsp; Most applications took advantage of an out-of-the-box Web Script implementation known as a declarative web script.<br></p>
         <p>To keep things simple, we can think of a declarative web script as a web script whose implementation has been split into a JavaScript file and a FreeMarker template file.&nbsp; It is implemented by a class called <tt>DeclarativeWebScript</tt>.&nbsp; For those with the source code at hand, you will see this file within the project called <tt>Web Script Framework</tt>.<br></p>
         <p><strong>on Alfresco <tt>org.alfresco.web.scripts.DeclarativeWebScript</tt></strong><br></p>
         <p><strong>on Alfresco 3.3 and beyond</strong><br></p>
         <p><tt>org.springframework.extensions.webscripts.DeclarativeWebScript</tt><br></p>
         <p>A declarative web script executes by making a few assumptions about naming conventions.&nbsp; It first checks to see if there is a JavaScript file and if it finds one, it executes it.&nbsp; The JavaScript file builds a model which is then processed by a FreeMarker template.&nbsp; The <tt>DeclarativeWebScript</tt> implementation is kind enough to resolve all this stuff for us so that things are pretty easy!&nbsp; This is covered in greater depth under <a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts" rel="nofollow" target="_blank">Web Scripts</a>.<br></p>
         <p>While declarative web scripts are very cool, they are by no means our only option when it comes to <a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts" rel="nofollow" target="_blank">Web Scripts</a>.&nbsp; In fact, with the Web Scripting engine, we can really put into place any kind of Web Script implementation that we would like.<br></p>
         <p>Why would we want to do this?&nbsp; Well, here are a couple of good reasons:<br></p>
         <br>
         <ul>
          <li> You may want to have tighter control of the generated response.<br></li>
          <li> You may need access to the Alfresco Java API<br></li>
          <li> You may wish your custom web scripts to be part of a formal build process (against which you can more readily test and automate)<br></li>
          <li> You may simply prefer a stronger programming language like Java<br></li>
         </ul>
         <p>For any of these reasons and more, the Alfresco Web Script engine allows you to define your own Java Beans to implement your own <a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FWeb_Scripts" rel="nofollow" target="_blank">Web Scripts</a>!<br></p>
         <br>
         <h1>The Demo Web Scripts</h1>
         <br>
         <p>In this section, we'll look at the Java-backed Web Scripts that were demonstrated during the Barcelona community conference.&nbsp; You can see the source of these scripts further down on this page.<br></p>
         <p>Four Java-backed web scripts were built.&nbsp; These are:<br></p>
         <br>
         <ul>
          <li> <tt><a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23SimpleWebScript.java" rel="nofollow" target="_blank">#SimpleWebScript.java</a></tt> the world's simplest web script!<br></li>
          <li> <tt><a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23RandomSelectWebScript.java" rel="nofollow" target="_blank">#RandomSelectWebScript.java</a></tt><br></li>
          <li> <tt><a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23RenditionWebScript.java" rel="nofollow" target="_blank">#RenditionWebScript.java</a></tt><br></li>
          <li> <tt><a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2F%23SimpleDeclarativeWebScript.java" rel="nofollow" target="_blank">#SimpleDeclarativeWebScript.java</a></tt> replace the javascript controller with a java controller but keep FreeMarker templates for renditions<br></li>
         </ul>
         <p>There also is a ready-to-run <a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=https%3A%2F%2Fgithub.com%2FOpenPj%2Falfresco-java-backed-webscripts-demo" rel="nofollow" target="_blank">Alfresco Java-Backed WebScripts Demo project</a> on Github that allows you to run with an unique command a new Alfresco instance with all the examples installed. You can quickly identify the demo WebScripts under the family 'Alfresco Java-Backed WebScripts Demo'.<br></p>
         <br>
         <h1>SimpleWebScript.java</h1>
         <br>
         <p>Well, technically, this may not be the world' simplest web script.&nbsp; It could have been, but we decided to soup it up a bit so that it handed back JSON instead of the usual 'Hello World'.&nbsp; After all, why not keep things a little interesting?<br></p>
         <br>
         <h2>Why JSON?</h2>
         <br>
         <p>JSON is an increasingly popular format in the Web 2.0 world.&nbsp; Its versatility makes it very adaptable to HTTP.&nbsp; It has become de facto as a means of reading and writing data between services.&nbsp; While Alfresco can already consume JSON, it is very convenient to use Web Scripts as a means for producing JSON for not only Alfresco applications but also other third-party applications in your business<br></p>
         <br>
         <h2>Writing the Web Script (Java)</h2>
         <br>
         <p>The code for <tt>SimpleWebScript</tt> is provided here:<br></p>
         <br>
         <pre><br>package org.alfresco.module.demoscripts;<br><br>import java.io.IOException;<br><br>import org.springframework.extensions.webscripts.AbstractWebScript;<br>import org.springframework.extensions.webscripts.WebScriptException;<br>import org.springframework.extensions.webscripts.WebScriptRequest;<br>import org.springframework.extensions.webscripts.WebScriptResponse;<br>import org.json.JSONException;<br>import org.json.JSONObject;<br><br>public class SimpleWebScript extends AbstractWebScript<br>{<br>&nbsp;&nbsp;&nbsp; public void execute(WebScriptRequest req, WebScriptResponse res)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throws IOException<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // build a json object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JSONObject obj = new JSONObject();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // put some data on it<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.put('field1', 'data1');<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // build a JSON string and send it back<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String jsonString = obj.toString();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res.getWriter().write(jsonString);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp; catch(JSONException e)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new WebScriptException('Unable to serialize JSON');<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; <br>}<br><br></pre>
         <br>
         <p>Any Java-backed Web Script must implement the <tt>org.springframework.extensions.webscripts.WebScript</tt> interface.&nbsp; Here, we do this by simply extending the <tt>AbstractWebScript</tt> class with a class that is specifically provided so as to make building custom Web Scripts easier!<br></p>
         <p>By extending <tt>AbstractWebScript</tt>, we are left to implement one abstract method to execute.&nbsp; Thus, that's the only thing we have to code.&nbsp; We just have to tell our custom web script what to do when it is executed.<br></p>
         <p>In this case, we build a JSON object and place some data onto it.&nbsp; Nothing exciting.&nbsp; Remember, we're trying to build the world simplest web script!<br></p>
         <p>The Web Script execute method builds the JSON string and then writes to the response.&nbsp; This is the actual web script response that is sent straight out to the end user.<br></p>
         <br>
         <h2>Declaring the Web Script (Spring)</h2>
         <br>
         <p>If you now take a look at the <tt>web-scripts-application-context.xml</tt> file, you'll see how we register the <tt>SimpleWebScript</tt> with the Web Script engine.&nbsp; <br></p>
         <br>
         <pre><br>&lt;bean id='webscript.org.alfresco.demo.simple.get' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class='org.alfresco.module.demoscripts.SimpleWebScript'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent='webscript'&gt;<br>&lt;/bean&gt;<br></pre>
         <br>
         <p>The naming convention for the bean id attribute of the Spring bean declaration is important.<br></p>
         <br>
         <ul>
          <li> The prefix <tt>webscript</tt> is picked up by the Web Script engine.&nbsp; In this way, it knows that the bean you are declaring is a web script implementation.<br></li>
          <li> The ending <tt>get</tt> is picked up by the Web Script engine.&nbsp; It tells the Web Script engine which HTTP method to handle.&nbsp; In this case, an HTTP GET.<br></li>
          <li> The rest is then assumed to be the package and name of the Web Script.<br></li>
         </ul>
         <p>The Web Script engine determines the following:&nbsp; There is a web script whose implementation class is <tt>org.alfresco.module.demoscripts.SimpleWebScript</tt>.&nbsp; Its declared package name is <tt>org.alfresco.demo</tt> and its name is <tt>simple</tt>.&nbsp; It can receive HTTP GETs.<br></p>
         <br>
         <h2>Describing the Web Script (XML)</h2>
         <br>
         <p>The final thing you need to then do is provide a Web Script descriptor file.&nbsp; All web scripts need to have an XML-based descriptor file.&nbsp; This descriptor file tells the framework some of the finer details about what it should do when it receives an HTTP GET call for this Web Script.<br></p>
         <p>The descriptor file is named <tt>simple.get.desc.xml</tt>.&nbsp; This is the descriptor file for the web script named <tt>simple</tt> implementing the GET HTTP method.&nbsp; You could have multiple descriptor files for multiple methods (i.e. PUT, POST, HEAD, etc).<br></p>
         <br>
         <pre><br>&lt;webscript&gt;<br>&nbsp; &lt;shortname&gt;The World's Simplest Webscript&lt;/shortname&gt;<br>&nbsp; &lt;description&gt;Hands back a little bit of JSON&lt;/description&gt;<br>&nbsp; &lt;url&gt;/demo/simple&lt;/url&gt;<br>&nbsp; &lt;authentication&gt;none&lt;/authentication&gt;<br>&nbsp; &lt;format default=''&gt;argument&lt;/format&gt;<br>&nbsp; &lt;family&gt;Alfresco Java-Backed WebScripts Demo&lt;/family&gt;<br>&lt;/webscript&gt;<br></pre>
         <br>
         <p>The descriptor file defines metadata for the Web Script registry as well as things like authentication and format.&nbsp; Most importantly, it defines the URL that we will use to access it from the outside world.<br></p>
         <br>
         <h2>Try it out</h2>
         <br>
         <p>That's it!&nbsp; If you've built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out:<br></p>
         <br>
         <pre><br>&nbsp;&nbsp; http://localhost:8080/alfresco/service/demo/simple<br></pre>
         <br>
         <p>This will return JSON:<br></p>
         <br>
         <pre><br>&nbsp;&nbsp; { 'field1'&nbsp;: 'data1' }<br></pre>
         <br>
         <p>There you go.&nbsp; Very cool.&nbsp; Certainly not the most complex data structure, but this is just part 1.&nbsp; We until you see the other web scripts we put together!<br></p>
         <br>
         <h2>Locations of the files</h2>
         <br>
         <p><strong>On Alfresco</strong><br></p>
         <br>
         <pre><br>.jar file in &lt;Alfresco&gt;/tomcat/webapps/alfresco/WEB-INF/lib or class files in &lt;Alfresco&gt;/tomcat/webapps/alfresco/WEB-INF/classes<br>web-scripts-application-context.xml - &lt;Alfresco&gt;/tomcat/webapps/alfresco/WEB-INF/classes/alfresco<br>simple.get.desc.xml&nbsp; - &lt;Alfresco&gt;/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/demo<br></pre>
         <br>
         <p><strong>On Alfresco Share Standalone (3.3 or greater)</strong><br></p>
         <br>
         <pre><br>.jar file in &lt;tomcat&gt;/webapps/share/WEB-INF/lib or .class files in &lt;Alfresco&gt;/tomcat/webapps/alfresco/WEB-INF/classes/&lt;class folder structure&gt;<br>web-scripts-application-context.xml - &lt;tomcat&gt;/webapps/share/WEB-INF/classes/org/springframework/extensions/webscripts<br>simple.get.desc.xml&nbsp; - &lt;tomcat&gt;/webapps/share/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/demo<br></pre>
         <br>
         <h1>RandomSelectWebScript.java</h1>
         <br>
         <p>Fresh off our victory with the simple yet scrappy <tt>SimpleWebScript</tt>, we now focus our attention on something a little more complex.<br></p>
         <p>The <tt>RandomSelectWebScript</tt> demonstrates how you can stream non-text data from the Alfresco Repository to the response.&nbsp; This means that non-text content is coming out of the Alfresco Repository and is being handed back to the browser in an optimal fashion.&nbsp; This is ideal for heavy media types like audio or video!<br></p>
         <p>This web script demonstrates the following:<br></p>
         <br>
         <ul>
          <li> It takes in the path to a space within the Alfresco Repository.<br></li>
          <li> It randomly selects one content object from that space.<br></li>
          <li> It streams the selected content object back to the browser.<br></li>
         </ul>
         <p>How would something like this be used?<br></p>
         <p>In the conference, we looked at how something like this can be used to produce a 'random image' on a web page.&nbsp; All you would have to do is place an IMG tag onto a page:<br></p>
         <br>
         <pre><br><img><br></pre>
         <br>
         <p>With every browser refresh, a new image will appear.&nbsp; The select images are drawn from the <tt>/Company Home/images</tt> space.<br></p>
         <br>
         <h2>Writing the Web Script (Java)</h2>
         <br>
         <p>The code for <tt>RandomWebScript</tt> is provided here:<br></p>
         <br>
         <pre><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>package org.alfresco.module.demoscripts; <br><br>import java.io.IOException; <br>import java.util.ArrayList;<br>import java.util.List;<br>import java.util.Random;<br>import java.util.StringTokenizer;<br>import javax.servlet.http.HttpServletRequest;<br>import javax.servlet.http.HttpServletResponse;<br>import org.alfresco.model.ContentModel;<br>import org.alfresco.repo.model.Repository;<br>import org.alfresco.service.ServiceRegistry;<br>import org.alfresco.service.cmr.model.FileInfo;<br>import org.alfresco.service.cmr.repository.ContentReader;<br>import org.alfresco.service.cmr.repository.NodeRef;<br>import org.springframework.extensions.webscripts.AbstractWebScript;<br>import org.springframework.extensions.webscripts.WebScriptException;<br>import org.springframework.extensions.webscripts.WebScriptRequest;<br>import org.springframework.extensions.webscripts.WebScriptResponse;<br>import org.springframework.extensions.webscripts.servlet.WebScriptServletRequest;<br><br>public class RandomSelectWebScript extends AbstractWebScript {<br> private static Random gen = new Random();<br> private ServiceRegistry registry;<br> private Repository repository;<br><br> // for Spring injection <br> public void setRepository(Repository repository) {<br>&nbsp; this.repository = repository;<br> }<br><br> // for Spring injection <br> public void setServiceRegistry(ServiceRegistry registry) {<br>&nbsp; this.registry = registry;<br> }<br><br> public void execute(WebScriptRequest req, WebScriptResponse res) <br>&nbsp;&nbsp; throws IOException {<br>&nbsp; // get the referenced incoming node<br>&nbsp; NodeRef rootNodeRef = getNodeRef(req);<br><br>&nbsp; // draw a random child <br>&nbsp; NodeRef childNodeRef = randomChild(rootNodeRef);<br>&nbsp; // stream child back<br>&nbsp; output(res, childNodeRef);<br> }<br> protected NodeRef randomChild(NodeRef rootNodeRef) {<br>&nbsp; // count the number of children<br>&nbsp; List&lt;FileInfo&gt; files = registry.getFileFolderService().listFiles(<br>&nbsp;&nbsp;&nbsp; rootNodeRef);<br><br>&nbsp; int fileCount = files.size();<br>&nbsp; // draw random number<br>&nbsp; int draw = gen.nextInt(fileCount);<br><br>&nbsp; // our draw <br>&nbsp; FileInfo fileInfo = files.get(draw);<br>&nbsp; NodeRef nodeRef = fileInfo.getNodeRef();<br>&nbsp; return nodeRef;<br> }<br> protected NodeRef getNodeRef(WebScriptRequest req) {<br>&nbsp; // NOTE: This web script must be executed in a HTTP Servlet environment<br>&nbsp; if (!(req instanceof WebScriptServletRequest)) {<br>&nbsp;&nbsp; throw new WebScriptException(<br>&nbsp;&nbsp;&nbsp;&nbsp; 'Content retrieval must be executed in HTTP Servlet environment');<br>&nbsp; }<br><br>&nbsp; HttpServletRequest httpReq = ((WebScriptServletRequest) req) <br>&nbsp;&nbsp;&nbsp; .getHttpServletRequest();<br>&nbsp; // locate the root path<br>&nbsp; String path = httpReq.getParameter('path');<br>&nbsp; if (path == null) {<br>&nbsp;&nbsp; path = '/images';<br>&nbsp; }<br><br>&nbsp; if (path.startsWith('/')) { <br>&nbsp;&nbsp; path = path.substring(1);<br>&nbsp; }<br>&nbsp; // build a path elements list<br>&nbsp; List&lt;String&gt; pathElements = new ArrayList&lt;String&gt;();<br>&nbsp; StringTokenizer tokenizer = new StringTokenizer(path, '/');<br>&nbsp; while (tokenizer.hasMoreTokens()) {<br>&nbsp;&nbsp; String childName = tokenizer.nextToken();<br>&nbsp;&nbsp; pathElements.add(childName);<br>&nbsp; }<br>&nbsp; // look up the child<br>&nbsp; NodeRef nodeRef = null;<br>&nbsp; try {<br>&nbsp;&nbsp; NodeRef companyHomeRef = repository.getCompanyHome();<br>&nbsp;&nbsp; nodeRef = registry.getFileFolderService()<br>&nbsp;&nbsp;&nbsp;&nbsp; .resolveNamePath(companyHomeRef, pathElements).getNodeRef();<br>&nbsp; } catch (Exception ex) {<br>&nbsp;&nbsp; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,<br>&nbsp;&nbsp;&nbsp;&nbsp; 'Unable to locate path');<br>&nbsp; }<br>&nbsp; if (nodeRef == null) {<br>&nbsp;&nbsp; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,<br>&nbsp;&nbsp;&nbsp;&nbsp; 'Unable to locate path');<br>&nbsp; }<br>&nbsp; return nodeRef; <br> }<br> protected void output(WebScriptResponse res, NodeRef nodeRef) {<br>&nbsp; // stream back <br>&nbsp; try {<br>&nbsp;&nbsp; ContentReader reader = registry.getContentService().getReader(<br>&nbsp;&nbsp;&nbsp;&nbsp; nodeRef, ContentModel.PROP_CONTENT);<br>&nbsp;&nbsp; reader.getContent(res.getOutputStream());<br>&nbsp; } catch (Exception ex) {<br>&nbsp;&nbsp; throw new WebScriptException('Unable to stream output');<br>&nbsp; }<br> }<br>}<br></pre>
         <br>
         <p>To begin, the getNodeRef function is called to determine the folder that is being looked at.&nbsp; <br></p>
         <p>The important thing to note here are the exception states.&nbsp; If an exception happens, we are able to handle this gracefully by using the <tt>WebScriptException</tt> class.&nbsp; We can pass in <tt>HttpServletResponse</tt> codes which will be handed back to the end-user.<br></p>
         <p>Once we have the nodeRef for the space, we can do a random draw from the space. <br></p>
         <p>Once we have the nodeRef for a random child, we can then stream that child back to the user.&nbsp; We do this by performing an optimal stream of the content directly to the output stream.<br></p>
         <p>Once again, if an error occurs, we are wise to throw a <tt>WebScriptException</tt>.&nbsp; This will result in proper error handling back to the caller (usually, the browser).<br></p>
         <br>
         <h2>Declaring the Web Script (Spring)</h2>
         <br>
         <p>Within the module-context file, you will see the registration for the <tt>RandomSelectWebScript</tt>:&nbsp; <br></p>
         <br>
         <pre><br>&lt;bean id='webscript.org.alfresco.demo.random.get' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class='org.alfresco.module.demoscripts.RandomSelectWebScript' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent='webscript'&gt;<br>&nbsp;&nbsp; &lt;property name='repository' ref='repositoryHelper' /&gt;<br>&nbsp;&nbsp; &lt;property name='serviceRegistry' ref='ServiceRegistry' /&gt;<br>&lt;/bean&gt;<br></pre>
         <br>
         <p>For older Alfresco versions, use <br></p>
         <br>
         <pre><br>...<br>&nbsp;&nbsp; &lt;property name='repository' ref='webscripts.repo' /&gt;<br>...<br></pre>
         <br>
         <p>As before, the naming convention of the Spring bean declaration is important.<br></p>
         <br>
         <ul>
          <li> The prefix 'webscript' is picked up by the Web Script engine.&nbsp; In this way, it knows that the bean you are declaring is a web script implementation.<br></li>
          <li> The ending 'get' is picked up by the Web Script engine.&nbsp; It tells the Web Script engine which HTTP method to handle.&nbsp; In this case, an HTTP GET.<br></li>
          <li> The rest is then assumed to be the package and name of the Web Script.<br></li>
         </ul>
         <p>The Web Script engine determines the following:&nbsp; There is a web script whose implementation class is <tt>org.alfresco.module.demoscripts.RandomWebScript</tt>.&nbsp; Its declared package name is <tt>org.alfresco.demo</tt> and its name is <tt>random</tt>.&nbsp; It can receive HTTP GETs.<br></p>
         <p>Note that this Spring bean declaration is a little more interesting than the former as it takes arguments.&nbsp; The Spring bean, upon instantiation, receives references to the Repository object (managed under id <tt>repositoryHelper</tt>) and the Service Registry (managed under id <tt>ServiceRegistry</tt>).<br></p>
         <br>
         <h2>Describing the Web Script (XML)</h2>
         <br>
         <p>The XML-based descriptor file is named <tt>random.get.desc.xml</tt>.&nbsp; This is the descriptor file for the web script named <tt>random</tt> which implements the method 'GET'.<br></p>
         <br>
         <pre><br>&lt;webscript&gt;<br>&nbsp; &lt;shortname&gt;Streams a random content item&lt;/shortname&gt;<br>&nbsp; &lt;description&gt;Streams a random content item&lt;/description&gt;<br>&nbsp; &lt;url&gt;/demo/random?path={path}&lt;/url&gt;<br>&nbsp; &lt;authentication&gt;user&lt;/authentication&gt;<br>&nbsp; &lt;transaction&gt;none&lt;/transaction&gt;<br>&nbsp; &lt;format default=''&gt;argument&lt;/format&gt;<br>&nbsp; &lt;family&gt;Alfresco Java-Backed WebScripts Demo&lt;/family&gt;<br>&lt;/webscript&gt;<br></pre>
         <br>
         <p>The descriptor file defines metadata for the Web Script registry as well as things like authentication and format.&nbsp; In this case, the authentication is set to 'user' which means that we require user authentication before we can execute.&nbsp; Is this necessary?&nbsp; Not if we intend to run against folders and content that is Guest-friendly.&nbsp; However, if the content is protected in any way, then we will need to be authenticated..<br></p>
         <p>Note that this descriptor file also tells the developer that they should pass in a path argument on the request which identifies the folder from which a random select will occur.<br></p>
         <br>
         <h2>Try it out</h2>
         <br>
         <p>That's it!&nbsp; If you've built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out:<br></p>
         <br>
         <pre><br>&nbsp;&nbsp; http://localhost:8080/alfresco/service/demo/random?path=/images<br></pre>
         <br>
         <p>If you have some content in the <tt>/images</tt> directory, you should almost immediately experience it streaming back from the Alfresco Repository!<br></p>
         <br>
         <h1>RenditionWebScript.java</h1>
         <br>
         <p>By now, we are quite good at writing Java-backed Web Scripts.&nbsp; But we are not Jedi yet!&nbsp; We have one example left this one combines streaming with the power of Alfresco's transformers!<br></p>
         <p>Alfresco provides transformers right within the repository.&nbsp; This conceivably allows you to take any piece of content and quickly convert it into another preferable format.&nbsp; For example, you might have a collection of TIF images that you would like to repurpose for the web.&nbsp; However, TIF isn't ideal for the web due to its size.&nbsp; You might prefer that they are JPGs.&nbsp; Alfresco can do this kind of conversion for you!<br></p>
         <p>One option would be to convert all of your TIF images to JPG ahead of time.&nbsp; That way, when a request comes along for an image, you could just point them at the JPG.&nbsp; Not a bad idea.&nbsp; However, what if people are really only interested in 10% of the images that you have.&nbsp; Aren't you wasting time, money and resources converting the other 90%?<br></p>
         <p>Another option is one that many would argue is better than is to consider the idea of doing a 'lazy transformation'.&nbsp; This implies nothing about work ethic.&nbsp; Rather, it means that you put off doing the transformation until a request arrives.&nbsp; The first user to request a particular image may have to wait just a little longer.&nbsp; But then they'll get their JPG image.&nbsp; And every other user after them who requests the same image will benefit.<br></p>
         <p>On-demand content generation.&nbsp; Pretty cool.<br></p>
         <p>We provide just that with our third example is the <tt>RenditionWebScript</tt>.&nbsp; The <tt>RenditionWebScript</tt> takes in a path to a content object and further lets you specify the format of the content that you would like to hand back.<br></p>
         <p>You can do things like:<br></p>
         <br>
         <pre><br>&lt;A HREF='http://localhost:8080/alfresco/service/demo/rendition<br>&nbsp; &nbsp;?path=/images/myImage.tif&amp;mimetype=jpg'&gt;Click here to view the image&lt;/A&gt;<br></pre>
         <br>
         <p>The web script looks up the object and then checks to see whether a rendition of the given mimetype has already been generated.&nbsp; If not, it generates one.&nbsp; The rendition is then streamed back to the end user!<br></p>
         <p>This web script demonstrates the following:<br></p>
         <br>
         <ul>
          <li> More of the Alfresco Java API<br></li>
          <li> Example of performing transformations in Java<br></li>
          <li> Working with content models within Java-backed Web Scripts<br></li>
          <li> Streaming content optimally from the Alfresco Repository to the response<br></li>
         </ul>
         <h2>Custom Content Model</h2>
         <br>
         <p>This Web Script is the most complex of the three.&nbsp; It involves some advanced things with the Alfresco Java API.&nbsp; It also involves a custom content model.<br></p>
         <p>The custom content model is defined by the file <tt>demoscriptsModel.xml</tt>.&nbsp; This model defines a new content type called <tt>demo:rendition</tt>.&nbsp; It also defines a new aspect called <tt>demo:renditionable</tt>.<br></p>
         <p>When a new rendition is created for an existing content item, the existing content item is assigned the <tt>demo:renditionable</tt> aspect.&nbsp; This aspect places new metadata onto the existing content item.&nbsp; Specifically, this allows the existing content item to keep track of associations to its new renditions!<br></p>
         <p>The new renditions are stamped with the content type named <tt>demo:rendition</tt>.&nbsp; This provides the new renditions with a fixed type and fixed metadata.&nbsp; The metadata includes notes and a timestamp.&nbsp; These are not used by the sample code but are in place to provide an example of how you might model the renditions.&nbsp; It would allow them to keep track of things like the time they were generated and information about how the transformation was performed.<br></p>
         <br>
         <h2>Custom Transformers</h2>
         <br>
         <p>For the demonstration in Barcelona, we also included a custom transformer.&nbsp; Alfresco is fully extensible which means that you can add your own transformers pretty easily.&nbsp; In this case, all it involved was the installation of <strong>SWF Tools</strong> and an XML file that tells Alfresco how to use SWF Tools.<br></p>
         <p>This XML file is named <tt>demoscripts-transform-context.xml</tt>.&nbsp; It declares two transformers:<br></p>
         <br>
         <ul>
          <li> A transformer named <tt>transformer.Pdf2swf</tt> which uses SWF Tools to convert PDF files to SWF files.&nbsp; This is the Flash format.&nbsp; It means that we can now convert documents from PDF format to Flash!<br></li>
          <li> A transformer named <tt>transformer.complex.OpenOffice.Pdf2swf</tt> which is an instance of a <tt>ComplexContentTransformer</tt>.&nbsp; This transformer lets you execute multiple transformers in sequence!&nbsp; In this case, it is configured to first convert documents to PDF and then PDF documents to SWF!&nbsp; This means that any file type that be converted to PDF can now additionally be converted to SWF!<br></li>
         </ul>
         <p>To get this working correctly, you should install SWF Tools onto your machine and then make sure that <tt>pdf2swf</tt> is accessible from your system path.&nbsp; The easiest way to accomplish this is to copy the executable to your <tt>/alfresco/bin</tt> directory.<br></p>
         <p>Note:&nbsp; This demonstration was performed on Windows so installation on other platforms is unknown.&nbsp; It essentially will amount to getting SWF Tools installed correctly on that platform and then tweaking the <tt>demoscripts-transform-context.xml</tt> file to pick up the executable.<br></p>
         <br>
         <h2>Writing the Web Script (Java)</h2>
         <br>
         <p>The code for <tt>RenditionWebScript</tt> is provided here:<br></p>
         <br>
         <pre><br><br>package org.alfresco.module.demoscripts;<br><br>import java.io.IOException; <br>import java.io.Serializable;<br>import java.util.ArrayList; <br>import java.util.HashMap;<br>import java.util.List;<br>import java.util.Map;<br>import java.util.StringTokenizer;<br>import javax.servlet.http.HttpServletRequest;<br>import javax.servlet.http.HttpServletResponse;<br>import org.alfresco.model.ContentModel;<br>import org.alfresco.repo.content.transform.ContentTransformer;<br>import org.alfresco.repo.model.Repository;<br>import org.alfresco.service.ServiceRegistry;<br>import org.alfresco.service.cmr.model.FileFolderService;<br>import org.alfresco.service.cmr.repository.AssociationRef;<br>import org.alfresco.service.cmr.repository.ContentReader;<br>import org.alfresco.service.cmr.repository.ContentService;<br>import org.alfresco.service.cmr.repository.ContentWriter;<br>import org.alfresco.service.cmr.repository.MimetypeService;<br>import org.alfresco.service.cmr.repository.NodeRef;<br>import org.alfresco.service.cmr.repository.NodeService;<br>import org.alfresco.service.cmr.repository.TransformationOptions;<br>import org.alfresco.service.namespace.QName;<br>import org.springframework.extensions.webscripts.AbstractWebScript;<br>import org.springframework.extensions.webscripts.WebScriptException;<br>import org.springframework.extensions.webscripts.WebScriptRequest;<br>import org.springframework.extensions.webscripts.WebScriptResponse;<br>import org.springframework.extensions.webscripts.servlet.WebScriptServletRequest;<br><br>public class RenditionWebScript extends AbstractWebScript {<br> static final String NAMESPACE = 'http://www.alfresco.org/model/demoscripts/1.0'; <br> static final QName TYPE_RENDITION = QName.createQName(NAMESPACE, 'rendition');<br> static final QName PROP_NOTES = QName.createQName(NAMESPACE, 'notes');<br> static final QName PROP_TIMESTAMP = QName.createQName(NAMESPACE, 'timestamp');<br> static final QName ASPECT_RENDITIONABLE = QName.createQName(NAMESPACE, 'renditionable');<br> static final QName PROP_ASSOC_RENDITIONS = QName.createQName(NAMESPACE, 'assocRenditions');<br><br> private ServiceRegistry registry; <br> private Repository repository;<br> // for Spring injection<br> public void setRepository(Repository repository) {<br>&nbsp; this.repository = repository;<br> }<br><br> // for Spring injection <br> public void setServiceRegistry(ServiceRegistry registry) {<br>&nbsp; this.registry = registry;<br> }<br><br> public void execute(WebScriptRequest req, WebScriptResponse res) <br>&nbsp;&nbsp; throws IOException {<br>&nbsp; String targetMimetype = req.getParameter('mimetype');<br>&nbsp; if (targetMimetype == null || ''.equals(targetMimetype)) {<br>&nbsp;&nbsp; targetMimetype = 'application/x-shockwave-flash';<br>&nbsp; }<br>&nbsp; // get the referenced incoming node<br>&nbsp; NodeRef nodeRef = getNodeRef(req);<br>&nbsp; // check to see if it has the 'demo:renditionable' aspect<br>&nbsp; if (getNodeService().hasAspect(nodeRef, ASPECT_RENDITIONABLE)) {<br>&nbsp;&nbsp; // check to see if it has a rendition for this mimetype<br>&nbsp;&nbsp; List&lt;AssociationRef&gt; list = getNodeService().getTargetAssocs(<br>&nbsp;&nbsp;&nbsp;&nbsp; nodeRef, PROP_ASSOC_RENDITIONS);<br>&nbsp;&nbsp; for (AssociationRef x&nbsp;: list) {<br>&nbsp;&nbsp;&nbsp; NodeRef childNodeRef = x.getTargetRef();<br>&nbsp;&nbsp;&nbsp; if (targetMimetype.equals(guessMimetype(childNodeRef))) {<br>&nbsp;&nbsp;&nbsp;&nbsp; // stream back<br>&nbsp;&nbsp;&nbsp;&nbsp; output(res, childNodeRef);<br>&nbsp;&nbsp;&nbsp;&nbsp; return;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp; }<br>&nbsp; } else {<br>&nbsp;&nbsp; // add the aspect<br>&nbsp;&nbsp; getNodeService().addAspect(nodeRef, ASPECT_RENDITIONABLE, null);<br>&nbsp; }<br><br>&nbsp; // now generate the rendition <br>&nbsp; String sourceMimetype = guessMimetype(nodeRef);<br>&nbsp; // try to locate a transformer that will convert from this mimetype to<br>&nbsp; // our intended type<br>&nbsp; ContentTransformer transformer = getContentService().getTransformer(<br>&nbsp;&nbsp;&nbsp; sourceMimetype, targetMimetype);<br>&nbsp; // if we don't have a transformer, throw an error<br>&nbsp; if (transformer == null) {<br>&nbsp;&nbsp; throw new WebScriptException('Unable to locate transformer');<br>&nbsp; }<br>&nbsp; // determine properties about the new node<br>&nbsp; NodeRef parentRef = getNodeService().getPrimaryParent(nodeRef)<br>&nbsp;&nbsp;&nbsp; .getParentRef();<br>&nbsp; String newNodeName = getFilename(nodeRef) + '.'<br>&nbsp;&nbsp;&nbsp; + getMimetypeService().getExtension(targetMimetype);<br>&nbsp; // create the new node<br>&nbsp; NodeRef newNodeRef = getNodeService().createNode(parentRef,<br>&nbsp;&nbsp;&nbsp; ContentModel.ASSOC_CONTAINS,<br>&nbsp;&nbsp;&nbsp; QName.createQName(NAMESPACE, newNodeName), TYPE_RENDITION)<br>&nbsp;&nbsp;&nbsp; .getChildRef();<br>&nbsp; // set the name of the node<br>&nbsp; getNodeService().setProperty(newNodeRef, ContentModel.PROP_NAME,<br>&nbsp;&nbsp;&nbsp; newNodeName);<br><br>&nbsp; // add the titled aspect<br>&nbsp; Map&lt;QName, Serializable&gt; aspectProperties = new HashMap&lt;QName, Serializable&gt;();<br>&nbsp; aspectProperties.put(ContentModel.PROP_TITLE, newNodeName);<br>&nbsp; getNodeService().addAspect(newNodeRef, ContentModel.ASPECT_TITLED,<br>&nbsp;&nbsp;&nbsp; aspectProperties);<br>&nbsp; // set up transformation options<br>&nbsp; TransformationOptions options = new TransformationOptions();<br>&nbsp; options.setSourceContentProperty(ContentModel.PROP_CONTENT);<br>&nbsp; options.setSourceNodeRef(nodeRef);<br>&nbsp; options.setTargetContentProperty(ContentModel.PROP_CONTENT);<br>&nbsp; options.setTargetNodeRef(newNodeRef);<br>&nbsp; // establish a content reader (from source)<br>&nbsp; ContentReader contentReader = getContentReader(nodeRef);<br>&nbsp; contentReader.setMimetype(sourceMimetype);<br><br>&nbsp; // establish a content writer (to destination) <br>&nbsp; ContentWriter contentWriter = getContentWriter(newNodeRef);<br>&nbsp; contentWriter.setMimetype(targetMimetype);<br><br>&nbsp; // do the transformation <br>&nbsp; transformer.transform(contentReader, contentWriter, options);<br><br>&nbsp; // set up the association so that we don't do this more than once <br>&nbsp; // it is remembered on the object and looked up next time<br>&nbsp; getNodeService().createAssociation(nodeRef, newNodeRef,<br>&nbsp;&nbsp;&nbsp; PROP_ASSOC_RENDITIONS);<br><br>&nbsp; // stream the result back <br>&nbsp; output(res, newNodeRef);<br> }<br> protected String guessMimetype(NodeRef nodeRef) {<br>&nbsp; String filename = getFilename(nodeRef);<br>&nbsp; return getMimetypeService().guessMimetype(filename);<br> }<br> protected String getFilename(NodeRef nodeRef) {<br>&nbsp; return getFileFolderService().getFileInfo(nodeRef).getName();<br> }<br><br> protected NodeRef getNodeRef(WebScriptRequest req) {<br>&nbsp; // NOTE: This web script must be executed in a HTTP Servlet environment <br>&nbsp; if (!(req instanceof WebScriptServletRequest)) {<br>&nbsp;&nbsp; throw new WebScriptException(<br>&nbsp;&nbsp;&nbsp;&nbsp; 'Content retrieval must be executed in HTTP Servlet environment');<br>&nbsp; }<br>&nbsp; HttpServletRequest httpReq = ((WebScriptServletRequest) req)<br>&nbsp;&nbsp;&nbsp; .getHttpServletRequest();<br><br>&nbsp; // locate the root path <br>&nbsp; String path = httpReq.getParameter('path');<br>&nbsp; if (path == null) {<br>&nbsp;&nbsp; path = '/images';<br>&nbsp; }<br>&nbsp; if (path.startsWith('/')) {<br>&nbsp;&nbsp; path = path.substring(1);<br>&nbsp; }<br>&nbsp; // build a path elements list<br>&nbsp; List&lt;String&gt; pathElements = new ArrayList&lt;String&gt;();<br>&nbsp; StringTokenizer tokenizer = new StringTokenizer(path, '/');<br>&nbsp; while (tokenizer.hasMoreTokens()) {<br>&nbsp;&nbsp; String childName = tokenizer.nextToken();<br>&nbsp;&nbsp; pathElements.add(childName);<br>&nbsp; }<br><br>&nbsp; // look up the child <br>&nbsp; NodeRef nodeRef = null;<br>&nbsp; try {<br>&nbsp;&nbsp; NodeRef companyHomeRef = repository.getCompanyHome();<br>&nbsp;&nbsp; nodeRef = registry.getFileFolderService()<br>&nbsp;&nbsp;&nbsp;&nbsp; .resolveNamePath(companyHomeRef, pathElements).getNodeRef();<br>&nbsp; } catch (Exception ex) {<br>&nbsp;&nbsp; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,<br>&nbsp;&nbsp;&nbsp;&nbsp; 'Unable to locate path');<br>&nbsp; }<br>&nbsp; if (nodeRef == null) {<br>&nbsp;&nbsp; throw new WebScriptException(HttpServletResponse.SC_NOT_FOUND,<br>&nbsp;&nbsp;&nbsp;&nbsp; 'Unable to locate path');<br>&nbsp; }<br>&nbsp; return nodeRef;<br> }<br> protected void output(WebScriptResponse res, NodeRef nodeRef) {<br>&nbsp; // stream back<br>&nbsp; try {<br>&nbsp;&nbsp; ContentReader reader = registry.getContentService().getReader(<br>&nbsp;&nbsp;&nbsp;&nbsp; nodeRef, ContentModel.PROP_CONTENT);<br>&nbsp;&nbsp; reader.getContent(res.getOutputStream());<br>&nbsp; } catch (Exception ex) {<br>&nbsp;&nbsp; throw new WebScriptException('Unable to stream output');<br>&nbsp; }<br> }<br><br> private ContentService getContentService() { <br>&nbsp; return this.registry.getContentService();<br> }<br> private NodeService getNodeService() {<br>&nbsp; return this.registry.getNodeService();<br> }<br><br> private MimetypeService getMimetypeService() { <br>&nbsp; return this.registry.getMimetypeService();<br> }<br> private FileFolderService getFileFolderService() {<br>&nbsp; return this.registry.getFileFolderService();<br> }<br><br> private ContentReader getContentReader(NodeRef nodeRef) { <br>&nbsp; return this.registry.getContentService().getReader(nodeRef,<br>&nbsp;&nbsp;&nbsp; ContentModel.PROP_CONTENT);<br> }<br> private ContentWriter getContentWriter(NodeRef nodeRef) {<br>&nbsp; return this.registry.getContentService().getWriter(nodeRef,<br>&nbsp;&nbsp;&nbsp; ContentModel.PROP_CONTENT, true);<br> }<br>}<br></pre>
         <br>
         <p>The code this time around is a little more complex.&nbsp; In essence, it figures out what mimetype you would like to convert to and then tries to look up the content item (using getNodeRef, as before).<br></p>
         <p>Once it has the node, it then works with the content model to make sure that the content item has the <tt>demo:renditionable</tt> aspect applied.&nbsp; If not, the aspect is applied.&nbsp; It then figures out the node's mimetype and looks up the transformer to use.&nbsp; If an appropriate transformer is not found, the code elegantly throws a WebScriptException.<br></p>
         <p>A new rendition node is then created and the transformation begins.&nbsp; Once the transformation is completed, the rendition is associated up to the original content item.&nbsp; In this way, the original content item always knows where all of its renditions are!<br></p>
         <br>
         <h2>Declaring the Web Script (Spring)</h2>
         <br>
         <p>Within the <tt>module-context.xml</tt> file, you will see the registration for the <tt>RenditionSelectWebScript</tt>:&nbsp; <br></p>
         <br>
         <pre><br>&lt;bean id='webscript.org.alfresco.demo.rendition.get' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class='org.alfresco.module.demoscripts.RenditionWebScript' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent='webscript' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; depends-on='webscripts.repo'&gt;<br>&nbsp;&nbsp; &lt;property name='repository' ref='repositoryHelper' /&gt;<br>&nbsp;&nbsp; &lt;property name='serviceRegistry' ref='ServiceRegistry' /&gt;<br>&lt;/bean&gt;<br></pre>
         <br>
         <p>As before, the naming convention of the Spring bean declaration is important.<br></p>
         <br>
         <ul>
          <li> The prefix 'webscript' is picked up by the Web Script engine.&nbsp; In this way, it knows that the bean you are declaring is a web script implementation.<br></li>
          <li> The ending 'get' is picked up by the Web Script engine.&nbsp; It tells the Web Script engine which HTTP method to handle.&nbsp; In this case, an HTTP GET.<br></li>
          <li> The rest is then assumed to be the package and name of the Web Script.<br></li>
         </ul>
         <p>The Web Script engine determines the following:&nbsp; There is a web script whose implementation class is <tt>org.alfresco.module.demoscripts.RenditionWebScript</tt>.&nbsp; Its declared package name is <tt>org.alfresco.demo</tt> and its name is <tt>rendition</tt>.&nbsp; It can receive HTTP GETs.<br></p>
         <br>
         <h2>Describing the Web Script (XML)</h2>
         <br>
         <p>The XML-based descriptor file is named <tt>rendition.get.desc.xml</tt>.&nbsp; This is the descriptor file for the web script named <tt>random</tt> which implements the method 'GET'.<br></p>
         <br>
         <pre><br>&lt;webscript&gt;<br>&nbsp; &lt;shortname&gt;Streams back a rendition for a content item&lt;/shortname&gt;<br>&nbsp; &lt;description&gt;Streams back a rendition for a content item&lt;/description&gt;<br>&nbsp; &lt;url&gt;/demo/rendition?path={path}&lt;/url&gt;<br>&nbsp; &lt;authentication&gt;user&lt;/authentication&gt;<br>&nbsp; &lt;format default=''&gt;argument&lt;/format&gt;<br>&nbsp; &lt;family&gt;Alfresco Java-Backed WebScripts Demo&lt;/family&gt;<br>&lt;/webscript&gt;<br></pre>
         <br>
         <p>The descriptor file defines metadata for the Web Script registry as well as things like authentication and format.&nbsp; In this case, the authentication is set to 'user' which means that we require user authentication before we can execute.<br></p>
         <p>Note that this descriptor file also tells the developer that they should pass in a path argument on the request which identifies the source content item for which a source item should be generated.<br></p>
         <p>Note also that the mimetype argument is not specified.&nbsp; It is not required.<br></p>
         <br>
         <h2>Try it out</h2>
         <br>
         <p>That's it!&nbsp; If you've built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out:<br></p>
         <br>
         <pre><br>&nbsp;&nbsp; http://localhost:8080/alfresco/service/demo/rendition?path=/pdfs/myPdf.pdf<br></pre>
         <br>
         <p>The web script should find PDF and kick off a transformation of the PDF to Flash.&nbsp; If the transformation has been performed previously, it will not be done a second time.&nbsp; The previously generated transformation will be streamed back to the end user!<br></p>
         <p>You can also fire in a request for a specific mimetype:<br></p>
         <br>
         <pre><br>&nbsp; http://localhost:8080/alfresco/service/demo/rendition<br>&nbsp;&nbsp;&nbsp; &nbsp;?path=/images/myImage.tif&amp;mimetype=jpg<br></pre>
         <br>
         <p>If your Alfresco installation knows how to convert TIF to JPG, you should immediately see a JPG file stream your way!<br></p>
         <br>
         <h1>SimpleDeclarativeWebScript.java</h1>
         <br>
         <h2>Writing the Web Script (Java)</h2>
         <br>
         <p>The code for <em>SimpleDeclarativeWebScript.java</em> on <strong>Alfresco v3.3 and beyond</strong> is provided here:<br></p>
         <br>
         <pre><br>package org.alfresco.demo;<br><br>import java.util.HashMap;<br>import java.util.Map;<br>import org.springframework.extensions.webscripts.Cache;<br>import org.springframework.extensions.webscripts.DeclarativeWebScript;<br>import org.springframework.extensions.webscripts.Status;<br>import org.springframework.extensions.webscripts.WebScriptRequest;<br><br>public class SimpleDeclarativeWebscript extends DeclarativeWebScript {<br><br>&nbsp;&nbsp; @Override<br>&nbsp;&nbsp; protected Map&lt;String, Object&gt; executeImpl(WebScriptRequest req, Status status, Cache cache) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //put all the objects that you need in renditions to the model map<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;String, Object&gt; model = new HashMap&lt;String, Object&gt;();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.put('demo', 'Happy coding!&nbsp;:D');<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return model;<br>&nbsp;&nbsp; }<br><br>}<br></pre>
         <br>
         <p>You can use the <em>executeImpl</em> method to do your business logic and produce a custom model that will be available in the FreeMarker renditions:<br></p>
         <br>
         <ul>
          <li> <em>WebScriptRequest req</em> can be used to extract URL paths, arguments and headers<br></li>
          <li> <em>Status status</em> can be used to handle the HTTP status response and eventually the error message<br></li>
          <li> <em>Cache cache</em> can be used to cache and retrieve values<br></li>
          <li> <em>Map&lt;String, Object&gt; model</em> can be used to create a model that fit your needs.<br></li>
         </ul>
         <h2>Declaring the Web Script (Spring)</h2>
         <br>
         <p>Within the module-context file, you will see the registration for the SimpleDeclarativeWebscript.java:<br></p>
         <br>
         <pre><br>&nbsp;&nbsp; &lt;bean id='webscript.org.alfresco.demo.declarative.get'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class='org.alfresco.module.demoscripts.SimpleDeclarativeWebscript'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent='webscript'&gt;<br>&nbsp;&nbsp; &lt;/bean&gt;<br></pre>
         <br>
         <p>As before, the naming convention of the Spring bean declaration is important.<br></p>
         <br>
         <ul>
          <li> The prefix 'webscript' is picked up by the Web Script engine.&nbsp; In this way, it knows that the bean you are declaring is a web script implementation.<br></li>
          <li> The ending 'get' is picked up by the Web Script engine.&nbsp; It tells the Web Script engine which HTTP method to handle.&nbsp; In this case, an HTTP GET.<br></li>
          <li> The rest is then assumed to be the package and name of the Web Script.<br></li>
         </ul>
         <p>The Web Script engine determines the following:&nbsp; There is a web script whose implementation class is <tt>org.alfresco.demo.SimpleDeclarativeWebscript</tt>.&nbsp; Its declared package name is <tt>org.alfresco.demo</tt> and its name is <tt>declarative</tt>.&nbsp; It can receive HTTP GETs.<br></p>
         <br>
         <h2>Describing the Webscript (XML)</h2>
         <br>
         <p>The XML-based descriptor file is named declarative.get.desc.xml. This is the descriptor file for the web script named random which implements the method 'GET'.<br></p>
         <br>
         <pre><br>&lt;webscript&gt;<br>&nbsp;&nbsp; &lt;shortname&gt;Streams a declarative content item&lt;/shortname&gt;<br>&nbsp;&nbsp; &lt;description&gt;Streams a declarative content item&lt;/description&gt;<br>&nbsp;&nbsp; &lt;url&gt;/demo/declarative&lt;/url&gt;<br>&nbsp;&nbsp; &lt;url&gt;/demo/declarative.xml&lt;/url&gt;<br>&nbsp;&nbsp; &lt;url&gt;/demo/declarative.json&lt;/url&gt;<br>&nbsp;&nbsp; &lt;url&gt;/demo/declarative.html&lt;/url&gt;<br>&nbsp;&nbsp; &lt;authentication&gt;user&lt;/authentication&gt;<br>&nbsp;&nbsp; &lt;format default='html'&gt;extension&lt;/format&gt;<br>&nbsp;&nbsp; &lt;family&gt;Alfresco Java-Backed WebScripts Demo&lt;/family&gt;<br>&lt;/webscript&gt;<br></pre>
         <br>
         <p>The descriptor file defines metadata for the Web Script registry as well as things like authentication and format. In this case, the authentication is set to 'user'.<br>Note that this descriptor file also tells the developer that the rendered format can be specified with the <em>format</em> URL argument or with the <em>Accept Http Header</em> and it does support Html, Xml and Json.<br></p>
         <br>
         <h2>Describing the Webscript's renditions templates (FTL)</h2>
         <br>
         <p>The Html FreeMarker rendition file <em>declarative.get.html.ftl</em>:<br></p>
         <br>
         <pre><br><br>&nbsp; <br>&nbsp;&nbsp;&nbsp; <br>&nbsp; <br>&nbsp; <br>&nbsp;&nbsp;&nbsp; <p>Hello ${person.properties.userName}: ${demo}</p><br>&nbsp; <br><br></pre>
         <br>
         <p>The XML FreeMarker rendition file <em>declarative.get.xml.ftl</em>:<br></p>
         <br>
         <pre><br>&lt;root&gt;<br>&nbsp; &lt;msg&gt;&lt;/msg&gt;<br>&lt;/root&gt;<br></pre>
         <br>
         <p>The Json FreeMarker rendition file <em>declarative.get.json.ftl</em>:<br></p>
         <br>
         <pre><br>{&nbsp;&nbsp; 'msg': 'Hello ${person.properties.userName}: ${demo}'}<br></pre>
         <br>
         <h2>Try it out</h2>
         <br>
         <p>That's it! If you've built the AMP and deployed it, you should be able to hit the Web Script straight away and try it out to perform a request for an HTML output:<br></p>
         <br>
         <pre><br>http://localhost:8080/alfresco/service/demo/declarative<br></pre>
         <br>
         <p><br><br>If you want to get a JSON response, you can invoke the following call:<br></p>
         <br>
         <pre><br>http://localhost:8080/alfresco/service/demo/declarative.json<br></pre>
         <br>
         <p><br><br>If you want to get an XML response, you can invoke the following call:<br></p>
         <br>
         <pre><br>http://localhost:8080/alfresco/service/demo/declarative.xml<br></pre>
         <br>
         <h1>Troubleshooting</h1>
         <br>
         <p><strong>I am getting: Cannot locate template processor for template ...</strong><br></p>
         <p>If you are extending the AbstractWebScript class then it is most likely that your bean definition file is either in the wrong place, or has the wrong content. <br><span>Double check this by visiting the following link </span><a class="jive-link-external-small" href="http://localhost:8080/share/page/script/org/alfresco/module/demoscripts/simple.get" rel="nofollow">http://localhost:8080/share/page/script/org/alfresco/module/demoscripts/simple.get</a><span> (for the first example) and look at the Implementation line.&nbsp; If the implementation is not the class you created, but is the default class (DeclaritiveWebScript), then your class is not being loaded properly.</span><br>Stop Tomcat and remove your class.&nbsp; Then start tomcat again.&nbsp; If you do not see any class loading errors then that means your bean definition file is not correct.&nbsp; Move it to the correct location and restart tomcat until you are getting a class loading error.&nbsp; Then move your java class file (or jar) into the correct place and restart tomcat again.&nbsp; Visit the page above to make sure the implementation is correct.<br></p>
         <p>If you are extending the DeclarativeWebScript class then you are most likely missing your freemarker template, or it is in an incorrect location.&nbsp; Verify the location and filename are correct.<br></p>
         <br>
         <h1>Questions?</h1>
         <br>
         <p>That's it for the Java-backed web scripts.&nbsp; They're pretty simple to write and deploy.&nbsp; Bear in mind that much of what we've seen here are some pretty complex examples that make pretty good use of the Alfresco Repository Services Java API.<br></p>
         <p>For further information on Alfresco's JAVA API, please see the following Wiki articles:<br></p>
         <br>
         <ul>
          <li> Alfresco <a class="jive-link-external-small" href="https://community.alfresco.com/external-link.jspa?url=http%3A%2F%2Fwikitest.alfresco.com%2Fwiki%2FServices_Framework" rel="nofollow" target="_blank">Services Framework</a><br></li>
          <li> More to come...<br></li>
         </ul>
         <p><span>If you have any questions on Alfresco Java-backed Web Scripts or Alfresco in general, please post your question to our community forums or write to </span><a class="jive-link-email-small" href="mailto:info@alfresco.com">info@alfresco.com</a><span> for formal support options!</span><br></p>
        </div>
        <!-- [DocumentBodyEnd:627d9009-01f6-477e-9cb8-eecf2ae2acc9] -->
        <div class="j-content-helpful">
         <span class="j-item-action j-tlo-helpful-controls"></span>
         <span class="js-outcome-helpful-counts-container j-outcome-helpful-counts-container-default font-color-okay j-outcome-helpful-counts-container" data-object-type="102" data-object-id="5462" data-helpful-count="2" data-overall-count="2" data-display-overall="false">2 people found this helpful</span>
        </div>
        <!-- BEGIN attachments -->
        <div class="jive-attachments">
         <h2>Attachments</h2>
         <ul class="clearfix"></ul>
         <div class="j-attach-clip j-ui-elem"></div>
        </div>
        <!-- END attachments -->
        <div id="previewable-binary-viewer"></div>
        <div class="j-region-outcomes j-region-hidden" data-jive-view="apps/outcomes/v2_badge_view" data-object-id="5462" data-object-type="102" data-helpful-min-replies="1" data-most-liked-min-replies="4" data-most-liked-min-likes="3" data-most-liked-rollup-limit="20" data-allowed-outcome-types="[&quot;decision&quot;,&quot;success&quot;,&quot;pending&quot;,&quot;helpful&quot;,&quot;resolved&quot;]" data-use-v2-outcomes="true">
         <h2>Outcomes</h2>
         <ul class="js-outcome-badge-container j-outcome-badge-container js-outcome-summaries js-ed-102-5462" data-object-type="102" data-object-id="5462" aria-label="Outcome badges" data-allowed-outcome-types="[&quot;decision&quot;,&quot;success&quot;,&quot;pending&quot;,&quot;helpful&quot;,&quot;resolved&quot;]" data-use-v2-outcomes="true" aria-live="polite"></ul>
        </div>
       </section>
       <footer class="j-content-footer clearfix font-color-meta">
        <div class="j-content-footer-line">
         <span class="jive-content-personal font-color-meta"><strong class="font-color-meta">Visibility: </strong><span class="jive-icon-glyph icon-j-space"></span> <a class="j-container jivecontainerTT-hover-container" data-uri="https://community.alfresco.com/api/core/v3/places/1196" href="https://community.alfresco.com/community/ecm">Alfresco Content Services (ECM)</a></span>
         <span class="jive-content-footer-item"><span id="js-view-count" class="j-view-count">7031 Views</span></span>
        </div>
        <div class="j-content-footer-line">
         <span class="jive-content-footer-item">Last modified on Dec 28, 2015 3:40 AM</span>
        </div>
        <div class="j-content-footer-line">
         <div class="j-content-tags-section clearfix">
          <span class="j-content-footer-label">Tags:</span>
          <span class="j-content-tags"><span class="jive-thread-post-details-tags" id="jive-thread-post-details-tags_hqCnx"><a class="j-content-tag-label font-color-meta" href="/community/ecm/tags#/?tags=web scripts" title="Content tagged with web scripts" aria-labelledby="tag-link-tooltip-0"><span role="presentation" aria-hidden="true">web scripts</span>
             <div id="tag-link-tooltip-0" class="j-508-label">
              Content tagged with web scripts
             </div></a></span></span>
         </div>
        </div>
        <div class="j-content-footer-line">
         <div class="j-content-categories-section clearfix">
          <span class="jive-content-footer-item jive-content-footer-categories"><span class="j-content-footer-label">Categories:</span> <span class="jive-content-categories"><a class="j-content-category-label" href="https://community.alfresco.com/community/ecm/content?filterID=contentstatus[published]~category[archive]" title="Archive">Archive</a></span></span>
         </div>
        </div>
        <div class="j-content-footer-line">
         <div class="j-social-sharing-actions"></div>
        </div>
       </footer>
      </div>
      <script>var _editor_lang = document.getElementsByTagName('html')[0].lang; var _jive_video_picker__url = "?container=2004&containerType=14"; var _jive_comment_images_enabled = false; require([ 'jquery', 'jive/comment_app', 'apps/comment_app/regions/main', 'apps/pager/regions/main', 'jive/namespace', 'domReady!' ], function($j, commentApp, CommentAppMain, Pager) {var pager = new Pager( "jive-comments-all", "/replies/view.jspa?contentID=5462&contentType=102",{per_page: 100,sort: "dateasc",mode: "comments",},{regions_requested: 'true'}); if (typeof(ContentFilterHandler) != 'undefined') {ContentFilterHandler.contentLoader = pager;}var options = {resourceType:       102, resourceID:         5462, messageID:          -1, messageTarget:      'all', tabsEnabled:        false, regions_requested:  'true', contentObject: {object:            5462, contentObjectType: 102}, advEditorLnk:       'create-advanced-comment.jspa?id=', editReplyAction:    'update-advanced-comment.jspa?id=', isAnonymous:        true, isThreaded:         true, isFinalized:        false, draftEnabled:       true, draftInterval:      10, keepAliveEnabled:   true, paginate:           false, pageSize:           5, isPrintPreview:     false, rteOptions : {preset        : "mini-w-quote", preferredMode : "", startMode     : "", mobileUI      : false, toggleText    : 'Show Full Editor', alwaysUseTabText : 'Always use this editor', editDisabledText : 'You are using a device that only enables you to add content.', editDisabledSummary : 'If you access {0} from a computer, you can both add and edit your content.', height        : 200, images_enabled: window._jive_comment_images_enabled, comment: true}, i18n: {confirmDeleteComment:    'Are you sure you want to delete this comment?', postSuccessText:         'Please note: your comment was added successfully, but a moderator needs to approve it before it can be posted.', postUserWroteLabel:      '{0} wrote', postGuestWroteLabel:     'Guest wrote', cmntEditingTitle:        'Editing comment', globalAjaxError:         'An unexpected error has occurred. Please make sure that your session did not expire while viewing this page.', replyToTitle:            'Reply to {0}', formSubmitPleaseWait:    'Please Wait ...', globalLoginRequired:     'You are no longer logged in. Please {0}log in{1} to continue.', loading:				 'Loading...', advEditor:               'Use advanced editor'}}; var tabView;jive.namespace('CommentApp'); jive.CommentApp.comments    = new CommentAppMain($j.extend({ commentMode: 'comments' }, options), tabView, pager);commentApp.set(jive.CommentApp);});</script>
      <div id="jive-comments-all" class="j-content-comments-container">
       <div id="jive-all" class="j-content-comments j-content-comments-display-section j-comments-all">
        <div id="jive-rolled-up-comments" data-jive-view="apps/content/region/comment_app_view" data-show-replies="false" class="j-so-finalized-rollup j-rc4" style="display:none;">
         This content has been marked as final. 
         <a id="jive-unroll-comments" class="j-so-finalized-unroll j-comment-count" href="#"></a>
        </div>
        <section id="jive-comments-block" class="j-ripstop-replies-block">
         <a href="#" name="comments"></a>
         <ul class="j-comment-options clearfix">
          <li id="jive-comments-tab" class="jive-body-tab j-tab-selected"><a href="#">0 Comments</a></li>
         </ul>
         <!-- END tabs -->
         <div style="display:none;" id="jive-comment-post-block">
          <!-- moderation warning -->
          <!-- end moderation warning -->
          <form method="post" action="javascript:void(0);" name="jive-comment-post-form" class="j-comment-form">
           <div class="jive-error-box" id="jive-comment-error-box" style="display:none">
            <p class="jive-error-message" id="jive-comment-error" style="display:none"></p>
           </div>
           <div class="jive-comment-post-anonymous jive-form-row">
            <div class="jive-form-label">
             <input id="comment-author" name="commentGuestName">
             <label for="comment-author">Name</label>
            </div>
            <div class="jive-form-label">
             <input id="comment-email" name="commentGuestEmail">
             <label for="comment-email">Email Address</label>
            </div>
            <div class="jive-form-label">
             <input id="comment-url" name="commentGuestUrl">
             <label for="comment-url">Website Address</label>
            </div>
           </div>
           <input type="hidden" class="js-outcome-attachment" value="">
           <div>
            <textarea id="47189031970488425" class="wysiwygtext" name="body" rows="15" cols="30"></textarea>
           </div>
           <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>
           <div class="j-rte-message js-rte-message"></div>
           <div class="jive-form-buttons">
            <input type="submit" name="post" class="j-btn-callout" value="Add Comment">
            <input type="button" class="j-btn-global" name="cancel" value="Cancel">
           </div>
          </form>
         </div>
         <div style="display:none;" id="jive-comment-edit-block">
          <form method="post" action="javascript:void(0);" name="jive-comment-edit-form" class="j-comment-form">
           <div class="jive-error-box" id="jive-comment-error-box" style="display:none">
            <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>
           </div>
           <div class="jive-comment-post-anonymous">
            <div>
             <input name="name" value="">
             <label for="name">Name<span>(Required)</span></label>
            </div>
            <div>
             <input name="email" value="">
             <label for="email">Email Address<span>(Required, will not be published)</span></label>
            </div>
            <div>
             <input name="url" value="">
             <label for="url">Website Address</label>
            </div>
           </div>
           <div>
            <textarea id="47189031970883377" class="wysiwygtext" name="body" rows="15" cols="30"></textarea>
           </div>
           <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>
           <div class="j-rte-message js-rte-message"></div>
           <div class="jive-form-buttons">
            <input type="submit" name="post" class="j-btn-callout" value="Save">
            <input type="button" name="cancel" value="Cancel">
           </div>
          </form>
         </div>
         <div class="j-comment-action-bar clearfix j-comment-add-comment-link-even-when-finalized"></div>
        </section> 
        <!-- / .jive-comment-wrapper -->
        <ul class="j-comment-add-form jive-comment-section-region-all"></ul>
       </div>
      </div>
     </div>
    </div>
   </section>
   <div id="jive-footer-region" class="j-content-r2 clearfix">
    <section class="j-content-r2-wrap clearfix">
     <!-- BEGIN sidebar box 'More Like This' -->
     <div class="j-content-r2-block js-more-like-this-block" style="display:none;">
      <header>
       <h3 class="font-color-meta" id="more-like-header-102-5462">Related Content</h3>
      </header>
      <section class="j-content-r2-block-body" role="navigation" aria-labelledby="more-like-header-102-5462">
       <div id="jive-more-like-this-102-5462" class="j-more-like-this">
        <p>Retrieving data ...</p>
       </div>
      </section>
     </div>
     <!-- END sidebar box 'More Like This' -->
     <div class="j-content-r2-block">
      <header>
       <h3 class="font-color-meta" id="recommended-content">Recommended Content</h3>
      </header>
      <section class="j-content-r2-block-body" role="navigation" aria-labelledby="recommended-content">
       <ul class="j-icon-list">
        <li><span class="jive-icon-discussion-correct jive-icon-med"></span><a href="https://community.alfresco.com/thread/218083-full-text-search-in-variables">full text search in variables</a></li>
        <li><span class="jive-icon-discussion-correct jive-icon-med"></span><a href="https://community.alfresco.com/thread/208974-add-document-to-package-items-in-jbpm-workflow-form-via-java">Add document to package items in JBPM workflow form via Java</a></li>
        <li><span class="jive-icon-document jive-icon-med"></span><a href="https://community.alfresco.com/docs/DOC-5367-javascript-api-cookbook">JavaScript API Cookbook</a></li>
        <li><span class="jive-icon-document jive-icon-med"></span><a href="https://community.alfresco.com/docs/DOC-6609-creating-your-first-application-with-adf">Creating your first application with ADF</a></li>
        <li><span class="jive-icon-blog jive-icon-med"></span><a href="https://community.alfresco.com/community/devops/blog/2016/09/15/testing-alfresco-one-with-docker">Testing Alfresco One with Docker</a></li>
       </ul>
      </section>
     </div>
     <!-- BEGIN sidebar box 'Incoming Links' -->
     <div class="j-content-r2-block">
      <header>
       <h3 class="font-color-meta">Incoming Links</h3>
      </header>
      <section class="j-content-r2-block-body">
       <ul class="j-icon-list">
        <li><span class="jive-icon-med jive-icon-document" title="Document"></span><a href="https://community.alfresco.com/docs/DOC-6469-sitemap">Sitemap</a></li>
       </ul>
      </section>
     </div>
     <!-- END sidebar box 'Incoming Links' -->
    </section>
   </div>
   <div id="j-footer-wrap" class="j-js-footer-wrap">
    <footer id="j-cust-foot" class="clearfix" role="contentinfo">
     <div class="custom-footer-alfresco"> 
      <p>The Alfresco community is designed to help you learn about the possibilities of the Alfresco platform. Join now to get started!</p> 
      <a href="https://community.alfresco.com/login.jspa?registerOnly=true" target="_top">Register</a> 
      <a href="https://community.alfresco.com/content?filterID=all~objecttype~thread%5Bquestions%5D" target="_top">Forums</a> 
      <a href="https://community.alfresco.com/content?filterID=all~objecttype~objecttype%5Bblogpost%5D" target="_top">Blogs</a> 
      <a href="https://community.alfresco.com/content?filterID=all~objecttype~objecttype%5Bdocument%5D" target="_top">Wiki</a> 
      <a href="https://community.alfresco.com/docs/DOC-6469-sitemap" target="_top">Sitemap</a> 
     </div> 
     <div class="bottom-footer"> 
      <img src="/resources/images/palette-1015/logo-footer.jpg"> 
      <p> 2016 Alfresco Software, Inc. All Rights Reserved.</p> 
      <a href="https://www.alfresco.com/" target="_blank">visit Alfresco.com</a> 
     </div>
    </footer>
    <footer id="j-footer" role="contentinfo">
     <div id="j-footer-poweredBy">
      <a class="font-color-meta-light j-copyright" href="http://www.jivesoftware.com/poweredby/" target="_blank"><span class="lnk"> 2017 Jive Software</span></a>
      <span class="j-pipe"> | </span>
      <a href="http://www.jivesoftware.com/poweredby/" target="_blank" title="Jive Software Version: 2016.3.8.0, revision: 20170907114440.657a983.nomerge_2016.3.8" class="j-powered-by"><span class="lnk">Powered by</span> <span class="jive-icon-glyph icon-jivelogo"><span class="j-508-label">Jive Software</span></span></a>
     </div>
     <div class="j-footer-nav font-color-meta">
      <a class="j-footer-nav-link" href="/">Home</a>
      <span class="j-pipe j-footer-nav-link"> | </span>
      <a class="j-footer-nav-link" href="#top">Top of page</a>
      <span class="j-pipe j-footer-nav-link"> | </span>
      <a class="j-footer-nav-link" href="http://docs.jivesoftware.com/cloud_ext/end_user/jive.help.core">Help</a>
     </div>
     <div class="j-footer-jiveVersion font-color-meta">
      Jive Software Version: 2016.3.8.0, revision: 20170907114440.657a983.nomerge_2016.3.8
     </div>
     <span id="speakSpan" class="j-508-label" role="marquee" aria-live="assertive" aria-relevant="all"></span>
     <!-- Google Tag Manager --> 
     <noscript>
      <iframe src="//www.googletagmanager.com/ns.html?id=GTM-W4HV22" height="0" width="0" style="display:none;visibility:hidden"></iframe>
     </noscript> 
     <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W4HV22');</script> 
     <!-- End Google Tag Manager --> 
     <script>require([ 'ui-modules/spotlight/scripts/main', 'domReady!' ], function(spotlight){spotlight.init();});</script>
    </footer>
   </div>
  </div>
  <div id="jiveTT-note" class="jive-tooltip2 notedefault snp-mouseoffset" role="tooltip">
   <div class="jive-tooltip2-mid j-mini-modal j-mini-modal-place">
    <div class="jive-tooltip2-mid-padding j-modal-content clearfix j-js-note-body" id="jive-note-body"></div>
   </div>
  </div>
  <div id="jiveTT-note-additems" class="jive-tooltip2 notedefault snp-mouseoffset">
   <div class="jive-tooltip2-mid j-mini-modal">
    <div class="jive-tooltip2-mid-padding j-modal-content clearfix" id="jive-note-additems-body"></div>
   </div>
  </div>
  <div id="jiveTT-note-checkpoint" class="jive-tooltip2 notedefault snp-mouseoffset">
   <div class="jive-tooltip2-mid j-mini-modal">
    <div class="jive-tooltip2-mid-padding j-modal-content" id="jive-note-checkpoint-body"></div>
   </div>
  </div>
  <div id="jiveTT-note-tasks" class="jive-tooltip2 notedefault snp-mouseoffset">
   <div class="jive-tooltip2-mid j-mini-modal">
    <div class="jive-tooltip2-mid-padding j-modal-content" id="jive-note-tasks-body"></div>
   </div>
  </div>
  <div id="jiveTT-note-playbox" class="jive-tooltip2 notedefault snp-mouseoffset">
   <div class="jive-tooltip2-mid j-mini-modal">
    <div class="jive-tooltip2-mid-padding j-modal-content" id="jive-note-playbox-body"></div>
   </div>
  </div>
  <script type="application/ld+json">{"@context": "http://schema.org", "@type": "WebSite", "url": "https://community.alfresco.com", "potentialAction": {"@type": "SearchAction", "target": "https://community.alfresco.com/search.jspa?q={search_term_string}", "query-input": "required name=search_term_string"}}</script>
  <div class="j-alert-container" role="alert" aria-live="polite" aria-atomic="true"></div>
  <span id="j-speak-accessibility" class="j-508-label" role="status" aria-live="polite" aria-relevant="all" aria-atomic="true"></span>
  <script>require(['apps/shared/models/user_relationship_list_source', 'apps/shared/models/user_relationship_source' ]);</script>
  <script>require([ 'apps/follows/main', 'apps/follows/user/views/follow_user_link', 'apps/follows/user/main' ]);</script>
  <script>require([ 'jive/urlcleaner' ]);</script>
  <script>var containerShortUrl = "\/container-short.jspa"; var videoShortUrl = "\/view-video-short.jspa"; var profileShortUrl = "\/profile-short.jspa"; var profileLoadingTooltip = "Loading user profile"; var profileErrorTooltip = "There was an error loading that profile information."; var followErrorMessage = "An internal error occurred while following the object."; var ajaxErrorMessage = "An unexpected error has occurred. Please make sure that your session did not expire while viewing this page."; var ajaxNotFoundMessage = "The specified item was not found."; var ajaxUnauthorizedMessage = "You are not authorized to perform this operation. If you are not logged in please log in and try again.";
        require([
            'jquery'
        ], function($) {
            var originalWrite = document.write;
            document.write = function() {
                if(typeof $ != 'undefined' && $.isReady) {
                    console.warn("document.write called after document was loaded: ", arguments);
                } else {
                    return Function.prototype.apply.call(originalWrite, document, arguments);
                }
            }
        });
        </script>
  <script>require(['places-autocomplete']);</script>
  <script>window.appsMarketEnabled =  false ; window.anyAppsEnabled =  false ; window.appsAvailable =  false ; window.appUUIDs = "";window.appContainerVersion = "2016.3.8.0";window.appsMarketID = "211828ba-72ed-4e58-85b5-6c4730b39fb1";require([ 'jive/app/core_container/event_relay' ], function() {require([ 'osapi' ], function(osapi) {require([ 'jive/app/app-feature-disabled' ], function(AppsDisabled) {window.appsDisabled = new AppsDisabled({apps_feature_disabled: "You may not be able to view this content as Apps have been disabled for this system. Please consult your System Administrator for more information."},{disabled: true});});});require([ 'jive/app/containerDeferred', 'jive/app/syntheticContainerDeferred', 'jive/app/core_container/mock', 'jive/app/core_container/tile_app' ], function(containerDeferred, syntheticContainerDeferred, Mock, TileApp) {var mockContainer = new Mock(); containerDeferred.resolve(mockContainer); var tileApp = TileApp(); tileApp.initActionLinkContext({coreAPIType: 'osapi.jive.core.Document', id:  5462.0   }); syntheticContainerDeferred.resolve(tileApp);});});</script>
  <script>
                require(['jquery'], function($) { $.migrateMute = true; });
            </script>
  <script src="/2016.3.8.657a983/resources/scripts/gen/981fc6c1bab5436f8f2a53e13a854b1c.js"></script> 
  <script>
require([ 'jive/rte/defaultStyles' ], function(defaultStyles) {defaultStyles = ["https:\/\/community.alfresco.com\/2016.3.8.657a983\/plugins\/gamification_2016.3.8.0\/resources\/styles\/n4jive.concat.css"];require(['jiverscripts/conc/observable'], function(observable) {jive.observable = observable;}); require([ 'jive/rte/externalLinkModal' ], function(externalLinkModal) {jive.rte.mobileUI = false;});}); jive.global.typeToNumeric = {"embedded_video":1100,"webhook":1224013431,"placeTemplateEntity":1567134318,"dm":109016030,"project":600,"discussion":1,"poll":18,"profileImage":501,"blog":37,"space":14,"post":38,"announcement":22,"group":700,"2901":2901,"image":111,"placeTemplateCategory":955999628,"static":1140061448,"securityGroup":4,"externalStreamInstance":1094237539,"task":602,"system":-2,"slide":1606291040,"person":3,"extprop":-1840153649,"extStreamActivity":-960826044,"page":-2106121635,"contentVersion":120,"favorite":800,"remoteDocument":9876,"streamEntry":1501,"idea":3227383,"document":102,"update":1464927464,"video":1100,"carousel":1527402675,"mention":550,"file":102,"attachment":13,"stream":-891990144,"share":109400031,"tileInstance":1094237539,"profileField":500,"event":96891546,"outcome":2700,"tileDefinition":1803367074,"photo":102,"message":2,"url":801,"collaboration":2800,"privateprop":987082157,"interaction":2801,"comment":105,"invite":350,"user":2020,"extStreamDefinition":1803367074}; jive.global.typeToMacroName = {"embedded_video":"videolink","idea":"idea","document":"document","project":"project","update":"microblog","photo":"document","discussion":"thread","poll":"polls","video":"videolink","blog":"blog","message":"message","space":"community","url":"external-site","task":"task","file":"document","post":"blogpost","person":"user","comment":"comment","extStreamActivity":"tilestream","event":"event","group":"group"};

require(['jive/bundles/zapatec'], function(Calendar) {Calendar._TT["DEF_DATE_FORMAT"] = "%m\/%d\/%Y";});

require([ 'jquery', 'apps/follows/user/views/follow_user_link', 'apps/follows/user/main', 'jquery-plugin/jquery.placeheld', 'domReady!' ], function($, ProfileFollowView, FollowUserApp) {var followView = new ProfileFollowView({i18n: {startFollowingMessage: '<p>You are now following {0}.</p>', stopFollowingMessage:  '<p>You have stopped following {0}.</p>', pendingConnectionMessage: '<p>Note: {0} will need to approve your request</p>'}, bidirectional: false}); var jiveUserFollow = new FollowUserApp({followView: followView}); $("input[placeholder]").placeHeld();});

</script> 
  <script>var containerType = '14'; var containerID = '2004';var spotlightSearchURL = "spotlight-search";</script>
  <script>window._jive_images_enabled = false; window._jive_video_module_enabled = false; window._jive_give_badge_rte_enabled = true; window._tinymce4_tab_indent = true; window._tinymce4_jive_link_legacy_modal = false;
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("color","","TEXT", true, false, [], [{name: "0",value: ""},{name: "__default_attr",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("size","","TEXT", true, false, [], [{name: "0",value: ""},{name: "__default_attr",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("font","","TEXT", true, false, [], [{name: "0",value: ""},{name: "__default_attr",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("toc","","IMAGE", true, true, [], [], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro'), 'jive/rte/syntax/syntaxhighlightmacro' ], function() {jive.rte.macros.push(new jive.rte.Macro("code","","TEXT", false, true, [{ name: "java", deleteAll: true, params: [{ name: "__default_attr", value :"java"} ]},{ name: "plain", deleteAll: true, params: [{ name: "__default_attr", value :"plain"} ]},{ name: "xml", deleteAll: true, params: [{ name: "__default_attr", value :"xml"} ]},{ name: "html", deleteAll: true, params: [{ name: "__default_attr", value :"html"} ]},{ name: "sql", deleteAll: true, params: [{ name: "__default_attr", value :"sql"} ]}], [{name: "__default_attr",value: ["java","plain","xml","html","sql"]}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("noformat","","TEXT", true, false, [], [], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("thread","thread/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("message","message/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("external-site","bookmarks/","INLINE", false, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("document","docs/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("comment","/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("tag","tags/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""},{name: "tag",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("microblog","status/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("polls","polls/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("blogpost","blogs/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("blog","blogs/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""},{name: "name",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("community","community/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("space","community/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("user","people/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""},{name: "username",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("project","project/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("task","view-task.jspa?task=","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("group","groups/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("quote","","TEXT", false, true, [], [{name: "title",value: ""},{name: "__default_attr",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("alert","","TEXT", false, true, [{ name: "success", deleteAll: true, params: [{ name: "__default_attr", value :"success"} ,{ name: "alert", value :"success"} ]},{ name: "info", deleteAll: true, params: [{ name: "__default_attr", value :"info"} ,{ name: "alert", value :"info"} ]},{ name: "warning", deleteAll: true, params: [{ name: "__default_attr", value :"warning"} ,{ name: "alert", value :"warning"} ]},{ name: "danger", deleteAll: true, params: [{ name: "__default_attr", value :"danger"} ,{ name: "alert", value :"danger"} ]}], [{name: "__default_attr",value: ""},{name: "alert",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("flag","","INLINE", false, true, [{ name: "new", deleteAll: true, params: [{ name: "flag", value :"new"} ]},{ name: "updated", deleteAll: true, params: [{ name: "flag", value :"updated"} ]}], [], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("vimeo","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("veoh","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("dailymotion","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("youtube","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("kaltura","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""},{name: "playerKey",value: ""},{name: "playerID",value: ""},{name: "partnerID",value: ""},{name: "playerColor",value: "#FFFFFF"},{name: "sourcedomain",value: ""}], false,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("brightcove","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""},{name: "playerKey",value: ""},{name: "playerID",value: ""}], false,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("showandshare","","IMAGE", false, false, [], [{name: "__default_attr",value: ""},{name: "width",value: ""},{name: "height",value: ""},{name: "playerColor",value: "#000000"},{name: "sourcedomain",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("videomacro","","IMAGE", true, false, [], [{name: "__default_attr",value: ""},{name: "videoid",value: ""},{name: "imageURL",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("videolink","thread/","INLINE", true, false, [], [{name: "id",value: ""},{name: "0",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("application","","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "__title",value: ""},{name: "__view",value: ""},{name: "__params",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("appEmbeddedView","","INLINE", true, false, [], [{name: "_default_attr",value: ""},{name: "_appuuid",value: ""},{name: "_title",value: ""},{name: "_view",value: ""},{name: "_context",value: ""},{name: "_url",value: ""},{name: "_previewimage",value: ""},{name: "_icon",value: ""},{name: "_action_id",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("tilestream","external/","INLINE", true, false, [], [{name: "id",value: ""},{name: "__default_attr",value: ""},{name: "title",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("event","","INLINE", true, false, [{ name: "default", deleteAll: true, params: [{ name: "id", value :""} ,{ name: "__default_attr", value :""} ,{ name: "title", value :""} ]}], [{name: "id",value: ""},{name: "title",value: ""},{name: "__default_attr",value: ""}], true,false));});});
require(['application/config'], function(config) {require([ (config.tinymce4Enabled ? 'jive/rte4/macro' : 'jive/rte/macro') ], function() {jive.rte.macros.push(new jive.rte.Macro("idea","","INLINE", true, false, [{ name: "default", deleteAll: true, params: [{ name: "id", value :""} ,{ name: "__default_attr", value :""} ,{ name: "title", value :""} ]}], [{name: "id",value: ""},{name: "title",value: ""},{name: "__default_attr",value: ""}], true,false));});});
</script>
  <script src="https://community.alfresco.com/2016.3.8.657a983/resources/scripts/i18n/keys/en/bundle_en.js?h=45038a9bacb370cb5e31d1b36c6690ed"></script>
  <script>












































































































































require([ 'apps/socialgroup/membership/main' ], function(MembershipApp) {var jiveMembership = new MembershipApp({objectID:2004});}); require([ 'apps/email_notification/main', 'domReady!' ], function(EmailNotification) {new EmailNotification(5462, 102);}); require(['jquery', 'jive/util'], function ($, util) {window.publishDraft = function() {var form = $j('#documentPublishForm'); util.securedForm(form).always(function() {form.submit();});}}); require(['jquery', 'domReady!'], function($j) {$j('#jive-office-plugin-download').css('display','block'); $j('#jive-office-plugin-download > div').css('padding', '0px');});

require([ 'apps/morelikethis/main' ], function() {new jive.MoreLikeThisApp.Main({objectType: '102', objectID: '5462', containerID: "jive-more-like-this-102-5462", numResults: 5, noContentMessage: 'No similar content found', errorMessage: 'Unable to retrieve content from the server:'});});









require(['apps/core_acclaim/core_acclaim_main']);

require([ 'apps/guided_navigation/main', 'domReady!' ], function(GuidedNavigation) {new GuidedNavigation();});















































































































































































































































require([ 'sso/google-oidc-login', 'domReady!' ], function(GoogleOidcLogin) {window.jiveGoogleOidcLogin = new GoogleOidcLogin({jiveTokenName: "jive.googleoidc.login", jiveTokenGUID: "1507049274883-LR761Y737BZY6YPV4FASVOXE02M1XYWZ", clientID: "null", openIDRealm: "null", redirectURI: "https://community.alfresco.com/googleoidc/sso"});});

require(['apps/navbar/menu/custom/main', 'domReady!'], function(){new jive.Navbar.Menu.Custom.Main('#customLink0','#customLink0-menu');});

require(['apps/navbar/menu/custom/main', 'domReady!'], function(){new jive.Navbar.Menu.Custom.Main('#customLink1','#customLink1-menu');});

require(['apps/navbar/menu/custom/main', 'domReady!'], function(){new jive.Navbar.Menu.Custom.Main('#customLink2','#customLink2-menu');});


                        require(['jquery'], function($) {
                            $('#navLogin').on('click', function(e) {
                                var fragment = '';
                                if (window.location.hash.length > 1){
                                    fragment = "?fragment=" + window.location.hash.substring(1);
                                }
                                $('#navLogin').attr("href", window._jive_base_url + '/login.jspa' + fragment);
                           });
                        });
                        


            require(['apps/autosearch/autosearch_main']);
            

require([ 'apps/activity_stream/activity_notifier', 'apps/activity_stream/models/activity_stream_source', 'apps/shared/controllers/switchboard', 'domReady!', 'jive/responsive' ], function(ActivityNotifier, ActivityStreamSource) {}); require([ 'domReady!' ], function() {jive.onLoadEventComplete = true;});

require([ 'apps/authentication/main', 'apps/authentication/models/authentication_source', 'apps/userregistration/main' ], function(Authentication, AuthenticationSource, UserRegistration) {var authSource = new AuthenticationSource({forceSecure: false});var loginApp = new Authentication({authenticationSource: authSource, rememberMe: true, passwordReset: true, forgotUsername: true, externalLoginEnabled: false, showRegisterForm: true, externalLogins: [], facebookEnabled: false, facebookApplicationID: 'blank', usernameIsEmail: false});});

require(['apps/social_sharing/main'], function(SocialSharing) {var SocialSharing = new SocialSharing();});

require(['jive/app/app-feature-disabled', 'jiveCoreApiV3'], function() {require(['gadgets', 'shindig', 'osapi']);});

</script> 
  <!-- plugin javascript -->
  <script src="https://community.alfresco.com/2016.3.8.657a983/plugins/event-type-plugin_2016.3.8.0/resources/script/bootstrapper.js"></script>
  <!-- end plugin javascript -->
  <script src="https://munchkin.marketo.net/munchkin.js" type="application/javascript"></script>
  <script type="text/javascript">Munchkin.init("453-LIZ-762");</script> 
  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"errorBeacon":"bam.nr-data.net","licenseKey":"e1336a1f47","agent":"","beacon":"bam.nr-data.net","applicationTime":269,"applicationID":"17204210","transactionName":"b1xUN0YHXEVRWxIMWFYWYxFdSVZZU0tJTw==","queueTime":0}</script>
 </body>
</html>