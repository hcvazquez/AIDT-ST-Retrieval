<!doctype html>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en">
 <head>
  <link rel="canonical" href="https://msdn.microsoft.com/en-us/library/bb299886.aspx"> 
  <title>An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET</title> 
  <meta name="DCS.dcsuri" content="/en-us/library/bb299886(d=default,l=en-us,v=msdn.10).aspx"> 
  <meta name="NormalizedUrl" content="https://msdn.microsoft.com/en-us/library/bb299886(d=default,l=en-us,v=msdn.10).aspx"> 
  <meta name="ms.normalizedurl" content="https://msdn.microsoft.com/en-us/library/bb299886(d=default,l=en-us,v=msdn.10).aspx"> 
  <meta name="VotingContextUrl" content="https://msdn.microsoft.com/en-us/library/bb299886(d=default,l=en-us,v=msdn.10).aspx"> 
  <meta name="MN" content="FB361395-12:52:05 PM"> 
  <meta name="Search.ShortId" content="bb299886"> 
  <meta name="ms.shortidmsdn" content="bb299886"> 
  <meta name="ms.locale" content="en-us"> 
  <meta name="ms.prodver" content="MSDN.10"> 
  <meta name="ms.contentlang" content="EN"> 
  <meta name="ms.lang" content="EN"> 
  <meta name="ms.loc" content="US"> 
  <meta name="ms.sitever" content="2017.09.29.3"> 
  <meta name="ms.assetid" content="MSDN|dnaspp|~\html\intro_to_json.htm"> 
  <meta name="ms.auth" content="0"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <script type="text/javascript" data-do-not-move="true">
        //<![CDATA[
        var AmbientContext = null;

        (function(){
            var root = (function(){return this;}).call(null);

            var GetCookie = function(name){
                var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];
                for (var i = 0; i < cookies.length; i++) {
                    var pos = cookies[i].indexOf('=');
                    if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))
                    {
                        var cookie = cookies[i].slice(pos + 1).replace(/\+/g, ' ');
                        cookie = root.decodeURIComponent(cookie);
                        return cookie;
                    }
                }
            };

            var JsonDeserialize = function(content) {
                return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();
            };

            try {
                AmbientContext = GetCookie('AmbientContext');
                AmbientContext = AmbientContext && JsonDeserialize(AmbientContext);
            } catch(ex) {
            } finally {
                AmbientContext = AmbientContext || null;
            }
        })();
        //]]>
    </script> 
  <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js" data-do-not-move="true" data-provides="jQuery"></script> 
  <link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.6.min.css">
  <link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:ImageSprite,0:TopicResponsive,0:TopicResponsive.MediaQueries,1:CodeSnippet,1:ProgrammingSelector,1:ExpandableCollapsibleArea,0:CommunityContent,1:TopicNotInScope,1:FeedViewerBasic,1:ImageSprite,2:Header,2:HeaderFooterSprite,2:Header.MediaQueries,3:Banner.MediaQueries,0:Breadcrumbs,0:Breadcrumbs.MediaQueries,0:ResponsiveToc,0:ResponsiveToc.MediaQueries,0:LibraryMemberFilter,2:Footer,2:Footer.MediaQueries,4:StandardRating,5:LinkList,0:BaseResponsive,6:MsdnResponsive,0:Tables.MediaQueries;/Areas/Library/Content:0,/Areas/Epx/Content/Css:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Epx/Shared/Content:3,/Areas/Global/Content:4,/Areas/Epx/Themes/Base/Content:5,/Areas/Library/Themes/Msdn/Content:6&amp;amp;v=DDD1A2DAE878408650C0553AB40839AB">
 </head> 
 <body class="library Chrome"> 
  <div id="page"> 
   <link type="text/css" rel="stylesheet"> 
   <input type="hidden" id="isHeaderBleeding" value="true"> 
   <div id="ux-header" dir="ltr" class="ltr msdn" ms.pgarea="header"> 
    <div id="ux-banner"> 
     <div id="msccBanner" dir="ltr" data-site-name="msdn.microsoft.com" data-mscc-version="0.3.6" data-nver="aspnet-2.0.6" data-sver="0.1.2" class="cc-banner" role="alert">
      <div class="cc-container">
       <svg class="cc-icon cc-v-center" x="0px" y="0px" viewbox="0 0 44 44" height="30px" fill="none" stroke="currentColor">
        <circle cx="22" cy="22" r="20" stroke-width="2"></circle>
        <line x1="22" x2="22" y1="18" y2="33" stroke-width="3"></line>
        <line x1="22" x2="22" y1="12" y2="15" stroke-width="3"></line>
       </svg> 
       <span class="cc-v-center cc-text">This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> 
       <a href="https://go.microsoft.com/fwlink/?linkid=845480" aria-label="Learn more about Microsoft’s Cookie Policy" id="msccLearnMore" class="cc-link cc-v-center cc-float-right" data-mscc-ic="false">Learn more</a>
      </div>
     </div> 
    </div> 
    <header> 
     <span id="singleCol"></span> 
     <span id="doubleCol"></span> 
     <span id="isMobile"></span> 
     <div> 
      <div class="row topRow" role="banner"> 
       <div class="top"> 
        <div class="left"> 
         <a class="msdnLogoImg" href="https://msdn.microsoft.com/en-us" title="MSDN home" ms.cmpgrp="mslogo"> 
          <div class="clip70x15"> 
           <img alt="Microsoft Logo" id="msft-logo" class="msft-logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636422593544160354"> 
          </div> </a> 
         <div class="GrayPipeDiv clip1x18"> 
          <img alt="Gray Pipe" class="GrayPipe" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636422593544160354"> 
         </div> 
         <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/en-us">Developer Network</a> 
         <a class="DevCenterFullName" href="https://msdn.microsoft.com/en-us">Developer Network</a> 
         <a class="DevCenterShortName" href="https://msdn.microsoft.com/en-us">Developer</a> 
        </div> 
        <div class="right" ms.cmpgrp="aux nav"> 
         <div id="signIn" aria-label="Profile button"> 
          <div class="profileImage"></div> 
          <a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=13&amp;ct=1506973925&amp;rver=6.7.6640.0&amp;wp=mcmbi&amp;wlcxt=msdn%24msdn%24msdn&amp;wreply=https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fbb299886.aspx&amp;lc=1033&amp;id=254354&amp;mkt=en-us">Sign in</a>
         </div> 
         <div class="auxNav"> 
          <div> 
           <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml"> 
            <a href="https://my.visualstudio.com/?wt.mc_id=o~msft~msdn~nav~subscriber&amp;campaign=o~msft~msdn~nav~subscriber" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml"> <p xmlns="">Subscriber portal</p> </a> 
           </div> 
           <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml"> 
            <a href="https://www.visualstudio.com/free-developer-offers/" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">Get tools</a> 
           </div> 
          </div> 
          <div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="row middleRow"> 
       <div class="expandTop"> 
        <div class="left"></div> 
        <div class="right"></div> 
       </div> 
      </div> 
     </div> 
     <div id="buttomRowWrapper" class="bg_default"> 
      <div class="row buttomRow bg_default"> 
       <div class="bottom"> 
        <div class="left" role="navigation" aria-label="header toc" ms.cmpgrp="main nav"> 
         <a id="grip" class="menu-icon" href="javascript:void(0)" role="button" aria-label="navigation menu" data-mscc-ic="false"></a> 
         <div id="drawer"> 
          <div class="toc"> 
           <nav> 
            <ul class="navL1"> 
             <li class="inactive toggle"> <a href="javascript:void(0)" role="button" aria-expanded="false" data-mscc-ic="false">Downloads</a> 
              <ul class="navL2"> 
               <li class="inactive"> <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" role="link" title="Visual Studio">Visual Studio</a> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" role="link" title="SDKs">SDKs</a> </li> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Trial software" role="button" aria-expanded="false" data-mscc-ic="false">Trial software</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/evalcenter" title="Free downloads" role="link">Free downloads</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office resources" role="link">Office resources</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 resources" role="link">SharePoint Server 2013 resources</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express resources" role="link">SQL Server 2014 Express resources</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 resources" role="link">Windows Server 2012 resources</a> </li> 
                </ul> </li> 
              </ul> </li> 
             <li class="inactive toggle"> <a href="javascript:void(0)" role="button" aria-expanded="false" data-mscc-ic="false">Programs</a> 
              <ul class="navL2"> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Subscriptions" role="button" aria-expanded="false" data-mscc-ic="false">Subscriptions</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="Overview" role="link">Overview</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators" role="link">Administrators</a> </li> 
                </ul> </li> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Students" role="button" aria-expanded="false" data-mscc-ic="false">Students</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine" role="link">Microsoft Imagine</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft Student Partners" role="link">Microsoft Student Partners</a> </li> 
                </ul> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/applicationbuilder" role="link" title="ISV">ISV</a> </li> 
               <li class="inactive"> <a href="https://www.microsoft.com/bizspark" role="link" title="Startups">Startups</a> </li> 
               <li class="inactive"> <a href="https://events.microsoft.com/" role="link" title="Events">Events</a> </li> 
              </ul> </li> 
             <li class="inactive toggle"> <a href="javascript:void(0)" role="button" aria-expanded="false" data-mscc-ic="false">Community</a> 
              <ul class="navL2"> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/magazine/dd767791" role="link" title="Magazine">Magazine</a> </li> 
               <li class="inactive"> <a href="https://social.msdn.microsoft.com/forums/" role="link" title="Forums">Forums</a> </li> 
               <li class="inactive"> <a href="https://blogs.msdn.microsoft.com/" role="link" title="Blogs">Blogs</a> </li> 
               <li class="inactive"> <a href="https://channel9.msdn.com/" role="link" title="Channel 9">Channel 9</a> </li> 
              </ul> </li> 
             <li class="inactive current toggle"> <a href="javascript:void(0)" role="button" aria-expanded="false" data-mscc-ic="false">Documentation</a> 
              <ul class="navL2"> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library" role="link" title="APIs and reference">APIs and reference</a> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/developer-centers-msdn" role="link" title="Dev centers">Dev centers</a> </li> 
               <li class="inactive"> <a href="https://code.msdn.microsoft.com/" role="link" title="Samples">Samples</a> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/mt703209" role="link" title="Retired content">Retired content</a> </li> 
              </ul> </li> 
            </ul> 
           </nav> 
          </div> 
         </div> 
        </div> 
        <div class="right" ms.title="search" role="search"> 
         <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml"> 
          <div class="SearchBox"> 
           <form id="HeaderSearchForm" name="HeaderSearchForm" method="get"> 
            <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button" role="button" aria-label="search finder"> 
             <div id="search-finder-div" class="clip16x20"> 
              <img alt="search finder" id="search-finder" class="search-finder" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636422593544160354"> 
             </div> </button> 
            <button id="HeaderSearchButton" style="display:none"></button> 
            <div id="searchSplitter"></div> 
            <div id="searchCloseIconDiv" class="clip16x20" tabindex="0"> 
             <img alt="search clear" id="searchCloseIcon" class="search-clear-x" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636422593544160354"> 
            </div> 
            <div id="searchTextContainer" style="width: 0;"> 
             <input id="HeaderSearchTextBox" name="query" type="text" aria-label="search edit textbox" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)"> 
            </div> 
           </form> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </header> 
   </div> 
   <div id="jumpInfo" style="display: none">
    We’re sorry. The content you requested has been removed. You’ll be auto redirected in 1 second.
   </div> 
   <link type="text/css" rel="stylesheet"> 
   <link type="text/css" rel="stylesheet"> 
   <div id="breadcrumbs" ms.pgarea="body" ms.cmpgrp="breadcrumbs"> 
    <div id="breadcrumbDesktop" class="breadCrumb"> 
     <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/dd560515.aspx" title="Articles and Overviews"></a></span> 
     <span><a href="https://msdn.microsoft.com/en-us/library/aa286485.aspx" title="Web Applications (ASP.NET)"><span>Web Applications (ASP.NET)</span></a></span> 
     <span><a href="https://msdn.microsoft.com/en-us/library/aa137125.aspx" title="ASP.NET"><span>ASP.NET</span></a></span> 
     <span class="breadcrumbDropSmall"> <a id="breadcrumbDropDownButton" href="#" targethref="https://msdn.microsoft.com/en-us/library/aa137125.aspx" title="Client-side Development"><span>Client-side Development</span></a> </span> 
    </div> 
    <div id="breadcrumbDropDownMenu"></div> 
    <div id="breadcrumbTablet" class="breadCrumb"> 
     <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/aa137125.aspx" title="ASP.NET"></a></span> 
     <span><a href="https://msdn.microsoft.com/en-us/library/aa530946.aspx" title="Client-side Development"><span>Client-side Development</span></a></span> 
     <span class="breadcrumbDropSmall"><a id="tocDropDownButton" href="#" title="An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET"><span>An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET</span></a></span> 
    </div> 
    <div id="tocDropDownMenu"></div> 
    <div id="breadcrumbMobile" class="breadCrumb"> 
     <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/aa530946.aspx" title="Client-side Development"></a></span> 
     <span class="breadcrumbDropSmall"><a id="tocPopupButton" href="#" title="An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET"><span>An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET</span></a></span> 
    </div> 
   </div> 
   <div id="tocPopupMenu"> 
    <div id="tocPopMenuClose" class="tocCloseLarge"></div> 
    <div id="tocTitle">
     An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET
    </div> 
   </div> 
   <div id="body" ms.pgarea="body" class=""> 
    <span id="tabletView_large"></span> 
    <span id="tabletView_small"></span> 
    <span id="mobileView"></span> 
    <div id="leftNav" ms.cmpgrp="left toc" role="navigation" aria-label="left toc"> 
     <div id="tocnav" class="ArchiveV2"> 
      <div class="tocunselected"> 
       <div id="tocExpandArea"> 
        <span class="toc_empty"></span> 
        <span id="tocExpandButton"><a href="javascript:void(0)" aria-label="expand sibling toc" role="button"></a></span> 
       </div> 
       <div id="tocExpand"></div> 
      </div> 
      <div class="tocselected"></div> 
      <div class="tocunselected"> 
       <div class="toclevel current" data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/bb299886.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET">An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/aa479326.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Design ASP.NET Pages and Controls That Take Advantage of the DHTML Object Model, Part I">Design ASP.NET Pages and Controls That Take Advantage of the DHTML Object Model, Part I</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/aa479327.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Design ASP.NET Pages and Controls That Take Advantage of the DHTML Object Model, Part II">Design ASP.NET Pages and Controls That Take Advantage of the DHTML Object Model, Part II</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/aa478975.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Injecting Client-Side Script from an ASP.NET Server Control">Injecting Client-Side Script from an ASP.NET Server Control</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/ms972956.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Life Without Refresh">Life Without Refresh</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/aa479011.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Using JavaScript Along with ASP.NET">Using JavaScript Along with ASP.NET</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/aa479302.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Working with Client-Side Script">Working with Client-Side Script</a> 
       </div> 
      </div> 
      <a id="tocMenuToggler" href="javascript:void(0)" role="button"> <span id="tocMenuTogglerIcon" class="tocMenuCollapse" role="button" aria-expanded="true" aria-label="Table of contents menu"></span> 
       <div id="tocMenuTogglerLabel">
        TOC
       </div> </a> 
     </div> 
     <div style="display:none"> 
      <div id="CollapseLocalizeString">
       Collapse the table of content
      </div> 
      <div id="ExpandLocalizeString">
       Expand the table of content
      </div> 
     </div> 
     <div> 
      <a id="isd_archiveControlResponsive" style="display:none;" href="javascript:void(0)" role="button" aria-label="Hide Archived Versions" data-include-archive="Show Archived Versions" data-exclude-archive="Hide Archived Versions"> </a> 
      <div id="isd_archiveInstrument" style="display:none">
       This documentation is archived and is not being maintained.
      </div> 
     </div> 
    </div> 
    <div id="content" class="content" ms.cmpgrp="content body" role="main"> 
     <div id="archiveDisclaimerText" style="display:none">
      This documentation is archived and is not being maintained.
     </div> 
     <div class="topic" xmlns="http://www.w3.org/1999/xhtml"> 
      <h1 class="title">An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET</h1> 
      <div id="scrollyes">
       &nbsp; 
       <h1 class="dtH1"><a id="intro_to_json"></a>An Introduction to JavaScript Object Notation (JSON) in JavaScript and .NET</h1> 
       <p>Atif Aziz, Scott Mitchell</p> 
       <p>February 2007</p> 
       <p>Applies to:<br> &nbsp;&nbsp;&nbsp;JSON<br> &nbsp;&nbsp;&nbsp;Ajax</p> 
       <p><strong>Summary:</strong> This article discusses JavaScript Object Notation (or JSON), an open and text-based data exchange format, that provides a standardized data exchange format better suited for Ajax-style web applications. (22 printed pages)</p> 
       <h4 class="dtH1">Contents</h4> 
       <p><a href="#intro_to_json_topic1">Introduction</a><br> <a href="#intro_to_json_topic2">Understanding Literal Notation in JavaScript</a><br> <a href="#intro_to_json_topic3">Comparing JSON to XML</a><br> <a href="#intro_to_json_topic4">Creating and Parsing JSON Messages with JavaScript</a><br> <a href="#intro_to_json_topic5">Working with JSON in the .NET Framework</a><br> <a href="#intro_to_json_topic6">Conclusion</a><br> <a href="#intro_to_json_topic7">References</a></p> 
       <p><a href="http://download.microsoft.com/download/3/e/5/3e57adfb-2b29-4595-b2b0-bd1eaf2c3ac2/IntroToJSONSamples.msi" target="_top">Download the source code for this article</a>.</p> 
       <h2 class="dtH1"><a id="intro_to_json_topic1"></a>Introduction</h2> 
       <p>When designing an application that will communicate with a remote computer, a data format and exchange protocol must be selected. There are a variety of open, standardized options, and the ideal choice depends on the applications requirements and pre-existing functionality. For example, SOAP-based web services format the data in an XML payload wrapped within a SOAP envelope.</p> 
       <p>While XML works well for many application scenarios, it has some drawbacks that make it less than ideal for others. One such space where XML is often less than ideal is with Ajax-style web applications. Ajax is a technique used for building interactive web applications that provide a snappier user experience through the use of out-of-band, lightweight calls to the web server in lieu of full-page postbacks. These asynchronous calls are initiated on the client using JavaScript and involve formatting data, sending it to a web server, and parsing and working with the returned data. While most browsers can construct, send, and parse XML, JavaScript Object Notation (or JSON) provides a standardized data exchange format that is better-suited for Ajax-style web applications.</p> 
       <p>JSON is an open, text-based data exchange format (see <a href="http://www.ietf.org/rfc/rfc4627.txt">RFC 4627</a>). Like XML, it is human-readable, platform independent, and enjoys a wide availability of implementations. Data formatted according to the JSON standard is lightweight and can be parsed by JavaScript implementations with incredible ease, making it an ideal data exchange format for Ajax web applications. Since it is primarily a data format, JSON is not limited to just Ajax web applications, and can be used in virtually any scenario where applications need to exchange or store structured information as text.</p> 
       <p>This article examines the JSON standard, its relationship to JavaScript, and how it compares to XML. <a href="http://jayrock.berlios.de/">Jayrock</a>, an open-source JSON implementation for .NET, is discussed and examples of creating and parsing JSON messages are provided in JavaScript and C#.</p> 
       <h2 class="dtH1"><a id="intro_to_json_topic2"></a>Understanding Literal Notation in JavaScript</h2> 
       <p>Literals are used in programming languages to <em>literally</em> express fixed values, such as the constant integer value of 4, or the string "Hello, World." Literals can be used in most languages wherever an expression is allowed, such as part of a condition in a control statement, an input parameter when calling a function, in variable assignment, and so forth. For example, the following C# and Visual Basic code initializes the variable <strong>x</strong> with the constant integer value of <strong>42</strong>.</p> 
       <pre class="code"><code><strong>int x = 42; // C# Dim x As Integer = 42 ' Visual Basic</strong></code></pre> 
       <p>Different programming languages allow for literals of different types. Most programming languages support, at minimum, literals for scalar types like integers, floating-point numbers, strings, and Boolean. What's interesting about JavaScript is that in addition to scalar types, it also supports literals for structured types like arrays and objects. This feature allows for a terse syntax for on-demand creation and initialization of arrays and objects.</p> 
       <p>Array literals in JavaScript are composed of zero or more expressions, with each expression representing an element of the array. The array elements are enclosed in square brackets (<strong>[]</strong>) and delimited by commas. The following example defines an array <em>literally</em> with seven string elements holding the names of the seven continents:</p> 
       <pre class="code"><code><strong>var continents = ["Europe", "Asia", "Australia", "Antarctica", "North America", "South America", "Africa"]; alert(continents[0] + " is one of the " + continents.length + " continents.");</strong></code></pre> 
       <p>Compare this now to how you would create and initialize an array in JavaScript without the literal notation:</p> 
       <pre class="code"><code><strong>var continents = new Array(); continents[0] = "Europe"; continents[1] = "Asia"; continents[2] = "Australia"; continents[3] = "Antarctica"; continents[4] = "North America"; continents[5] = "South America"; continents[6] = "Africa";</strong></code></pre> 
       <p>An object literal defines the members of an object and their values. The list of object members and values is enclosed in curly braces (<strong>{}</strong>) and each member is delimited by a comma. Within each member, the name and value are delimited by a colon (<strong>:</strong>). The following example creates an object and initializes it with three members named <strong>Address</strong>, <strong>City</strong>, and <strong>PostalCode</strong> with respective values "<strong>123 Anywhere St.</strong>", "<strong>Springfield</strong>", and "<strong>99999</strong>."</p> 
       <pre class="code"><code><strong>var mailingAddress = { "Address" : "123 Anywhere St.", "City" : "Springfield", "PostalCode" : 99999 }; alert("The package will be shipped to postal code " + mailingAddress.PostalCode);</strong></code></pre> 
       <p>The examples presented thus far illustrate using string and numeric literals within array and object literals. You can also express an entire graph by using the notation recursively such that array elements and object member values can themselves, in turn, use object and array literals. For example, the following snippet illustrates an object that has an array as a member (<strong>PhoneNumbers</strong>), where the array is composed of a list of objects.</p> 
       <pre class="code"><code><strong>var contact = { "Name": "John Doe", "PermissionToCall": true, "PhoneNumbers": [ { "Location": "Home", "Number": "555-555-1234" }, { "Location": "Work", "Number": "555-555-9999 Ext. 123" } ] }; if (contact.PermissionToCall) { alert("Call " + contact.Name + " at " + contact.PhoneNumbers[0].Number); }</strong></code></pre> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;A more thorough discussion of literal support for JavaScript can be found in the 
        <a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Guide">Core JavaScript 1.5 Guide</a> under the 
        <a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Guide:Literals">Literals section</a>.
       </blockquote> 
       <h3 class="dtH1">From JavaScript Literals to JSON</h3> 
       <p>JSON is a data exchange format that was created from a subset of the literal object notation in JavaScript. While the syntax accepted by JavaScript for literal values is very flexible, it is important to note that JSON has much stricter rules. According to the JSON standard, for example, the name of an object member <em>must</em> be a valid JSON string. A string in JSON <em>must</em> be enclosed in quotation marks. JavaScript, on the other hand, allows object member names to be delimited by quotation marks or apostrophes or to omit quoting altogether so long as the member name doesn't conflict with a reserved JavaScript keyword. Likewise, an array element or an object member value in JSON is limited to a very limited set. In JavaScript, however, array elements and object member values can refer to pretty much any valid JavaScript expression, including function calls and definitions!</p> 
       <p>The charm of JSON is in its simplicity. A message formatted according to the JSON standard is composed of a single top-level object or array. The array elements and object values can be objects, arrays, strings, numbers, Boolean values (true and false), or null. That, in a nutshell, is the JSON standard! It's really that simple. See <a href="http://www.json.org/">www.json.org</a> or <a href="http://www.ietf.org/rfc/rfc4627.txt">RFC 4627</a> for a more formal description of the standard.</p> 
       <p>One of the sore points of JSON is the lack of a date/time literal. Many people are surprised and disappointed to learn this when they first encounter JSON. The simple explanation (consoling or not) for the absence of a date/time literal is that JavaScript never had one either: The support for date and time values in JavaScript is entirely provided through the <a href="http://msdn2.microsoft.com/en-us/library/cd9w2te4.aspx">Date</a> object. Most applications using JSON as a data format, therefore, generally tend to use either a string or a number to express date and time values. If a string is used, you can generally expect it to be in the <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601 format</a>. If a number is used, instead, then the value is usually taken to mean the number of milliseconds in Universal Coordinated Time (UTC) since epoch, where epoch is defined as midnight January 1, 1970 (UTC). Again, this is a mere convention and not part of the JSON standard. If you are exchanging data with another application, you will need to check its documentation to see how it encodes date and time values within a JSON literal. For example, Microsoft's ASP.NET AJAX uses neither of the described conventions. Rather, it encodes .NET <a href="http://msdn2.microsoft.com/en-us/library/system.datetime.aspx">DateTime</a> values as a JSON string, where the content of the string is <strong>\/Date(ticks)\/</strong> and where <em>ticks</em> represents milliseconds since epoch (UTC). So November 29, 1989, 4:55:30 AM, in UTC is encoded as "<strong>\/Date(628318530718)\/</strong>". For some rationale behind this rather contrived choice of encoding, see "<a href="#intro_to_json_sidebarb">Inside ASP.NET AJAX’s JSON date and time string</a>."</p> 
       <h2 class="dtH1"><a id="intro_to_json_topic3"></a>Comparing JSON to XML</h2> 
       <p>Both JSON and XML can be used to represent native, in-memory objects in a text-based, human-readable, data exchange format. Furthermore, the two data exchange formats are isomorphic—given text in one format, an equivalent one is conceivable in the other. For example, when calling one of <a href="http://developer.yahoo.com/">Yahoo!'s publicly accessible web services</a>, you can indicate via a querystring parameter whether the response should be formatted as XML or JSON. Therefore, when deciding upon a data exchange format, it's not a simple matter of choosing one over the other as a silver bullet, but rather what format has the <em>characteristics</em> that make it the best choice for a particular application. For example, XML has its roots in marking-up document text and tends to shine very well in that space (as is evident with XHTML). JSON, on the other hand, has its roots in programming language types and structures and therefore provides a more natural and readily available mapping to exchange structured data. Beyond these two starting points, the following table will help you to understand and compare the key characteristics of XML and JSON.</p> 
       <p class="label"><strong>Key Characteristic Differences between XML and JSON</strong></p> 
       <div class="tablediv">
        <table class="dtTABLE" responsive="true" summary="table"> 
         <tbody>
          <tr responsive="true">
           <th scope="col">Characteristic</th>
           <th scope="col">XML</th>
           <th scope="col">JSON</th>
          </tr> 
          <tr>
           <td data-th="Characteristic">Data types</td>
           <td data-th="XML">Does not provide any notion of data types. One must rely on <a href="http://www.w3.org/XML/Schema">XML Schema</a> for adding type information.</td>
           <td data-th="JSON">Provides scalar data types and the ability to express structured data through arrays and objects.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Support for arrays</td>
           <td data-th="XML">Arrays have to be expressed by conventions, for example through the use of an outer placeholder element that models the arrays contents as inner elements. Typically, the outer element uses the plural form of the name used for inner elements.</td>
           <td data-th="JSON">Native array support.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Support for objects</td>
           <td data-th="XML">Objects have to be expressed by conventions, often through a mixed use of attributes and elements.</td>
           <td data-th="JSON">Native object support.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Null support</td>
           <td data-th="XML">Requires use of <strong>xsi:nil</strong> on elements in an XML instance document plus an import of the corresponding namespace.</td>
           <td data-th="JSON">Natively recognizes the <strong>null</strong> value.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Comments</td>
           <td data-th="XML">Native support and usually available through APIs.</td>
           <td data-th="JSON">Not supported.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Namespaces</td>
           <td data-th="XML">Supports namespaces, which eliminates the risk of name collisions when combining documents. Namespaces also allow existing XML-based standards to be safely extended.</td>
           <td data-th="JSON">No concept of namespaces. Naming collisions are usually avoided by nesting objects or using a prefix in an object member name (the former is preferred in practice).</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Formatting decisions</td>
           <td data-th="XML">Complex. Requires a greater effort to decide how to map application types to XML elements and attributes. Can create heated debates whether an element-centric or attribute-centric approach is better.</td>
           <td data-th="JSON">Simple. Provides a much more direct mapping for application data. The only exception may be the absence of date/time literal.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Size</td>
           <td data-th="XML">Documents tend to be lengthy in size, especially when an element-centric approach to formatting is used.</td>
           <td data-th="JSON">Syntax is very terse and yields formatted text where most of the space is consumed (rightly so) by the represented data.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Parsing in JavaScript</td>
           <td data-th="XML">Requires an XML DOM implementation and additional application code to map text back into JavaScript objects.</td>
           <td data-th="JSON">No additional application code required to parse text; can use JavaScript's <strong>eval</strong> function.</td>
          </tr> 
          <tr>
           <td data-th="Characteristic">Learning curve</td>
           <td data-th="XML">Generally tends to require use of several technologies in concert: <a href="http://www.w3.org/TR/xpath">XPath</a>, XML Schema, <a href="http://www.w3.org/TR/xslt">XSLT</a>, <a href="http://www.w3.org/TR/xml-names/">XML Namespaces</a>, the <a href="http://www.w3.org/DOM/">DOM</a>, and so on.</td>
           <td data-th="JSON">Very simple technology stack that is already familiar to developers with a background in JavaScript or other dynamic programming languages.</td>
          </tr> 
         </tbody>
        </table>
       </div> 
       <p>JSON is a relatively new data exchange format and does not have the years of adoption or vendor support that XML enjoys today (although JSON is catching up quickly). The following table highlights the current state of affairs in the XML and JSON spaces.</p> 
       <p class="label"><strong>Support Differences between XML and JSON</strong></p> 
       <div class="tablediv">
        <table class="dtTABLE" responsive="true" summary="table"> 
         <tbody>
          <tr responsive="true">
           <th scope="col">Support</th>
           <th scope="col">XML</th>
           <th scope="col">JSON</th>
          </tr> 
          <tr>
           <td data-th="Support">Tools</td>
           <td data-th="XML">Enjoys a mature set of tools widely available from many industry vendors.</td>
           <td data-th="JSON">Rich tool support—such as editors and formatters—is scarce.</td>
          </tr> 
          <tr>
           <td data-th="Support">Microsoft .NET Framework</td>
           <td data-th="XML">Very good and mature support since version 1.0 of the .NET Framework. XML support is available as part of the Base Class Library (BCL). For unmanaged environments, there is MSXML.</td>
           <td data-th="JSON">None so far, except an initial implementation as part of <a href="http://ajax.asp.net">ASP.NET AJAX</a>.</td>
          </tr> 
          <tr>
           <td data-th="Support">Platform and language</td>
           <td data-th="XML">Parsers and formatters are widely available on many platforms and languages (commercial and open source implementations).</td>
           <td data-th="JSON">Parsers and formatters are available already on many platforms and in many languages. Consult <a href="http://www.json.org">json.org</a> for a good set of references. Most implementations for now tend to be open source projects.</td>
          </tr> 
          <tr>
           <td data-th="Support">Integrated language</td>
           <td data-th="XML">Industry vendors are currently experimenting with support <em>literally</em> within languages. See <a href="https://msdn.microsoft.com/data/ref/linq/">Microsoft's LINQ project</a> for more information.</td>
           <td data-th="JSON">Is natively supported in JavaScript/ECMAScript only.</td>
          </tr> 
         </tbody>
        </table>
       </div> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;Neither table is meant to be a comprehensive list of comparison points. There are further angles on which both data formats can be compared, but we felt that these key points should be sufficient to build an initial impression.
       </blockquote> 
       <h2 class="dtH1"><a id="intro_to_json_topic4"></a>Creating and Parsing JSON Messages with JavaScript</h2> 
       <p>When using JSON as the data exchange format, two common tasks are turning a native and in-memory representation into its JSON text representation and vice versa. Unfortunately, at the time of writing, JavaScript does not provide built-in functions to create JSON text from a given object or array. These methods are expected to be included in the fourth edition of the ECMAScript standard in 2007. Until these JSON formatting functions are formally added to JavaScript and widely available across popular implementations, use the reference implementation script available for download at <a href="http://www.json.org/json.js">http://www.json.org/json.js</a>.</p> 
       <p>In its latest iteration at the time of this writing, the json.js script at <a href="http://www.json.org">www.json.org</a> adds <strong>toJSONString()</strong> functions to array, string, Boolean, object, and other JavaScript types. The <strong>toJSONString()</strong> functions for scalar types (like Number and Boolean) are quite simple since they only need to return a string representation of the instance value. The <strong>toJSONString()</strong> function for the <strong>Boolean</strong> type, for example, returns the string "true" if the value is true, and "false" otherwise. The <strong>toJSONString()</strong> functions<strong> </strong>for Array and Object types are more interesting. For Array instances, the <strong>toJSONString()</strong> function for each contained element is called in sequence, with the results being concatenated with commas to delimit each result. The final output enclosed in square brackets. Likewise, for Object instances, each member is enumerated and its <strong>toJSONString()</strong> function invoked. The member name and the JSON representation of its value are concatenated with a colon in the middle; each member name and value pair is delimited with a comma and the entire output is enclosed in curly brackets.</p> 
       <p>The net result of the <strong>toJSONString()</strong> functions is that any type can be converted into its JSON format with a single function call. The following JavaScript creates an Array object and adds seven String elements deliberately using the verbose and non-literal method for illustrative purposes. It then goes on to displays the arrays JSON representation:</p> 
       <pre class="code"><code><strong>// josn.js must be included prior to this point var continents = new Array(); continents.push("Europe"); continents.push("Asia"); continents.push("Australia"); continents.push("Antarctica"); continents.push("North America"); continents.push("South America"); continents.push("Africa"); alert("The JSON representation of the continents array is: " + continents.toJSONString());</strong></code></pre> 
       <p class="fig"><img id="intro_to_json01" alt="Bb299886.intro_to_json01(en-us,MSDN.10).gif" src="https://i-msdn.sec.s-msft.com/dynimg/IC145468.gif" title="Bb299886.intro_to_json01(en-us,MSDN.10).gif" xmlns=""></p> 
       <p class="label"><strong>Figure 1. The toJSONString() function emits the array formatted according to the JSON standard.</strong></p> 
       <p>Parsing JSON text is even simpler. Since JSON is merely a subset of JavaScript literals, it can be parsed into an in-memory representation using the <a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Guide:Predefined_Functions:eval_Function">eval(expr) function</a><code>, </code>treating the source JSON text as JavaScript source code. The <strong>eval</strong> function accepts as input a string of valid JavaScript code and evaluates the expression. Consequently, the following single line of code is all that is needed to turn JSON text into a native representation:</p> 
       <pre class="code"><code><strong>var value = eval( "(" + jsonText + ")" );</strong></code></pre> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;The extra parentheses are used make 
        <strong>eval</strong> unconditionally treat the source input like an expression. This is especially important for objects. If you try to call eval with a string containing JSON text that defines an object, such as the string "
        <strong>{}</strong>" (meaning an empty object), then it simply returns undefined as the parsed result. The parentheses force the JavaScript parser to see the top-level curly braces as the literal notation for an Object instance rather than, say, curly braces defining a statement block. Incidentally, the same problem does not occur if the top-level item is an array, as in 
        <strong>eval("[1,2,3]")</strong>. For sake of uniformity, however, JSON text should always be surrounded with parentheses prior to calling 
        <strong>eval</strong> so that there is no ambiguity about how to interpret the source.
       </blockquote> 
       <p>When evaluating literal notation, an instance corresponding to the literal syntax is returned and assigned to <strong>value</strong>. Consider the following example, which uses the <strong>eval</strong> function to parse the literal notation for an array and assigning the resulting array to the variable <strong>continents</strong>.</p> 
       <pre class="code"><code><strong>var arrayAsJSONText = '["Europe", "Asia", "Australia", "Antarctica", "North America", "South America", "Africa"]'; var continents = eval( arrayAsJSONText ); alert(continents[0] + " is one of the " + continents.length + " continents.");</strong></code></pre> 
       <p>Of course, in practice the evaluated JSON text will come from some external source rather than being hard-coded as in the above case.</p> 
       <p>The <strong>eval</strong> function blindly evaluates whatever expression it is passed. An untrustworthy source could therefore include potentially dangerous JavaScript along with or mixed into the literal notation that makes up the JSON data. In scenarios where the source cannot be trusted, it is highly recommended that you parse the JSON text using the <strong>parseJSON()</strong> function (found in json.js):</p> 
       <pre class="code"><code><strong>// Requires json.js var continents = arrayAsJSONText.parseJSON();</strong></code></pre> 
       <p>The <strong>parseJSON()</strong> function also uses <strong>eval</strong>, but only if the string contained in <strong>arrayAsJSONText</strong> conforms to the JSON text standard. It does this using a clever regular expression test.</p> 
       <h2 class="dtH1"><a id="intro_to_json_topic5"></a>Working with JSON in the .NET Framework</h2> 
       <p>JSON text can easily be created and parsed from JavaScript code, which is part of its allure. However, when JSON is used in an ASP.NET web application, only the browser enjoys JavaScript support since the server-side code is most likely written in Visual Basic or C#.</p> 
       <p>Most Ajax libraries designed for ASP.NET provide support for programmatically creating and parsing JSON text. Therefore, to work with JSON in a .NET application, consider using one of these libraries. There are plenty of open-source and third-party options, and Microsoft also has their own Ajax library named <a href="http://ajax.asp.net/">ASP.NET AJAX</a>.</p> 
       <p>In this article we will look at examples that use <a href="http://jayrock.berlios.de/">Jayrock</a>, an open-source implementation of JSON for the Microsoft .NET Framework created by coauthor <a href="http://www.raboof.com/">Atif Aziz</a>. We chose to use Jayrock instead of ASP.NET AJAX for three reasons: </p>
       <ul> 
        <li>Jayrock is open-source, making it possible to extend or customize as needed.</li> 
        <li>Jayrock can be used in ASP.NET 1.x, 2.0, and <a href="http://www.mono-project.com/Main_Page">Mono</a> applications, whereas ASP.NET AJAX is for ASP.NET version 2.0 only.</li> 
        <li>Jayrock's scope is limited to JSON and JSON-RPC, and the former is the main focus of this article. While ASP.NET AJAX includes some support for creating and parsing JSON text, its primary purpose is to offer a rich platform for building end-to-end Ajax-style web applications in ASP.NET. The extra bells and whistles can be distracting when your main focus is JSON.</li> 
       </ul> 
       <p>Working with JSON in .NET using Jayrock is similar to working with XML through the <a href="http://msdn2.microsoft.com/en-us/library/system.xml.xmlwriter.aspx">XmlWriter</a>, <a href="http://msdn2.microsoft.com/en-us/library/system.xml.xmlreader.aspx">XmlReader</a>, and <a href="http://msdn2.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx">XmlSerializer</a> classes in the .NET Framework. The classes <strong>JsonWriter</strong>, <strong>JsonReader</strong>, <strong>JsonTextWriter</strong>, and <strong>JsonTextReader</strong> found in Jayrock mimic the semantics of the .NET Framework classes <strong>XmlWriter</strong>, <strong>XmlReader</strong>, <strong>XmlTextWriter</strong>, and <strong>XmlTextReader</strong>. These classes are useful for interfacing with JSON at a low- and stream-oriented level. Using these classes, JSON text can be created or parsed piecemeal through a series of method calls. For example, using the <strong>JsonWriter</strong> class method <strong>WriteNumber(number)</strong> writes out the appropriate string representation of <em>number</em> according to the JSON standard. The <strong>JsonConvert</strong> class offers <strong>Export</strong> and <strong>Import</strong> methods for converting between .NET types and JSON. These methods provide a similar functionality as found in the <strong>XmlSerializer</strong> class methods <strong>Serialize</strong> and <strong>Deserialize</strong>, respectively.</p> 
       <h3 class="dtH1">Creating JSON Text</h3> 
       <p>The following code illustrates using the <strong>JsonTextWriter</strong> class to create the JSON text for a string array of continents. This JSON text is sent to a <strong>TextWriter</strong> instance passed into the constructor, which happens to be the output stream from the console in this example (in ASP.NET you can use <strong>Response.Output</strong> instead):</p> 
       <pre class="code"><code><strong>using (JsonTextWriter writer = JsonTextWriter(Console.Out)) { writer.WriteStartArray(); writer.WriteString("Europe"); writer.WriteString("Asia"); writer.WriteString("Australia"); writer.WriteString("Antarctica"); writer.WriteString("North America"); writer.WriteString("South America"); writer.WriteString("Africa"); writer.WriteEndArray(); }</strong></code></pre> 
       <p>In addition to the <strong>WriteStartArray</strong>, <strong>WriteString</strong>, and <strong>WriteEndArray</strong> methods, the <strong>JsonWriter</strong> class provides methods for writing other JSON value types, such as <strong>WriteNumber</strong>, <strong>WriteBoolean</strong>, <strong>WriteNull</strong>, and so on. The <strong>WriteStartObject</strong>, <strong>WriteEndObject</strong>, and <strong>WriteMember</strong> methods create the JSON text for an object. The following example illustrates creating the JSON text for the contact object examined in the "<a href="#intro_to_json_topic2">Understanding Literal Notation in JavaScript</a>" section:</p> 
       <pre class="code">private static void WriteContact()
{
&nbsp;&nbsp;&nbsp; using (JsonWriter w = new JsonTextWriter(Console.Out))
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteStartObject();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;// {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteMember("Name");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; "Name" : 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteString("John Doe");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp; "John Doe",
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteMember("PermissionToCall"); //&nbsp;&nbsp; "PermissionToCall" :
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteBoolean(true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp; true,
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;w.WriteMember("PhoneNumbers");&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; "PhoneNumbers" :
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteStartArray();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; [ 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritePhoneNumber(w,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp; { "Location": "Home",
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Home"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Number": 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"555-555-1234");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "555-555-1234" },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritePhoneNumber(w,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp; { "Location": "Work",
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Work",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Number": 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "555-555-9999");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "555-555-9999" }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteEndArray();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; ]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.WriteEndObject();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // }
&nbsp;&nbsp;&nbsp; }
}

private static void WritePhoneNumber(JsonWriter w, string location,
&nbsp;&nbsp;&nbsp; string number)
{
&nbsp;&nbsp;&nbsp; w.WriteStartObject();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; {
&nbsp;&nbsp;&nbsp; w.WriteMember("Location"); //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Location" : 
&nbsp;&nbsp;&nbsp; w.WriteString(location);&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "...", 
&nbsp;&nbsp;&nbsp; w.WriteMember("Number");&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Number" :
&nbsp;&nbsp;&nbsp; w.WriteString(number);&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "..."
&nbsp;&nbsp;&nbsp; w.WriteEndObject();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; }
}</pre> 
       <p><strong>Export</strong> and <strong>ExportToString</strong> methods in the <strong>JsonConvert</strong> class can be used to serialize a specified .NET type into JSON text. For example, rather than manually building the JSON text for the array of the seven continents using the <strong>JsonTextWriter</strong> class, the following call to <strong>JsonConvert.ExportToString</strong> produces the same results:</p> 
       <pre class="code">string[] continents = {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Europe", "Asia", "Australia", "Antarctica", "North America", 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "South America", "Africa"
};
string jsonText = JsonConvert.ExportToString(continents);</pre> 
       <h3 class="dtH1">Parsing JSON Text</h3> 
       <p>The <strong>JsonTextReader</strong> class provides a variety of methods to parse the tokens of JSON text with the core one being <strong>Read</strong>. Each time the <strong>Read</strong> method is invoked, the parser consumes the next token, which could be a string value, a number value, an object member name, the start of an array, and so forth. Where applicable, the parsed text of the current token can be accessed via the <strong>Text</strong> property. For example, if the reader is sitting on Boolean data, then the <strong>Text</strong> property will return "true" or "false" depending on the actual parse value.</p> 
       <p>The following sample code uses the <strong>JsonTextReader</strong> class to parse through the JSON text representation of a string array containing the names of the seven continents. Each continent that begins with the letter "A" is sent to the console:</p> 
       <pre class="code"><code><strong>string jsonText = @"[""Europe"", ""Asia"", ""Australia"", ""Antarctica"", ""North America"", ""South America"", ""Africa""]"; using (JsonTextReader reader = new JsonTextReader(new StringReader(jsonText))) { while (reader.Read()) { if (reader.TokenClass == JsonTokenClass.String &amp;&amp; reader.Text.StartsWith("A")) { Console.WriteLine(reader.Text); } } }</strong></code></pre> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;The 
        <strong>JsonTextReader</strong> class in Jayrock is a fairly liberal JSON text parser. It actually permits a lot more syntax than is considered valid JSON text according to rules laid out in 
        <a href="http://www.ietf.org/rfc/rfc4627.txt">RFC 4627</a>. For example, the 
        <strong>JsonTextReader</strong> class allows single-line and multi-line comments to appear within JSON text as you'd expect in JavaScript. Single-line comments start with slash-slash (
        <strong>//</strong>) and multi-line comments being with slash-star (
        <strong>/*</strong>) and end in star-slash (
        <strong>*/</strong>). Single-line comments can even begin with the hash/pound sign (
        <strong>#</strong>), which is common among Unix-style configuration files. In all instances, the comments are completely skipped by the parser and never exposed through the API. Also as in JavaScript, 
        <strong>JsonTextReader</strong> permits a JSON string to be delimited by an apostrophe (
        <strong>'</strong>). The parser can even tolerate an extra comma after the last member of an object or element of an array.
       </blockquote> 
       <blockquote class="dtBlock">
         Even with all these additions, 
        <strong>JsonTextReader</strong> is a conforming parser! 
        <strong>JsonTextWriter</strong>, on the other hand, produces only strict standard-conforming JSON text. This follows what is often coined as the robustness principal, which states, "Be conservative in what you do; be liberal in what you accept from others."
       </blockquote> 
       <p>To convert JSON text directly into a .NET object, use the <strong>JsonConvert</strong> class import method, specifying the output type and JSON text. The following example shows conversion of a JSON array of strings into a .NET string array:</p> 
       <pre class="code">string jsonText = @"[""Europe"", ""Asia"", ""Australia"", ""Antarctica"",
 ""North America"", ""South America"", ""Africa""]";

string[] continents = (string[]) JsonConvert.Import(typeof(string[]),
 jsonText);</pre> 
       <p>Here is a more interesting example of conversion that takes an RSS XML feed, deserializes it into a .NET type using <strong>XmlSerializer</strong>, and then converts the object into JSON text using <strong>JsonConvert</strong> (effectively converting RSS in XML to JSON text):</p> 
       <pre class="code">XmlSerializer serializer = new XmlSerializer(typeof(RichSiteSummary));
RichSiteSummary news;

// Get the MSDN RSS feed and deserialize it...

using (XmlReader reader = XmlReader.Create("http://msdn.microsoft.com/rss.xml"))
&nbsp;&nbsp;&nbsp; news = (RichSiteSummary) serializer.Deserialize(reader);

// Export the RichSiteSummary object as JSON text, emitting the output to
// Console.Out.

using (JsonTextWriter writer = new JsonTextWriter(Console.Out))
&nbsp;&nbsp;&nbsp; JsonConvert.Export(news, writer);</pre> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;The definition of 
        <strong>RichSiteSummary</strong> and its related types can be found in the samples accompanying this article.
       </blockquote> 
       <h3 class="dtH1">Using JSON in ASP.NET</h3> 
       <p>Having looked at ways to work with JSON in JavaScript and from within the .NET Framework using Jayrock, it's time to turn to a practical example of where and how all this knowledge can be applied. Consider the client script callback feature in ASP.NET 2.0, which simplifies the process of making out-of-band calls from the web browser to the ASP.NET page (or to a particular control on the page). During a typical callback scenario, the client-side script in the browser packages and sends data back to the web server for some processing by a server-side method. After receiving the response data from the server, the client then uses it to update the browser display.</p> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;More information can be found in the MSDN Magazine article 
        <a href="https://msdn.microsoft.com/msdnmag/issues/04/08/cuttingedge/">Script Callbacks in ASP.NET 2.0</a>.
       </blockquote> 
       <p>The challenge in a client callback scenario is that the client and server can only ship a string back and forth. Therefore, the information to be exchanged must be converted from a native, in-memory representation to a string before being sent and then parsed from a string back to its native, in-memory representation when received. The client script callback feature in ASP.NET 2.0 does not require a particular string format for the exchanged data, nor does it provide any built-in functionality for converting between the native in-memory and string representations; it is up to the developer to implement the conversion logic based on some data exchange format of his or her choice.</p> 
       <p>The following example illustrates how to use JSON as the data exchange format in a client script callback scenario. In particular, the example consists of an ASP.NET page that uses data from the Northwind database to provide a listing of the categories in a drop-down list; products in the selected category are displayed in a bulleted list (see Figure 3). Whenever the drop-down list is changed on the client side, a callback is made passing in an array whose single element is the selected <strong>CategoryID</strong>.</p> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;We are passing in an array that contains the selected 
        <strong>CategoryID</strong> as its sole element (rather than just the 
        <strong>CategoryID</strong>) because the JSON standard requires that any JSON text must have an object or an array as its root. Of course, the client is not required to pass JSON text to the server—we could have had this example pass just the selected 
        <strong>CategoryID</strong> as a string. However, we wanted to demonstrate sending JSON text in both the request and response messages of the callback.
       </blockquote> 
       <p>The following code in the <strong>Page_Load</strong> event handler configures the <strong>Categories DropDownList </strong>Web control so that when it is changed, the <strong>GetProductsForCategory</strong> function is called and passed the selected drop-down lists value. This function initiates the client script callback if the passed-in drop-down list value is greater than zero:</p> 
       <pre class="code"><code><strong>// Add client-side onchange event to drop-down list Categories.Attributes["onchange"] = "Categories_onchange(this);"; // Generate the callback script string callbackScript = ClientScript.GetCallbackEventReference( /* control */ this, /* argument */ "'[' + categoryID + ']'", /* clientCallback */ "showProducts", /* context */ "null"); // Add the Categories_onchange function ClientScript.RegisterClientScriptBlock(GetType(), "Categories_onchange", @" function Categories_onchange(sender) { clearResults(); var categoryID = sender.value; if (categoryID &gt; 0) { " + callbackScript + @" } }", true);</strong></code></pre> 
       <p>The <a href="http://msdn2.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.getcallbackeventreference.aspx">GetCallBackEventReference</a> method in the <a href="http://msdn2.microsoft.com/en-us/library/system.web.ui.clientscriptmanager(vs.80).aspx">ClientScriptManager</a> class, which is used to generate the JavaScript code that invokes the callback, has the following signature:</p> 
       <pre class="code"><code><strong>public string GetCallbackEventReference ( Control control, string argument, string clientCallback, string context, )</strong></code></pre> 
       <p>The <strong>argument parameter</strong> specifies what data is sent from the client to the web server during the callback and the <strong>clientCallback</strong> parameter specifies the name of the client-side function to invoke upon completion of the callback (<strong>showProducts</strong>). The <strong>GetCallBackEventReference</strong> method call generates the following JavaScript code and adds it to the rendered markup:</p> 
       <pre class="code"><code><strong>WebForm_DoCallback('__Page','[' + categoryID + ']',showProducts,null,null,false)</strong></code></pre> 
       <p><strong>'[' + categoryID + ']'</strong> is the value that is passed to the server during the callback (an array with a single element, <strong>categoryID</strong>) and <strong>showProducts</strong> is the JavaScript function that is executed when the callback returns.</p> 
       <p>On the server side, the method that is executed in response to the callback uses <strong>JsonConvert</strong> class from Jayrock to parse the incoming JSON text and format the outgoing JSON text. In particular, the names of the products that are associated with the selected category are retrieved and returned as a string array.</p> 
       <pre class="code"><code><strong>// Deserialize the JSON text into an array of integers int[] args = (int[]) JsonConvert.Import(typeof(int[]), eventArgument); // Read the selected CategoryID from the array int categoryID = args[0]; // Get products based on categoryID </strong></code>NorthwindDataSet.ProductsRow[] rows = 
Northwind.Categories.FindByCategoryID(categoryID).GetProductsRows();

<code><strong>// Load the names into a string array</strong></code>
string[] productNames = new string[rows.Length];
for (int i = 0; i &lt; rows.Length; i++)
{
    productNames[i] = rows[i].ProductName;
<code><strong>}</strong></code>

<code><strong>// Serialize the string array as JSON text and return it to the client</strong></code>
<code><strong>return JsonConvert.ExportToString(productNames);</strong></code></pre> 
       <blockquote class="dtBlock"> 
        <strong>Note</strong>&nbsp;&nbsp;&nbsp;The 
        <strong>JsonConvert</strong> class is used twice—once to convert the JSON text in 
        <strong>eventArgument</strong> into an array of integers and then to convert the string array 
        <strong>productNames</strong> into JSON text to return to the client. Alternatively, we could have used the 
        <strong>JsonReader</strong> and 
        <strong>JsonWriter</strong> classes here, but 
        <strong>JsonConvert</strong> does the same job fairly well when the data involved is relatively small and easily mapped to existing types.
       </blockquote> 
       <p>When the data is returned from the server-side, the JavaScript function specified from the <strong>GetCallBackEventReference</strong> method is called and passed the return value. This JavaScript method, <strong>showProducts</strong>, starts by referencing the <strong>&lt;div&gt;</strong> element <strong>ProductOutput</strong>. It then parses the JSON response and dynamically adds an unordered list with a list item for each array element. If no products are returned for the selected category, then a corresponding message is displayed instead.</p> 
       <pre class="code">function showProducts(arg, context)
{
&nbsp;&nbsp;&nbsp; // Dump the JSON text response from the server.

&nbsp;&nbsp;&nbsp; document.forms[0].JSONResponse.value = arg;
&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; // Parse JSON text returned from callback.

&nbsp;&nbsp;&nbsp; var categoryProducts = eval("(" + arg + ")");

&nbsp;&nbsp;&nbsp; // Get a reference to the &lt;div&gt; ProductOutput.
&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; var output = document.getElementById("ProductOutput");

&nbsp;&nbsp;&nbsp; // If no products for category, show message.
&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; if (categoryProducts.length == 0)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output.appendChild(document.createTextNode(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "There are no products for this category..."));
&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp; else
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // There are products, display them in an unordered list. 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var ul = document.createElement("ul");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (var i = 0; i &lt; categoryProducts.length; i++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var product = categoryProducts[i];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var li = document.createElement("li");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; li.appendChild(document.createTextNode(product));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ul.appendChild(li);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output.appendChild(ul);
&nbsp;&nbsp;&nbsp; }
}</pre> 
       <p>Figure 2 illustrates the sequence of events while Figure 3 shows this example in action; the complete code is included in this articles download.</p> 
       <p class="fig"><img id="intro_to_json02" alt="Bb299886.intro_to_json02(en-us,MSDN.10).gif" src="https://i-msdn.sec.s-msft.com/dynimg/IC88241.gif" title="Bb299886.intro_to_json02(en-us,MSDN.10).gif" xmlns=""></p> 
       <p class="label"><strong>Figure 2: The client sends the selected CategoryID as the single element in an array and the server returns an array of associated product names.</strong></p> 
       <p class="fig"><img id="intro_to_json03" alt="Bb299886.intro_to_json03(en-us,MSDN.10).gif" src="https://i-msdn.sec.s-msft.com/dynimg/IC26405.gif" title="Bb299886.intro_to_json03(en-us,MSDN.10).gif" xmlns=""></p> 
       <p class="label"><strong>Figure 3: The products are displayed in a bulleted list inside the selected category.</strong></p> 
       <h2 class="dtH1"><a id="intro_to_json_topic6"></a>Conclusion</h2> 
       <p>JSON is a lightweight, text-based data exchange format based on a subset of the literal notation from the JavaScript programming language. It provides a succinct encoding for application data structures and is typically used in scenarios where a JavaScript implementation is available to one or both of the applications exchanging data, such as in Ajax-style web applications. The allure of JSON lies in its simplicity to understand, adopt, and implement. JSON has virtually no learning curve for developers already familiar with JavaScript or other programming languages with similar support for a rich literal notation (like Python and Ruby). Parsing JSON text in JavaScript code can be accomplished by simply calling the <strong>eval</strong> function, and creating JSON text is a breeze with the json.js script provided at <a href="http://www.json.org/json.js">http://www.json.org/json.js</a>.</p> 
       <p>There are a blossoming number of libraries for working with JSON across all major platforms and frameworks. In this article we looked at Jayrock, an open-source library for creating and parsing JSON text in .NET applications. Jayrock can be used in ASP.NET 1.x, 2.0, and Mono applications. ASP.NET AJAX offers similar JSON functionality, but for ASP.NET 2.0 applications only.</p> 
       <p>Happy Programming!</p> 
       <h2 class="dtH1"><a id="intro_to_json_topic7"></a>References</h2> 
       <ul> 
        <li><a href="http://ajax.asp.net/Default.aspx">ASP.NET AJAX</a></li> 
        <li><a href="https://msdn.microsoft.com/msdnmag/issues/07/01/extremeaspnet/default.aspx">Client-Side Web Service Calls with AJAX Extensions</a></li> 
        <li><a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Guide">Core JavaScript 1.5 Guide</a></li> 
        <li><a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Guide:Predefined_Functions:eval_Function">eval(expr) function</a></li> 
        <li><a href="http://jayrock.berlios.de/">Jayrock</a></li> 
        <li><a href="http://json.org/">JSON.org</a></li> 
        <li><a href="https://msdn.microsoft.com/msdnmag/issues/04/08/cuttingedge/">Script Callbacks in ASP.NET</a></li> 
        <li><a href="http://www.ietf.org/rfc/rfc4627.txt">RFC 4627</a></li> 
       </ul> 
       <blockquote class="dtBlock"> 
        <strong>Ajax or AJAX?</strong>
       </blockquote> 
       <blockquote class="dtBlock">
         The term Ajax was initially coined by 
        <a href="http://blog.jjg.net/">Jesse James Garrett</a> to describe the style of web applications and set of technologies involved in making highly interactive web applications. Historically, the term Ajax spread around the web as the acronym AJAX, meaning Asynchronous JavaScript And XML. With time, however, people realized that the "X" in AJAX was not very representative of the underlying data format used to communicate with the web server in the background since most implementations were switching to JSON as a simpler and more efficient alternative. So rather than coming up with a replacement acronym like AJAJ that's a bit of tongue-twister, the acronym is generally being retired in favor of Ajax the term rather than AJAX the acronym.
       </blockquote> 
       <blockquote class="dtBlock">
         At the time of this writing, expect to see a mixed and wide use of "AJAX" and "Ajax" to mean one and the same thing. In this article, we've stuck with "Ajax the term." Commercial products that provide frameworks enabling Ajax-style applications, however, tend to use the acronym form to distinguish from a similarly named cleaning agent product and to avoid any potential trademark or legal disputes.
       </blockquote> 
       <blockquote class="dtBlock"> 
        <a id="intro_to_json_sidebarb"></a>
        <strong>ASP.NET AJAX: Inside JSON date and time string</strong>
       </blockquote> 
       <blockquote class="dtBlock">
         The AJAX JSON serializer in ASP.NET encodes a 
        <strong>DateTime</strong> instance as a JSON string. During its pre-release cycles, ASP.NET AJAX used the format "
        <strong>@ticks@</strong>", where ticks represents the number of milliseconds since January 1, 1970 in Universal Coordinated Time (UTC). A date and time in UTC like November 29, 1989, 4:55:30 AM would be written out as "
        <strong>@62831853071@</strong>." Although simple and straightforward, this format cannot differentiate between a serialized date and time value and a string that looks like a serialized date but is not meant to be deserialized as one. Consequently, the ASP.NET AJAX team made a change for the final release to address this problem by adopting the "
        <strong>\/Date(ticks)\/</strong>" format.
       </blockquote> 
       <blockquote class="dtBlock">
         The new format relies on a small trick to reduce the chance for misinterpretation. In JSON, a forward-slash (
        <strong>/</strong>) character in a string can be escaped with a backslash (
        <strong>\</strong>) even though it is not strictly required. Taking advantage of this, the ASP.NET AJAX team modified JavaScriptSerializer to write a 
        <strong>DateTime</strong> instance as the string "
        <strong>\/Date(ticks)\/</strong>" instead. The escaping of the two forward-slashes is superficial, but significant to JavaScriptSerializer. By JSON rules, 
        <code>"</code>
        <strong>\/Date(ticks)\/</strong>
        <code>"</code> is technically equivalent to 
        <code>"</code>
        <strong>/Date(ticks)/</strong>
        <code>"</code> but the JavaScriptSerializer will deserialize the former as a 
        <strong>DateTime</strong> and the latter as a 
        <strong>String</strong>. The chances for ambiguity are therefore considerably less when compared to the simpler "
        <strong>@ticks@</strong>" format from the pre-releases.
       </blockquote> 
       <h4 class="dtH1">Special Thanks</h4> 
       <p>Before submitting this article to MSDN, we had a number of volunteers help proofread the article and provide feedback on the content, grammar, and direction. Primary contributors to the review process include Douglas Crockford, Eric Schönholzer and Milan Negovan.</p> 
       <h4 class="dtH1">About the Authors</h4> 
       <p>Atif Aziz is a Principal Consultant at Skybow AG where his primary focus is to help customers understand and build solutions on the .NET development platform. Atif contributes regularly to the Microsoft developer community by speaking at conferences and writing articles for technical publications. He is an INETA speaker and president of the largest Swiss .NET User Group. He can be reached at <a href="mailto:atif.aziz@skybow.com">atif.aziz@skybow.com</a> or via his web site at <a href="http://www.raboof.com">http://www.raboof.com</a>.</p> 
       <p>Scott Mitchell, author of six ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft web technologies since 1998. Scott works as an independent consultant, trainer, and writer. He can be reached at <a href="mailto:mitchell@4guysfromrolla.com">mitchell@4guysfromrolla.com</a> or via his blog: <a href="http://ScottOnWriting.net">http://ScottOnWriting.net</a>.</p> 
      </div> 
     </div> 
     <div class="libraryMemberFilter"> 
      <div class="filterContainer"> 
       <span>Show:</span> 
       <label> <input type="checkbox" class="libraryFilterInherited" checked value="Inherit">Inherited </label> 
       <label> <input type="checkbox" class="libraryFilterProtected" checked value="Protected">Protected </label> 
      </div> 
     </div> 
     <input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings."> 
    </div> 
    <div id="rightNavigationMenu" ms.cmpgrp="right nav"> 
     <div id="mobileButtons"> 
      <div id="navigationButtons"> 
       <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/bb299886(d=printer).aspx" rel="nofollow"><ins class="print"></ins>Print </a> 
       <a id="isd_printABook" href="/en-us/library/export/help/?returnurl=%2fen-us%2flibrary%2fbb299886.aspx"> <ins class="export"></ins>Export (<span class="count">0</span>) </a> 
      </div> 
     </div> 
     <div id="navMain"> 
      <div id="closeNavigation"> 
       <a class="tocCloseSmall" id="closeButton"></a> 
      </div> 
      <div id="navigationButtons"> 
       <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/bb299886(d=printer).aspx" rel="nofollow"><ins class="print"></ins>Print </a> 
       <a id="isdShare" href="#" role="button" aria-expanded="false"> <ins class="share"></ins>Share </a> 
       <div id="socials" style="display: none"> 
        <a class="isdFacebook" href="#" aria-label="Share on Facebook"> <ins class="facebook"></ins> </a> 
        <a class="isdTwitter" href="#" aria-label="Share on Twitter"> <ins class="twitter"></ins> </a> 
        <a class="isdGooglePlus" href="#" aria-label="Share on Google+"> <ins class="googlePlus"></ins> </a> 
       </div> 
      </div> 
      <div id="indoc_toc" style="display: none" ms.cmpgrp="indoc toc"> 
       <div id="indoc_title">
        IN THIS ARTICLE
       </div> 
       <ul id="indoc_toclist"></ul> 
      </div> 
     </div> 
    </div> 
    <div id="rightNavigationMenuThumbnail" class="rightNavigationMenuThumbnail"> 
    </div> 
   </div> 
   <div class="clear"></div> 
   <input name="__RequestVerificationToken" type="hidden" value="nCAHZan3Vz0hUiRAyV0Ngt_8iVOAKxi6kgODkdLjAVtz_uZwsFVyJI51s8DxXAhPhorajINzOABEpJWYyAyVbkL7Xjk1"> 
   <input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/rate/bb299886.aspx"> 
   <input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/additional/bb299886.aspx"> 
   <input id="isTopicRated" type="hidden" value="false"> 
   <div id="lib-footer"> 
    <link type="text/css" rel="stylesheet"> 
    <div id="ux-footer" class="" style="" dir="ltr" ms.pgarea="footer"> 
     <div id="standardRatingBefore" class="clear stdr-container-before"></div> 
     <div id="standardRating" class="stdr-container" ms.pgarea="body"> 
      <div class="stdr-close"></div> 
      <div class="stdr-vote stdr-content"> 
       <div class="stdr-content"> 
        <span class="stdr-votetitle">Is this page helpful?</span> 
        <button class="stdr-yes" aria-label="Yes, this page was helpful">Yes</button> 
        <button class="stdr-no" aria-label="No, this page was not helpful">No</button> 
        <input id="s_ratingValue" type="hidden" value=""> 
       </div> 
      </div> 
      <div class="stdr-feedback" style="display: none"> 
       <div class="stdr-form"> 
        <div class="stdr-fieldtitle">
         Additional feedback?
        </div> 
        <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea> 
        <div> 
         <span class="stdr-count"><span class="stdr-charcnt">1500</span> characters remaining</span> 
         <div class="stdr-buttons"> 
          <button class="stdr-provide" aria-label="Submit my additional feedback">Submit</button> 
          <button class="stdr-skip" aria-label="Skip additional feedback">Skip this</button> 
         </div> 
        </div> 
        <div class="clear"></div> 
       </div> 
      </div> 
      <div class="stdr-thanks" style="display: none"> 
       <div class="stdr-content"> 
        <span class="stdr-thankyou">Thank you!</span> 
        <span class="stdr-appreciate">We appreciate your feedback.</span> 
       </div> 
      </div> 
      <div id="contentFeedbackQAContainer" style="display: none;"></div> 
     </div> 
     <div id="standardRatingPlaceholder" style="display: none"></div> 
     <footer class="top" role="navigation" aria-label="footer"> 
      <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml"> 
       <div class="linkList"> 
        <h4 class="linkListTitle">Dev centers</h4> 
        <ul class="links"> 
         <li> <a href="https://developer.microsoft.com/en-us/windows" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a> </li> 
         <li> <a href="https://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a> </li> 
         <li> <a href="https://www.visualstudio.com/" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a> </li> 
         <li> <a href="https://docs.microsoft.com/en-us/azure/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a> </li> 
         <li> <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">More...</a> </li> 
        </ul> 
       </div> 
      </div> 
      <div id="rightLinks"> 
       <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Learning resources</h4> 
         <ul class="links"> 
          <li> <a href="https://mva.microsoft.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft Virtual Academy</a> </li> 
          <li> <a href="https://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">Channel 9</a> </li> 
          <li> <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN Magazine</a> </li> 
         </ul> 
        </div> 
       </div> 
       <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Community</h4> 
         <ul class="links"> 
          <li> <a href="https://social.msdn.microsoft.com/forums/en-us/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">Forums</a> </li> 
          <li> <a href="https://blogs.msdn.microsoft.com/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">Blogs</a> </li> 
          <li> <a href="https://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a> </li> 
         </ul> 
        </div> 
       </div> 
       <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Support</h4> 
         <ul class="links"> 
          <li> <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">Self support</a> </li> 
         </ul> 
        </div> 
       </div> 
       <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Programs</h4> 
         <ul class="links"> 
          <li> <a href="https://bizspark.microsoft.com/Startups/Index" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark (for startups)</a> </li> 
          <li> <a href="https://imagine.microsoft.com/en-us" id="CenterLinks4_2151_22" xmlns="http://www.w3.org/1999/xhtml">Microsoft Imagine (for students)</a> </li> 
         </ul> 
        </div> 
       </div> 
      </div> 
     </footer> 
     <footer class="bottom" role="contentinfo"> 
      <span class="localeContainer"> 
       <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/en-us/selectlocale-dmc"> 
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fbb299886.aspx"> 
        <a href="#" onclick="$('#selectLocaleForm').submit();return false;" title="Change your language">United States (English)</a> 
       </form> </span> 
      <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml"> 
       <div class="linkList"> 
        <ul class="links horizontal"> 
         <li> <a href="https://msdn.microsoft.com/en-us/flashnewsletter" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">Newsletter</a> </li> 
         <li> <a href="https://msdn.microsoft.com/en-us/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">Privacy &amp; cookies</a> </li> 
         <li> <a href="https://msdn.microsoft.com/en-us/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">Terms of use</a> </li> 
         <li> <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a> </li> 
        </ul> 
       </div> 
      </div> 
      <span class="logoLegal"> <span class="logoSpan clip67x13" role="img" tabindex="0" aria-label="microsoft logo"> <img alt="logo" class="logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636422593544160354"> </span> <span class="copyright">© 2017 Microsoft</span> </span> 
     </footer> 
    </div> 
   </div> 
   <div class="footerPrintView"> 
    <div class="footerCopyrightPrintView">
     © 2017 Microsoft
    </div> 
   </div> 
   <input id="tocPaddingPerLevel" type="hidden" value="17"> 
   <input id="MtpsDevice" type="hidden" value="Default"> Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft. See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. WebTrends view model not available or IncludeLegacyWebTrendsScriptInGlobal feature flag is off 
   <div id="globalRequestVerification"> 
    <input name="__RequestVerificationToken" type="hidden" value="scqJ9pNSI60T5xyNtNC8KoFg2FhYSDfopgqanXaUfHhgJpiVhkVVH8XuExmST327QChWUZnjCWq9D1B6j0tk3QxJFHk1"> 
   </div> 
  </div> 
  <script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:Breadcrumbs,4:LibraryRightNavigationMenu,4:PrintExportButton,5:StandardRating,2:Footer,0:Topic,3:ResponsiveSupport,6:JSLLRecord,0:ABTestControl;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Content:3,/Areas/Library/Themes/Base/Content:4,/Areas/Global/Content:5,/Areas/Centers/Themes/Base/Content:6\u0026amp;hashKey=5BCC6179B3A366032BFF561B6ACBF9DE\u0026amp;v=F92669ED481360EA1F7BE15E43808B07" },
	{ url: "https://uhf.microsoft.com/mscc/statics/mscc-0.3.6.min.js" },
	{ url: "https://i2-msdn.sec.s-msft.com/Areas/Epx/Themes/Base/Content/SearchBox.js" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026minimumTermLength=2\u0026pgArea=header\u0026brand=Msdn\u0026loc=en-us\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=Search MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:CmpgrpForHeader,1:ResponsiveToc,1:LibraryMemberFilter,2:Toc_Fixed,2:CodeSnippet,2:TopicNotInScope,2:VersionSelector,2:SurveyBroker;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Content:1,/Areas/Epx/Content/Scripts:2\u0026amp;hashKey=E7F336C86AB4177F67844EA512D97992\u0026amp;v=F92669ED481360EA1F7BE15E43808B07" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>  
 </body>
</html>