<!doctype html>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en">
 <head>
  <link rel="canonical" href="https://msdn.microsoft.com/en-us/library/hh210217.aspx"> 
  <title>Sample: Send an email</title> 
  <meta name="DCS.dcsuri" content="/en-us/library/hh210217(d=default,l=en-us,v=crm.8).aspx"> 
  <meta name="NormalizedUrl" content="https://msdn.microsoft.com/en-us/library/hh210217(d=default,l=en-us,v=crm.8).aspx"> 
  <meta name="ms.normalizedurl" content="https://msdn.microsoft.com/en-us/library/hh210217(d=default,l=en-us,v=crm.8).aspx"> 
  <meta name="ms.service" content="crm-online"> 
  <meta name="ms.devlang" content="na"> 
  <meta name="ms.topic" content="samples"> 
  <meta name="AmbientContext" content="{&quot;layout.limit_max_width&quot;:true,&quot;AmbientContextId&quot;:&quot;14A1DD73-6A24-495E-A382-CBA8F72995EC&quot;,&quot;display.use_large_font&quot;:false,&quot;insight.perf_timing&quot;:true,&quot;AmbientContextDownstream&quot;:{&quot;LogTrace&quot;:false},&quot;display.high_contrast&quot;:false,&quot;insight.use_wedcs_vnext&quot;:true}"> 
  <meta name="VotingContextUrl" content="https://msdn.microsoft.com/en-us/library/hh210217(d=default,l=en-us,v=crm.8).aspx"> 
  <meta name="MN" content="EE4293C5-11:57:24 AM"> 
  <meta name="Search.ShortId" content="hh210217"> 
  <meta name="ms.shortidmsdn" content="hh210217"> 
  <meta name="ms.locale" content="en-us"> 
  <meta name="ms.prodver" content="CRM.8"> 
  <meta name="ms.contentlang" content="EN"> 
  <meta name="ms.lang" content="EN"> 
  <meta name="ms.loc" content="US"> 
  <meta name="ms.sitever" content="2017.08.13.1"> 
  <meta name="ms.assetid" content="c95bec08-bdd2-420a-93aa-ee7c0f20fa16"> 
  <meta name="ms.auth" content="0"> 
  <meta name="ms.date" content="11/29/2016"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <script type="text/javascript" data-do-not-move="true">
        //<![CDATA[
        var AmbientContext = null;

        (function(){
            var root = (function(){return this;}).call(null);

            var GetCookie = function(name){
                var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];
                for (var i = 0; i < cookies.length; i++) {
                    var pos = cookies[i].indexOf('=');
                    if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))
                    {
                        var cookie = cookies[i].slice(pos + 1).replace(/\+/g, ' ');
                        cookie = root.decodeURIComponent(cookie);
                        return cookie;
                    }
                }
            };

            var JsonDeserialize = function(content) {
                return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();
            };

            try {
                AmbientContext = GetCookie('AmbientContext');
                AmbientContext = AmbientContext && JsonDeserialize(AmbientContext);
            } catch(ex) {
            } finally {
                AmbientContext = AmbientContext || null;
            }
        })();
        //]]>
    </script> 
  <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js" data-do-not-move="true" data-provides="jQuery"></script> 
  <link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:ImageSprite,0:TopicResponsive,0:TopicResponsive.MediaQueries,1:CodeSnippet,1:ProgrammingSelector,1:ExpandableCollapsibleArea,0:CommunityContent,1:TopicNotInScope,1:FeedViewerBasic,1:ImageSprite,2:Header,2:HeaderFooterSprite,2:Header.MediaQueries,3:Banner.MediaQueries,0:Breadcrumbs,0:Breadcrumbs.MediaQueries,0:ResponsiveToc,0:ResponsiveToc.MediaQueries,1:VersionSelector,0:LibraryMemberFilter,2:Footer,2:Footer.MediaQueries,4:StandardRating,5:LinkList,0:BaseResponsive,6:MsdnResponsive,0:Tables.MediaQueries;/Areas/Library/Content:0,/Areas/Epx/Content/Css:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Epx/Shared/Content:3,/Areas/Global/Content:4,/Areas/Epx/Themes/Base/Content:5,/Areas/Library/Themes/Msdn/Content:6&amp;amp;v=669B444DE50492B44234575208289AF3">
 </head> 
 <body class="library Chrome"> 
  <div id="page"> 
   <link type="text/css" rel="stylesheet"> 
   <input type="hidden" id="isHeaderBleeding" value="true"> 
   <div id="ux-header" dir="ltr" class="ltr dynamicscrm" ms.pgarea="header"> 
    <header> 
     <span id="singleCol"></span> 
     <span id="doubleCol"></span> 
     <span id="isMobile"></span> 
     <div> 
      <div class="row topRow" role="banner"> 
       <div class="top"> 
        <div class="left"> 
         <a class="msdnLogoImg" href="https://msdn.microsoft.com/en-us" title="MSDN home" ms.cmpgrp="mslogo"> 
          <div class="clip70x15"> 
           <img alt="Microsoft Logo" id="msft-logo" class="msft-logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636382651724723869"> 
          </div> </a> 
         <div class="GrayPipeDiv clip1x18"> 
          <img alt="Gray Pipe" class="GrayPipe" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636382651724723869"> 
         </div> 
         <div class="MegaBladeNavigation"> 
          <div class="megaBladeToc"> 
           <nav> 
            <ul class="navL1"> 
             <li class="toggle inactive"> <a href="javascript:void(0)" title="Developer Network" role="button" aria-expanded="false">Developer Network</a> 
              <ul class="navL2"> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Downloads" role="button" aria-expanded="false">Downloads</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio" role="link">Visual Studio</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/microsoft-sdks-msdn" title="SDKs" role="link">SDKs</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/evalcenter" title="Trial software" role="link">Trial software</a> </li> 
                </ul> </li> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Programs" role="button" aria-expanded="false">Programs</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/msdn-subscriptions-overview" title="Subscriptions" role="link">Subscriptions</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/students-overview-msdn" title="Students" role="link">Students</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/applicationbuilder" title="ISV" role="link">ISV</a> </li> 
                 <li class="inactive"> <a href="https://www.microsoft.com/bizspark" title="Startups" role="link">Startups</a> </li> 
                 <li class="inactive"> <a href="https://events.microsoft.com/" title="Events" role="link">Events</a> </li> 
                </ul> </li> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Community" role="button" aria-expanded="false">Community</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine" role="link">Magazine</a> </li> 
                 <li class="inactive"> <a href="https://social.msdn.microsoft.com/forums/" title="Forums" role="link">Forums</a> </li> 
                 <li class="inactive"> <a href="https://blogs.msdn.microsoft.com/" title="Blogs" role="link">Blogs</a> </li> 
                 <li class="inactive"> <a href="https://channel9.msdn.com/" title="Channel 9" role="link">Channel 9</a> </li> 
                </ul> </li> 
               <li class="inactive toggle"> <a href="javascript:void(0)" title="Documentation" role="button" aria-expanded="false">Documentation</a> 
                <ul class="navL3"> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/library/" title="APIs and reference" role="link">APIs and reference</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/developer-centers-msdn" title="Dev centers" role="link">Dev centers</a> </li> 
                 <li class="inactive"> <a href="https://code.msdn.microsoft.com/" title="Samples" role="link">Samples</a> </li> 
                 <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/mt703209" title="Retired content" role="link">Retired content</a> </li> 
                </ul> </li> 
              </ul> </li> 
            </ul> 
           </nav> 
          </div> 
         </div> 
         <a class="DevCenterFullName" href="https://msdn.microsoft.com/en-us">Developer Network</a> 
         <a class="DevCenterShortName" href="https://msdn.microsoft.com/en-us">Developer</a> 
        </div> 
        <div class="right" ms.cmpgrp="aux nav"> 
         <div id="signIn" aria-label="Profile button"> 
          <div class="profileImage"></div> 
          <a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=13&amp;ct=1505674644&amp;rver=6.7.6640.0&amp;wp=mcmbi&amp;wlcxt=msdn%24msdn%24msdn&amp;wreply=https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fhh210217.aspx&amp;lc=1033&amp;id=254354&amp;mkt=en-us">Sign in</a>
         </div> 
         <div class="auxNav"> 
          <div> 
           <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml"> 
            <a href="https://my.visualstudio.com/?wt.mc_id=o~msft~msdn~nav~subscriber&amp;campaign=o~msft~msdn~nav~subscriber" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml"> <p xmlns="">Subscriber portal</p> </a> 
           </div> 
           <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml"> 
            <a href="https://www.visualstudio.com/free-developer-offers/" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">Get tools</a> 
           </div> 
          </div> 
          <div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="row middleRow"> 
       <div class="expandTop"> 
        <div class="left"></div> 
        <div class="right"></div> 
       </div> 
      </div> 
     </div> 
     <div id="buttomRowWrapper" class="bg_default"> 
      <div class="row buttomRow bg_default"> 
       <div class="bottom"> 
        <div class="left" role="navigation" aria-label="header toc" ms.cmpgrp="main nav"> 
         <a id="grip" class="menu-icon" href="javascript:void(0)" role="button" aria-label="navigation menu"></a> 
         <div data-fragmentname="SiteLogo" id="Fragment_SiteLogo" xmlns="http://www.w3.org/1999/xhtml"> 
          <div class="LinkWithImage topImage"> 
           <a id="SiteLogo_14879_1" href="https://msdn.microsoft.com/en-us/dynamics365/"> <span>Dynamics 365</span> </a> 
          </div> 
         </div> 
         <div id="drawer"> 
          <div class="toc"> 
           <nav> 
            <ul class="navL1"> 
             <li class="inactive current toggle"> <a href="javascript:void(0)" role="button" aria-expanded="false">Documentation</a> 
              <ul class="navL2"> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library/hh547453(v=crm.8).aspx" role="link" title="Dynamics 365">Dynamics 365</a> </li> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library/dn864923(v=usd.2).aspx" role="link" title="Unified Service Desk 2.0">Unified Service Desk 2.0</a> </li> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library/dn659819.aspx" role="link" title="Microsoft Dynamics Marketing">Microsoft Dynamics Marketing</a> </li> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library/gg309408.aspx" role="link" title="Dynamics CRM 2015">Dynamics CRM 2015</a> </li> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library/gg309408(v=crm.6).aspx" role="link" title="Dynamics CRM 2013">Dynamics CRM 2013</a> </li> 
               <li class="inactive current"> <a href="https://msdn.microsoft.com/library/dn864923.aspx" role="link" title="Unified Service Desk">Unified Service Desk</a> </li> 
              </ul> </li> 
             <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/downloads" role="link" title="Downloads">Downloads</a> </li> 
             <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/samplecode" role="link" title="Sample Code">Sample Code</a> </li> 
             <li class="inactive toggle"> <a href="javascript:void(0)" role="button" aria-expanded="false">Mobile SDK</a> 
              <ul class="navL2"> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/mobilesdk" role="link" title="Mobile App Development">Mobile App Development</a> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/dn705837" role="link" title="iOS">iOS</a> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/dn705849" role="link" title="Android">Android</a> </li> 
               <li class="inactive"> <a href="https://msdn.microsoft.com/dynamics365/dn705851" role="link" title="Mobile Development Forum">Mobile Development Forum</a> </li> 
              </ul> </li> 
            </ul> 
           </nav> 
          </div> 
         </div> 
        </div> 
        <div class="right" ms.title="search" role="search"> 
         <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml"> 
          <div class="SearchBox"> 
           <form id="HeaderSearchForm" name="HeaderSearchForm" method="get"> 
            <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button" role="button" aria-label="search finder"> 
             <div id="search-finder-div" class="clip16x20"> 
              <img alt="search finder" id="search-finder" class="search-finder" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636382651724723869"> 
             </div> </button> 
            <button id="HeaderSearchButton" style="display:none"></button> 
            <div id="searchSplitter"></div> 
            <div id="searchCloseIconDiv" class="clip16x20" tabindex="0"> 
             <img alt="search clear" id="searchCloseIcon" class="search-clear-x" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636382651724723869"> 
            </div> 
            <div id="searchTextContainer" style="width: 0;"> 
             <input id="HeaderSearchTextBox" name="query" type="text" aria-label="search edit textbox" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)"> 
            </div> 
           </form> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </header> 
   </div> 
   <div id="jumpInfo" style="display: none">
    We’re sorry. The content you requested has been removed. You’ll be auto redirected in 1 second.
   </div> 
   <link type="text/css" rel="stylesheet"> 
   <link type="text/css" rel="stylesheet"> 
   <div id="breadcrumbs" ms.pgarea="body" ms.cmpgrp="breadcrumbs"> 
    <div id="breadcrumbDesktop" class="breadCrumb"> 
     <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/hh547453.aspx" title="Software Development Kit for Microsoft Dynamics 365 (online) and Dynamics 365 (on-premises)"></a></span> 
     <span><a href="https://msdn.microsoft.com/en-us/library/gg334400.aspx" title="Model your business data in Microsoft Dynamics 365"><span>Model your business data in Microsoft Dynamics 365</span></a></span> 
     <span><a href="https://msdn.microsoft.com/en-us/library/gg309626.aspx" title="Activity entities"><span>Activity entities</span></a></span> 
     <span class="breadcrumbDropSmall"> <a id="breadcrumbDropDownButton" href="#" targethref="https://msdn.microsoft.com/en-us/library/gg309626.aspx" title="Sample code for activity entities"><span>Sample code for activity entities</span></a> </span> 
    </div> 
    <div id="breadcrumbDropDownMenu"></div> 
    <div id="breadcrumbTablet" class="breadCrumb"> 
     <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/gg309626.aspx" title="Activity entities"></a></span> 
     <span><a href="https://msdn.microsoft.com/en-us/library/gg309494.aspx" title="Sample code for activity entities"><span>Sample code for activity entities</span></a></span> 
     <span class="breadcrumbDropSmall"><a id="tocDropDownButton" href="#" title="Sample: Send an email"><span>Sample: Send an email</span></a></span> 
    </div> 
    <div id="tocDropDownMenu"></div> 
    <div id="breadcrumbMobile" class="breadCrumb"> 
     <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/gg309494.aspx" title="Sample code for activity entities"></a></span> 
     <span class="breadcrumbDropSmall"><a id="tocPopupButton" href="#" title="Sample: Send an email"><span>Sample: Send an email</span></a></span> 
    </div> 
   </div> 
   <div id="tocPopupMenu"> 
    <div id="tocPopMenuClose" class="tocCloseLarge"></div> 
    <div id="tocTitle">
     Sample: Send an email
    </div> 
   </div> 
   <div id="body" ms.pgarea="body" class=""> 
    <span id="tabletView_large"></span> 
    <span id="tabletView_small"></span> 
    <span id="mobileView"></span> 
    <div id="leftNav" ms.cmpgrp="left toc" role="navigation" aria-label="left toc"> 
     <div id="tocnav" class="ArchiveV2"> 
      <div class="tocunselected"> 
       <div id="tocExpandArea"> 
        <span class="toc_empty"></span> 
        <span id="tocExpandButton"><a href="javascript:void(0)" aria-label="expand sibling toc" role="button"></a></span> 
       </div> 
       <div id="tocExpand"></div> 
      </div> 
      <div class="tocselected"></div> 
      <div class="tocunselected"> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/gg334223.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Create a custom activity">Sample: Create a custom activity</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/gg328344.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Create, retrieve, update, and delete an email attachment">Sample: Create, retrieve, update, and delete an email attachment</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/gg334240.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Retrieve email attachments for an email template">Sample: Retrieve email attachments for an email template</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/gg334706.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Convert a fax to a task">Sample: Convert a fax to a task</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/gg334420.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Promote an email message to Microsoft Dynamics 365">Sample: Promote an email message to Microsoft Dynamics 365</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/gg334461.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Send an email using a template">Sample: Send an email using a template</a> 
       </div> 
       <div class="toclevel current" data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/hh210217.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Send an email">Sample: Send an email</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/hh210212.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Create an email using a template">Sample: Create an email using a template</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/hh372955.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Work with activity party records">Sample: Work with activity party records</a> 
       </div> 
       <div class="toclevel " data-toclevel="1"> 
        <a href="https://msdn.microsoft.com/en-us/library/jj602919.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample: Send bulk email and monitor results">Sample: Send bulk email and monitor results</a> 
       </div> 
      </div> 
      <a id="tocMenuToggler" href="javascript:void(0)" role="button"> <span id="tocMenuTogglerIcon" class="tocMenuCollapse" role="button" aria-expanded="true" aria-label="Table of contents menu"></span> 
       <div id="tocMenuTogglerLabel">
        TOC
       </div> </a> 
     </div> 
     <div style="display:none"> 
      <div id="CollapseLocalizeString">
       Collapse the table of content
      </div> 
      <div id="ExpandLocalizeString">
       Expand the table of content
      </div> 
     </div> 
     <div> 
      <a id="isd_archiveControlResponsive" style="display:none;" href="javascript:void(0)" role="button" aria-label="Hide Archived Versions" data-include-archive="Show Archived Versions" data-exclude-archive="Hide Archived Versions"> </a> 
      <div id="isd_archiveInstrument" style="display:none">
       This documentation is archived and is not being maintained.
      </div> 
     </div> 
    </div> 
    <div id="content" class="content" ms.cmpgrp="content body" role="main"> 
     <div id="archiveDisclaimerText" style="display:none">
      This documentation is archived and is not being maintained.
     </div> 
     <div xmlns="http://www.w3.org/1999/xhtml"> 
      <div class="topic"> 
       <h1 class="title">Sample: Send an email</h1> 
       <div class="lw_vs"> 
        <div id="curversion"> 
         <strong> Dynamics CRM 2016 </strong> 
        </div> 
        <div id="versionclick"> 
         <div id="vsseperator" class="cl_lw_vs_seperator"></div> 
         <div> 
          <div> 
           <a id="vsLink" href="javascript:void(0)" role="button" aria-label="Other Versions" aria-expanded="false"> Other Versions </a> 
          </div> 
          <div class="cl_vs_arrow clip10x10"> 
           <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="https://i-msdn.sec.s-msft.com/Areas/Epx/Content/Images/ImageSprite.png?v=636382651780193385"> 
          </div> 
         </div> 
         <ul id="vsPanel"> 
          <li class=""> <a href="/en-us/library/hh210217(v=crm.7).aspx">Dynamics CRM 2015</a> </li> 
          <li class=""> <a href="/en-us/library/hh210217(v=crm.6).aspx">Dynamics CRM 2013</a> </li> 
          <li class=""> <a href="/en-us/library/hh210217(v=crm.5).aspx">Dynamics CRM 2011</a> </li> 
         </ul> 
        </div> 
       </div> 
       <div style="clear:both;"></div> 
       <div id="mainSection"> 
        <div id="mainBody">
         &nbsp;
         <p>Updated: November 29, 2016</p>
         <p>Applies To: Dynamics 365 (online), Dynamics 365 (on-premises), Dynamics CRM 2016, Dynamics CRM Online</p>
         <div class="introduction">
          <p>This sample code is for Microsoft Dynamics 365 (online &amp; on-premises). <a href="http://go.microsoft.com/fwlink/?LinkID=627298">Download the Microsoft Dynamics CRM SDK package.</a> It can be found in the following location in the download package:</p>
          <p><span class="code">SampleCode\CS\BusinessDataModel\Activities\SendEmail.cs</span></p>
         </div>
         <div class="section">
          <h2 class="heading" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink">Requirements</h2>
          <div class="section">
           <p>For more information about the requirements for running the sample code provided in this SDK, see <a href="https://msdn.microsoft.com/en-us/library/gg328228.aspx">Use the sample and helper code</a>.</p>
          </div>
         </div>
         <div class="section">
          <h2 class="heading" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink">Demonstrates</h2>
          <div class="section">
           <p>This sample shows how to send an email <a href="https://msdn.microsoft.com/en-us/library/microsoft.crm.sdk.messages.sendemailrequest.aspx">SendEmailRequest</a> message.</p>
          </div>
         </div>
         <div class="section">
          <h2 class="heading" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink">Example</h2> 
          <div id="code-snippet-1" class="codeSnippetContainer" xmlns=""> 
           <div class="codeSnippetContainerTabs"> 
            <div class="codeSnippetContainerTabSingle" dir="ltr">
             <a>C#</a>
            </div> 
           </div> 
           <div class="codeSnippetContainerCodeContainer"> 
            <div class="codeSnippetToolBar"> 
             <div class="codeSnippetToolBarText"> 
              <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_a43f9548-8b61-4aee-81e8-9010c9606e0a');" ms.cmptyp="CodeSnippet">Copy</a> 
             </div> 
            </div> 
            <div id="CodeSnippetContainerCode_a43f9548-8b61-4aee-81e8-9010c9606e0a" class="codeSnippetContainerCode" dir="ltr"> 
             <div style="color:Black;">
              <pre>


<span style="color:Blue;">using</span> System;
<span style="color:Blue;">using</span> System.ServiceModel;
<span style="color:Blue;">using</span> System.ServiceModel.Description;
<span style="color:Blue;">using</span> System.Text;

<span style="color:Green;">// These namespaces are found in the Microsoft.Xrm.Sdk.dll assembly</span>
<span style="color:Green;">// found in the SDK\bin folder.</span>
<span style="color:Blue;">using</span> Microsoft.Xrm.Sdk;
<span style="color:Blue;">using</span> Microsoft.Xrm.Sdk.Query;
<span style="color:Blue;">using</span> Microsoft.Xrm.Sdk.Discovery;
<span style="color:Blue;">using</span> Microsoft.Xrm.Sdk.Messages;
<span style="color:Blue;">using</span> Microsoft.Xrm.Sdk.Client;


<span style="color:Green;">// This namespace is found in Microsoft.Crm.Sdk.Proxy.dll assembly</span>
<span style="color:Green;">// found in the SDK\bin folder.</span>
<span style="color:Blue;">using</span> Microsoft.Crm.Sdk.Messages;

<span style="color:Blue;">namespace</span> Microsoft.Crm.Sdk.Samples
{
    <span style="color:Blue;">public</span> <span style="color:Blue;">class</span> SendEmail
    {
        <span style="color:Blue;">#region</span> Class Level Members
        <span style="color:Green;">// Define the IDs needed for this sample.</span>
        <span style="color:Blue;">private</span> Guid _emailId;
        <span style="color:Blue;">private</span> Guid _contactId;
        <span style="color:Blue;">private</span> Guid _userId;
        <span style="color:Blue;">private</span> OrganizationServiceProxy _serviceProxy;

        <span style="color:Blue;">#endregion</span> Class Level Members

        <span style="color:Blue;">#region</span> How To Sample Code
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;summary&gt;</span>
        <span style="color:Gray;">///</span><span style="color:Green;"> Send an e-mail message.</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;/summary&gt;</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;param name="serverConfig"&gt;</span><span style="color:Green;">Contains server connection information.&lt;/param&gt;</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;param name="promptforDelete"&gt;</span><span style="color:Green;">When True, the user will be prompted to delete all</span>
        <span style="color:Gray;">///</span><span style="color:Green;"> created entities.&lt;/param&gt;</span>
        <span style="color:Blue;">public</span> <span style="color:Blue;">void</span> Run(ServerConnection.Configuration serverConfig, <span style="color:Blue;">bool</span> promptforDelete)
        {
            <span style="color:Blue;">try</span>
            {
                <span style="color:Green;">// Connect to the Organization service. </span>
                <span style="color:Green;">// The using statement assures that the service proxy will be properly disposed.</span>
                <span style="color:Blue;">using</span> (_serviceProxy = <span style="color:Blue;">new</span> OrganizationServiceProxy(serverConfig.OrganizationUri, serverConfig.HomeRealmUri,serverConfig.Credentials, serverConfig.DeviceCredentials))
                {
                    <span style="color:Green;">// This statement is required to enable early-bound type support.</span>
                    _serviceProxy.EnableProxyTypes();

                    <span style="color:Green;">// Call the method to create any data that this sample requires.</span>
                    CreateRequiredRecords();


                    <span style="color:Green;">// Use the SendEmail message to send an e-mail message.</span>
                    SendEmailRequest sendEmailreq = <span style="color:Blue;">new</span> SendEmailRequest
                    {
                        EmailId = _emailId,
                        TrackingToken = <span style="color:#A31515;">""</span>,
                        IssueSend = <span style="color:Blue;">true</span>
                    };

                    SendEmailResponse sendEmailresp = (SendEmailResponse)_serviceProxy.Execute(sendEmailreq);
                    Console.WriteLine(<span style="color:#A31515;">"Sent the e-mail message."</span>);              


                    DeleteRequiredRecords(promptforDelete);
                }
            }

            <span style="color:Green;">// Catch any service fault exceptions that Microsoft Dynamics CRM throws.</span>
            <span style="color:Blue;">catch</span> (FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt;)
            {
                <span style="color:Green;">// You can handle an exception here or pass it back to the calling method.</span>
                <span style="color:Blue;">throw</span>;
            }
        }

        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;summary&gt;</span>
        <span style="color:Gray;">///</span><span style="color:Green;"> This method creates any entity records that this sample requires.        </span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;/summary&gt;</span>
        <span style="color:Blue;">public</span> <span style="color:Blue;">void</span> CreateRequiredRecords()
        {
            <span style="color:Green;">// Create a contact to send an email to (To: field)</span>
            Contact emailContact = <span style="color:Blue;">new</span> Contact
            {
                FirstName = <span style="color:#A31515;">"Nancy"</span>,
                LastName = <span style="color:#A31515;">"Anderson"</span>,
                EMailAddress1 = <span style="color:#A31515;">"nancy@contoso.com"</span>
            };
            _contactId = _serviceProxy.Create(emailContact);
            Console.WriteLine(<span style="color:#A31515;">"Created a contact: {0}."</span>, emailContact.FirstName + <span style="color:#A31515;">" "</span> + emailContact.LastName);

            <span style="color:Green;">// Get a system user to send the email (From: field)</span>
            WhoAmIRequest systemUserRequest = <span style="color:Blue;">new</span> WhoAmIRequest();
            WhoAmIResponse systemUserResponse = (WhoAmIResponse)_serviceProxy.Execute(systemUserRequest);
            _userId = systemUserResponse.UserId;

            <span style="color:Green;">// Create the 'From:' activity party for the email</span>
            ActivityParty fromParty = <span style="color:Blue;">new</span> ActivityParty
            {
                PartyId = <span style="color:Blue;">new</span> EntityReference(SystemUser.EntityLogicalName, _userId)
            };

            <span style="color:Green;">// Create the 'To:' activity party for the email</span>
            ActivityParty toParty = <span style="color:Blue;">new</span> ActivityParty
            {
                PartyId = <span style="color:Blue;">new</span> EntityReference(Contact.EntityLogicalName, _contactId)
            };
            Console.WriteLine(<span style="color:#A31515;">"Created activity parties."</span>);

            <span style="color:Green;">// Create an e-mail message.</span>
            Email email = <span style="color:Blue;">new</span> Email
            {
                To = <span style="color:Blue;">new</span> ActivityParty[] { toParty },
                From = <span style="color:Blue;">new</span> ActivityParty[] { fromParty },
                Subject = <span style="color:#A31515;">"SDK Sample e-mail"</span>,
                Description = <span style="color:#A31515;">"SDK Sample for SendEmail Message."</span>,
                DirectionCode = <span style="color:Blue;">true</span>
            };
            _emailId = _serviceProxy.Create(email);
            Console.WriteLine(<span style="color:#A31515;">"Create {0}."</span>, email.Subject);
        }


        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;summary&gt;</span>
        <span style="color:Gray;">///</span><span style="color:Green;"> Deletes the custom entity record that was created for this sample.</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;param name="prompt"&gt;</span><span style="color:Green;">Indicates whether to prompt the user </span>
        <span style="color:Gray;">///</span><span style="color:Green;"> to delete the entity created in this sample.&lt;/param&gt;</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;/summary&gt;</span>
        <span style="color:Blue;">public</span> <span style="color:Blue;">void</span> DeleteRequiredRecords(<span style="color:Blue;">bool</span> prompt)
        {
            <span style="color:Blue;">bool</span> toBeDeleted = <span style="color:Blue;">true</span>;

            <span style="color:Blue;">if</span> (prompt)
            {
                <span style="color:Green;">// Ask the user if the created entities should be deleted.</span>
                Console.Write(<span style="color:#A31515;">"\nDo you want these entity records deleted? (y/n) [y]: "</span>);
                String answer = Console.ReadLine();
                <span style="color:Blue;">if</span> (answer.StartsWith(<span style="color:#A31515;">"y"</span>) ||
                    answer.StartsWith(<span style="color:#A31515;">"Y"</span>) ||
                    answer == String.Empty)
                {
                    toBeDeleted = <span style="color:Blue;">true</span>;
                }
                <span style="color:Blue;">else</span>
                {
                    toBeDeleted = <span style="color:Blue;">false</span>;
                }
            }

            <span style="color:Blue;">if</span> (toBeDeleted)
            {
                _serviceProxy.Delete(Email.EntityLogicalName, _emailId);
                _serviceProxy.Delete(Contact.EntityLogicalName, _contactId); ;

                Console.WriteLine(<span style="color:#A31515;">"Entity records have been deleted."</span>);
            }
        }

        <span style="color:Blue;">#endregion</span> How To Sample Code

        <span style="color:Blue;">#region</span> Main method
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;summary&gt;</span>
        <span style="color:Gray;">///</span><span style="color:Green;"> Main. Runs the sample and provides error output.</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;param name="args"&gt;</span><span style="color:Green;">Array of arguments to Main method.&lt;/param&gt;</span>
        <span style="color:Gray;">///</span> <span style="color:Gray;">&lt;/summary&gt;</span>
        <span style="color:Blue;">static</span> <span style="color:Blue;">public</span> <span style="color:Blue;">void</span> Main(<span style="color:Blue;">string</span>[] args)
        {
            <span style="color:Blue;">try</span>
            {
                <span style="color:Green;">// Obtain the target organization's Web address and client logon </span>
                <span style="color:Green;">// credentials from the user.</span>
                ServerConnection serverConnect = <span style="color:Blue;">new</span> ServerConnection();
                ServerConnection.Configuration config = serverConnect.GetServerConfiguration();

                SendEmail app = <span style="color:Blue;">new</span> SendEmail();
                app.Run(config, <span style="color:Blue;">true</span>);

            }
            <span style="color:Blue;">catch</span> (FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt; ex)
            {
                Console.WriteLine(<span style="color:#A31515;">"The application terminated with an error."</span>);
                Console.WriteLine(<span style="color:#A31515;">"Timestamp: {0}"</span>, ex.Detail.Timestamp);
                Console.WriteLine(<span style="color:#A31515;">"Code: {0}"</span>, ex.Detail.ErrorCode);
                Console.WriteLine(<span style="color:#A31515;">"Message: {0}"</span>, ex.Detail.Message);
                Console.WriteLine(<span style="color:#A31515;">"Plugin Trace: {0}"</span>, ex.Detail.TraceText);
                Console.WriteLine(<span style="color:#A31515;">"Inner Fault: {0}"</span>,
                    <span style="color:Blue;">null</span> == ex.Detail.InnerFault ? <span style="color:#A31515;">"No Inner Fault"</span> : <span style="color:#A31515;">"Has Inner Fault"</span>);
            }
            <span style="color:Blue;">catch</span> (System.TimeoutException ex)
            {
                Console.WriteLine(<span style="color:#A31515;">"The application terminated with an error."</span>);
                Console.WriteLine(<span style="color:#A31515;">"Message: {0}"</span>, ex.Message);
                Console.WriteLine(<span style="color:#A31515;">"Stack Trace: {0}"</span>, ex.StackTrace);
                Console.WriteLine(<span style="color:#A31515;">"Inner Fault: {0}"</span>,
                    <span style="color:Blue;">null</span> == ex.InnerException.Message ? <span style="color:#A31515;">"No Inner Fault"</span> : ex.InnerException.Message);
            }
            <span style="color:Blue;">catch</span> (System.Exception ex)
            {
                Console.WriteLine(<span style="color:#A31515;">"The application terminated with an error."</span>);
                Console.WriteLine(ex.Message);

                <span style="color:Green;">// Display the details of the inner exception.</span>
                <span style="color:Blue;">if</span> (ex.InnerException != <span style="color:Blue;">null</span>)
                {
                    Console.WriteLine(ex.InnerException.Message);

                    FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt; fe =
                        ex.InnerException
                        <span style="color:Blue;">as</span> FaultException&lt;Microsoft.Xrm.Sdk.OrganizationServiceFault&gt;;
                    <span style="color:Blue;">if</span> (fe != <span style="color:Blue;">null</span>)
                    {
                        Console.WriteLine(<span style="color:#A31515;">"Timestamp: {0}"</span>, fe.Detail.Timestamp);
                        Console.WriteLine(<span style="color:#A31515;">"Code: {0}"</span>, fe.Detail.ErrorCode);
                        Console.WriteLine(<span style="color:#A31515;">"Message: {0}"</span>, fe.Detail.Message);
                        Console.WriteLine(<span style="color:#A31515;">"Plugin Trace: {0}"</span>, fe.Detail.TraceText);
                        Console.WriteLine(<span style="color:#A31515;">"Inner Fault: {0}"</span>,
                            <span style="color:Blue;">null</span> == fe.Detail.InnerFault ? <span style="color:#A31515;">"No Inner Fault"</span> : <span style="color:#A31515;">"Has Inner Fault"</span>);
                    }
                }
            }
            <span style="color:Green;">// Additonal exceptions to catch: SecurityTokenValidationException, ExpiredSecurityTokenException,</span>
            <span style="color:Green;">// SecurityAccessDeniedException, MessageSecurityException, and SecurityNegotiationException.</span>

            <span style="color:Blue;">finally</span>
            {
                Console.WriteLine(<span style="color:#A31515;">"Press &lt;Enter&gt; to exit."</span>);
                Console.ReadLine();
            }

        }
        <span style="color:Blue;">#endregion</span> Main method

    }
}

</pre>
             </div> 
            </div> 
           </div> 
          </div> 
         </div>
         <div>
          <h2 class="LW_CollapsibleArea_TitleDiv">
           <div>
            <a class="LW_CollapsibleArea_TitleAhref" title="Collapse" role="heading"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">See Also</span></a>
            <div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div">
             <a href="/en-us/library/hh210217.aspx#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="Right-click to copy and share the link for this section"></a>
            </div>
            <div class="LW_CollapsibleArea_HrDiv">
             <hr class="LW_CollapsibleArea_Hr">
            </div>
           </div></h2>
          <div class="sectionblock">
           <p><a href="https://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.iorganizationservice.aspx">IOrganizationService</a><br><a href="https://msdn.microsoft.com/en-us/library/microsoft.crm.sdk.messages.sendemailrequest.aspx">SendEmailRequest</a><br><a href="https://msdn.microsoft.com/en-us/library/gg309494.aspx">Sample code for activity entities</a><br><a href="https://msdn.microsoft.com/en-us/library/hh210212.aspx">Sample: Create an email using a template</a><br><a href="https://msdn.microsoft.com/en-us/library/gg334229.aspx">Email activity entities</a><br><a href="https://msdn.microsoft.com/en-us/library/gg328424.aspx">Email entity messages and methods</a><br><a href="https://msdn.microsoft.com/en-us/library/gg309393.aspx">Helper code: ServerConnection class</a><br></p>
          </div>
         </div>
         <p></p>
         <p>Microsoft Dynamics 365</p> 
         <p>© 2016 Microsoft. All rights reserved. <a href="https://msdn.microsoft.com/en-us/library/gg490658.aspx">Copyright</a></p> 
         <p></p>
        </div> 
       </div> 
      </div> 
     </div> 
     <script id="CommentTemplate" type="text/x-jquery-tmpl">
    <div class="communityContentAnnotation">
        <a name="${Index}"></a>
        <h3>
            ${Title}
        </h3>
        <div class="communityContentAnnotationBody">
            {{html Body}}
        </div>
        <div class="communityContentAnnotationInfo">
            <div class="communityContentAnnotationAvatarContainer">
                <a href="${UserAvatar.Href}" title="${UserAvatar.ToolTip}" class="communityContentAnnotationAvatar"><img src="${UserAvatar.ImageUrl}" alt="${UserAvatar.ImageAltText}" width="34" height="34" /></a>
            </div>
            <div class="communityContentAnnotationUserDateContainer">
                <div class="communityContentAnnotationUserContainer">
                    <a href="${UserAvatar.Href}">
                        ${User}
                    </a>
                </div>
                <div class="communityContentAnnotationDateContainer">
                    <span>${Date}</span>
                    
                    {{if EditLink}}
                        <span>
                            <a href="${EditLink.Href}" title="${EditLink.ToolTip}" class="communityContentCommentEditLink">${EditLink.Title}</a>
                        </span>
                    {{/if}}

                    {{if DeleteLink}}
                        <span>
                            <a href="${DeleteLink.Href}" title="${DeleteLink.ToolTip}" class="communityContentDeleteLink">${DeleteLink.Title}</a>
                        </span>
                    {{/if}}
                </div>
            </div>
        </div>
    </div>
</script> 
     <div class="communityContentContainer" ms.cmpgrp="community"> 
      <div id="CommunityContentHeader" class="communityContentHeader"> 
       <div class="communityContentHeaderTitleContainer"> 
        <h2>Community Additions</h2> 
        <a class="communityContentAddLink" href="https://msdn.microsoft.com/en-us/library/community/add/hh210217.aspx"> <span class="communityContentAddButton" title="Add"> ADD </span> </a> 
       </div> 
       <div style="clear: both;"></div> 
      </div> 
      <div id="CommunityComments" data-url="/en-us/library/community/comments/hh210217.aspx"></div> 
     </div> 
     <div class="libraryMemberFilter"> 
      <div class="filterContainer"> 
       <span>Show:</span> 
       <label> <input type="checkbox" class="libraryFilterInherited" checked value="Inherit">Inherited </label> 
       <label> <input type="checkbox" class="libraryFilterProtected" checked value="Protected">Protected </label> 
      </div> 
     </div> 
     <input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings."> 
    </div> 
    <div id="rightNavigationMenu" ms.cmpgrp="right nav"> 
     <div id="mobileButtons"> 
      <div id="navigationButtons"> 
       <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/hh210217(d=printer).aspx" rel="nofollow"><ins class="print"></ins>Print </a> 
       <a id="isd_printABook" href="/en-us/library/export/help/?returnurl=%2fen-us%2flibrary%2fhh210217.aspx"> <ins class="export"></ins>Export (<span class="count">0</span>) </a> 
      </div> 
     </div> 
     <div id="navMain"> 
      <div id="closeNavigation"> 
       <a class="tocCloseSmall" id="closeButton"></a> 
      </div> 
      <div id="navigationButtons"> 
       <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/hh210217(d=printer).aspx" rel="nofollow"><ins class="print"></ins>Print </a> 
       <a id="isdShare" href="#" role="button" aria-expanded="false"> <ins class="share"></ins>Share </a> 
       <div id="socials" style="display: none"> 
        <a class="isdFacebook" href="#" aria-label="Share on Facebook"> <ins class="facebook"></ins> </a> 
        <a class="isdTwitter" href="#" aria-label="Share on Twitter"> <ins class="twitter"></ins> </a> 
        <a class="isdGooglePlus" href="#" aria-label="Share on Google+"> <ins class="googlePlus"></ins> </a> 
       </div> 
      </div> 
      <div id="indoc_toc" style="display: none" ms.cmpgrp="indoc toc"> 
       <div id="indoc_title">
        IN THIS ARTICLE
       </div> 
       <ul id="indoc_toclist"></ul> 
      </div> 
     </div> 
    </div> 
    <div id="rightNavigationMenuThumbnail" class="rightNavigationMenuThumbnail"> 
    </div> 
   </div> 
   <div class="clear"></div> 
   <input name="__RequestVerificationToken" type="hidden" value="LBj5aeyQ5Ltp38QlGUQLiwcOueQjq9-5-AJ9IbOysz4FTlyFU4p83BnDuqdzmkdouRbQ_07DLEzo2IaTBIVzyUOPK3M1"> 
   <input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/rate/hh210217.aspx"> 
   <input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/additional/hh210217.aspx"> 
   <input id="isTopicRated" type="hidden" value="false"> 
   <div id="lib-footer"> 
    <link type="text/css" rel="stylesheet"> 
    <div id="ux-footer" class="" style="" dir="ltr" ms.pgarea="footer"> 
     <div id="standardRatingBefore" class="clear stdr-container-before"></div> 
     <div id="standardRating" class="stdr-container" ms.pgarea="body"> 
      <div class="stdr-close"></div> 
      <div class="stdr-vote stdr-content"> 
       <div class="stdr-content"> 
        <span class="stdr-votetitle">Is this page helpful?</span> 
        <button class="stdr-yes" aria-label="Yes, this page was helpful">Yes</button> 
        <button class="stdr-no" aria-label="No, this page was not helpful">No</button> 
        <input id="s_ratingValue" type="hidden" value=""> 
       </div> 
      </div> 
      <div class="stdr-feedback" style="display: none"> 
       <div class="stdr-form"> 
        <div class="stdr-fieldtitle">
         Additional feedback?
        </div> 
        <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea> 
        <div> 
         <span class="stdr-count"><span class="stdr-charcnt">1500</span> characters remaining</span> 
         <div class="stdr-buttons"> 
          <button class="stdr-provide" aria-label="Submit my additional feedback">Submit</button> 
          <button class="stdr-skip" aria-label="Skip additional feedback">Skip this</button> 
         </div> 
        </div> 
        <div class="clear"></div> 
       </div> 
      </div> 
      <div class="stdr-thanks" style="display: none"> 
       <div class="stdr-content"> 
        <span class="stdr-thankyou">Thank you!</span> 
        <span class="stdr-appreciate">We appreciate your feedback.</span> 
       </div> 
      </div> 
      <div id="contentFeedbackQAContainer" style="display: none;"></div> 
     </div> 
     <div id="standardRatingPlaceholder" style="display: none"></div> 
     <footer class="top" role="navigation" aria-label="footer"> 
      <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml"> 
       <div class="linkList"> 
        <h4 class="linkListTitle">Dev centers</h4> 
        <ul class="links"> 
         <li> <a href="https://developer.microsoft.com/en-us/windows" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a> </li> 
         <li> <a href="https://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a> </li> 
         <li> <a href="https://www.visualstudio.com/" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a> </li> 
         <li> <a href="https://docs.microsoft.com/en-us/azure/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a> </li> 
         <li> <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">More...</a> </li> 
        </ul> 
       </div> 
      </div> 
      <div id="rightLinks"> 
       <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Related Dynamics 365 Sites</h4> 
         <ul class="links"> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/crm-free-trial-overview.aspx" title="Get started with a free 30-day Microsoft Dynamics 365 Online trial." target="_blank" id="CenterLinks1_14878_4" xmlns="http://www.w3.org/1999/xhtml">Try Microsoft Dynamics 365 Online</a> </li> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/crm-help-center/default.aspx" title="Help Center for all Dynamics 365 related products" target="_blank" id="CenterLinks1_14878_5" xmlns="http://www.w3.org/1999/xhtml">Dynamics 365 Help Center</a> </li> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/crm-customer-center/default.aspx" title="Help &amp; Training for Microsoft Dynamics 365" target="_blank" id="CenterLinks1_14878_6" xmlns="http://www.w3.org/1999/xhtml">Dynamics 365 Help &amp; Training</a> </li> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/crm-setup-and-administration/default.aspx" title="Information for administrators to configure Microsoft 365" target="_blank" id="CenterLinks1_14878_7" xmlns="http://www.w3.org/1999/xhtml">Dynamics 365 Setup &amp; Administration</a> </li> 
         </ul> 
        </div> 
       </div> 
       <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Related Microsoft Dynamics Marketing Sites</h4> 
         <ul class="links"> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/marketing-help-center/" title="Help Center for Microsoft Dynamics Marketing" target="_blank" id="CenterLinks2_14878_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Dynamics Marketing Help Center</a> </li> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/marketing-developer-center/default.aspx" title="The developer center for Microsoft Dynamics Marketing" target="_blank" id="CenterLinks2_14878_13" xmlns="http://www.w3.org/1999/xhtml">Microsoft Dynamics Marketing Developer Center</a> </li> 
         </ul> 
        </div> 
       </div> 
       <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml"> 
        <div class="linkList"> 
         <h4 class="linkListTitle">Support</h4> 
         <ul class="links"> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/crm-customer-center/support.aspx" title="Links to product, billing, and subscription support" target="_blank" id="CenterLinks4_14878_8" xmlns="http://www.w3.org/1999/xhtml">Support</a> </li> 
          <li> <a href="https://www.microsoft.com/en-us/dynamics/crm-customer-center/contact-technical-support.aspx" title="How to contact technical support" target="_blank" id="CenterLinks4_14878_9" xmlns="http://www.w3.org/1999/xhtml">Contact Technical Support</a> </li> 
          <li> <a href="http://go.microsoft.com/fwlink/p/?LinkID=825368" title="Dynamics 365 Community resources" target="_blank" id="CenterLinks4_14878_21" xmlns="http://www.w3.org/1999/xhtml">Dynamics 365 Community</a> </li> 
          <li> <a href="http://go.microsoft.com/fwlink/?LinkId=825367" title="The Dynamics 365 Enterprise edition forum" target="_blank" id="CenterLinks4_14878_22" xmlns="http://www.w3.org/1999/xhtml">Dynamics 365 Enterprise edition Forum</a> </li> 
          <li> <a href="https://community.dynamics.com/crm/f/117.aspx" title="General forum for Dynamics CRM questions" target="_blank" id="CenterLinks4_14878_10" xmlns="http://www.w3.org/1999/xhtml">Microsoft Dynamics CRM forum</a> </li> 
          <li> <a href="https://community.dynamics.com/crm/f/117.aspx?pi49901=0&amp;category=Development%20%2F%20Customization%20%2F%20SDK" title="The Development / Customization / SDK  category of the Microsoft Dynamics CRM forum" target="_blank" id="CenterLinks4_14878_11" xmlns="http://www.w3.org/1999/xhtml">Microsoft Dynamics CRM forum for developer issues</a> </li> 
          <li> <a href="https://social.msdn.microsoft.com/forums/en-us/home?forum=crmdevelopment" title="The MSDN forum for Microsoft Dynamics CRM development" target="_blank" id="CenterLinks4_14878_14" xmlns="http://www.w3.org/1999/xhtml">MSDN Dynamics CRM development forum</a> </li> 
          <li> <a href="http://go.microsoft.com/fwlink/p/?LinkID=325003" title="Vote for your favorite product ideas or add your own" target="_blank" id="CenterLinks4_14878_15" xmlns="http://www.w3.org/1999/xhtml">Product Ideas</a> </li> 
         </ul> 
        </div> 
       </div> 
      </div> 
     </footer> 
     <footer class="bottom" role="contentinfo"> 
      <span class="localeContainer"> 
       <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/en-us/selectlocale-dmc"> 
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fhh210217.aspx"> 
        <a href="#" onclick="$('#selectLocaleForm').submit();return false;" title="Change your language">United States (English)</a> 
       </form> </span> 
      <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml"> 
       <div class="linkList"> 
        <ul class="links horizontal"> 
         <li> <a href="https://msdn.microsoft.com/en-us/flashnewsletter" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">Newsletter</a> </li> 
         <li> <a href="https://msdn.microsoft.com/en-us/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">Privacy &amp; cookies</a> </li> 
         <li> <a href="https://msdn.microsoft.com/en-us/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">Terms of use</a> </li> 
         <li> <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a> </li> 
        </ul> 
       </div> 
      </div> 
      <span class="logoLegal"> <span class="logoSpan clip67x13" role="img" tabindex="0" aria-label="microsoft logo"> <img alt="logo" class="logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636382651724723869"> </span> <span class="copyright">© 2017 Microsoft</span> </span> 
     </footer> 
    </div> 
   </div> 
   <div class="footerPrintView"> 
    <div class="footerCopyrightPrintView">
     © 2017 Microsoft
    </div> 
   </div> 
   <input id="tocPaddingPerLevel" type="hidden" value="17"> 
   <input id="MtpsDevice" type="hidden" value="Default"> Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft. See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. WebTrends view model not available or IncludeLegacyWebTrendsScriptInGlobal feature flag is off 
   <div id="globalRequestVerification"> 
    <input name="__RequestVerificationToken" type="hidden" value="SGMp2TahKgcyoplYOv7RrM5Nu65llwkmjgKl49V-nMfMEr4lkdTIVWu7scuumK3hVg0irqoeW8b1i3G28kwt9bnJOcQ1"> 
   </div> 
  </div> 
  <script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:Breadcrumbs,4:LibraryRightNavigationMenu,4:PrintExportButton,5:StandardRating,2:Footer,0:Topic,3:ResponsiveSupport,0:AppInsightsPerf,3:ResponsiveToc,0:ABTestControl,4:WEDCS,3:CmpgrpForHeader,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Content:3,/Areas/Library/Themes/Base/Content:4,/Areas/Global/Content:5\u0026amp;hashKey=9B821351554FB172FE572BBD060FF016\u0026amp;v=49F8B276F7974A7A683814303145D71B" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026minimumTermLength=2\u0026pgArea=header\u0026brand=Msdn\u0026loc=en-us\u0026Refinement=241\u0026watermark=Search%20the%20MSDN%20library%20for%20Dynamics%20365%20SDK%20topics\u0026focusOnInit=false\u0026iroot=dynamics365%2f\u0026emptyWatermark=true\u0026searchButtonTooltip=Search" },
	{ url: "https://i2-msdn.sec.s-msft.com/Areas/Epx/Themes/Base/Content/JumpRedirect.js" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027Expand\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027Collapse\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027Click to expand. Double-click to expand all.\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027Click to collapse. Double-click to collapse all.\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027Expand All\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027Collapse All\u0027;" },
	{ url: "https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:CommunityContent,0:LibraryMemberFilter,1:Toc_Fixed,1:CodeSnippet,1:TopicNotInScope,1:VersionSelector,1:SurveyBroker;/Areas/Library/Content:0,/Areas/Epx/Content/Scripts:1\u0026amp;hashKey=7014190F90B8537F47B755239814958F\u0026amp;v=49F8B276F7974A7A683814303145D71B" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>  
 </body>
</html>