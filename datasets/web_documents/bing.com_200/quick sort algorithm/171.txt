<!doctype html>
<html class="client-nojs" lang="en" dir="ltr">
 <head> 
  <meta charset="UTF-8"> 
  <title>Algorithm Implementation/Sorting/Quicksort - Wikibooks, open books for an open world</title> 
  <script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script> 
  <script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Algorithm_Implementation/Sorting/Quicksort","wgTitle":"Algorithm Implementation/Sorting/Quicksort","wgCurRevisionId":3251346,"wgRevisionId":3251346,"wgArticleId":77364,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages with syntax highlighting errors","Books to be merged","Book:Algorithm Implementation"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Algorithm_Implementation/Sorting/Quicksort","wgRelevantArticleId":77364,"wgRequestId":"Wb68kwpAEKoAADW8GjQAAAAK","wgIsProbablyEditable":true,"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Algorithm_implementation/Sorting/Quicksort","wgFlaggedRevsParams":{"tags":{"value":{"levels":3,"quality":2,"pristine":3}}},"wgStableRevisionId":3251346,"wgWikiEditorEnabledModules":{"toolbar":true,"preview":false,"publish":false},"wgBetaFeaturesFeatures":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":false,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en","usePageImages":false,"usePageDescriptions":true},"wgPreferredVariant":"en","wgMFExpandAllSectionsUserOption":false,"wgMFDisplayWikibaseDescriptions":{"search":true,"nearby":true,"watchlist":true,"tagline":false},"wgULSCurrentAutonym":"English","wgNoticeProject":"wikibooks","wgCentralNoticeCookiesToDelete":[],"wgCentralNoticeCategoriesUsingLegacy":["Fundraising","fundraising"],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}","wgInternalRedirectTargetUrl":"/wiki/Algorithm_Implementation/Sorting/Quicksort","wgCentralAuthMobileDomain":false,"wgVisualEditorToolbarScrollOffset":0,"wgVisualEditorUnsupportedEditParams":["preload","preloadparams","preloadtitle","undo","undoafter","veswitched"],"wgEditSubmitButtonLabelPublish":true});mw.loader.state({"ext.globalCssJs.user.styles":"ready","ext.globalCssJs.site.styles":"ready","site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.pygments":"ready","wikibase.client.init":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","ext.wikimediaBadges":"ready","ext.flaggedRevs.basic":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready","ext.globalCssJs.user":"ready","ext.globalCssJs.site":"ready"});mw.loader.implement("user.options@0bhc5ha",function($,jQuery,require,module){mw.user.options.set([]);});mw.loader.implement("user.tokens@1dqfd7l",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/

});mw.loader.load(["mediawiki.action.view.redirect","site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","ext.gadget.wikidialog","ext.gadget.commons-file","ext.centralauth.centralautologin","mmv.head","mmv.bootstrap.autostart","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging.subscriber","ext.wikimediaEvents","ext.navigationTiming","ext.uls.eventlogger","ext.uls.init","ext.uls.compactlinks","ext.uls.interface","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.flaggedRevs.advanced","skins.vector.js"]);});</script> 
  <link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=ext.flaggedRevs.basic%7Cext.pygments%2CwikimediaBadges%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles%7Cwikibase.client.init&amp;only=styles&amp;skin=vector"> 
  <script async src="/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script> 
  <meta name="ResourceLoaderDynamicStyles" content=""> 
  <link rel="stylesheet" href="/w/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"> 
  <meta name="generator" content="MediaWiki 1.30.0-wmf.18"> 
  <meta name="referrer" content="origin-when-cross-origin"> 
  <link rel="alternate" type="application/x-wiki" title="Edit" href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit"> 
  <link rel="edit" title="Edit" href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit"> 
  <link rel="shortcut icon" href="/static/favicon/wikibooks.ico"> 
  <link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikibooks (en)"> 
  <link rel="EditURI" type="application/rsd+xml" href="//en.wikibooks.org/w/api.php?action=rsd"> 
  <link rel="license" href="//creativecommons.org/licenses/by-sa/3.0/"> 
  <link rel="alternate" type="application/atom+xml" title="Wikibooks Atom feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom"> 
  <link rel="canonical" href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Sorting/Quicksort"> 
  <link rel="dns-prefetch" href="//login.wikimedia.org"> 
  <link rel="dns-prefetch" href="//meta.wikimedia.org"> 
  <!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.min.js"></script><![endif]--> 
 </head> 
 <body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Algorithm_Implementation_Sorting_Quicksort rootpage-Algorithm_Implementation skin-vector action-view"> 
  <div id="mw-page-base" class="noprint"></div> 
  <div id="mw-head-base" class="noprint"></div> 
  <div id="content" class="mw-body" role="main"> 
   <a id="top"></a> 
   <div id="siteNotice" class="mw-body-content">
    <!-- CentralNotice -->
   </div> 
   <div class="mw-indicators mw-body-content"> 
   </div> 
   <h1 id="firstHeading" class="firstHeading" lang="en">Algorithm Implementation/Sorting/Quicksort</h1> 
   <div id="bodyContent" class="mw-body-content"> 
    <div id="siteSub" class="noprint">
     From Wikibooks, open books for an open world
    </div> 
    <div id="contentSub">
     <span class="subpages">&lt; <a href="/wiki/Algorithm_Implementation" title="Algorithm Implementation">Algorithm Implementation</a>?&nbsp;| <a href="/wiki/Algorithm_Implementation/Sorting" title="Algorithm Implementation/Sorting">Sorting</a></span>
     <span class="mw-redirectedfrom">(Redirected from <a href="/w/index.php?title=Algorithm_implementation/Sorting/Quicksort&amp;redirect=no" class="mw-redirect" title="Algorithm implementation/Sorting/Quicksort">Algorithm implementation/Sorting/Quicksort</a>)</span>
    </div> 
    <div id="jump-to-nav" class="mw-jump">
      Jump to: 
     <a href="#mw-head">navigation</a>, 
     <a href="#p-search">search</a> 
    </div> 
    <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
     <div class="mw-parser-output">
      <table class="plainlinks noprint messagebox notice" style="width:250px; float:right; clear:right; margin:0px; margin-left:10px;"> 
       <tbody>
        <tr style="vertical-align:middle;"> 
         <td style="padding:0.1em; text-align:center; vertical-align:middle; width:45px; border:none;"><img alt="Wikipedia-logo.png" src="//upload.wikimedia.org/wikipedia/commons/thumb/6/63/Wikipedia-logo.png/40px-Wikipedia-logo.png" width="40" height="40" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/6/63/Wikipedia-logo.png/60px-Wikipedia-logo.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/63/Wikipedia-logo.png/80px-Wikipedia-logo.png 2x" data-file-width="200" data-file-height="200"></td> 
         <td style="color:black; text-align:left; vertical-align:middle; padding:0.5em; padding-left:0em; border:none;"> <p><a href="https://en.wikipedia.org/wiki/" class="extiw" title="w:">Wikipedia</a> has related information at <a class="external text" href="//en.wikipedia.org/wiki/Quicksort"><i><b>Quicksort</b></i></a></p> </td> 
        </tr> 
       </tbody>
      </table> 
      <table class="metadata plainlinks ambox ambox-move" style=""> 
       <tbody>
        <tr> 
         <td class="mbox-image"> 
          <div style="width: 52px;">
           <img alt="" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Mergefrom.svg/50px-Mergefrom.svg.png" width="50" height="20" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Mergefrom.svg/75px-Mergefrom.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Mergefrom.svg/100px-Mergefrom.svg.png 2x" data-file-width="50" data-file-height="20">
          </div> </td> 
         <td class="mbox-text" style=""><b>A Wikibookian suggests that <i><a href="/wiki/Transwiki:Quicksort" title="Transwiki:Quicksort">Transwiki:Quicksort</a></i> be <a href="/wiki/Help:Pages#Merging" title="Help:Pages">merged</a> into this book or chapter.</b><br> <small>Discuss whether or not this merger should happen on the <a href="/wiki/Talk:Algorithm_Implementation/Sorting/Quicksort" title="Talk:Algorithm Implementation/Sorting/Quicksort">discussion page</a>.</small></td> 
        </tr> 
       </tbody>
      </table> 
      <p></p> 
      <div id="toc" class="toc"> 
       <div class="toctitle"> 
        <h2>Contents</h2> 
       </div> 
       <ul> 
        <li class="toclevel-1 tocsection-1"><a href="#Pseudocode"><span class="tocnumber">1</span> <span class="toctext">Pseudocode</span></a> 
         <ul> 
          <li class="toclevel-2 tocsection-2"><a href="#Iterative_version"><span class="tocnumber">1.1</span> <span class="toctext">Iterative version</span></a></li> 
         </ul> </li> 
        <li class="toclevel-1 tocsection-3"><a href="#ALGOL_68"><span class="tocnumber">2</span> <span class="toctext">ALGOL 68</span></a></li> 
        <li class="toclevel-1 tocsection-4"><a href="#AppleScript"><span class="tocnumber">3</span> <span class="toctext">AppleScript</span></a></li> 
        <li class="toclevel-1 tocsection-5"><a href="#ARM_Assembly"><span class="tocnumber">4</span> <span class="toctext">ARM Assembly</span></a></li> 
        <li class="toclevel-1 tocsection-6"><a href="#AutoIt_v3"><span class="tocnumber">5</span> <span class="toctext">AutoIt v3</span></a></li> 
        <li class="toclevel-1 tocsection-7"><a href="#C"><span class="tocnumber">6</span> <span class="toctext">C</span></a> 
         <ul> 
          <li class="toclevel-2 tocsection-8"><a href="#Iterative_Quicksort"><span class="tocnumber">6.1</span> <span class="toctext">Iterative Quicksort</span></a></li> 
         </ul> </li> 
        <li class="toclevel-1 tocsection-9"><a href="#C.2B.2B"><span class="tocnumber">7</span> <span class="toctext">C++</span></a></li> 
        <li class="toclevel-1 tocsection-10"><a href="#C.23"><span class="tocnumber">8</span> <span class="toctext">C#</span></a></li> 
        <li class="toclevel-1 tocsection-11"><a href="#Common_Lisp"><span class="tocnumber">9</span> <span class="toctext">Common Lisp</span></a></li> 
        <li class="toclevel-1 tocsection-12"><a href="#D"><span class="tocnumber">10</span> <span class="toctext">D</span></a></li> 
        <li class="toclevel-1 tocsection-13"><a href="#Delphi"><span class="tocnumber">11</span> <span class="toctext">Delphi</span></a></li> 
        <li class="toclevel-1 tocsection-14"><a href="#Elixir"><span class="tocnumber">12</span> <span class="toctext">Elixir</span></a></li> 
        <li class="toclevel-1 tocsection-15"><a href="#Erlang"><span class="tocnumber">13</span> <span class="toctext">Erlang</span></a></li> 
        <li class="toclevel-1 tocsection-16"><a href="#F.23"><span class="tocnumber">14</span> <span class="toctext">F#</span></a></li> 
        <li class="toclevel-1 tocsection-17"><a href="#Go"><span class="tocnumber">15</span> <span class="toctext">Go</span></a></li> 
        <li class="toclevel-1 tocsection-18"><a href="#Groovy"><span class="tocnumber">16</span> <span class="toctext">Groovy</span></a></li> 
        <li class="toclevel-1 tocsection-19"><a href="#Haskell"><span class="tocnumber">17</span> <span class="toctext">Haskell</span></a></li> 
        <li class="toclevel-1 tocsection-20"><a href="#J"><span class="tocnumber">18</span> <span class="toctext">J</span></a></li> 
        <li class="toclevel-1 tocsection-21"><a href="#Java"><span class="tocnumber">19</span> <span class="toctext">Java</span></a></li> 
        <li class="toclevel-1 tocsection-22"><a href="#JavaScript"><span class="tocnumber">20</span> <span class="toctext">JavaScript</span></a></li> 
        <li class="toclevel-1 tocsection-23"><a href="#Mathematica"><span class="tocnumber">21</span> <span class="toctext">Mathematica</span></a></li> 
        <li class="toclevel-1 tocsection-24"><a href="#MATLAB"><span class="tocnumber">22</span> <span class="toctext">MATLAB</span></a></li> 
        <li class="toclevel-1 tocsection-25"><a href="#Miranda"><span class="tocnumber">23</span> <span class="toctext">Miranda</span></a></li> 
        <li class="toclevel-1 tocsection-26"><a href="#ML"><span class="tocnumber">24</span> <span class="toctext">ML</span></a></li> 
        <li class="toclevel-1 tocsection-27"><a href="#OCaml"><span class="tocnumber">25</span> <span class="toctext">OCaml</span></a></li> 
        <li class="toclevel-1 tocsection-28"><a href="#Perl"><span class="tocnumber">26</span> <span class="toctext">Perl</span></a></li> 
        <li class="toclevel-1 tocsection-29"><a href="#Perl_6"><span class="tocnumber">27</span> <span class="toctext">Perl 6</span></a></li> 
        <li class="toclevel-1 tocsection-30"><a href="#PHP"><span class="tocnumber">28</span> <span class="toctext">PHP</span></a></li> 
        <li class="toclevel-1 tocsection-31"><a href="#Prolog"><span class="tocnumber">29</span> <span class="toctext">Prolog</span></a></li> 
        <li class="toclevel-1 tocsection-32"><a href="#Python"><span class="tocnumber">30</span> <span class="toctext">Python</span></a></li> 
        <li class="toclevel-1 tocsection-33"><a href="#Ruby"><span class="tocnumber">31</span> <span class="toctext">Ruby</span></a></li> 
        <li class="toclevel-1 tocsection-34"><a href="#Scala"><span class="tocnumber">32</span> <span class="toctext">Scala</span></a></li> 
        <li class="toclevel-1 tocsection-35"><a href="#Scheme"><span class="tocnumber">33</span> <span class="toctext">Scheme</span></a></li> 
        <li class="toclevel-1 tocsection-36"><a href="#Shen"><span class="tocnumber">34</span> <span class="toctext">Shen</span></a></li> 
        <li class="toclevel-1 tocsection-37"><a href="#Shell"><span class="tocnumber">35</span> <span class="toctext">Shell</span></a></li> 
        <li class="toclevel-1 tocsection-38"><a href="#Standard_ML"><span class="tocnumber">36</span> <span class="toctext">Standard ML</span></a></li> 
        <li class="toclevel-1 tocsection-39"><a href="#Swift"><span class="tocnumber">37</span> <span class="toctext">Swift</span></a></li> 
        <li class="toclevel-1 tocsection-40"><a href="#Visual_Basic"><span class="tocnumber">38</span> <span class="toctext">Visual Basic</span></a></li> 
        <li class="toclevel-1 tocsection-41"><a href="#XProc"><span class="tocnumber">39</span> <span class="toctext">XProc</span></a></li> 
        <li class="toclevel-1 tocsection-42"><a href="#Zilog_Z80000_Assembly"><span class="tocnumber">40</span> <span class="toctext">Zilog Z80000 Assembly</span></a></li> 
        <li class="toclevel-1 tocsection-43"><a href="#TorqueScript"><span class="tocnumber">41</span> <span class="toctext">TorqueScript</span></a></li> 
        <li class="toclevel-1 tocsection-44"><a href="#FORTRAN_90.2F95"><span class="tocnumber">42</span> <span class="toctext">FORTRAN 90/95</span></a></li> 
       </ul> 
      </div> 
      <p></p> 
      <h2><span class="mw-headline" id="Pseudocode"><a href="https://en.wikipedia.org/wiki/Pseudocode" class="extiw" title="wikipedia:Pseudocode">Pseudocode</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=1" title="Edit section: Pseudocode">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <h3><span class="mw-headline" id="Iterative_version">Iterative version</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=2" title="Edit section: Iterative version">edit</a><span class="mw-editsection-bracket">]</span></span></h3> 
      <pre>
 <b>function</b> QuickSort(Array, Left, Right)
 <b>var</b>
     L2, R2, PivotValue
 <b>begin</b>
     Stack.Push(Left, Right);       <i>// pushes Left, and then Right, on to a stack</i>
     <b>while not</b> Stack.Empty <b>do</b>
     <b>begin</b>
         Stack.Pop(Left, Right);    <i>// pops 2 values, storing them in Right and then Left</i>
         <b>repeat</b>
             PivotValue := Array[(Left + Right) <b>div</b> 2];
             L2 := Left;
             R2 := Right;
             <b>repeat</b>
                 <b>while</b> Array[L2] &lt; PivotValue <b>do</b> <i>// scan left partition</i>
                     L2 := L2 + 1;
                 <b>while</b> Array[R2] &gt; PivotValue <b>do</b> <i>// scan right partition</i>
                     R2 := R2 - 1;
                 <b>if</b> L2 &lt;= R2 <b>then</b>
                 <b>begin</b>
                     <b>if</b> L2 != R2 <b>then</b>
                         Swap(Array[L2], Array[R2]);  <i>// swaps the data at L2 and R2</i>
                     L2 := L2 + 1;
                     R2 := R2 - 1;
                 <b>end;</b>
             <b>until</b> L2 &gt;= R2;
             <b>if</b> R2 - Left &gt; Right - L2 <b>then</b> <i>// is left side piece larger?</i>
             <b>begin</b>
                 <b>if</b> Left &lt; R2 <b>then</b>
                     Stack.Push(Left, R2);
                 Left := L2;
             <b>end;</b>
             <b>else</b>
             <b>begin</b>
                 <b>if</b> L2 &lt; Right <b>then</b> <i>// if left side isn't, right side is larger</i>
                     Stack.Push(L2, Right);
                 Right := R2;
             <b>end;</b>
         <b>until</b> Left &gt;= Right;
     <b>end;</b>
 <b>end;</b>
</pre> 
      <h2><span class="mw-headline" id="ALGOL_68"><a href="https://en.wikipedia.org/wiki/ALGOL_68" class="extiw" title="wikipedia:ALGOL 68">ALGOL 68</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=3" title="Edit section: ALGOL 68">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>Quick sort in ALGOL 68 using the PAR clause to break the job into multiple threads.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
MODE DATA = INT;

PROC partition =(REF [] DATA array, PROC (REF DATA, REF DATA) BOOL cmp)INT: (
    INT begin:=LWB array;
    INT end:=UPB array;
    WHILE begin &lt; end DO
         WHILE begin &lt; end DO
            IF cmp(array[begin], array[end]) THEN
                DATA tmp=array[begin];
                array[begin]:=array[end];
                array[end]:=tmp;
                GO TO break while decr end
            FI;
            end -:= 1
         OD;
         break while decr end: SKIP;
         WHILE begin &lt; end DO
            IF cmp(array[begin], array[end]) THEN
                DATA tmp=array[begin];
                array[begin]:=array[end];
                array[end]:=tmp;
                GO TO break while incr begin
            FI;
            begin +:= 1
         OD;
         break while incr begin: SKIP
    OD;
    begin
);

PROC qsort=(REF [] DATA array, PROC (REF DATA, REF DATA) BOOL cmp)VOID: (
    IF LWB array &lt; UPB array THEN
        INT i := partition(array, cmp);
        PAR ( # remove PAR for single threaded sort #
          qsort(array[:i-1], cmp),
          qsort(array[i+1:], cmp)
        )
    FI
);

PROC cmp=(REF DATA a,b)BOOL: a&gt;b;

main:(
  []DATA const l=(5,4,3,2,1);
  [UPB const l]DATA l:=const l;
  qsort(l,cmp);
  printf(($g(3)$,l))
)
</pre>
      </div> 
      <h2><span class="mw-headline" id="AppleScript"><a href="https://en.wikipedia.org/wiki/AppleScript" class="extiw" title="wikipedia:AppleScript">AppleScript</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=4" title="Edit section: AppleScript">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This is a basic implementation using C.A.R. Hoare's algorithm with pivot in middle (sometimes referred to as binary or dichotomic sort). The use of a script object to store the list makes this version about 10 times faster than previously proposed one (for a list of a 1000 strings). Also "left" and "right" are keywords, and may not always run as expected. Improvement can also be done depending on data to be sorted by choosing pivot randomly or by increasing their umbers.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">on</span> <span class="nv">QuickSort</span><span class="p">(</span><span class="nv">aList</span><span class="p">,</span> <span class="nv">Le</span><span class="p">,</span> <span class="nv">Ri</span><span class="p">)</span>
	<span class="c">--&gt; Sorts list of of simple types such as reals, integers, strings or even booleans</span>
	<span class="nv">script</span> <span class="nv">Sal</span> <span class="c">--&gt; script object aList</span>
		<span class="k">property</span> <span class="nv">Array</span> <span class="p">:</span> <span class="nv">aList</span>
	<span class="k">end</span> <span class="nv">script</span>
	<span class="k">set</span> <span class="err">[</span><span class="nv">i</span><span class="p">,</span> <span class="nv">j</span><span class="err">]</span> <span class="k">to</span> <span class="err">[</span><span class="nv">Le</span><span class="p">,</span> <span class="nv">Ri</span><span class="err">]</span>
	<span class="k">set</span> <span class="nv">v</span> <span class="k">to</span> <span class="nv">Sal</span>'s <span class="nv">Array</span>'s <span class="nb">item</span> <span class="p">((</span><span class="nv">Le</span> <span class="o">+</span> <span class="nv">Ri</span><span class="p">)</span> <span class="ow">div</span> <span class="mi">2</span><span class="p">)</span> <span class="c">--&gt; pivot in middle (as C.A.R. Hoare's algorithm)</span>
	<span class="k">repeat</span> <span class="k">while</span> <span class="nv">j</span> <span class="o">&gt;</span> <span class="nv">i</span>
		<span class="k">repeat</span> <span class="k">while</span> <span class="nv">Sal</span>'s <span class="nv">Array</span>'s <span class="nb">item</span> <span class="nv">i</span> <span class="o">&lt;</span> <span class="nv">v</span>
			<span class="k">set</span> <span class="nv">i</span> <span class="k">to</span> <span class="nv">i</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">end</span> <span class="k">repeat</span>
		<span class="k">repeat</span> <span class="k">while</span> <span class="nv">Sal</span>'s <span class="nv">Array</span>'s <span class="nb">item</span> <span class="nv">j</span> <span class="o">&gt;</span> <span class="nv">v</span>
			<span class="k">set</span> <span class="nv">j</span> <span class="k">to</span> <span class="nv">j</span> <span class="o">-</span> <span class="mi">1</span>
		<span class="k">end</span> <span class="k">repeat</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nv">i</span> <span class="o">&gt;</span> <span class="nv">j</span> <span class="k">then</span>
			<span class="k">tell</span> <span class="p">(</span><span class="nv">a</span> <span class="ow">reference to</span> <span class="nv">Sal</span>'s <span class="nv">Array</span><span class="p">)</span> <span class="k">to</span> <span class="k">set</span> <span class="err">[</span><span class="nb">item</span> <span class="nv">i</span><span class="p">,</span> <span class="nb">item</span> <span class="nv">j</span><span class="err">]</span> <span class="k">to</span> <span class="err">[</span><span class="nb">item</span> <span class="nv">j</span><span class="p">,</span> <span class="nb">item</span> <span class="nv">i</span><span class="err">]</span> <span class="c">--&gt; let's swap</span>
			<span class="k">set</span> <span class="err">[</span><span class="nv">i</span><span class="p">,</span> <span class="nv">j</span><span class="err">]</span> <span class="k">to</span> <span class="err">[</span><span class="nv">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">j</span> <span class="o">-</span> <span class="mi">1</span><span class="err">]</span>
		<span class="k">end</span> <span class="k">if</span>
	<span class="k">end</span> <span class="k">repeat</span>
	<span class="k">if</span> <span class="nv">Le</span> <span class="o">&lt;</span> <span class="nv">j</span> <span class="k">then</span> <span class="nv">QuickSort</span><span class="p">(</span><span class="nv">Sal</span>'s <span class="nv">Array</span><span class="p">,</span> <span class="nv">Le</span><span class="p">,</span> <span class="nv">j</span><span class="p">)</span>
	<span class="k">if</span> <span class="nv">Ri</span> <span class="o">&gt;</span> <span class="nv">i</span> <span class="k">then</span> <span class="nv">QuickSort</span><span class="p">(</span><span class="nv">Sal</span>'s <span class="nv">Array</span><span class="p">,</span> <span class="nv">i</span><span class="p">,</span> <span class="nv">Ri</span><span class="p">)</span>
<span class="k">end</span> <span class="nv">QuickSort</span>
</pre>
      </div> 
      <p>This is a straightforward implementation. It is certainly possible to come up with a more efficient one, but it will probably not be as clear as this one:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
 <span class="nb">on</span> <span class="nv">sort</span><span class="p">(</span> <span class="nv">array</span><span class="p">,</span> <span class="nv">left</span><span class="p">,</span> <span class="nv">right</span> <span class="p">)</span>
     <span class="k">set</span> <span class="nv">i</span> <span class="k">to</span> <span class="nv">left</span>
     <span class="k">set</span> <span class="nv">j</span> <span class="k">to</span> <span class="nv">right</span>
     <span class="k">set</span> <span class="nv">v</span> <span class="k">to</span> <span class="nb">item</span> <span class="p">(</span> <span class="p">(</span> <span class="nv">left</span> <span class="o">+</span> <span class="nv">right</span> <span class="p">)</span> <span class="ow">div</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">of</span> <span class="nv">array</span> <span class="c">-- pivot</span>
     <span class="k">repeat</span> <span class="k">while</span> <span class="p">(</span> <span class="nv">j</span> <span class="o">&gt;</span> <span class="nv">i</span> <span class="p">)</span>
         <span class="k">repeat</span> <span class="k">while</span> <span class="p">(</span> <span class="nb">item</span> <span class="nv">i</span> <span class="k">of</span> <span class="nv">array</span> <span class="o">&lt;</span> <span class="nv">v</span> <span class="p">)</span>
             <span class="k">set</span> <span class="nv">i</span> <span class="k">to</span> <span class="nv">i</span> <span class="o">+</span> <span class="mi">1</span>
         <span class="k">end</span> <span class="k">repeat</span>
         <span class="k">repeat</span> <span class="k">while</span> <span class="p">(</span> <span class="nb">item</span> <span class="nv">j</span> <span class="k">of</span> <span class="nv">array</span> <span class="o">&gt;</span> <span class="nv">v</span> <span class="p">)</span>
             <span class="k">set</span> <span class="nv">j</span> <span class="k">to</span> <span class="nv">j</span> <span class="o">-</span> <span class="mi">1</span>
         <span class="k">end</span> <span class="k">repeat</span>
         <span class="k">if</span> <span class="p">(</span> <span class="ow">not</span> <span class="nv">i</span> <span class="o">&gt;</span> <span class="nv">j</span> <span class="p">)</span> <span class="k">then</span>
             <span class="k">tell</span> <span class="nv">array</span> <span class="k">to</span> <span class="k">set</span> <span class="p">{</span> <span class="nb">item</span> <span class="nv">i</span><span class="p">,</span> <span class="nb">item</span> <span class="nv">j</span> <span class="p">}</span> <span class="k">to</span> <span class="p">{</span> <span class="nb">item</span> <span class="nv">j</span><span class="p">,</span> <span class="nb">item</span> <span class="nv">i</span> <span class="p">}</span> <span class="c">-- swap</span>
             <span class="k">set</span> <span class="nv">i</span> <span class="k">to</span> <span class="nv">i</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="k">set</span> <span class="nv">j</span> <span class="k">to</span> <span class="nv">j</span> <span class="o">-</span> <span class="mi">1</span>
         <span class="k">end</span> <span class="k">if</span>
     <span class="k">end</span> <span class="k">repeat</span> 
     <span class="k">if</span> <span class="p">(</span> <span class="nv">left</span>  <span class="o">&lt;</span> <span class="nv">j</span> <span class="p">)</span> <span class="k">then</span> <span class="nv">sort</span><span class="p">(</span> <span class="nv">array</span><span class="p">,</span> <span class="nv">left</span><span class="p">,</span> <span class="nv">j</span>  <span class="p">)</span>
     <span class="k">if</span> <span class="p">(</span> <span class="nv">right</span> <span class="o">&gt;</span> <span class="nv">i</span> <span class="p">)</span> <span class="k">then</span> <span class="nv">sort</span><span class="p">(</span> <span class="nv">array</span><span class="p">,</span> <span class="nv">i</span><span class="p">,</span> <span class="nv">right</span> <span class="p">)</span>
 <span class="k">end</span> <span class="nv">sort</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="ARM_Assembly"><a href="https://en.wikipedia.org/wiki/ARM_architecture" class="extiw" title="wikipedia:ARM architecture">ARM</a> <a href="https://en.wikipedia.org/wiki/Assembly_language" class="extiw" title="wikipedia:Assembly language">Assembly</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=5" title="Edit section: ARM Assembly">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This <a href="/wiki/Embedded_Systems/ARM_Microprocessors" title="Embedded Systems/ARM Microprocessors">ARM RISC assembly language</a> implementation for sorting an array of 32-bit integers demonstrates how well quicksort takes advantage of the register model and capabilities of a typical machine instruction set (note that this particular implementation does not meet standard calling conventions and may use more than O(log <i>n</i>) space):</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
  qsort:  @ Takes three parameters:
        @   a:     Pointer to base of array a to be sorted (arrives in r0)
        @   left:  First of the range of indexes to sort (arrives in r1)
        @   right: One past last of range of indexes to sort (arrives in r2)
        @ This function destroys: r1, r2, r3, r5, r7
        stmfd   sp!, {r4, r6, lr}     @ Save r4 and r6 for caller
        mov     r6, r2                @ r6 &lt;- right
  qsort_tailcall_entry:
        sub     r7, r6, r1            @ If right - left &lt;= 1 (already sorted),
        cmp     r7, #1
        ldmlefd sp!, {r4, r6, pc}     @ Return, restoring r4 and r6
        ldr     r7, [r0, r1, asl #2]  @ r7 &lt;- a[left], gets pivot element
        add     r2, r1, #1            @ l &lt;- left + 1
        mov     r4, r6                @ r &lt;- right
  partition_loop:
        ldr     r3, [r0, r2, asl #2]  @ r3 &lt;- a[l]
        cmp     r3, r7                @ If a[l] &lt;= pivot_element,
        addle   r2, r2, #1            @ ... increment l, and
        ble     partition_test        @ ... continue to next iteration.
        sub     r4, r4, #1            @ Otherwise, decrement r,
        ldr     r5, [r0, r4, asl #2]  @ ... and swap a[l] and a[r].
        str     r5, [r0, r2, asl #2]
        str     r3, [r0, r4, asl #2]
  partition_test:
        cmp     r2, r4                @ If l &lt; r,
        blt     partition_loop        @ ... continue iterating.
  partition_finish:
        sub     r2, r2, #1            @ Decrement l
        ldr     r3, [r0, r2, asl #2]  @ Swap a[l] and pivot
        str     r3, [r0, r1, asl #2]
        str     r7, [r0, r2, asl #2]
        bl      qsort                 @ Call self recursively on left part,
                                      @  with args a (r0), left (r1), r (r2),
                                      @  also preserves r4 and r6
        mov     r1, r4
        b       qsort_tailcall_entry  @ Tail-call self on right part,
                                      @  with args a (r0), l (r1), right (r6)
</pre>
      </div> 
      <p>The call produces 3 words of stack per recursive call and is able to take advantage of its knowledge of its own behavior. A more efficient implementation would sort small ranges by a more efficient method. If an implementation obeying standard calling conventions were needed, a simple wrapper could be written for the initial call to the above function that saves the appropriate registers.</p> 
      <h2><span class="mw-headline" id="AutoIt_v3"><a href="https://en.wikipedia.org/wiki/AutoIt" class="extiw" title="wikipedia:AutoIt">AutoIt</a> v3</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=6" title="Edit section: AutoIt v3">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This is a straightforward implementation based on the AppleScript example. It is certainly possible to come up with a more efficient one, but it will probably not be as clear as this one:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
  <span class="nb">Func</span> <span class="n">sort</span><span class="p">(</span> <span class="nb">ByRef</span> <span class="nv">$array</span><span class="p">,</span> <span class="nv">$left</span><span class="p">,</span> <span class="nv">$right</span> <span class="p">)</span>
    <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$left</span>
    <span class="nv">$j</span> <span class="o">=</span> <span class="nv">$right</span>
    <span class="nv">$v</span> <span class="o">=</span> <span class="nv">$array</span><span class="p">[</span><span class="nf">Round</span><span class="p">(</span> <span class="p">(</span> <span class="nv">$left</span> <span class="o">+</span> <span class="nv">$right</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
    <span class="nb">While</span> <span class="p">(</span> <span class="nv">$j</span> <span class="o">&gt;</span> <span class="nv">$i</span> <span class="p">)</span>
        <span class="nb">While</span> <span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$v</span> <span class="p">)</span>
            <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">WEnd</span>
        <span class="nb">While</span> <span class="p">(</span> <span class="nv">$array</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nv">$v</span> <span class="p">)</span>
            <span class="nv">$j</span> <span class="o">=</span> <span class="nv">$j</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="nb">WEnd</span>
        <span class="nb">If</span> <span class="p">(</span> <span class="nb">NOT</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&gt;</span> <span class="nv">$j</span><span class="p">)</span> <span class="p">)</span> <span class="nb">then</span>
            <span class="n">swap</span><span class="p">(</span><span class="nv">$array</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span> <span class="nv">$array</span><span class="p">[</span><span class="nv">$j</span><span class="p">])</span>
            <span class="nv">$i</span> <span class="o">=</span> <span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="nv">$j</span> <span class="o">=</span> <span class="nv">$j</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="nb">EndIf</span>
    <span class="nb">WEnd</span>
    <span class="nb">if</span> <span class="p">(</span> <span class="nv">$left</span>  <span class="o">&lt;</span> <span class="nv">$j</span> <span class="p">)</span> <span class="nb">then</span> <span class="n">sort</span><span class="p">(</span> <span class="nv">$array</span><span class="p">,</span> <span class="nv">$left</span><span class="p">,</span> <span class="nv">$j</span>  <span class="p">)</span>
    <span class="nb">if</span> <span class="p">(</span> <span class="nv">$right</span> <span class="o">&gt;</span> <span class="nv">$i</span> <span class="p">)</span> <span class="nb">then</span> <span class="n">sort</span><span class="p">(</span> <span class="nv">$array</span><span class="p">,</span> <span class="nv">$i</span><span class="p">,</span> <span class="nv">$right</span> <span class="p">)</span>
  <span class="nb">EndFunc</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="C"><a href="https://en.wikipedia.org/wiki/C_programming_language" class="extiw" title="wikipedia:C programming language">C</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=7" title="Edit section: C">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The implementation in the core implementations section is limited to arrays of integers. The following implementation works with any data type, given its size and a function that compares it. This is similar to what ISO/POSIX compliant C standard libraries provide:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
   <span class="kt">char</span> <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
   <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">c</span> <span class="o">=</span> <span class="o">*</span><span class="n">a</span><span class="p">;</span>
      <span class="o">*</span><span class="n">a</span><span class="o">++</span> <span class="o">=</span> <span class="o">*</span><span class="n">b</span><span class="p">;</span>
      <span class="o">*</span><span class="n">b</span><span class="o">++</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">sort</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">array</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">void</span><span class="o">*</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span><span class="p">),</span> <span class="kt">int</span> <span class="n">begin</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">begin</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">void</span> <span class="o">*</span><span class="n">pivot</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="n">begin</span><span class="p">;</span>
      <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">size</span><span class="p">;</span>
      <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">end</span><span class="p">;</span>
      <span class="k">while</span><span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">cmp</span><span class="p">(</span><span class="n">array</span><span class="o">+</span><span class="n">l</span><span class="p">,</span><span class="n">pivot</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="n">size</span><span class="p">;</span>
         <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">cmp</span><span class="p">(</span><span class="n">array</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>  <span class="p">{</span>
            <span class="n">r</span> <span class="o">-=</span> <span class="n">size</span><span class="p">;</span>
         <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span> <span class="p">)</span> <span class="p">{</span>
            <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="o">+</span><span class="n">l</span><span class="p">,</span> <span class="n">array</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
         <span class="p">}</span>
      <span class="p">}</span>
      <span class="n">l</span> <span class="o">-=</span> <span class="n">size</span><span class="p">;</span>
      <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="o">+</span><span class="n">begin</span><span class="p">,</span> <span class="n">array</span><span class="o">+</span><span class="n">l</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
      <span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>
      <span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">qsort</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">array</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">nitems</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">void</span><span class="o">*</span><span class="p">,</span><span class="kt">void</span><span class="o">*</span><span class="p">))</span> <span class="p">{</span>
   <span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">cmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nitems</span><span class="o">*</span><span class="n">size</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">typedef</span> <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">type_cmp</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">b</span><span class="p">){</span> <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">type</span><span class="o">*</span><span class="p">)</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">type</span><span class="o">*</span><span class="p">)</span><span class="n">b</span><span class="p">);</span> <span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span> <span class="cm">/* simple test case for type=int */</span>
  <span class="kt">int</span> <span class="n">num_list</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">};</span>
  <span class="kt">int</span> <span class="n">len</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="n">num_list</span><span class="p">)</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">sep</span><span class="o">=</span><span class="s">""</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">qsort</span><span class="p">(</span><span class="n">num_list</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">type</span><span class="p">),</span><span class="n">type_cmp</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"sorted_num_list={"</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%s%d"</span><span class="p">,</span><span class="n">sep</span><span class="p">,</span><span class="n">num_list</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="n">sep</span><span class="o">=</span><span class="s">", "</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"};</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>Result:</p> 
      <pre>
sorted_num_list={1, 2, 3, 4, 5};
</pre> 
      <p>Here's yet another version with various other improvements:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="cm">/*****   macros create functional code   *****/</span>
<span class="cp">#define pivot_index() (begin+(end-begin)/2)</span>
<span class="cp">#define swap(a,b,t) ((t)=(a),(a)=(b),(b)=(t))</span>

<span class="kt">void</span> <span class="nf">sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">begin</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
   <span class="cm">/*** Use of static here will reduce memory footprint, but will make it thread-unsafe ***/</span>
   <span class="k">static</span> <span class="kt">int</span> <span class="n">pivot</span><span class="p">;</span>
   <span class="k">static</span> <span class="kt">int</span> <span class="n">t</span><span class="p">;</span>     <span class="cm">/* temporary variable for swap */</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">begin</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">end</span><span class="p">;</span>
      <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">begin</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">pivot_index</span><span class="p">()],</span> <span class="n">t</span><span class="p">);</span> <span class="cm">/*** choose arbitrary pivot ***/</span>
      <span class="n">pivot</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">begin</span><span class="p">];</span>
      <span class="k">while</span><span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">l</span><span class="o">++</span><span class="p">;</span>
         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">while</span><span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="o">--</span><span class="n">r</span> <span class="o">&amp;&amp;</span> <span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pivot</span><span class="p">)</span> <span class="cm">/*** skip superfluous swaps ***/</span>
               <span class="p">;</span>
            <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">t</span><span class="p">);</span> 
         <span class="p">}</span>
      <span class="p">}</span>
      <span class="n">l</span><span class="o">--</span><span class="p">;</span>
      <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">begin</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">t</span><span class="p">);</span>
      <span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>
      <span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="cp">#undef swap</span>
<span class="cp">#undef pivot_index</span>
</pre>
      </div> 
      <p>An alternate simple C quicksort. The first C implementation above does not sort the list properly if the initial input is a reverse sorted list, or any time in which the pivot turns out be the largest element in the list. Here is another sample quick sort implementation that does address these issues. Note that the swaps are done inline in this implementation. They may be replaced with a swap function as in the above examples.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kt">void</span> <span class="nf">quick</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">start</span><span class="p">];</span>
        <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">)</span>
                <span class="n">l</span><span class="o">++</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">p</span><span class="p">)</span>
                <span class="n">r</span><span class="o">--</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">array</span><span class="p">[</span><span class="n">r</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">){</span>
            <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">array</span><span class="p">[</span><span class="n">start</span><span class="p">]);</span>
            <span class="n">l</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">l</span><span class="o">--</span><span class="p">;</span>
            <span class="n">swap</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">array</span><span class="p">[</span><span class="n">start</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">quick</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>
        <span class="n">quick</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>This sorts an array of integers using quicksort with in-place partition.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
 <span class="kt">void</span> <span class="nf">quicksort</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="kt">int</span> <span class="n">last</span><span class="p">)</span> <span class="p">{</span>
     <span class="kt">int</span> <span class="n">pivIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
     <span class="k">if</span><span class="p">(</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">last</span><span class="p">)</span> <span class="p">{</span>
         <span class="n">pivIndex</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">);</span>
         <span class="n">quicksort</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">first</span><span class="p">,(</span><span class="n">pivIndex</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
         <span class="n">quicksort</span><span class="p">(</span><span class="n">x</span><span class="p">,(</span><span class="n">pivIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">last</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>

 <span class="kt">int</span> <span class="nf">partition</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
     <span class="kt">int</span> <span class="n">up</span><span class="p">,</span><span class="n">down</span><span class="p">,</span><span class="n">temp</span><span class="p">;</span>
     <span class="kt">int</span> <span class="n">piv</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">f</span><span class="p">];</span>
     <span class="n">up</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>
     <span class="n">down</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span>
     <span class="k">goto</span> <span class="n">partLS</span><span class="p">;</span>
     <span class="k">do</span> <span class="p">{</span> 
         <span class="n">temp</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">up</span><span class="p">];</span>
         <span class="n">y</span><span class="p">[</span><span class="n">up</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">down</span><span class="p">];</span>
         <span class="n">y</span><span class="p">[</span><span class="n">down</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
     <span class="nl">partLS</span><span class="p">:</span>
         <span class="k">while</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">up</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">piv</span> <span class="o">&amp;&amp;</span> <span class="n">up</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
             <span class="n">up</span><span class="o">++</span><span class="p">;</span>
         <span class="p">}</span>
         <span class="k">while</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">down</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">piv</span>  <span class="o">&amp;&amp;</span> <span class="n">down</span> <span class="o">&gt;</span> <span class="n">f</span> <span class="p">)</span> <span class="p">{</span>
             <span class="n">down</span><span class="o">--</span><span class="p">;</span>
         <span class="p">}</span>
     <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">down</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">);</span>
     <span class="n">y</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">down</span><span class="p">];</span>
     <span class="n">y</span><span class="p">[</span><span class="n">down</span><span class="p">]</span> <span class="o">=</span> <span class="n">piv</span><span class="p">;</span>
     <span class="k">return</span> <span class="n">down</span><span class="p">;</span>
 <span class="p">}</span>
</pre>
      </div> 
      <p>The following sample of C code can be compiled to sort a vector of strings (defined as char *list[ ]), integers, doubles, etc. This piece of code implements a mixed iterative-recursive strategy that avoids out of stack risks even in worst case. It runs faster than the standard C lib function qsort(), especially when used with partially sorted arrays (compiled with free Borland bcc32 and tested with 1 million strings vector).</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="cm">/********** QuickSort(): sorts the vector 'list[]' **********/</span>

<span class="cm">/**** Compile QuickSort for strings ****/</span>
<span class="cp">#define QS_TYPE char*</span>
<span class="cp">#define QS_COMPARE(a,b) (strcmp((a),(b)))</span>

<span class="cm">/**** Compile QuickSort for integers ****/</span>
<span class="c1">//#define QS_TYPE int</span>
<span class="c1">//#define QS_COMPARE(a,b) ((a)-(b))</span>

<span class="cm">/**** Compile QuickSort for doubles, sort list in inverted order ****/</span>
<span class="c1">//#define QS_TYPE double</span>
<span class="c1">//#define QS_COMPARE(a,b) ((b)-(a))</span>

<span class="kt">void</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="n">QS_TYPE</span> <span class="n">list</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">beg</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">QS_TYPE</span> <span class="n">piv</span><span class="p">;</span> <span class="n">QS_TYPE</span> <span class="n">tmp</span><span class="p">;</span>
    
    <span class="kt">int</span>  <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">beg</span><span class="o">&lt;</span><span class="n">end</span><span class="p">)</span>    <span class="c1">// This while loop will avoid the second recursive call</span>
    <span class="p">{</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">beg</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">beg</span> <span class="o">+</span> <span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">beg</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">end</span><span class="p">;</span>

        <span class="n">piv</span> <span class="o">=</span> <span class="n">list</span><span class="p">[</span><span class="n">p</span><span class="p">];</span>

        <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">QS_COMPARE</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">piv</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="n">l</span><span class="o">++</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">QS_COMPARE</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="n">r</span><span class="p">],</span><span class="n">piv</span><span class="p">)</span>  <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="n">r</span><span class="o">--</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">&gt;</span><span class="n">r</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

            <span class="n">tmp</span><span class="o">=</span><span class="n">list</span><span class="p">[</span><span class="n">l</span><span class="p">];</span> <span class="n">list</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="n">list</span><span class="p">[</span><span class="n">r</span><span class="p">];</span> <span class="n">list</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="n">r</span><span class="p">)</span> <span class="n">p</span><span class="o">=</span><span class="n">l</span><span class="p">;</span>
            
            <span class="n">l</span><span class="o">++</span><span class="p">;</span> <span class="n">r</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">list</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="n">list</span><span class="p">[</span><span class="n">r</span><span class="p">];</span> <span class="n">list</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">=</span><span class="n">piv</span><span class="p">;</span>
        <span class="n">r</span><span class="o">--</span><span class="p">;</span>

        <span class="c1">// Recursion on the shorter side &amp; loop (with new indexes) on the longer</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">beg</span><span class="p">)</span><span class="o">&lt;</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">l</span><span class="p">))</span>   
        <span class="p">{</span>
            <span class="n">QuickSort</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="n">beg</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
            <span class="n">beg</span><span class="o">=</span><span class="n">l</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">QuickSort</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
            <span class="n">end</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>   
<span class="p">}</span>
</pre>
      </div> 
      <h3><span class="mw-headline" id="Iterative_Quicksort">Iterative Quicksort</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=8" title="Edit section: Iterative Quicksort">edit</a><span class="mw-editsection-bracket">]</span></span></h3> 
      <p>Quicksort could also be implemented iteratively with the help of a little <a href="https://en.wikipedia.org/wiki/Stack_(abstract_data_type)" class="extiw" title="w:Stack (abstract data type)">stack</a>. Here a simple version with random selection of the pivot element:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">typedef</span> <span class="kt">long</span> <span class="n">type</span><span class="p">;</span>                                         <span class="cm">/* array type */</span>
<span class="cp">#define MAX 64            </span><span class="cm">/* stack size for max 2^(64/2) array elements  */</span>

<span class="kt">void</span> <span class="nf">quicksort_iterative</span><span class="p">(</span><span class="n">type</span> <span class="n">array</span><span class="p">[],</span> <span class="kt">unsigned</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
   <span class="kt">unsigned</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stack</span><span class="p">[</span><span class="n">MAX</span><span class="p">],</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
   <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>                                           <span class="cm">/* outer loop */</span>
      <span class="k">for</span> <span class="p">(;</span> <span class="n">left</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">len</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>                <span class="cm">/* sort left to len-1 */</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">MAX</span><span class="p">)</span> <span class="n">len</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">];</span>  <span class="cm">/* stack overflow, reset */</span>
         <span class="n">type</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">left</span><span class="o">+</span><span class="n">seed</span><span class="o">%</span><span class="p">(</span><span class="n">len</span><span class="o">-</span><span class="n">left</span><span class="p">)];</span>  <span class="cm">/* pick random pivot */</span>
         <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="o">*</span><span class="mi">69069</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>                <span class="cm">/* next pseudorandom number */</span>
         <span class="n">stack</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>                    <span class="cm">/* sort right part later */</span>
         <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">right</span> <span class="o">=</span> <span class="n">left</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span> <span class="cm">/* inner loop: partitioning */</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="o">++</span><span class="n">right</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="p">);</span>  <span class="cm">/* look for greater element */</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">pivot</span> <span class="o">&lt;</span> <span class="n">array</span><span class="p">[</span><span class="o">--</span><span class="n">len</span><span class="p">]);</span>    <span class="cm">/* look for smaller element */</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="o">&gt;=</span> <span class="n">len</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>           <span class="cm">/* partition point found? */</span>
            <span class="n">type</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">right</span><span class="p">];</span>
            <span class="n">array</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">len</span><span class="p">];</span>                  <span class="cm">/* the only swap */</span>
            <span class="n">array</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
         <span class="p">}</span>                            <span class="cm">/* partitioned, continue left part */</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>                               <span class="cm">/* stack empty? */</span>
      <span class="n">left</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>                             <span class="cm">/* left to right is sorted */</span>
      <span class="n">len</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="o">--</span><span class="n">pos</span><span class="p">];</span>                      <span class="cm">/* get next range to sort */</span>
   <span class="p">}</span> 
<span class="p">}</span>
</pre>
      </div> 
      <p>The <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator" class="extiw" title="w:Linear congruential generator">pseudorandom</a> selection of the pivot element ensures efficient sorting in <a href="https://en.wikipedia.org/wiki/Big_O_notation" class="extiw" title="w:Big O notation">O</a>(n log n) under all input conditions (increasing, decreasing order, equal elements). The size of the needed stack is smaller than 2log<sub>2</sub>(n) entries (about 99.9% probability). If a limited stack overflows the sorting simply restarts.</p> 
      <h2><span class="mw-headline" id="C.2B.2B"><a href="https://en.wikipedia.org/wiki/C_plus_plus" class="extiw" title="wikipedia:C plus plus">C++</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=9" title="Edit section: C++">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This is a generic, STL-based version of quicksort.</p> 
      <p>Note that this implementation uses last iterator content, and is not suitable for a std::[whatever]sort replacement as is.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;iterator&gt;</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="n">BidirectionalIterator</span><span class="p">,</span> <span class="k">typename</span> <span class="n">Compare</span> <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">quick_sort</span><span class="p">(</span> <span class="n">BidirectionalIterator</span> <span class="n">first</span><span class="p">,</span> <span class="n">BidirectionalIterator</span> <span class="n">last</span><span class="p">,</span> <span class="n">Compare</span> <span class="n">cmp</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">first</span> <span class="o">!=</span> <span class="n">last</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">BidirectionalIterator</span> <span class="n">left</span>  <span class="o">=</span> <span class="n">first</span><span class="p">;</span>
        <span class="n">BidirectionalIterator</span> <span class="n">right</span> <span class="o">=</span> <span class="n">last</span><span class="p">;</span>
        <span class="n">BidirectionalIterator</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">left</span><span class="o">++</span><span class="p">;</span>

        <span class="k">while</span><span class="p">(</span> <span class="n">left</span> <span class="o">!=</span> <span class="n">right</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">cmp</span><span class="p">(</span> <span class="o">*</span><span class="n">left</span><span class="p">,</span> <span class="o">*</span><span class="n">pivot</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
                <span class="o">++</span><span class="n">left</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">while</span><span class="p">(</span> <span class="p">(</span><span class="n">left</span> <span class="o">!=</span> <span class="n">right</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">cmp</span><span class="p">(</span> <span class="o">*</span><span class="n">pivot</span><span class="p">,</span> <span class="o">*</span><span class="n">right</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="o">--</span><span class="n">right</span><span class="p">;</span>
                <span class="n">std</span><span class="o">::</span><span class="n">iter_swap</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="o">--</span><span class="n">left</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">iter_swap</span><span class="p">(</span> <span class="n">pivot</span><span class="p">,</span> <span class="n">left</span> <span class="p">);</span>

        <span class="n">quick_sort</span><span class="p">(</span> <span class="n">first</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">cmp</span> <span class="p">);</span>
        <span class="n">quick_sort</span><span class="p">(</span> <span class="n">right</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="n">cmp</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="n">BidirectionalIterator</span> <span class="o">&gt;</span>
    <span class="kr">inline</span> <span class="kt">void</span> <span class="n">quick_sort</span><span class="p">(</span> <span class="n">BidirectionalIterator</span> <span class="n">first</span><span class="p">,</span> <span class="n">BidirectionalIterator</span> <span class="n">last</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">quick_sort</span><span class="p">(</span> <span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span>
                <span class="n">std</span><span class="o">::</span><span class="n">less_equal</span><span class="o">&lt;</span> <span class="k">typename</span> <span class="n">std</span><span class="o">::</span><span class="n">iterator_traits</span><span class="o">&lt;</span> <span class="n">BidirectionalIterator</span> <span class="o">&gt;::</span><span class="n">value_type</span> <span class="o">&gt;</span><span class="p">()</span>
                <span class="p">);</span>
    <span class="p">}</span>
</pre>
      </div> 
      <p>Here's a shorter version than the one in the core implementations section which takes advantage of the standard library's partition() function:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;iterator&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;functional&gt;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sort</span><span class="p">(</span><span class="n">T</span> <span class="n">begin</span><span class="p">,</span> <span class="n">T</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">begin</span> <span class="o">!=</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">T</span> <span class="n">middle</span> <span class="o">=</span> <span class="n">partition</span> <span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">bind2nd</span><span class="p">(</span>
                    <span class="n">less</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">iterator_traits</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">value_type</span><span class="o">&gt;</span><span class="p">(),</span> <span class="o">*</span><span class="n">begin</span><span class="p">));</span>
        <span class="n">sort</span> <span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">middle</span><span class="p">);</span>
<span class="c1">//        sort (max(begin + 1, middle), end);</span>
        <span class="n">T</span> <span class="n">new_middle</span> <span class="o">=</span> <span class="n">begin</span><span class="p">;</span>
        <span class="n">sort</span> <span class="p">(</span><span class="o">++</span><span class="n">new_middle</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="C.23"><a href="https://en.wikipedia.org/wiki/C_Sharp" class="extiw" title="wikipedia:C Sharp">C#</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=10" title="Edit section: C#">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The followings C# implementations uses the functional aspect of c#</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Quicksort</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">v</span><span class="p">,</span> <span class="n">IComparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">comparer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">Count</span> <span class="p">&lt;</span> <span class="m">2</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">v</span><span class="p">;</span>

	<span class="n">T</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">.</span><span class="n">Count</span> <span class="p">/</span> <span class="m">2</span><span class="p">];</span>

	<span class="k">return</span> <span class="nf">Quicksort</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">),</span> <span class="n">comparer</span><span class="p">)</span>
		<span class="p">.</span><span class="n">Concat</span><span class="p">(</span><span class="k">new</span> <span class="n">T</span><span class="p">[]</span> <span class="p">{</span> <span class="n">pivot</span> <span class="p">})</span>
		<span class="p">.</span><span class="n">Concat</span><span class="p">(</span><span class="n">Quicksort</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">),</span> <span class="n">comparer</span><span class="p">));</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>Faster cause uses partition</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Quicksort</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">v</span><span class="p">,</span> <span class="n">Comparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">compare</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(!</span><span class="n">v</span><span class="p">.</span><span class="n">Any</span><span class="p">())</span>
		<span class="k">return</span> <span class="n">Enumerable</span><span class="p">.</span><span class="n">Empty</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>

	<span class="n">T</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">v</span><span class="p">.</span><span class="n">First</span><span class="p">();</span>

	<span class="c1">// partition</span>
	<span class="n">Stack</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">lowers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stack</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(),</span> <span class="n">greaters</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Stack</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;();</span>
			
	<span class="k">foreach</span> <span class="p">(</span><span class="n">T</span> <span class="n">item</span> <span class="k">in</span> <span class="n">v</span><span class="p">.</span><span class="n">Skip</span><span class="p">(</span><span class="m">1</span><span class="p">))</span> <span class="c1">// skip the pivot</span>
		<span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">&lt;</span> <span class="m">0</span> <span class="p">?</span> <span class="n">lowers</span> <span class="p">:</span> <span class="n">greaters</span><span class="p">).</span><span class="n">Push</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

	<span class="k">return</span> <span class="nf">Quicksort</span><span class="p">(</span><span class="n">lowers</span><span class="p">,</span> <span class="n">compare</span><span class="p">)</span>
		<span class="p">.</span><span class="n">Concat</span><span class="p">(</span><span class="k">new</span> <span class="n">T</span><span class="p">[]</span> <span class="p">{</span> <span class="n">pivot</span> <span class="p">})</span>
		<span class="p">.</span><span class="n">Concat</span><span class="p">(</span><span class="n">Quicksort</span><span class="p">(</span><span class="n">greaters</span><span class="p">,</span> <span class="n">compare</span><span class="p">));</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>The following example uses linq to filter the list</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">private</span> <span class="k">void</span> <span class="n">Quicksort</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="p">[]</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="kt">int</span> <span class="n">right</span><span class="p">,</span> <span class="n">IComparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">comparer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="p">-</span> <span class="n">left</span> <span class="p">&gt;</span> <span class="m">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">var</span> <span class="n">mid</span> <span class="p">=</span> <span class="p">(</span><span class="n">left</span> <span class="p">+</span> <span class="n">right</span><span class="p">)</span> <span class="p">/</span> <span class="m">2</span><span class="p">;</span>
		<span class="n">T</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">v</span><span class="p">[</span><span class="n">mid</span><span class="p">];</span>
		<span class="n">T</span><span class="p">[]</span> <span class="n">aux</span> <span class="p">=</span> <span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">right</span> <span class="p">-</span> <span class="n">left</span> <span class="p">+</span> <span class="m">1</span><span class="p">];</span>

		<span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">aux</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>

		<span class="kt">var</span> <span class="n">vv</span> <span class="p">=</span> <span class="n">aux</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
			<span class="p">.</span><span class="n">Concat</span><span class="p">(</span> <span class="k">new</span> <span class="n">T</span><span class="p">[]</span> <span class="p">{</span><span class="n">pivot</span><span class="p">}</span> <span class="p">)</span> 
			<span class="p">.</span><span class="n">Concat</span><span class="p">(</span><span class="n">aux</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)).</span><span class="n">ToArray</span><span class="p">();</span>

		<span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">vv</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>

		<span class="n">Quicksort</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">comparer</span><span class="p">);</span>
		<span class="n">Quicksort</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">mid</span> <span class="p">+</span> <span class="m">1</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">comparer</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>The following C# implementation uses a random pivot.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">static</span> <span class="k">class</span> <span class="nc">Quicksort</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="n">Swap</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="p">[]</span> <span class="n">array</span><span class="p">,</span> <span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="kt">int</span> <span class="n">right</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">array</span><span class="p">[</span><span class="n">right</span><span class="p">];</span>
        <span class="n">array</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="p">=</span> <span class="n">array</span><span class="p">[</span><span class="n">left</span><span class="p">];</span>
        <span class="n">array</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="p">=</span> <span class="n">temp</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">Sort</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="p">[]</span> <span class="n">array</span><span class="p">,</span> <span class="n">IComparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">comparer</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">array</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">,</span> <span class="n">comparer</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">Sort</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">T</span><span class="p">[]</span> <span class="n">array</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startIndex</span><span class="p">,</span> <span class="kt">int</span> <span class="n">endIndex</span><span class="p">,</span> <span class="n">IComparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">comparer</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">comparer</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="n">comparer</span> <span class="p">=</span> <span class="n">Comparer</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">Default</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">left</span> <span class="p">=</span> <span class="n">startIndex</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">right</span> <span class="p">=</span> <span class="n">endIndex</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">startIndex</span><span class="p">;</span>
        <span class="n">startIndex</span><span class="p">++;</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">endIndex</span> <span class="p">&gt;=</span> <span class="n">startIndex</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">startIndex</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">pivot</span><span class="p">])</span> <span class="p">&gt;=</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">endIndex</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">pivot</span><span class="p">])</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="n">Swap</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">startIndex</span><span class="p">,</span> <span class="n">endIndex</span><span class="p">);</span>
            <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">startIndex</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">pivot</span><span class="p">])</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
                <span class="n">endIndex</span><span class="p">--;</span>
            <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">comparer</span><span class="p">.</span><span class="n">Compare</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">endIndex</span><span class="p">],</span> <span class="n">array</span><span class="p">[</span><span class="n">pivot</span><span class="p">])</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="n">startIndex</span><span class="p">++;</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">endIndex</span><span class="p">--;</span>
                <span class="n">startIndex</span><span class="p">++;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">Swap</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">pivot</span><span class="p">,</span> <span class="n">endIndex</span><span class="p">);</span>
        <span class="n">pivot</span> <span class="p">=</span> <span class="n">endIndex</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span> <span class="p">&gt;</span> <span class="n">left</span><span class="p">)</span>
            <span class="n">Sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">pivot</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="p">&gt;</span> <span class="n">pivot</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span>
            <span class="n">Sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">pivot</span> <span class="p">+</span> <span class="m">1</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Common_Lisp"><a href="https://en.wikipedia.org/wiki/Common_Lisp" class="extiw" title="wikipedia:Common Lisp">Common Lisp</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=11" title="Edit section: Common Lisp">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">partition</span> <span class="p">(</span><span class="nv">fun</span> <span class="nc">array</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">remove-if-not</span> <span class="nv">fun</span> <span class="nc">array</span><span class="p">)</span> <span class="p">(</span><span class="nb">remove-if</span> <span class="nv">fun</span> <span class="nc">array</span><span class="p">)))</span>
 
<span class="p">(</span><span class="nb">defun</span> <span class="nb">sort</span> <span class="p">(</span><span class="nc">array</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null</span> <span class="nc">array</span><span class="p">)</span> <span class="no">nil</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">part</span> <span class="p">(</span><span class="nv">partition</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">car</span> <span class="nc">array</span><span class="p">)))</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nc">array</span><span class="p">))))</span>
      <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">sort</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">part</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nc">array</span><span class="p">)</span> <span class="p">(</span><span class="nb">sort</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">part</span><span class="p">)))))))</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="D"><a href="https://en.wikipedia.org/wiki/D_(programming_language)" class="extiw" title="wikipedia:D (programming language)">D</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=12" title="Edit section: D">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>Based on the C code posted at rossetacode.org</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kt">void</span> <span class="n">sort</span><span class="p">(</span><span class="n">T</span><span class="p">)(</span><span class="n">T</span> <span class="n">arr</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="p">.</span><span class="n">length</span> <span class="p">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">quickSort</span><span class="p">(</span><span class="n">arr</span><span class="p">.</span><span class="n">ptr</span><span class="p">,</span> <span class="n">arr</span><span class="p">.</span><span class="n">ptr</span> <span class="p">+</span> <span class="p">(</span><span class="n">arr</span><span class="p">.</span><span class="n">length</span> <span class="p">-</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">quickSort</span><span class="p">(</span><span class="n">T</span><span class="p">)(</span><span class="n">T</span> <span class="p">*</span><span class="n">left</span><span class="p">,</span> <span class="n">T</span> <span class="p">*</span><span class="n">right</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="p">&gt;</span> <span class="n">left</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">T</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">left</span><span class="p">[(</span><span class="n">right</span> <span class="p">-</span> <span class="n">left</span><span class="p">)</span> <span class="p">/</span> <span class="mi">2</span><span class="p">];</span>
        <span class="n">T</span><span class="p">*</span> <span class="n">r</span> <span class="p">=</span> <span class="n">right</span><span class="p">,</span> <span class="n">l</span> <span class="p">=</span> <span class="n">left</span><span class="p">;</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">while</span> <span class="p">(*</span><span class="n">l</span> <span class="p">&lt;</span> <span class="n">pivot</span><span class="p">)</span> <span class="n">l</span><span class="p">++;</span>
            <span class="k">while</span> <span class="p">(*</span><span class="n">r</span> <span class="p">&gt;</span> <span class="n">pivot</span><span class="p">)</span> <span class="n">r</span><span class="p">--;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="p">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="n">swap</span><span class="p">(*</span><span class="n">l</span><span class="p">++,</span> <span class="p">*</span><span class="n">r</span><span class="p">--);</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="p">&lt;=</span> <span class="n">r</span><span class="p">);</span>
        <span class="n">quickSort</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="n">quickSort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//D2 version,working with almost any kind of iterator(called range in the D community)not only array</span>
<span class="kt">void</span> <span class="n">quickSort</span><span class="p">(</span><span class="n">T</span><span class="p">)(</span><span class="n">T</span> <span class="n">iter</span><span class="p">)</span>
  <span class="k">if</span><span class="p">(</span><span class="n">hasLength</span><span class="p">!</span><span class="n">T</span> <span class="p">&amp;&amp;</span> <span class="n">isRandomAccessRange</span><span class="p">!</span><span class="n">T</span> <span class="p">&amp;&amp;</span> <span class="n">hasSlicing</span><span class="p">!</span><span class="n">T</span><span class="p">){</span>

    <span class="k">if</span><span class="p">(</span><span class="n">iter</span><span class="p">.</span><span class="n">length</span><span class="p">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="c1">//there is nothing to sort</span>

    <span class="k">auto</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">iter</span><span class="p">[</span><span class="n">iter</span><span class="p">.</span><span class="n">length</span><span class="p">/</span><span class="mi">2</span><span class="p">];</span>
    <span class="nb">size_t</span> <span class="n">r</span> <span class="p">=</span> <span class="n">iter</span><span class="p">.</span><span class="n">length</span><span class="p">,</span> <span class="n">l</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">iter</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="p">&lt;</span> <span class="n">pivot</span><span class="p">)</span> <span class="n">l</span><span class="p">++;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">iter</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="p">&gt;</span> <span class="n">pivot</span><span class="p">)</span> <span class="n">r</span><span class="p">--;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="p">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">iter</span><span class="p">[</span><span class="n">l</span><span class="p">++],</span> <span class="n">iter</span><span class="p">[</span><span class="n">r</span><span class="p">--]);</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="p">&lt;=</span> <span class="n">r</span><span class="p">);</span>

    <span class="n">quickSort</span><span class="p">(</span><span class="n">iter</span><span class="p">[</span><span class="mi">0</span> <span class="p">..</span> <span class="n">r</span><span class="p">]);</span>
    <span class="n">quickSort</span><span class="p">(</span><span class="n">iter</span><span class="p">[</span><span class="n">l</span> <span class="p">..</span> <span class="p">$]);</span>

<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Delphi"><a href="https://en.wikipedia.org/wiki/Delphi_programming_language" class="extiw" title="wikipedia:Delphi programming language">Delphi</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=13" title="Edit section: Delphi">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This example sorts strings using quicksort.</p> 
      <p><b>Note:</b> This can be considered bad code, as it is very slow.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">procedure</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="k">const</span> <span class="n">AList</span><span class="o">:</span> <span class="n">TStrings</span><span class="o">;</span> <span class="k">const</span> <span class="n">AStart</span><span class="o">,</span> <span class="n">AEnd</span><span class="o">:</span> <span class="kt">Integer</span><span class="p">)</span><span class="o">;</span>
  <span class="k">procedure</span> <span class="nf">Swap</span><span class="p">(</span><span class="k">const</span> <span class="n">AIdx1</span><span class="o">,</span> <span class="n">AIdx2</span><span class="o">:</span> <span class="kt">Integer</span><span class="p">)</span><span class="o">;</span>
  <span class="k">var</span>
    <span class="n">Tmp</span><span class="o">:</span> <span class="k">string</span><span class="o">;</span>
  <span class="k">begin</span>
    <span class="n">Tmp</span> <span class="o">:=</span> <span class="n">AList</span><span class="p">[</span><span class="n">AIdx1</span><span class="p">]</span><span class="o">;</span>
    <span class="n">AList</span><span class="p">[</span><span class="n">AIdx1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">AList</span><span class="p">[</span><span class="n">AIdx2</span><span class="p">]</span><span class="o">;</span>
    <span class="n">AList</span><span class="p">[</span><span class="n">AIdx2</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Tmp</span><span class="o">;</span>
  <span class="k">end</span><span class="o">;</span>

<span class="k">var</span>
  <span class="n">Left</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
  <span class="n">Pivot</span><span class="o">:</span> <span class="k">string</span><span class="o">;</span>
  <span class="n">Right</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="k">if</span> <span class="n">AStart</span> <span class="o">&gt;=</span> <span class="n">AEnd</span> <span class="k">then</span>
    <span class="k">Exit</span><span class="o">;</span>
  <span class="n">Pivot</span> <span class="o">:=</span> <span class="n">AList</span><span class="p">[</span><span class="n">AStart</span><span class="p">]</span><span class="o">;</span>
  <span class="n">Left</span> <span class="o">:=</span> <span class="n">AStart</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
  <span class="n">Right</span> <span class="o">:=</span> <span class="n">AEnd</span><span class="o">;</span>
  <span class="k">while</span> <span class="n">Left</span> <span class="o">&lt;</span> <span class="n">Right</span> <span class="k">do</span>
    <span class="k">begin</span>
      <span class="k">if</span> <span class="n">AList</span><span class="p">[</span><span class="n">Left</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Pivot</span> <span class="k">then</span>
        <span class="nb">Inc</span><span class="p">(</span><span class="n">Left</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">begin</span>
          <span class="nb">Swap</span><span class="p">(</span><span class="n">Left</span><span class="o">,</span> <span class="n">Right</span><span class="p">)</span><span class="o">;</span>
          <span class="nb">Dec</span><span class="p">(</span><span class="n">Right</span><span class="p">)</span><span class="o">;</span>
        <span class="k">end</span><span class="o">;</span>
    <span class="k">end</span><span class="o">;</span>
  <span class="nb">Dec</span><span class="p">(</span><span class="n">Left</span><span class="p">)</span><span class="o">;</span>
  <span class="nb">Swap</span><span class="p">(</span><span class="n">Left</span><span class="o">,</span> <span class="n">AStart</span><span class="p">)</span><span class="o">;</span>
  <span class="nb">Dec</span><span class="p">(</span><span class="n">Left</span><span class="p">)</span><span class="o">;</span>
  <span class="n">QuickSort</span><span class="p">(</span><span class="n">AList</span><span class="o">,</span> <span class="n">AStart</span><span class="o">,</span> <span class="n">Left</span><span class="p">)</span><span class="o">;</span>
  <span class="n">QuickSort</span><span class="p">(</span><span class="n">AList</span><span class="o">,</span> <span class="n">Right</span><span class="o">,</span> <span class="n">AEnd</span><span class="p">)</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre>
      </div> 
      <p>This implementation sorts an array of integers.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">procedure</span> <span class="nf">QSort</span><span class="p">(</span><span class="k">var</span> <span class="n">A</span><span class="o">:</span> <span class="k">array</span> <span class="k">of</span> <span class="kt">Integer</span><span class="p">)</span><span class="o">;</span>
  <span class="k">procedure</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="k">var</span> <span class="n">A</span><span class="o">:</span> <span class="k">array</span> <span class="k">of</span> <span class="kt">Integer</span><span class="o">;</span> <span class="n">iLo</span><span class="o">,</span> <span class="n">iHi</span><span class="o">:</span> <span class="kt">Integer</span><span class="p">)</span><span class="o">;</span>
  <span class="k">var</span> <span class="nb">Lo</span><span class="o">,</span> <span class="nb">Hi</span><span class="o">,</span> <span class="n">Mid</span><span class="o">,</span> <span class="n">T</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
  <span class="k">begin</span>
    <span class="nb">Lo</span> <span class="o">:=</span> <span class="n">iLo</span><span class="o">;</span>
    <span class="nb">Hi</span> <span class="o">:=</span> <span class="n">iHi</span><span class="o">;</span>
    <span class="n">Mid</span> <span class="o">:=</span> <span class="n">A</span><span class="p">[(</span><span class="nb">Lo</span> <span class="o">+</span> <span class="nb">Hi</span><span class="p">)</span> <span class="k">div</span> <span class="mi">2</span><span class="p">]</span><span class="o">;</span>
    <span class="k">repeat</span>
      <span class="k">while</span> <span class="n">A</span><span class="p">[</span><span class="nb">Lo</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Mid</span> <span class="k">do</span>
        <span class="nb">Inc</span><span class="p">(</span><span class="nb">Lo</span><span class="p">)</span><span class="o">;</span>
      <span class="k">while</span> <span class="n">A</span><span class="p">[</span><span class="nb">Hi</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Mid</span> <span class="k">do</span>
        <span class="nb">Dec</span><span class="p">(</span><span class="nb">Hi</span><span class="p">)</span><span class="o">;</span>
      <span class="k">if</span> <span class="nb">Lo</span> <span class="o">&lt;=</span> <span class="nb">Hi</span> <span class="k">then</span> <span class="k">begin</span>
        <span class="n">T</span> <span class="o">:=</span> <span class="n">A</span><span class="p">[</span><span class="nb">Lo</span><span class="p">]</span><span class="o">;</span>
        <span class="n">A</span><span class="p">[</span><span class="nb">Lo</span><span class="p">]</span> <span class="o">:=</span> <span class="n">A</span><span class="p">[</span><span class="nb">Hi</span><span class="p">]</span><span class="o">;</span>
        <span class="n">A</span><span class="p">[</span><span class="nb">Hi</span><span class="p">]</span> <span class="o">:=</span> <span class="n">T</span><span class="o">;</span>
        <span class="nb">Inc</span><span class="p">(</span><span class="nb">Lo</span><span class="p">)</span><span class="o">;</span>
        <span class="nb">Dec</span><span class="p">(</span><span class="nb">Hi</span><span class="p">)</span><span class="o">;</span>
      <span class="k">end</span><span class="o">;</span>
    <span class="k">until</span> <span class="nb">Lo</span> <span class="o">&gt;</span> <span class="nb">Hi</span><span class="o">;</span>
    <span class="k">if</span> <span class="nb">Hi</span> <span class="o">&gt;</span> <span class="n">iLo</span> <span class="k">then</span>
      <span class="n">QuickSort</span><span class="p">(</span><span class="n">A</span><span class="o">,</span> <span class="n">iLo</span><span class="o">,</span> <span class="nb">Hi</span><span class="p">)</span><span class="o">;</span>
    <span class="k">if</span> <span class="nb">Lo</span> <span class="o">&lt;</span> <span class="n">iHi</span> <span class="k">then</span>
      <span class="n">QuickSort</span><span class="p">(</span><span class="n">A</span><span class="o">,</span> <span class="nb">Lo</span><span class="o">,</span> <span class="n">iHi</span><span class="p">)</span><span class="o">;</span>
  <span class="k">end</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">QuickSort</span><span class="p">(</span><span class="n">A</span><span class="o">,</span> <span class="nb">Low</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">,</span> <span class="nb">High</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre>
      </div> 
      <p>This slightly modified implementation sorts an array of records. This is approximately 8x quicker than the previous one. <b>Note:</b> this is QuickSort only, more speedup can be gain with handling trivial case (comparing two values), or implementing Bubble or Shell sort on small ranges.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">type</span>
  <span class="n">TCustomRecord</span> <span class="o">=</span> <span class="k">record</span>
    <span class="n">Key</span><span class="o">:</span> <span class="kt">WideString</span><span class="o">;</span>
    <span class="n">foo1</span><span class="o">:</span><span class="kt">Int64</span><span class="o">;</span>
    <span class="n">foo2</span><span class="o">:</span><span class="kt">TDatetime</span><span class="o">;</span>
    <span class="n">foo3</span><span class="o">:</span><span class="kt">Extended</span><span class="o">;</span>
  <span class="k">end</span><span class="o">;</span>
  <span class="n">TCustomArray</span> <span class="o">=</span> <span class="k">array</span> <span class="k">of</span> <span class="n">TCustomRecord</span><span class="o">;</span>

<span class="k">procedure</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="k">var</span> <span class="n">A</span><span class="o">:</span> <span class="n">TCustomArray</span><span class="o">;</span> <span class="n">L</span><span class="o">,</span> <span class="n">R</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span> <span class="k">var</span> <span class="n">tmp</span><span class="o">:</span> <span class="n">TCustomRecord</span><span class="p">)</span><span class="o">;</span>
<span class="k">var</span>
  <span class="n">OrigL</span><span class="o">,</span>
  <span class="n">OrigR</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
  <span class="n">Pivot</span><span class="o">:</span> <span class="kt">WideString</span><span class="o">;</span>
  <span class="n">GoodPivot</span><span class="o">,</span>
  <span class="n">SortPartitions</span><span class="o">:</span> <span class="kt">Boolean</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="k">if</span> <span class="n">L</span><span class="o">&lt;</span><span class="n">R</span> <span class="k">then</span> <span class="k">begin</span>
    <span class="n">Pivot</span><span class="o">:=</span><span class="n">A</span><span class="p">[</span><span class="n">L</span><span class="o">+</span><span class="nb">Random</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">L</span><span class="p">)]</span><span class="o">.</span><span class="n">Key</span><span class="o">;</span>
    <span class="n">OrigL</span><span class="o">:=</span><span class="n">L</span><span class="o">;</span> <span class="c1">//saving original bounds</span>
    <span class="n">OrigR</span><span class="o">:=</span><span class="n">R</span><span class="o">;</span>
    <span class="k">repeat</span>
      <span class="n">L</span><span class="o">:=</span><span class="n">OrigL</span><span class="o">;</span> <span class="c1">//restoring original bounds if we</span>
      <span class="n">R</span><span class="o">:=</span><span class="n">OrigR</span><span class="o">;</span> <span class="c1">//have chosen a bad pivot value</span>
      <span class="k">while</span> <span class="n">L</span><span class="o">&lt;</span><span class="n">R</span> <span class="k">do</span> <span class="k">begin</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">L</span><span class="o">&lt;</span><span class="n">R</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">.</span><span class="n">Key</span><span class="o">&lt;</span><span class="n">Pivot</span><span class="p">)</span> <span class="k">do</span> <span class="nb">Inc</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">L</span><span class="o">&lt;</span><span class="n">R</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">R</span><span class="p">]</span><span class="o">.</span><span class="n">Key</span><span class="o">&gt;=</span><span class="n">Pivot</span><span class="p">)</span> <span class="k">do</span> <span class="nb">Dec</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">L</span><span class="o">&lt;</span><span class="n">R</span><span class="p">)</span> <span class="k">then</span> <span class="k">begin</span>
          <span class="n">tmp</span><span class="o">:=</span><span class="n">A</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">;</span>
          <span class="n">A</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">:=</span><span class="n">A</span><span class="p">[</span><span class="n">R</span><span class="p">]</span><span class="o">;</span>
          <span class="n">A</span><span class="p">[</span><span class="n">R</span><span class="p">]</span><span class="o">:=</span><span class="n">tmp</span><span class="o">;</span>
          <span class="nb">Dec</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">;</span>
          <span class="nb">Inc</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">;</span>
        <span class="k">end</span><span class="o">;</span>
      <span class="k">end</span><span class="o">;</span>
      <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">.</span><span class="n">Key</span><span class="o">&gt;=</span><span class="n">Pivot</span> <span class="k">then</span> <span class="nb">Dec</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">;</span>                            <span class="c1">//has we managed to choose</span>
      <span class="n">GoodPivot</span><span class="o">:=</span><span class="n">L</span><span class="o">&gt;=</span><span class="n">OrigL</span><span class="o">;</span>                                       <span class="c1">//a good pivot value?</span>
      <span class="n">SortPartitions</span><span class="o">:=</span><span class="k">True</span><span class="o">;</span>                                      <span class="c1">//if so, then sort on</span>
      <span class="k">if</span> <span class="k">not</span> <span class="n">GoodPivot</span> <span class="k">then</span> <span class="k">begin</span>                                <span class="c1">//bad luck, the pivot is the smallest one in our range</span>
        <span class="n">GoodPivot</span><span class="o">:=</span><span class="k">True</span><span class="o">;</span>                                         <span class="c1">//let's presume that all the values are equal to pivot</span>
        <span class="n">SortPartitions</span><span class="o">:=</span><span class="k">False</span><span class="o">;</span>                                   <span class="c1">//then no need to sort it</span>
        <span class="k">for</span> <span class="n">R</span> <span class="o">:=</span> <span class="n">OrigL</span> <span class="k">to</span> <span class="n">OrigR</span> <span class="k">do</span> <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">R</span><span class="p">]</span><span class="o">.</span><span class="n">Key</span><span class="o">&lt;&gt;</span><span class="n">Pivot</span> <span class="k">then</span> <span class="k">begin</span> <span class="c1">//we have at least one different value than our pivot</span>
          <span class="n">Pivot</span><span class="o">:=</span><span class="n">A</span><span class="p">[</span><span class="n">R</span><span class="p">]</span><span class="o">.</span><span class="n">Key</span><span class="o">;</span>                                       <span class="c1">//so this will be our new pivot</span>
          <span class="n">GoodPivot</span><span class="o">:=</span><span class="k">False</span><span class="o">;</span>                                      <span class="c1">//we have to start again sorting this range</span>
          <span class="k">Break</span><span class="o">;</span>
        <span class="k">end</span><span class="o">;</span>
      <span class="k">end</span><span class="o">;</span>
    <span class="k">until</span> <span class="n">GoodPivot</span><span class="o">;</span>
    <span class="k">if</span> <span class="n">SortPartitions</span> <span class="k">then</span> <span class="k">begin</span>
      <span class="n">QuickSort</span><span class="p">(</span><span class="n">A</span><span class="o">,</span> <span class="n">OrigL</span><span class="o">,</span> <span class="n">L</span><span class="o">,</span> <span class="n">tmp</span><span class="p">)</span><span class="o">;</span>
      <span class="n">QuickSort</span><span class="p">(</span><span class="n">A</span><span class="o">,</span> <span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">OrigR</span><span class="o">,</span> <span class="n">tmp</span><span class="p">)</span><span class="o">;</span>
    <span class="k">end</span><span class="o">;</span>
  <span class="k">end</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Elixir"><a href="https://en.wikipedia.org/wiki/Elixir_(programming_language)" class="extiw" title="wikipedia:Elixir (programming language)">Elixir</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=14" title="Edit section: Elixir">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The following Elixir code sorts collections that implement the Enumerbale protocol of items of <i>any type</i> that can be compared using the &lt; operator.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kd">defmodule</span> <span class="nc">QSort</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">sort</span><span class="p">([]),</span> <span class="ss">do</span><span class="p">:</span> <span class="p">[]</span>
  <span class="kd">def</span> <span class="n">sort</span><span class="p">([</span><span class="n">pivot</span> <span class="o">|</span> <span class="n">rest</span><span class="p">])</span> <span class="k">do</span>
    <span class="p">{</span><span class="n">smaller</span><span class="p">,</span> <span class="n">bigger</span><span class="p">}</span> <span class="o">=</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="ni">&amp;1</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="p">))</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">smaller</span><span class="p">)</span> <span class="o">++</span> <span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="o">++</span> <span class="n">sort</span><span class="p">(</span><span class="n">bigger</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Erlang"><a href="https://en.wikipedia.org/wiki/Erlang_programming_language" class="extiw" title="wikipedia:Erlang programming language">Erlang</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=15" title="Edit section: Erlang">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The following Erlang code sorts lists of items of <i>any type</i>.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="nf">qsort</span><span class="p">([])</span> <span class="o">-&gt;</span> <span class="p">[];</span>
<span class="nf">qsort</span><span class="p">([</span><span class="nv">Pivot</span><span class="p">|</span><span class="nv">Rest</span><span class="p">])</span> <span class="o">-&gt;</span>
    <span class="n">qsort</span><span class="p">([</span> <span class="nv">X</span> <span class="p">||</span> <span class="nv">X</span> <span class="o">&lt;-</span> <span class="nv">Rest</span><span class="p">,</span> <span class="nv">X</span> <span class="o">&lt;</span> <span class="nv">Pivot</span><span class="p">])</span> <span class="o">++</span> <span class="p">[</span><span class="nv">Pivot</span><span class="p">]</span> <span class="o">++</span> <span class="n">qsort</span><span class="p">([</span> <span class="nv">Y</span> <span class="p">||</span> <span class="nv">Y</span> <span class="o">&lt;-</span> <span class="nv">Rest</span><span class="p">,</span> <span class="nv">Y</span> <span class="o">&gt;=</span> <span class="nv">Pivot</span><span class="p">]).</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="F.23"><a href="https://en.wikipedia.org/wiki/F_Sharp_(programming_language)" class="extiw" title="wikipedia:F Sharp (programming language)">F#</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=16" title="Edit section: F#">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">let</span> <span class="k">rec</span> <span class="n">quicksort</span> <span class="n">l</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
    <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
    <span class="o">|</span> <span class="n">h</span><span class="o">::</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">quicksort</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">h</span><span class="o">)</span> <span class="n">t</span><span class="o">)</span> <span class="o">@</span> <span class="n">h</span> <span class="o">::</span> <span class="n">quicksort</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">h</span><span class="o">)</span> <span class="n">t</span><span class="o">)</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Go"><a href="https://en.wikipedia.org/wiki/Go_(programming_language)" class="extiw" title="wikipedia:Go (programming language)">Go</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=17" title="Edit section: Go">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kd">func</span> <span class="nx">QSort</span><span class="p">(</span><span class="nx">data</span> <span class="p">[]</span><span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">&lt;</span> <span class="mi">2</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">pivot</span> <span class="o">:=</span> <span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nx">l</span><span class="p">,</span> <span class="nx">r</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="nx">l</span> <span class="o">&lt;=</span> <span class="nx">r</span> <span class="p">{</span>
        <span class="k">for</span> <span class="nx">l</span> <span class="o">&lt;=</span> <span class="nx">r</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nx">pivot</span> <span class="p">{</span>
            <span class="nx">l</span> <span class="o">++</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="nx">r</span> <span class="o">&gt;=</span> <span class="nx">l</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nx">pivot</span> <span class="p">{</span>
            <span class="nx">r</span> <span class="o">--</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="nx">l</span> <span class="p">&lt;</span> <span class="nx">r</span> <span class="p">{</span>
            <span class="nx">data</span><span class="p">[</span><span class="nx">l</span><span class="p">],</span> <span class="nx">data</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="p">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">r</span><span class="p">],</span> <span class="nx">data</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
 
    <span class="k">if</span> <span class="nx">r</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">data</span><span class="p">[</span><span class="nx">r</span><span class="p">]</span> <span class="p">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">r</span><span class="p">],</span> <span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nx">qsort</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nx">r</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="nx">qsort</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">l</span><span class="p">:])</span>
<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Groovy"><a href="https://en.wikipedia.org/wiki/Groovy_programming_language" class="extiw" title="wikipedia:Groovy programming language">Groovy</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=18" title="Edit section: Groovy">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kd">static</span> <span class="kt">def</span> <span class="nf">quicksort</span><span class="o">(</span><span class="n">v</span><span class="o">)</span> <span class="o">{</span>
   <span class="k">if</span> <span class="o">(!</span><span class="n">v</span> <span class="o">||</span> <span class="n">v</span><span class="o">.</span><span class="na">size</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="k">return</span> <span class="n">v</span>
   <span class="kt">def</span> <span class="o">(</span><span class="n">less</span><span class="o">,</span> <span class="n">more</span><span class="o">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">[</span><span class="mi">1</span><span class="o">..-</span><span class="mi">1</span><span class="o">].</span><span class="na">split</span> <span class="o">{</span> <span class="n">it</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">}</span>
   <span class="n">quicksort</span><span class="o">(</span><span class="n">less</span><span class="o">)</span> <span class="o">+</span> <span class="n">v</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="n">quicksort</span><span class="o">(</span><span class="n">more</span><span class="o">)</span>
<span class="o">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Haskell"><a href="https://en.wikipedia.org/wiki/Haskell_(programming_language)" class="extiw" title="wikipedia:Haskell (programming language)">Haskell</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=19" title="Edit section: Haskell">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The Haskell code in the core implementations section is almost self explanatory but can suffer from inefficiencies because it crawls through the list "rest" twice, once for each list comprehension. A smart implementation can perform optimizations to prevent this inefficiency, but these are not required by the language. The following implementation does not have the aforementioned inefficiency, as it uses a partition function that ensures that we only traverse `xs' once:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
    <span class="kr">import</span> <span class="nn">Data.List</span> <span class="p">(</span><span class="nf">partition</span><span class="p">)</span>
    
    <span class="n">sort</span><span class="ow">::</span> <span class="p">(</span><span class="kt">Ord</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="n">sort</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="kt">[]</span>
    <span class="n">sort</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">sort</span> <span class="n">less</span> <span class="o">++</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">++</span> <span class="n">sort</span> <span class="n">greatereq</span>
        <span class="kr">where</span> <span class="p">(</span><span class="n">less</span><span class="p">,</span><span class="n">greatereq</span><span class="p">)</span> <span class="ow">=</span> <span class="n">partition</span> <span class="p">(</span><span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="n">xs</span>
</pre>
      </div> 
      <p>Another version:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
    <span class="n">quicksort</span> <span class="ow">::</span> <span class="kt">Ord</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="n">quicksort</span> <span class="kt">[]</span>           <span class="ow">=</span> <span class="kt">[]</span>
    <span class="n">quicksort</span> <span class="p">(</span><span class="n">pivot</span><span class="kt">:</span><span class="n">tail</span><span class="p">)</span> <span class="ow">=</span> <span class="n">quicksort</span> <span class="n">less</span> <span class="o">++</span> <span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="o">++</span> <span class="n">quicksort</span> <span class="n">greater</span>
        <span class="kr">where</span> <span class="n">less</span>    <span class="ow">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">|</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="n">tail</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="p">]</span>
              <span class="n">greater</span> <span class="ow">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">|</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="n">tail</span><span class="p">,</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">pivot</span><span class="p">]</span>
</pre>
      </div> 
      <p>An even shorter version:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
    <span class="n">qsort</span> <span class="kt">[]</span>     <span class="ow">=</span> <span class="kt">[]</span>
    <span class="n">qsort</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">qsort</span> <span class="p">(</span><span class="n">filter</span> <span class="p">(</span><span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="n">xs</span><span class="p">)</span> <span class="o">++</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">++</span> <span class="n">qsort</span> <span class="p">(</span><span class="n">filter</span> <span class="p">(</span><span class="o">&gt;=</span> <span class="n">x</span><span class="p">)</span> <span class="n">xs</span><span class="p">)</span>
</pre>
      </div> 
      <p>A rather fast version which builds the list from the end, making the use of (++) ok, it only traverses the list of lower parts, prepending them to head of the higher and equal lists. One draw back is that it requires the whole list be sorted, it's not very good for laziness:</p> 
      <pre>
    qsort xs = qsort' xs []
    
    qsort' [] end = end
    qsort' (x:xs) end = qsort' lower (equal ++ qsort' higher end)
        where (lower, equal, higher) = partit x xs ([],[x],[])
    
    partit s [] part = part
    partit s (x:xs) (l,e,h) 
        |x &lt; s = partit s xs (x:l, e, h)
        |x &gt; s = partit s xs (l, e, x:h)
        |otherwise = partit s xs (l, x:e, h)
</pre> 
      <h2><span class="mw-headline" id="J"><a href="https://en.wikipedia.org/wiki/J_programming_language" class="extiw" title="wikipedia:J programming language">J</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=20" title="Edit section: J">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The J example in the core implementations section is extremely terse and difficult to understand. This implementation, from the J Dictionary, is less obtuse:</p> 
      <pre>
sel=: adverb def 'x. # ['

quicksort=: verb define
 if. 1 &gt;: #y. do. y.
 else. 
  (quicksort y. &lt;sel e),(y. =sel e),quicksort y. &gt;sel e=.y.{~?#y.
 end.
)
</pre> 
      <h2><span class="mw-headline" id="Java"><a href="https://en.wikipedia.org/wiki/Java_programming_language" class="extiw" title="wikipedia:Java programming language">Java</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=21" title="Edit section: Java">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The following example uses the functional characteristics of Java 8</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.function.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">Quicksort</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">v</span><span class="o">,</span> <span class="n">BiFunction</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">T</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">comparer</span><span class="o">)</span>
<span class="o">{</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span>
		<span class="k">return</span> <span class="n">v</span><span class="o">;</span>
	
	<span class="n">T</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>

	<span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">Quicksort</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">comparer</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()),</span> <span class="n">comparer</span><span class="o">));</span>
	<span class="n">l</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span> <span class="n">v</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">comparer</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">==</span> <span class="mi">0</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">())</span> <span class="o">);</span>
	<span class="n">l</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span> <span class="n">Quicksort</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">comparer</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()),</span> <span class="n">comparer</span><span class="o">)</span> <span class="o">);</span>
	
	<span class="k">return</span> <span class="n">l</span><span class="o">;</span>
<span class="o">}</span>
</pre>
      </div> 
      <p>Here is a sample Java implementation that sorts an ArrayList of numbers.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuickSort</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">NUMBERS_TO_SORT</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">QuickSort</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NUMBERS_TO_SORT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">numbers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">NUMBERS_TO_SORT</span> <span class="o">+</span> <span class="mi">1</span><span class="o">));</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">number</span> <span class="o">:</span> <span class="n">numbers</span><span class="o">)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">number</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\nBefore quick sort\n\n"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">number</span> <span class="o">:</span> <span class="n">quicksort</span><span class="o">(</span><span class="n">numbers</span><span class="o">))</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">number</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\nAfter quick sort\n\n"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">quicksort</span><span class="o">(</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">numbers</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span>
            <span class="k">return</span> <span class="n">numbers</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">lesser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">greater</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="kt">int</span> <span class="n">sameAsPivot</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">number</span> <span class="o">:</span> <span class="n">numbers</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">number</span> <span class="o">&gt;</span> <span class="n">numbers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">pivot</span><span class="o">))</span>
                <span class="n">greater</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
            <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">number</span> <span class="o">&lt;</span> <span class="n">numbers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">pivot</span><span class="o">))</span>
                <span class="n">lesser</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
            <span class="k">else</span>
                <span class="n">sameAsPivot</span><span class="o">++;</span>
        <span class="o">}</span>
        <span class="n">lesser</span> <span class="o">=</span> <span class="n">quicksort</span><span class="o">(</span><span class="n">lesser</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">sameAsPivot</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">lesser</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">numbers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">pivot</span><span class="o">));</span>
        <span class="n">greater</span> <span class="o">=</span> <span class="n">quicksort</span><span class="o">(</span><span class="n">greater</span><span class="o">);</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">sorted</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">number</span> <span class="o">:</span> <span class="n">lesser</span><span class="o">)</span>
            <span class="n">sorted</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">:</span> <span class="n">greater</span><span class="o">)</span>
            <span class="n">sorted</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">sorted</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
      </div> 
      <p>The following Java implementation uses a randomly selected pivot. Analogously to the Erlang solution above, a user-supplied <a href="/w/index.php?title=Template:Javadoc:SE&amp;action=edit&amp;redlink=1" class="new" title="Template:Javadoc:SE (does not exist)">Template:Javadoc:SE</a> determines the partial ordering of array elements:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Quicksort</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">RND</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span> 
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">swap</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
        <span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">int</span> <span class="nf">partition</span><span class="o">(</span><span class="n">E</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">begin</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">,</span> <span class="n">Comparator</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;</span>  <span class="n">cmp</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">RND</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">E</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">index</span><span class="o">];</span>
        <span class="n">swap</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span> 
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">index</span> <span class="o">=</span> <span class="n">begin</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">end</span><span class="o">;</span> <span class="o">++</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">pivot</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">swap</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span><span class="o">++,</span> <span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">swap</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span> 
        <span class="k">return</span> <span class="o">(</span><span class="n">index</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">qsort</span><span class="o">(</span><span class="n">E</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">begin</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">,</span> <span class="n">Comparator</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;</span> <span class="n">cmp</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">begin</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">partition</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">begin</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">cmp</span><span class="o">);</span>
            <span class="n">qsort</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">begin</span><span class="o">,</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">cmp</span><span class="o">);</span>
            <span class="n">qsort</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span>  <span class="n">end</span><span class="o">,</span>  <span class="n">cmp</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">sort</span><span class="o">(</span><span class="n">E</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="n">Comparator</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;</span>  <span class="n">cmp</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">qsort</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">cmp</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
      </div> 
      <p>With the advent of <a href="/w/index.php?title=J2SE&amp;action=edit&amp;redlink=1" class="new" title="J2SE (does not exist)">J2SE</a> 5.0 you can use <a href="/w/index.php?title=Generic_programming&amp;action=edit&amp;redlink=1" class="new" title="Generic programming (does not exist)">parameterized types</a> to avoid passing the <code>Comparator</code> used above.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Random</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuickSort</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">RND</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">swap</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
        <span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="kt">int</span> <span class="nf">partition</span><span class="o">(</span><span class="n">E</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">begin</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">begin</span> <span class="o">+</span> <span class="n">RND</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">E</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">array</span><span class="o">[</span><span class="n">index</span><span class="o">];</span>
        <span class="n">swap</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">index</span> <span class="o">=</span> <span class="n">begin</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">end</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">compareTo</span><span class="o">(</span><span class="n">pivot</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">swap</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span><span class="o">++,</span> <span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">swap</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">index</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="kt">int</span> <span class="kt">void</span> <span class="nf">qsort</span><span class="o">(</span><span class="n">E</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">begin</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">begin</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">partition</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">begin</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
            <span class="n">qsort</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">begin</span><span class="o">,</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
            <span class="n">qsort</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="kt">int</span> <span class="kt">void</span> <span class="nf">sort</span><span class="o">(</span><span class="n">E</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">qsort</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Example uses</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Integer</span><span class="o">[]</span> <span class="n">l1</span> <span class="o">=</span> <span class="o">{</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">1024</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">88</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1024</span> <span class="o">};</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"l1  start:"</span> <span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">l1</span><span class="o">));</span>
        <span class="n">QuickSort</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">l1</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"l1 sorted:"</span> <span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">l1</span><span class="o">));</span>

        <span class="n">String</span><span class="o">[]</span> <span class="n">l2</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"gamma"</span><span class="o">,</span> <span class="s">"beta"</span><span class="o">,</span> <span class="s">"alpha"</span><span class="o">,</span> <span class="s">"zoolander"</span> <span class="o">};</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"l2  start:"</span> <span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">l2</span><span class="o">));</span>
        <span class="n">QuickSort</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">l2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"l2 sorted:"</span> <span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">l2</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
      </div> 
      <p>Another implementation.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuickSort</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> 
    <span class="o">{</span>
        <span class="cm">/* Data to be sorted */</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">createRandomData</span><span class="o">();</span>
        
        <span class="cm">/* Generate a random permutation of the data.</span>
<span class="cm">         * This sometimes improves the performance of QuickSort</span>
<span class="cm">         */</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
        
        <span class="cm">/* Call quick sort */</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">sorted</span> <span class="o">=</span> <span class="n">quickSort</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
        
        <span class="cm">/* Print sorted data to the standard output */</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sorted</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    
    <span class="cm">/* Add data to be sorted to the list */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">createRandomData</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="kt">int</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">1000000</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
        <span class="o">{</span>
            <span class="cm">/* You can add any type that implements</span>
<span class="cm">             * the Comparable interface */</span>             
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">max</span><span class="o">)));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">quickSort</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">data</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">sorted</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;();</span>
        <span class="n">rQuickSort</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">sorted</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">sorted</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="cm">/**</span>
<span class="cm">     * A recursive implementation of QuickSort. Pivot selection</span>
<span class="cm">     * is random. The algorithm is stable.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="kt">void</span> <span class="nf">rQuickSort</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">data</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">sorted</span><span class="o">)</span>
    <span class="o">{</span>   
        <span class="k">if</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">sorted</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">iterator</span><span class="o">().</span><span class="na">next</span><span class="o">());</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="k">if</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        
        <span class="cm">/* choose the pivot randomly */</span>
        <span class="kt">int</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="n">E</span> <span class="n">pivotI</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">pivot</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">fatPivot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">left</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">right</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;();</span>
        
        <span class="cm">/* partition data */</span>
        <span class="k">for</span><span class="o">(</span><span class="n">E</span> <span class="n">next</span> <span class="o">:</span> <span class="n">data</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="kt">int</span> <span class="n">compare</span> <span class="o">=</span> <span class="n">pivotI</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span><span class="n">compare</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
            <span class="o">{</span>
                <span class="n">right</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">compare</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
            <span class="o">{</span>
                <span class="n">left</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span>
            <span class="o">{</span>
                <span class="n">fatPivot</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">rQuickSort</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">sorted</span><span class="o">);</span>
        <span class="n">sorted</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">fatPivot</span><span class="o">);</span>
        <span class="n">rQuickSort</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">sorted</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
      </div> 
      <p>Here is a sample that uses recursion, like the Groovy implementation:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.LinkedList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Quicksort</span> <span class="o">{</span>

	<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;[]</span> <span class="nf">split</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;[]</span> <span class="n">results</span> <span class="o">=</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;[])</span><span class="k">new</span> <span class="n">List</span><span class="o">[]</span> <span class="o">{</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;(),</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;()</span> <span class="o">};</span>
		<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
		<span class="n">E</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
		<span class="k">while</span> <span class="o">(</span><span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
			<span class="n">E</span> <span class="n">x</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">pivot</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="n">results</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">add</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
			<span class="k">else</span> <span class="n">results</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">add</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">results</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">quicksort</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">v</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="k">return</span> <span class="n">v</span><span class="o">;</span>
		<span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;();</span>
		<span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;[]</span> <span class="n">lists</span> <span class="o">=</span> <span class="n">split</span><span class="o">(</span><span class="n">v</span><span class="o">);</span>
		<span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">quicksort</span><span class="o">(</span><span class="n">lists</span><span class="o">[</span><span class="mi">0</span><span class="o">]));</span>
		<span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
		<span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">quicksort</span><span class="o">(</span><span class="n">lists</span><span class="o">[</span><span class="mi">1</span><span class="o">]));</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>

<span class="o">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="JavaScript"><a href="https://en.wikipedia.org/wiki/JavaScript" class="extiw" title="wikipedia:JavaScript">JavaScript</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=22" title="Edit section: JavaScript">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kd">function</span> <span class="nx">qsort</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">right</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">pivot</span> <span class="o">=</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">pivot</span> <span class="o">?</span> <span class="nx">left</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">:</span> <span class="nx">right</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">[...</span><span class="nx">qsort</span><span class="p">(</span><span class="nx">left</span><span class="p">),</span> <span class="nx">pivot</span><span class="p">,</span> <span class="p">...</span><span class="nx">qsort</span><span class="p">(</span><span class="nx">right</span><span class="p">)];</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>Here is another JavaScript implementation in a more functional style.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kd">function</span> <span class="nx">qsort</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">pivot</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
  <span class="k">return</span> <span class="p">[</span>
    <span class="p">...</span><span class="nx">qsort</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">el</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">el</span> <span class="o">&lt;=</span> <span class="nx">pivot</span><span class="p">)),</span>
    <span class="nx">pivot</span><span class="p">,</span>
    <span class="p">...</span><span class="nx">qsort</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">el</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">el</span> <span class="o">&gt;</span> <span class="nx">pivot</span><span class="p">))</span>
    <span class="p">];</span>
<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Mathematica"><a href="https://en.wikipedia.org/wiki/Mathematica" class="extiw" title="wikipedia:Mathematica">Mathematica</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=23" title="Edit section: Mathematica">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>Here's a functional-style implementation:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="n">QSort</span><span class="p">[{}]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">{}</span>
<span class="n">QSort</span><span class="p">[{</span><span class="nv">h_</span><span class="p">,</span><span class="w"> </span><span class="nv">t___</span><span class="p">}]</span><span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="n">Join</span><span class="p">[</span><span class="n">QSort</span><span class="p">[</span><span class="n">Select</span><span class="p">[{</span><span class="n">t</span><span class="p">},</span><span class="w"> </span><span class="nv">#</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">&amp;</span><span class="p">]],</span><span class="w"> </span><span class="p">{</span><span class="n">h</span><span class="p">},</span><span class="w"> </span><span class="n">QSort</span><span class="p">[</span><span class="n">Select</span><span class="p">[{</span><span class="n">t</span><span class="p">},</span><span class="w"> </span><span class="nv">#</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">&amp;</span><span class="p">]]]</span>
</pre>
      </div> 
      <p>Here's a test driver which should yield <code>True</code>:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="n">OrderedQ</span><span class="p">[</span><span class="n">QSort</span><span class="p">[</span><span class="n">Table</span><span class="p">[</span><span class="n">Random</span><span class="p">[</span><span class="n">Integer</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">}],</span><span class="w"> </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">}]]]</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="MATLAB"><a href="https://en.wikipedia.org/wiki/MATLAB" class="extiw" title="wikipedia:MATLAB">MATLAB</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=24" title="Edit section: MATLAB">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">function</span><span class="w"> </span>[y]<span class="p">=</span><span class="nf">quicksort</span><span class="p">(</span>x<span class="p">)</span>
<span class="c">% Uses quicksort to sort an array. Two dimensional arrays are sorted column-wise.</span>
<span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">]=</span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span><span class="p">=</span><span class="n">x</span><span class="p">;</span>
    <span class="k">for</span> <span class="nb">j</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span>
        <span class="n">y</span><span class="p">(:,</span><span class="nb">j</span><span class="p">)=</span><span class="n">quicksort</span><span class="p">(</span><span class="n">x</span><span class="p">(:,</span><span class="nb">j</span><span class="p">));</span>
    <span class="k">end</span>
    <span class="k">return</span><span class="p">;</span>
<span class="k">end</span>
<span class="c">% The trivial cases</span>
<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="p">=</span><span class="mi">1</span><span class="p">);</span><span class="n">y</span><span class="p">=</span><span class="n">x</span><span class="p">;</span><span class="k">return</span><span class="p">;</span><span class="k">end</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">x</span><span class="p">=[</span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span>
        <span class="k">end</span>
        <span class="n">y</span><span class="p">=</span><span class="n">x</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
    <span class="k">end</span>
<span class="c">% The non-trivial case</span>
<span class="c">% Find a pivot, and divide the array into two parts.</span>
<span class="c">% All elements of the first part are less than the</span>
<span class="c">% pivot, and the elements of the other part are greater </span>
<span class="c">% than or equal to the pivot.</span>
<span class="n">m</span><span class="p">=</span><span class="nb">fix</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">pivot</span><span class="p">=</span><span class="n">x</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="n">ltIndices</span><span class="p">=</span><span class="nb">find</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">pivot</span><span class="p">);</span> <span class="c">% Indices of all elements less than pivot.</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isempty</span><span class="p">(</span><span class="n">ltIndices</span><span class="p">))</span> <span class="c">% This happens when pivot is miniumum of all elements.</span>
    <span class="n">ind</span><span class="p">=</span><span class="nb">find</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">pivot</span><span class="p">);</span> <span class="c">% Find the indices of elements greater than pivot.</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isempty</span><span class="p">(</span><span class="n">ind</span><span class="p">));</span><span class="n">y</span><span class="p">=</span> <span class="n">x</span><span class="p">;</span><span class="k">return</span><span class="p">;</span><span class="k">end</span><span class="p">;</span> <span class="c">% This happens when all elements are the same.</span>
        <span class="n">pivot</span><span class="p">=</span><span class="n">x</span><span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span> <span class="c">% Use new pivot.</span>
        <span class="n">ltIndices</span><span class="p">=</span><span class="nb">find</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">pivot</span><span class="p">);</span>
<span class="k">end</span>
<span class="c">% Now find the indices of all elements not less than pivot.</span>
<span class="c">% Since the pivot is an element of the array, </span>
<span class="c">% geIndices cannot be empty.</span>
<span class="n">geIndices</span><span class="p">=</span><span class="nb">find</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="p">=</span><span class="n">pivot</span><span class="p">);</span>
<span class="c">% Recursively sort the two parts of the array and concatenate </span>
<span class="c">% the sorted parts.</span>
<span class="n">y</span><span class="p">=</span> <span class="p">[</span><span class="n">QuickSort</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">ltIndices</span><span class="p">));</span><span class="n">QuickSort</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">geIndices</span><span class="p">))];</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Miranda"><a href="https://en.wikipedia.org/wiki/Miranda_programming_language" class="extiw" title="wikipedia:Miranda programming language">Miranda</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=25" title="Edit section: Miranda">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
   <span class="n">sort</span> <span class="kt">[]</span>           <span class="ow">=</span> <span class="kt">[]</span>  
   <span class="n">sort</span> <span class="p">(</span><span class="n">pivot</span><span class="kt">:</span><span class="n">rest</span><span class="p">)</span> <span class="ow">=</span> <span class="n">sort</span> <span class="p">[</span> <span class="n">y</span> <span class="o">|</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="n">rest</span><span class="p">;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">pivot</span> <span class="p">]</span>  
                        <span class="o">++</span> <span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="o">++</span>
                       <span class="n">sort</span> <span class="p">[</span> <span class="n">y</span> <span class="o">|</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="n">rest</span><span class="p">;</span> <span class="n">y</span> <span class="o">&gt;</span>  <span class="n">pivot</span> <span class="p">]</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="ML"><a href="https://en.wikipedia.org/wiki/ML_(programming_language)" class="extiw" title="w:ML (programming language)">ML</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=26" title="Edit section: ML">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="cm">(* quicksort_r recurses down the list partitioning it into elements smaller than the pivot and others.</span>
<span class="cm">    it then combines the lists at the end with the pivot in the middle.</span>

<span class="cm">   It can be generalised to take a comparison function and thus remove the "int" type restriction.</span>
<span class="cm">   It could also be generalised to use a Cons() function instead of the :: abbreviation allowing for </span>
<span class="cm">   other sorts of lists.</span>
<span class="cm"> *)</span>

<span class="kr">fun</span> <span class="nf">quicksort</span> <span class="p">[]</span> <span class="p">=</span> <span class="p">[]</span>
<span class="p">|</span>   <span class="nf">quicksort</span> <span class="p">(</span><span class="n">p::lst</span><span class="p">)</span> <span class="p">=</span> 
      <span class="kr">let</span> <span class="kr">fun</span> <span class="nf">quicksort_r</span> <span class="n">pivot</span> <span class="p">([],</span> <span class="n">front</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="p">=</span>  <span class="p">(</span><span class="n">quicksort</span> <span class="n">front</span><span class="p">)</span> <span class="n">@</span> <span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="n">@</span> <span class="p">(</span><span class="n">quicksort</span> <span class="n">back</span><span class="p">)</span>
          <span class="p">|</span>   <span class="nf">quicksort_r</span> <span class="n">pivot</span> <span class="p">(</span><span class="n">x::xs</span><span class="p">,</span> <span class="n">front</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span> <span class="p">=</span> 
                <span class="kr">if</span> <span class="n">x</span> <span class="n">&lt;</span> <span class="n">pivot</span> <span class="kr">then</span> 
                   <span class="n">quicksort_r</span> <span class="n">pivot</span> <span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">x::front</span><span class="p">,</span> <span class="n">back</span><span class="p">)</span>
                <span class="kr">else</span> 
                   <span class="n">quicksort_r</span> <span class="n">pivot</span> <span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">front</span><span class="p">,</span> <span class="n">x::back</span><span class="p">)</span>
      <span class="kr">in</span>
         <span class="n">quicksort_r</span> <span class="n">p</span> <span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
      <span class="kr">end</span>
<span class="p">;</span>
<span class="cm">(* val quicksort = fn : int list -&gt; int list *)</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="OCaml"><a href="https://en.wikipedia.org/wiki/OCaml" class="extiw" title="wikipedia:OCaml">OCaml</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=27" title="Edit section: OCaml">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">let</span> <span class="k">rec</span> <span class="n">sort</span> <span class="o">=</span> <span class="k">function</span>
      <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
    <span class="o">|</span> <span class="n">pivot</span> <span class="o">::</span> <span class="n">rest</span> <span class="o">-&gt;</span>
        <span class="k">let</span> <span class="n">left</span><span class="o">,</span> <span class="n">right</span> <span class="o">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">partition</span> <span class="o">((</span> <span class="o">&gt;</span> <span class="o">)</span> <span class="n">pivot</span><span class="o">)</span> <span class="n">rest</span> <span class="k">in</span>
        <span class="n">sort</span> <span class="n">left</span> <span class="o">@</span> <span class="n">pivot</span> <span class="o">::</span> <span class="n">sort</span> <span class="n">right</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Perl"><a href="https://en.wikipedia.org/wiki/Perl" class="extiw" title="wikipedia:Perl">Perl</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=28" title="Edit section: Perl">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">sub</span> <span class="nf">qsort</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">()</span> <span class="k">unless</span> <span class="nv">@_</span><span class="p">;</span>
  <span class="p">(</span><span class="n">qsort</span><span class="p">(</span><span class="nb">grep</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">&lt;</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span> <span class="nv">@_</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="nv">$#_</span><span class="p">]),</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">qsort</span><span class="p">(</span><span class="nb">grep</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">&gt;=</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}</span> <span class="nv">@_</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="nv">$#_</span><span class="p">]))</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>Or:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">sub</span> <span class="nf">qsort</span> <span class="p">{</span>
  <span class="nv">@_</span> <span class="ow">or</span> <span class="k">return</span> <span class="p">();</span>
  <span class="k">my</span> <span class="nv">$p</span> <span class="o">=</span> <span class="nb">shift</span><span class="p">;</span>
  <span class="p">(</span><span class="n">qsort</span><span class="p">(</span><span class="nb">grep</span> <span class="nv">$_</span> <span class="o">&lt;</span> <span class="nv">$p</span><span class="p">,</span> <span class="nv">@_</span><span class="p">),</span> <span class="nv">$p</span><span class="p">,</span>
    <span class="n">qsort</span><span class="p">(</span><span class="nb">grep</span> <span class="nv">$_</span> <span class="o">&gt;=</span> <span class="nv">$p</span><span class="p">,</span> <span class="nv">@_</span><span class="p">))</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>Or:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">sub</span> <span class="nf">qsort</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">if</span> <span class="ow">not</span> <span class="nv">@_</span><span class="p">;</span>
  <span class="k">my</span> <span class="p">(</span><span class="nv">$head</span><span class="p">,</span> <span class="nv">@tail</span><span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">qsort</span><span class="p">(</span><span class="nb">grep</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">&lt;</span> <span class="nv">$head</span> <span class="p">}</span> <span class="nv">@tail</span><span class="p">),</span> <span class="nv">$head</span><span class="p">,</span>
    <span class="n">qsort</span><span class="p">(</span><span class="nb">grep</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">&gt;=</span> <span class="nv">$head</span><span class="p">}</span> <span class="nv">@tail</span><span class="p">))</span>
<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Perl_6"><a href="https://en.wikipedia.org/wiki/Perl_6" class="extiw" title="wikipedia:Perl 6">Perl 6</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=29" title="Edit section: Perl 6">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">multi</span> <span class="n">quicksort</span> () { () }
<span class="k">multi</span> <span class="n">quicksort</span> (*<span class="nv">$x</span>, *<span class="nv">@xs</span>) {
   <span class="k">my</span> <span class="nv">@pre</span>  = <span class="nv">@xs</span>.<span class="n">grep:</span>{ <span class="nv">$_</span> &lt;  <span class="nv">$x</span> };
   <span class="k">my</span> <span class="nv">@post</span> = <span class="nv">@xs</span>.<span class="n">grep:</span>{ <span class="nv">$_</span> &gt;= <span class="nv">$x</span> };
   (<span class="nv">@pre</span>.<span class="n">quicksort</span>, <span class="nv">$x</span>, <span class="nv">@post</span>.<span class="n">quicksort</span>);
}
</pre>
      </div> 
      <h2><span class="mw-headline" id="PHP"><a href="https://en.wikipedia.org/wiki/PHP" class="extiw" title="wikipedia:PHP">PHP</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=30" title="Edit section: PHP">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">function</span> <span class="nf">quicksort</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
	
    <span class="nv">$left</span> <span class="o">=</span> <span class="nv">$right</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>

    <span class="nb">reset</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="nv">$pivot_key</span> <span class="o">=</span> <span class="nb">key</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
    <span class="nv">$pivot</span> <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>
	
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$array</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="nv">$v</span> <span class="o">&lt;</span> <span class="nv">$pivot</span><span class="p">)</span>
            <span class="nv">$left</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
        <span class="k">else</span>
            <span class="nv">$right</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
    <span class="p">}</span>
	
    <span class="k">return</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nx">quicksort</span><span class="p">(</span><span class="nv">$left</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="nv">$pivot_key</span> <span class="o">=&gt;</span> <span class="nv">$pivot</span><span class="p">),</span> <span class="nx">quicksort</span><span class="p">(</span><span class="nv">$right</span><span class="p">));</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>With array_filter and consecutive numerical keys</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">function</span> <span class="nf">quicksort</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$array</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$array</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nv">$pivot_value</span> <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span><span class="nv">$array</span><span class="p">);</span>

  <span class="k">return</span> <span class="nb">array_merge</span><span class="p">(</span>
    <span class="nx">quicksort</span><span class="p">(</span><span class="nb">array_filter</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="k">use</span><span class="p">(</span><span class="nv">$pivot_value</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$v</span> <span class="o">&lt;</span> <span class="nv">$pivot_value</span><span class="p">;})),</span>
    <span class="k">array</span><span class="p">(</span><span class="nv">$pivot_value</span><span class="p">),</span>
    <span class="nx">quicksort</span><span class="p">(</span><span class="nv">$higher</span> <span class="o">=</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$array</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$v</span><span class="p">)</span> <span class="k">use</span><span class="p">(</span><span class="nv">$pivot_value</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nv">$v</span> <span class="o">&gt;=</span> <span class="nv">$pivot_value</span><span class="p">;}))</span>
  <span class="p">);</span>
<span class="p">}</span>
</pre>
      </div> 
      <p>Here is an in-place algorythm that performs better than the implementations above. Of course in real life use sort PHP native function.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="c1">// Quick sort between $start and $last indexes of array $a (inplace implementation)</span>
<span class="k">function</span> <span class="nf">quickSort</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$last</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>    
    <span class="c1">// Init</span>
    <span class="nv">$wall</span> <span class="o">=</span> <span class="nv">$start</span><span class="p">;</span>
	<span class="nv">$last</span> <span class="o">=</span> <span class="nb">is_null</span><span class="p">(</span><span class="nv">$last</span><span class="p">)</span> <span class="o">?</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="nv">$last</span><span class="p">;</span>
	
	<span class="c1">// Nothing to sort</span>
	<span class="k">if</span><span class="p">(</span><span class="nv">$last</span> <span class="o">-</span> <span class="nv">$start</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
    
	<span class="c1">// Moving median value to the back to avoid bad performance when sorting an already sorted array</span>
	<span class="nx">switchValues</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="p">((</span><span class="nv">$start</span> <span class="o">+</span> <span class="nv">$last</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="nv">$last</span><span class="p">);</span>
	
	<span class="c1">// Splitting the array according to comparisons with the last value</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$start</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$last</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$a</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$a</span><span class="p">[</span><span class="nv">$last</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">switchValues</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$i</span><span class="p">,</span> <span class="nv">$wall</span><span class="p">);</span>
            <span class="nv">$wall</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
	<span class="c1">// Placing last value between the two split arrays</span>
    <span class="nx">switchValues</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$wall</span><span class="p">,</span> <span class="nv">$last</span><span class="p">);</span>

    <span class="c1">// Sorting left of the wall</span>
	<span class="nx">quickSort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$start</span><span class="p">,</span> <span class="nv">$wall</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    
    <span class="c1">// Sorting right of the wall</span>
	<span class="nx">quickSort</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$wall</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">$last</span><span class="p">);</span>  
<span class="p">}</span>

<span class="c1">// Switch two values identified by keys $i1 and $i2 of $a</span>
<span class="k">function</span> <span class="nf">switchValues</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$i1</span><span class="p">,</span> <span class="nv">$i2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$i1</span> <span class="o">!==</span> <span class="nv">$i2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$temp</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="nv">$i1</span><span class="p">];</span>
        <span class="nv">$a</span><span class="p">[</span><span class="nv">$i1</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$a</span><span class="p">[</span><span class="nv">$i2</span><span class="p">];</span>
        <span class="nv">$a</span><span class="p">[</span><span class="nv">$i2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$temp</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">printArray</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">echo</span> <span class="s1">'['</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">', '</span><span class="p">,</span> <span class="nv">$a</span><span class="p">)</span><span class="o">.</span> <span class="s1">']'</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Generate array with random values</span>
<span class="nv">$arr</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nv">$size</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$size</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$arr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="p">(</span><span class="nb">rand</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000000000</span> <span class="o">/</span> <span class="nv">$size</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// Measuring function's performance</span>
<span class="nv">$t1</span> <span class="o">=</span> <span class="nb">microtime</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
<span class="nx">quickSort</span><span class="p">(</span><span class="nv">$arr</span><span class="p">);</span>
<span class="nv">$t2</span> <span class="o">=</span> <span class="nb">microtime</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

<span class="c1">// Printing stats</span>
<span class="c1">// printArray($arr);</span>
<span class="nv">$t</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="nv">$t2</span> <span class="o">-</span> <span class="nv">$t1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
<span class="k">echo</span> <span class="nx">PHP_EOL</span> <span class="o">.</span> <span class="s2">"Sorted </span><span class="si">$size</span><span class="s2"> elements in </span><span class="si">{</span><span class="nv">$t</span><span class="si">}</span><span class="s2">ms"</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Prolog"><a href="https://en.wikipedia.org/wiki/Prolog" class="extiw" title="wikipedia:Prolog">Prolog</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=31" title="Edit section: Prolog">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The version in the core implementations section is concise and, because it uses tail recursion, efficient. Here's another version:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="nf">partition</span><span class="p">([],</span> <span class="k">_</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]).</span>
<span class="nf">partition</span><span class="p">([</span><span class="nv">X</span><span class="p">|</span><span class="nv">Xs</span><span class="p">],</span> <span class="nv">Pivot</span><span class="p">,</span> <span class="nv">Smalls</span><span class="p">,</span> <span class="nv">Bigs</span><span class="p">)</span> <span class="p">:-</span>
    <span class="p">(</span>   <span class="nv">X</span> <span class="s s-Atom">@&lt;</span> <span class="nv">Pivot</span> <span class="s s-Atom">-&gt;</span>
        <span class="nv">Smalls</span> <span class="o">=</span> <span class="p">[</span><span class="nv">X</span><span class="p">|</span><span class="nv">Rest</span><span class="p">],</span>
        <span class="nf">partition</span><span class="p">(</span><span class="nv">Xs</span><span class="p">,</span> <span class="nv">Pivot</span><span class="p">,</span> <span class="nv">Rest</span><span class="p">,</span> <span class="nv">Bigs</span><span class="p">)</span>
    <span class="p">;</span>   <span class="nv">Bigs</span> <span class="o">=</span> <span class="p">[</span><span class="nv">X</span><span class="p">|</span><span class="nv">Rest</span><span class="p">],</span>
        <span class="nf">partition</span><span class="p">(</span><span class="nv">Xs</span><span class="p">,</span> <span class="nv">Pivot</span><span class="p">,</span> <span class="nv">Smalls</span><span class="p">,</span> <span class="nv">Rest</span><span class="p">)</span>
    <span class="p">).</span>

<span class="nf">quicksort</span><span class="p">([])</span>     <span class="p">--&gt;</span> <span class="p">[].</span>
<span class="nf">quicksort</span><span class="p">([</span><span class="nv">X</span><span class="p">|</span><span class="nv">Xs</span><span class="p">])</span> <span class="p">--&gt;</span> 
    <span class="p">{</span> <span class="nf">partition</span><span class="p">(</span><span class="nv">Xs</span><span class="p">,</span> <span class="nv">X</span><span class="p">,</span> <span class="nv">Smaller</span><span class="p">,</span> <span class="nv">Bigger</span><span class="p">)</span> <span class="p">},</span>
    <span class="nf">quicksort</span><span class="p">(</span><span class="nv">Smaller</span><span class="p">),</span> <span class="p">[</span><span class="nv">X</span><span class="p">],</span> <span class="nf">quicksort</span><span class="p">(</span><span class="nv">Bigger</span><span class="p">).</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Python"><a href="https://en.wikipedia.org/wiki/Python_programming_language" class="extiw" title="wikipedia:Python programming language">Python</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=32" title="Edit section: Python">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>Using list comprehensions:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
 <span class="k">def</span> <span class="nf">qsort</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="p">[]:</span> <span class="k">return</span> <span class="p">[]</span>
   <span class="k">return</span> <span class="n">qsort</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> \
          <span class="n">qsort</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;=</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre>
      </div> 
      <p>With in place partitioning and random pivot selection:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">_doquicksort</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="sd">"""Quick sort"""</span>
    <span class="k">def</span> <span class="nf">partition</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">pivotidx</span><span class="p">):</span>
        <span class="sd">"""In place paritioning from left to right using the element at</span>
<span class="sd">        pivotidx as the pivot. Returns the new pivot position."""</span>

        <span class="n">pivot</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">pivotidx</span><span class="p">]</span>
        <span class="c1"># swap pivot and the last element</span>
        <span class="n">values</span><span class="p">[</span><span class="n">right</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">pivotidx</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">pivotidx</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>

        <span class="n">storeidx</span> <span class="o">=</span> <span class="n">left</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="p">:</span>
                <span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">storeidx</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">storeidx</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">storeidx</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># move pivot to the proper place</span>
        <span class="n">values</span><span class="p">[</span><span class="n">storeidx</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">right</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="n">storeidx</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">storeidx</span>
    
    <span class="k">if</span> <span class="n">right</span> <span class="o">&gt;</span> <span class="n">left</span><span class="p">:</span>
        <span class="c1"># random pivot</span>
        <span class="n">pivotidx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="n">pivotidx</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">pivotidx</span><span class="p">)</span>
        <span class="n">_doquicksort</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">pivotidx</span><span class="p">)</span>
        <span class="n">_doquicksort</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">pivotidx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">values</span>

<span class="k">def</span> <span class="nf">quicksort</span><span class="p">(</span><span class="n">mylist</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_doquicksort</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre>
      </div> 
      <p>The above takes longer than the in place sort below, which only swaps values above the pivot value to the left, with values below the pivot to the right, instead of the previous , which re-swaps already swapped under pivot values, which doubles the number of swaps.</p> 
      <p>However , both in-place sorts are slower than the memory consuming list comprehension version, which itself is 10 times slower than the in-built sorted() function.</p> 
      <p>The version below doesn't avoid the bad sorted input problem, by choosing a random pivot element or median-of-three pivot element.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">def</span> <span class="nf">qsinplace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">r</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">pivot_idx</span> <span class="o">=</span> <span class="n">l</span>
    <span class="n">old_r</span> <span class="o">=</span> <span class="n">r</span>
    <span class="n">pivot</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="c1"># manual check, does it work when l=pivot_idx, r=l+1 for a[l] &lt;= a[r], and for a[l] &gt; a[r] ?</span>
        <span class="k">while</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pivot</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="k">while</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span> <span class="ow">and</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pivot</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1">#pre-conditions to swap: l == r, or a[l] &gt; pivot from 2nd loop, and a[r] &lt;= pivot from 1st loop</span>
        <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    
    <span class="n">a</span><span class="p">[</span><span class="n">pivot_idx</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">pivot_idx</span><span class="p">]</span>
     
    <span class="n">qsinplace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">pivot_idx</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">qsinplace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">old_r</span><span class="p">)</span>

<span class="c1">#driver test</span>
<span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100000</span><span class="p">)</span> <span class="p">]</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span> <span class="s2">"took "</span><span class="p">,</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">,</span> <span class="s2">" time to shuffle "</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="k">print</span> <span class="n">l</span>
<span class="n">ll</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># quick sort</span>
<span class="n">qsinplace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">ll</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span> <span class="s2">"took "</span><span class="p">,</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">,</span> <span class="s2">" time to qsinplace"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Ruby"><a href="https://en.wikipedia.org/wiki/Ruby_programming_language" class="extiw" title="wikipedia:Ruby programming language">Ruby</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=33" title="Edit section: Ruby">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">class</span> <span class="nc">QuickSort</span>
  
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">sort!</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
    <span class="n">quick</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">keys</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">end</span>
    
  <span class="kp">private</span>
  
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">quick</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span>
      <span class="n">pivot</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
      <span class="n">quick</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">pivot</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">quick</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">pivot</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">keys</span>
  <span class="k">end</span>
    
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">partition</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keys</span><span class="o">[</span><span class="n">right</span><span class="o">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">left</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="n">left</span><span class="o">..</span><span class="n">right</span><span class="o">-</span><span class="mi">1</span>
      <span class="k">if</span> <span class="n">keys</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">x</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">keys</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span> <span class="n">keys</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">keys</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">,</span> <span class="n">keys</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">keys</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">keys</span><span class="o">[</span><span class="n">right</span><span class="o">]</span> <span class="o">=</span> <span class="n">keys</span><span class="o">[</span><span class="n">right</span><span class="o">]</span><span class="p">,</span> <span class="n">keys</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span>
    <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
  <span class="k">end</span>

<span class="k">end</span>
</pre>
      </div> 
      <p>Using Closures:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">def</span> <span class="nf">quicksort</span><span class="p">(</span><span class="n">list</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">list</span> <span class="k">if</span> <span class="n">list</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">1</span>
   <span class="n">pivot</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="n">shift</span>
   <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="n">partition</span> <span class="p">{</span> <span class="o">|</span><span class="n">el</span><span class="o">|</span> <span class="n">el</span> <span class="o">&lt;</span> <span class="n">pivot</span> <span class="p">}</span>
   <span class="n">quicksort</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">+</span> <span class="o">[</span><span class="n">pivot</span><span class="o">]</span> <span class="o">+</span> <span class="n">quicksort</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="k">end</span>
</pre>
      </div> 
      <p>Using Closures but with a random pivot:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">def</span> <span class="nf">quicksort</span><span class="p">(</span><span class="n">list</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">list</span> <span class="k">if</span> <span class="n">list</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">1</span>
   <span class="n">pivot</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="n">shuffle</span><span class="o">.</span><span class="n">shift</span>
   <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="n">partition</span> <span class="p">{</span> <span class="o">|</span><span class="n">el</span><span class="o">|</span> <span class="n">el</span> <span class="o">&lt;</span> <span class="n">pivot</span> <span class="p">}</span>
   <span class="n">quicksort</span><span class="p">(</span><span class="n">left</span><span class="p">)</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">quicksort</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
<span class="k">end</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Scala"><a href="https://en.wikipedia.org/wiki/Scala" class="extiw" title="wikipedia:Scala">Scala</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=34" title="Edit section: Scala">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">def</span> <span class="n">qsort</span><span class="o">(</span><span class="n">l</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="n">l</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nc">List</span><span class="o">()</span> <span class="k">=&gt;</span> <span class="n">l</span>
        <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>  <span class="n">qsort</span><span class="o">(</span><span class="k">for</span><span class="o">(</span><span class="n">x</span> <span class="k">&lt;-</span> <span class="n">l</span><span class="o">.</span><span class="n">tail</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">.</span><span class="n">head</span><span class="o">)</span> <span class="k">yield</span> <span class="n">x</span><span class="o">)</span> <span class="o">:::</span> <span class="nc">List</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="n">head</span><span class="o">)</span> <span class="o">:::</span> <span class="n">qsort</span><span class="o">(</span><span class="k">for</span><span class="o">(</span><span class="n">x</span> <span class="k">&lt;-</span><span class="mf">1.</span><span class="n">tail</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">l</span><span class="o">.</span><span class="n">head</span><span class="o">)</span> <span class="k">yield</span> <span class="n">x</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
      </div> 
      <p>Or shorter version:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">def</span> <span class="n">qsort</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="nc">Nil</span>
  <span class="k">case</span> <span class="n">pivot</span> <span class="o">::</span> <span class="n">tail</span> <span class="k">=&gt;</span>
    <span class="k">val</span> <span class="o">(</span><span class="n">smaller</span><span class="o">,</span> <span class="n">rest</span><span class="o">)</span> <span class="k">=</span> <span class="n">tail</span><span class="o">.</span><span class="n">partition</span><span class="o">(</span><span class="k">_</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="o">)</span>
    <span class="n">qsort</span><span class="o">(</span><span class="n">smaller</span><span class="o">)</span> <span class="o">:::</span> <span class="n">pivot</span> <span class="o">::</span> <span class="n">qsort</span><span class="o">(</span><span class="n">rest</span><span class="o">)</span>
<span class="o">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Scheme"><a href="https://en.wikipedia.org/wiki/Scheme" class="extiw" title="wikipedia:Scheme">Scheme</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=35" title="Edit section: Scheme">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This uses <a rel="nofollow" class="external text" href="http://srfi.schemers.org/srfi-1/srfi-1.html">SRFI 1</a> and <a rel="nofollow" class="external text" href="http://srfi.schemers.org/srfi-8/srfi-8.html">SRFI 8</a>. It avoids redundantly traversing the list: it partitions it with the pivot in one traversal, not two, and it avoids copying entire lists to append them, by instead only adding elements on the front of the output list's tail.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">quicksort</span> <span class="nv">list</span> <span class="nv">elt&lt;</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let </span><span class="nv">qsort</span> <span class="p">((</span><span class="nb">list </span><span class="nv">list</span><span class="p">)</span> <span class="p">(</span><span class="nf">tail</span> <span class="o">'</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null-list?</span> <span class="nv">list</span><span class="p">)</span>
        <span class="nv">tail</span>
        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">pivot</span> <span class="p">(</span><span class="nb">car </span><span class="nv">list</span><span class="p">)))</span>
          <span class="p">(</span><span class="nf">receive</span> <span class="p">(</span><span class="nf">smaller</span> <span class="nv">larger</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">partition</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">elt&lt;</span> <span class="nv">x</span> <span class="nv">pivot</span><span class="p">))</span>
                              <span class="p">(</span><span class="nb">cdr </span><span class="nv">list</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">qsort</span> <span class="nv">smaller</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">pivot</span> <span class="p">(</span><span class="nf">qsort</span> <span class="nv">larger</span> <span class="nv">tail</span><span class="p">))))))))</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Shen"><a href="https://en.wikipedia.org/wiki/Shen_(programming_language)" class="extiw" title="wikipedia:Shen (programming language)">Shen</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=36" title="Edit section: Shen">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="p">(</span><span class="k">define </span><span class="nv">filter</span>
  <span class="err">{</span><span class="p">(</span><span class="nf">A</span> <span class="nv">--&gt;</span> <span class="nv">boolean</span><span class="p">)</span> <span class="nv">--&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="nv">A</span><span class="p">)</span> <span class="nv">--&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="nv">A</span><span class="p">)</span><span class="err">}</span>
  <span class="nv">_</span>   <span class="p">[]</span>      <span class="nv">-&gt;</span> <span class="p">[]</span>
  <span class="nv">T?</span>  <span class="p">[</span><span class="nv">A</span> <span class="nv">|</span> <span class="nv">B</span><span class="p">]</span>  <span class="nv">-&gt;</span> <span class="p">(</span><span class="nb">append </span><span class="p">[</span><span class="nv">A</span><span class="p">]</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">T?</span> <span class="nv">B</span><span class="p">))</span> <span class="nv">where</span> <span class="p">(</span><span class="nf">T?</span> <span class="nv">A</span><span class="p">)</span>
  <span class="nv">T?</span>  <span class="p">[</span><span class="nv">_|B</span><span class="p">]</span>    <span class="nv">-&gt;</span> <span class="p">(</span><span class="nf">filter</span> <span class="nv">T?</span> <span class="nv">B</span><span class="p">)</span>
<span class="p">)</span>

<span class="p">(</span><span class="k">define </span><span class="nv">q-sort</span>
  <span class="err">{</span><span class="p">(</span><span class="nb">list </span><span class="nv">number</span><span class="p">)</span> <span class="nv">--&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="nv">number</span><span class="p">)</span><span class="err">}</span>
  <span class="p">[]</span> <span class="nv">-&gt;</span> <span class="p">[]</span>
  <span class="p">[</span><span class="nv">A</span> <span class="nv">|</span> <span class="nv">B</span><span class="p">]</span> <span class="nv">-&gt;</span> <span class="p">(</span><span class="nb">append </span><span class="p">(</span><span class="nf">q-sort</span> <span class="p">(</span><span class="nf">filter</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">A</span><span class="p">)</span> <span class="p">[</span><span class="nv">A|B</span><span class="p">]))</span>
                     <span class="p">[</span><span class="nv">A</span><span class="p">]</span>
                     <span class="p">(</span><span class="nf">q-sort</span> <span class="p">(</span><span class="nf">filter</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">A</span><span class="p">)</span> <span class="p">[</span><span class="nv">A|B</span><span class="p">]))))</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Shell"><a href="https://en.wikipedia.org/wiki/Shell" class="extiw" title="wikipedia:Shell">Shell</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=37" title="Edit section: Shell">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>While many of the other scripting languages (e.g. Perl, Python, Ruby) have a built-in library sort routine, POSIX shells generally do not.</p> 
      <p>The following was adapted from the <a href="/wiki/Algorithm_implementation/Sorting/Quicksort#Applescript" class="mw-redirect" title="Algorithm implementation/Sorting/Quicksort">Applescript</a> code above and used in the bash debugger <a rel="nofollow" class="external autonumber" href="http://bashdb.sf.net">[1]</a>. It has been tested on <a href="https://en.wikipedia.org/wiki/Bash" class="extiw" title="wikipedia:Bash">bash</a>, <a href="https://en.wikipedia.org/wiki/Zsh" class="extiw" title="wikipedia:Zsh">zsh</a>, and the <a href="https://en.wikipedia.org/wiki/Korn_shell" class="extiw" title="wikipedia:Korn shell">Korn shell</a> (<code>ksh</code>).</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="c1"># Sort global array, $list, starting from $1 to up to $2. 0 is </span>
<span class="c1"># returned if everything went okay, and nonzero if there was an error.</span>

<span class="c1"># We use the recursive quicksort of Tony Hoare with inline array</span>
<span class="c1"># swapping to partition the array. The partition item is the middle</span>
<span class="c1"># array item. String comparison is used.  The sort is not stable.</span>

<span class="c1"># It is necessary to use "function" keyword in order not to inherit </span>
<span class="c1"># variables being defined via typset, which solves the instability </span>
<span class="c1"># problem here.This is specified in the manual page of ksh.</span>

<span class="k">function</span> sort_list<span class="o">()</span> <span class="o">{</span>
  <span class="o">((</span><span class="nv">$#</span> !<span class="o">=</span> <span class="m">2</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">return</span> <span class="m">1</span>
  <span class="nb">typeset</span> -i <span class="nv">left</span><span class="o">=</span><span class="nv">$1</span>
  <span class="o">((</span>left &lt; <span class="m">0</span><span class="o">))</span> <span class="o">||</span> <span class="o">((</span> <span class="nv">0</span> <span class="o">==</span> <span class="si">${#</span><span class="nv">list</span><span class="p">[@]</span><span class="si">}</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">return</span> <span class="m">2</span>
  <span class="nb">typeset</span> -i <span class="nv">right</span><span class="o">=</span><span class="nv">$2</span>
  <span class="o">((</span>right &gt;<span class="o">=</span> <span class="si">${#</span><span class="nv">list</span><span class="p">[@]</span><span class="si">}</span><span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">return</span> <span class="m">3</span>
  <span class="nb">typeset</span> -i <span class="nv">i</span><span class="o">=</span><span class="nv">$left</span><span class="p">;</span> <span class="nb">typeset</span> -i <span class="nv">j</span><span class="o">=</span><span class="nv">$right</span>
  <span class="nb">typeset</span> -i mid<span class="p">;</span> <span class="o">((</span><span class="nv">mid</span><span class="o">=</span> <span class="o">(</span>left+right<span class="o">)</span> / <span class="m">2</span><span class="o">))</span>
  <span class="nb">typeset</span> partition_item<span class="p">;</span> <span class="nv">partition_item</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">list</span><span class="p">[</span><span class="nv">$mid</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">typeset</span> temp
  <span class="k">while</span> <span class="o">((</span>j &gt; i<span class="o">))</span> <span class="p">;</span> <span class="k">do</span>
      <span class="k">while</span> <span class="o">[[</span> <span class="s2">"</span><span class="si">${</span><span class="nv">list</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span> &lt; <span class="s2">"</span><span class="nv">$partition_item</span><span class="s2">"</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">do</span>
	  <span class="o">((</span>i++<span class="o">))</span>
      <span class="k">done</span>
      <span class="k">while</span> <span class="o">[[</span> <span class="s2">"</span><span class="si">${</span><span class="nv">list</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span> &gt; <span class="s2">"</span><span class="nv">$partition_item</span><span class="s2">"</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">do</span>
	  <span class="o">((</span>j--<span class="o">))</span>
      <span class="k">done</span>
      <span class="k">if</span> <span class="o">((</span>i &lt;<span class="o">=</span> j<span class="o">))</span> <span class="p">;</span> <span class="k">then</span>
	  <span class="nv">temp</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">list</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span> list<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span><span class="s2">"</span><span class="si">${</span><span class="nv">list</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span> list<span class="o">[</span><span class="nv">$j</span><span class="o">]=</span><span class="s2">"</span><span class="nv">$temp</span><span class="s2">"</span>
          <span class="o">((</span>i++<span class="o">))</span>
          <span class="o">((</span>j--<span class="o">))</span>
      <span class="k">fi</span>
  <span class="k">done</span>
  <span class="o">((</span>left &lt; j<span class="o">))</span>  <span class="o">&amp;&amp;</span> sort_list <span class="nv">$left</span>  <span class="nv">$j</span>  
  <span class="o">((</span>right &gt; i<span class="o">))</span> <span class="o">&amp;&amp;</span> sort_list <span class="nv">$i</span> <span class="nv">$right</span>
  <span class="k">return</span> <span class="nv">$?</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$0</span> <span class="o">==</span> *sort.sh <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span> 
    <span class="o">[[</span> -n <span class="nv">$ZSH_VERSION</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> setopt ksharrays
    <span class="nb">typeset</span> -a list
    <span class="nv">list</span><span class="o">=()</span>
    sort_list -1 <span class="m">0</span> 
    <span class="nb">typeset</span> -p list
    <span class="nv">list</span><span class="o">=(</span><span class="s1">'one'</span><span class="o">)</span>
    <span class="nb">typeset</span> -p list
    sort_list <span class="m">0</span> <span class="m">0</span> 
    <span class="nb">typeset</span> -p list
    <span class="nv">list</span><span class="o">=(</span><span class="s1">'one'</span> <span class="s1">'two'</span> <span class="s1">'three'</span><span class="o">)</span>
    sort_list <span class="m">0</span> <span class="m">2</span>
    <span class="nb">typeset</span> -p list
    <span class="nv">list</span><span class="o">=(</span><span class="m">4</span> <span class="m">3</span> <span class="m">2</span> <span class="m">1</span><span class="o">)</span>
    sort_list <span class="m">0</span> <span class="m">3</span>
    <span class="nb">typeset</span> -p list
<span class="k">fi</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Standard_ML"><a href="https://en.wikipedia.org/wiki/Standard_ML" class="extiw" title="wikipedia:Standard ML">Standard ML</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=38" title="Edit section: Standard ML">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>The following examplethough less general than the snippet in the core implementations section in that it does not accept a predicate argumentstrives to more closely resemble the implementations in the other functional languages. The use of <code>List.partition</code> in both examples enables the implementation to walk the list only once per call, thereby reducing the constant factor of the algorithm.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kr">fun</span> <span class="nf">qsort</span> <span class="p">[]</span> <span class="p">=</span> <span class="p">[]</span>
  <span class="p">|</span> <span class="nf">qsort</span> <span class="p">(</span><span class="n">h::t</span><span class="p">)</span> <span class="p">=</span> <span class="kr">let</span> <span class="kr">val</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="nv">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">partition</span> <span class="p">(</span><span class="kr">fn</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span> <span class="n">&lt;</span> <span class="n">h</span><span class="p">)</span> <span class="n">t</span>
                   <span class="kr">in</span> <span class="n">qsort</span> <span class="n">left</span> <span class="n">@</span> <span class="n">h</span> <span class="n">::</span> <span class="n">qsort</span> <span class="n">right</span>
                   <span class="kr">end</span><span class="p">;</span>
</pre>
      </div> 
      <p>Replacing the predicate is trivial:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kr">fun</span> <span class="nf">qsort</span> <span class="n">pred</span> <span class="p">[]</span> <span class="p">=</span> <span class="p">[]</span>
  <span class="p">|</span> <span class="nf">qsort</span> <span class="n">pred</span> <span class="p">(</span><span class="n">h::t</span><span class="p">)</span> <span class="p">=</span> <span class="kr">let</span> <span class="kr">val</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="nv">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">partition</span> <span class="p">(</span><span class="kr">fn</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">pred</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span> <span class="n">t</span>
                        <span class="kr">in</span> <span class="n">qsort</span> <span class="n">pred</span> <span class="n">left</span> <span class="n">@</span> <span class="n">h</span> <span class="n">::</span> <span class="n">qsort</span> <span class="n">pred</span> <span class="n">right</span>
                        <span class="kr">end</span><span class="p">;</span>
</pre>
      </div> 
      <p>A cleaner version that sacrifices the efficiency of <code>List.partition</code> and resembles the list-comprehension versions in other functional languages:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="kr">fun</span> <span class="nf">qsort</span> <span class="p">[]</span> <span class="p">=</span> <span class="p">[]</span>
  <span class="p">|</span> <span class="nf">qsort</span> <span class="p">(</span><span class="n">h::t</span><span class="p">)</span> <span class="p">=</span> <span class="n">qsort</span> <span class="p">(</span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span> <span class="p">(</span><span class="kr">fn</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span> <span class="n">&lt;</span> <span class="n">h</span><span class="p">)</span> <span class="n">t</span><span class="p">)</span> <span class="n">@</span> <span class="n">h</span> <span class="n">::</span> <span class="n">qsort</span> <span class="p">(</span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span> <span class="p">(</span><span class="kr">fn</span> <span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span> <span class="n">&gt;=</span> <span class="n">h</span><span class="p">)</span> <span class="n">t</span><span class="p">);</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Swift"><a href="https://en.wikipedia.org/wiki/Swift_programming_language" class="extiw" title="wikipedia:Swift programming language">Swift</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=39" title="Edit section: Swift">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
    <span class="kd">func</span> <span class="nf">qsort</span><span class="p">(</span><span class="kd">var</span> <span class="nv">array</span><span class="p">:</span> <span class="p">[</span><span class="nb">Int</span><span class="p">])</span> <span class="p">-&gt;</span> <span class="p">[</span><span class="nb">Int</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">.</span><span class="bp">isEmpty</span> <span class="p">{</span> <span class="k">return</span> <span class="p">[]</span> <span class="p">}</span>
        <span class="kd">let</span> <span class="nv">pivot</span> <span class="p">=</span> <span class="n">array</span><span class="p">.</span><span class="bp">removeAtIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="kd">var</span> <span class="nv">left</span> <span class="p">=</span> <span class="n">array</span><span class="p">.</span><span class="bp">filter</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">&lt;</span> <span class="n">pivot</span> <span class="p">}</span>
        <span class="kd">var</span> <span class="nv">right</span> <span class="p">=</span> <span class="n">array</span><span class="p">.</span><span class="bp">filter</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">&gt;=</span> <span class="n">pivot</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">qsort</span><span class="p">(</span><span class="kr">left</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">pivot</span><span class="p">]</span> <span class="o">+</span> <span class="n">qsort</span><span class="p">(</span><span class="kr">right</span><span class="p">)</span>
    <span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Visual_Basic"><a href="https://en.wikipedia.org/wiki/Visual_Basic" class="extiw" title="wikipedia:Visual Basic">Visual Basic</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=40" title="Edit section: Visual Basic">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">Option</span> <span class="n">Explicit</span>

<span class="c">' a position, which is *hopefully* never used:</span>
<span class="k">Public</span> <span class="k">Const</span> <span class="n">N_POS</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2147483648</span><span class="p">#</span>

<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Swap</span><span class="p">(</span><span class="k">ByRef</span> <span class="n">Data</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">,</span> _
                <span class="n">Index1</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> _
                <span class="n">Index2</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">Index1</span> <span class="o">&lt;&gt;</span> <span class="n">Index2</span> <span class="k">Then</span>
        <span class="k">Dim</span> <span class="n">tmp</span> <span class="ow">As</span> <span class="kt">Variant</span>
        
        <span class="k">If</span> <span class="n">IsObject</span><span class="p">(</span><span class="n">Data</span><span class="p">(</span><span class="n">Index1</span><span class="p">))</span> <span class="k">Then</span>
            <span class="k">Set</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">Index1</span><span class="p">)</span>
        <span class="k">Else</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">Index1</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
        
        <span class="k">If</span> <span class="n">IsObject</span><span class="p">(</span><span class="n">Data</span><span class="p">(</span><span class="n">Index2</span><span class="p">))</span> <span class="k">Then</span>
            <span class="k">Set</span> <span class="n">Data</span><span class="p">(</span><span class="n">Index1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">Index2</span><span class="p">)</span>
        <span class="k">Else</span>
            <span class="n">Data</span><span class="p">(</span><span class="n">Index1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">Index2</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
        
        <span class="k">If</span> <span class="n">IsObject</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="k">Then</span>
            <span class="k">Set</span> <span class="n">Data</span><span class="p">(</span><span class="n">Index2</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="k">Else</span>
            <span class="n">Data</span><span class="p">(</span><span class="n">Index2</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="k">End</span> <span class="k">If</span>
        
        <span class="k">Set</span> <span class="n">tmp</span> <span class="o">=</span> <span class="k">Nothing</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Public</span> <span class="k">Sub</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="k">ByRef</span> <span class="n">Data</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Variant</span><span class="p">,</span> _
                     <span class="k">Optional</span> <span class="k">ByVal</span> <span class="n">Lower</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="n">N_POS</span><span class="p">,</span> _
                     <span class="k">Optional</span> <span class="k">ByVal</span> <span class="n">Upper</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="o">=</span> <span class="n">N_POS</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">Lower</span> <span class="o">=</span> <span class="n">N_POS</span> <span class="k">Then</span>
        <span class="n">Lower</span> <span class="o">=</span> <span class="n">LBound</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
    
    <span class="k">If</span> <span class="n">Upper</span> <span class="o">=</span> <span class="n">N_POS</span> <span class="k">Then</span>
        <span class="n">Upper</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
            
    <span class="k">If</span> <span class="n">Lower</span> <span class="o">&lt;</span> <span class="n">Upper</span> <span class="k">Then</span>
        <span class="k">Dim</span> <span class="n">Right</span> <span class="ow">As</span> <span class="kt">Long</span>
        <span class="k">Dim</span> <span class="n">Left</span>  <span class="ow">As</span> <span class="kt">Long</span>
    
        <span class="n">Left</span> <span class="o">=</span> <span class="n">Lower</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">Right</span> <span class="o">=</span> <span class="n">Upper</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="k">Do</span> <span class="k">While</span> <span class="n">Left</span> <span class="o">&lt;</span> <span class="n">Right</span>
            <span class="k">If</span> <span class="n">Data</span><span class="p">(</span><span class="n">Left</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Data</span><span class="p">(</span><span class="n">Lower</span><span class="p">)</span> <span class="k">Then</span>
                <span class="n">Left</span> <span class="o">=</span> <span class="n">Left</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">Else</span>
                <span class="n">Right</span> <span class="o">=</span> <span class="n">Right</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">Swap</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Left</span><span class="p">,</span> <span class="n">Right</span>
            <span class="k">End</span> <span class="k">If</span>
        <span class="k">Loop</span>
        
        <span class="n">Left</span> <span class="o">=</span> <span class="n">Left</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">Swap</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Lower</span><span class="p">,</span> <span class="n">Left</span>
        <span class="n">QuickSort</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Lower</span><span class="p">,</span> <span class="n">Left</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">QuickSort</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Right</span><span class="p">,</span> <span class="n">Upper</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre>
      </div> 
      <p>Another implementation:</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="k">Function</span> <span class="nf">Quicksort</span><span class="p">(</span><span class="k">ByRef</span> <span class="n">aData</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">lPivot</span> <span class="ow">As</span> <span class="kt">Long</span>
    
    <span class="k">Dim</span> <span class="n">aLesser</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">aPivotList</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">aBigger</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">count</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">ret</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span>
    
    <span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
    
    <span class="n">count</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">aData</span><span class="p">)</span>
    
    <span class="k">If</span> <span class="n">Err</span> <span class="k">Then</span>
        <span class="k">Exit</span> <span class="k">Function</span>
    <span class="nf">ElseIf</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="n">Quicksort</span> <span class="o">=</span> <span class="n">aData</span>
        <span class="k">Exit</span> <span class="k">Function</span>
    <span class="nf">End</span> <span class="k">If</span>
    
    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="mi">0</span>
    
    <span class="n">Randomize</span>
    <span class="n">lPivot</span> <span class="o">=</span> <span class="n">aData</span><span class="p">(</span><span class="n">Int</span><span class="p">(</span><span class="n">Rnd</span> <span class="o">*</span> <span class="n">count</span><span class="p">))</span>
    
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">count</span>
        <span class="k">If</span> <span class="n">aData</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">lPivot</span> <span class="k">Then</span> <span class="n">AddTo</span> <span class="n">aData</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">aLesser</span>
        <span class="k">If</span> <span class="n">aData</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">lPivot</span> <span class="k">Then</span> <span class="n">AddTo</span> <span class="n">aData</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">aPivotList</span>
        <span class="k">If</span> <span class="n">aData</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">lPivot</span> <span class="k">Then</span> <span class="n">AddTo</span> <span class="n">aData</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">aBigger</span>
    <span class="k">Next</span>

    <span class="n">aLesser</span> <span class="o">=</span> <span class="n">Quicksort</span><span class="p">(</span><span class="n">aLesser</span><span class="p">)</span>
    <span class="n">aPivotList</span> <span class="o">=</span> <span class="n">aPivotList</span>
    <span class="n">aBigger</span> <span class="o">=</span> <span class="n">Quicksort</span><span class="p">(</span><span class="n">aBigger</span><span class="p">)</span>
    
    <span class="n">ret</span> <span class="o">=</span> <span class="n">JoinLists</span><span class="p">(</span><span class="n">aLesser</span><span class="p">,</span> <span class="n">aPivotList</span><span class="p">,</span> <span class="n">aBigger</span><span class="p">)</span>
    
    <span class="n">Quicksort</span> <span class="o">=</span> <span class="n">ret</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Sub</span> <span class="nf">AddTo</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">lData</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByRef</span> <span class="n">aWhere</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span>
    <span class="k">Dim</span> <span class="n">count</span> <span class="ow">As</span> <span class="kt">Long</span>
    
    <span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
    
    <span class="n">count</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">aWhere</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">ReDim</span> <span class="n">Preserve</span> <span class="n">aWhere</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    
    <span class="n">aWhere</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">=</span> <span class="n">lData</span>
    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="mi">0</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Function</span> <span class="nf">JoinLists</span><span class="p">(</span><span class="k">ByRef</span> <span class="n">Arr1</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByRef</span> <span class="n">Arr2</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">,</span> <span class="k">ByRef</span> <span class="n">Arr3</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Long</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">count1</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">count2</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">count3</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">ret</span><span class="p">()</span> <span class="ow">As</span> <span class="kt">Long</span>
    <span class="k">Dim</span> <span class="n">cnt</span> <span class="ow">As</span> <span class="kt">Long</span>
    
    <span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
    
    <span class="n">Err</span><span class="p">.</span><span class="n">Clear</span>
    
    <span class="n">count1</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">Arr1</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">Err</span> <span class="k">Then</span> <span class="n">count1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">Err</span><span class="p">.</span><span class="n">Clear</span>
    
    <span class="n">count2</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">Arr2</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">Err</span> <span class="k">Then</span> <span class="n">count2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">Err</span><span class="p">.</span><span class="n">Clear</span>
    
    <span class="n">count3</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">Arr3</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">Err</span> <span class="k">Then</span> <span class="n">count3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">Err</span><span class="p">.</span><span class="n">Clear</span>
    
    <span class="k">On</span> <span class="k">Error</span> <span class="k">GoTo</span> <span class="mi">0</span>
    
    <span class="k">ReDim</span> <span class="n">ret</span><span class="p">(</span><span class="n">count1</span> <span class="o">+</span> <span class="p">(</span><span class="n">count2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">count3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">To</span> <span class="n">count1</span>
        <span class="n">ret</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Arr1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">Next</span>
    
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="n">count1</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">To</span> <span class="p">(</span><span class="n">count2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">count1</span>
        <span class="n">ret</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Arr2</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">count1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">Next</span>
    
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="n">count2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">count1</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">To</span> <span class="p">(</span><span class="n">count3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">count2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">count1</span>
        <span class="n">ret</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Arr3</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">count2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">count1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">Next</span>
    
    <span class="n">JoinLists</span> <span class="o">=</span> <span class="n">ret</span>
<span class="k">End</span> <span class="k">Function</span>
</pre>
      </div> 
      <p>To generalize it, simply change types to Variant.</p> 
      <h2><span class="mw-headline" id="XProc"><a href="https://en.wikipedia.org/wiki/XProc" class="extiw" title="wikipedia:XProc">XProc</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=41" title="Edit section: XProc">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
  <span class="nt">&lt;p:declare-step</span> <span class="na">xmlns:p=</span><span class="s">"http://www.w3.org/ns/xproc"</span> <span class="na">xmlns:c=</span><span class="s">"http://www.w3.org/ns/xproc-step"</span> <span class="na">xmlns:ix=</span><span class="s">"http://www.innovimax.fr/ns"</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p:inline</span> <span class="na">exclude-inline-prefixes=</span><span class="s">"#all"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;root&gt;</span>
          <span class="nt">&lt;doc&gt;</span>03<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>04<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>07<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>06<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>02<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>01<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>08<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>10<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>09<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>05<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>03<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>04<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>07<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>06<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>02<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>01<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>08<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>10<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>09<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>05<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>03<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>04<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>07<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>06<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>02<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>01<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>08<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>10<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>09<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>05<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>03<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>04<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>07<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>06<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>02<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>01<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>08<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>10<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>09<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>05<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>03<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>04<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>07<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>06<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>02<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>01<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>08<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>10<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>09<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>05<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>03<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>04<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>07<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>06<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>02<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>01<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>08<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>10<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>09<span class="nt">&lt;/doc&gt;</span>
          <span class="nt">&lt;doc&gt;</span>05<span class="nt">&lt;/doc&gt;</span>
        <span class="nt">&lt;/root&gt;</span>
      <span class="nt">&lt;/p:inline&gt;</span>
    <span class="nt">&lt;/p:input&gt;</span>
    <span class="nt">&lt;p:output</span> <span class="na">port=</span><span class="s">"result"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;p:declare-step</span> <span class="na">type=</span><span class="s">"ix:sort"</span> <span class="na">name=</span><span class="s">"sort"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p:documentation&gt;</span>
        <span class="nt">&lt;p&gt;</span>XProc QuickSort implementation<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;p&gt;</span>Copyright (C) 2010 Mohamed ZERGAOUI Innovimax<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;p&gt;</span>This program is free software: you can redistribute it and/or modify
          it under the terms of the GNU General Public License as published by
          the Free Software Foundation, either version 3 of the License, or
          (at your option) any later version.<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;p&gt;</span>This program is distributed in the hope that it will be useful,
          but WITHOUT ANY WARRANTY; without even the implied warranty of
          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
          GNU General Public License for more details.<span class="nt">&lt;/p&gt;</span>
        
        <span class="nt">&lt;p&gt;</span>You should have received a copy of the GNU General Public License
          along with this program. If not, see
          http://www.gnu.org/licenses/.<span class="nt">&lt;/p&gt;</span>
      <span class="nt">&lt;/p:documentation&gt;</span>
      <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span> <span class="na">sequence=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;p:output</span> <span class="na">port=</span><span class="s">"result"</span> <span class="na">sequence=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;p:option</span> <span class="na">name=</span><span class="s">"key"</span> <span class="na">required=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;p:count</span> <span class="na">limit=</span><span class="s">"2"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;p:choose&gt;</span>
        <span class="nt">&lt;p:when</span> <span class="na">test=</span><span class="s">"number(.) le 1"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;p:identity&gt;</span>
            <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"source"</span> <span class="na">step=</span><span class="s">"sort"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/p:input&gt;</span>
          <span class="nt">&lt;/p:identity&gt;</span>
        <span class="nt">&lt;/p:when&gt;</span>
        <span class="nt">&lt;p:otherwise&gt;</span>
          <span class="nt">&lt;p:split-sequence</span> <span class="na">test=</span><span class="s">"position() = 1"</span> <span class="na">name=</span><span class="s">"split"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"source"</span> <span class="na">step=</span><span class="s">"sort"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/p:input&gt;</span>
          <span class="nt">&lt;/p:split-sequence&gt;</span>
          <span class="nt">&lt;p:filter</span> <span class="na">name=</span><span class="s">"filter"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p:with-option</span> <span class="na">name=</span><span class="s">"select"</span> <span class="na">select=</span><span class="s">"$key"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:empty/&gt;</span>
            <span class="nt">&lt;/p:with-option&gt;</span>
          <span class="nt">&lt;/p:filter&gt;</span>
          <span class="nt">&lt;p:group&gt;</span>
            <span class="nt">&lt;p:variable</span> <span class="na">name=</span><span class="s">"pivot-key"</span> <span class="na">select=</span><span class="s">"."</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"result"</span> <span class="na">step=</span><span class="s">"filter"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/p:variable&gt;</span>
            <span class="nt">&lt;p:split-sequence</span> <span class="na">name=</span><span class="s">"split-pivot"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"not-matched"</span> <span class="na">step=</span><span class="s">"split"</span><span class="nt">/&gt;</span>
              <span class="nt">&lt;/p:input&gt;</span>
              <span class="nt">&lt;p:with-option</span> <span class="na">name=</span><span class="s">"test"</span> <span class="na">select=</span><span class="s">"concat($key, ' &amp;lt;= ',</span>
<span class="s">                $pivot-key)"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/p:split-sequence&gt;</span>
            <span class="nt">&lt;ix:sort</span> <span class="na">name=</span><span class="s">"less"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:with-option</span> <span class="na">name=</span><span class="s">"key"</span> <span class="na">select=</span><span class="s">"$key"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:empty/&gt;</span>
              <span class="nt">&lt;/p:with-option&gt;</span>
              <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"matched"</span> <span class="na">step=</span><span class="s">"split-pivot"</span><span class="nt">/&gt;</span>
              <span class="nt">&lt;/p:input&gt;</span>
            <span class="nt">&lt;/ix:sort&gt;</span>
            <span class="nt">&lt;ix:sort</span> <span class="na">name=</span><span class="s">"greater"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;p:with-option</span> <span class="na">name=</span><span class="s">"key"</span> <span class="na">select=</span><span class="s">"$key"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:empty/&gt;</span>
              <span class="nt">&lt;/p:with-option&gt;</span>
              <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"not-matched"</span> <span class="na">step=</span><span class="s">"split-pivot"</span><span class="nt">/&gt;</span>
              <span class="nt">&lt;/p:input&gt;</span>
            <span class="nt">&lt;/ix:sort&gt;</span>
            <span class="nt">&lt;p:identity&gt;</span>
              <span class="nt">&lt;p:input</span> <span class="na">port=</span><span class="s">"source"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"result"</span> <span class="na">step=</span><span class="s">"less"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"matched"</span> <span class="na">step=</span><span class="s">"split"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;p:pipe</span> <span class="na">port=</span><span class="s">"result"</span> <span class="na">step=</span><span class="s">"greater"</span><span class="nt">/&gt;</span>
              <span class="nt">&lt;/p:input&gt;</span>
            <span class="nt">&lt;/p:identity&gt;</span>
          <span class="nt">&lt;/p:group&gt;</span>
        <span class="nt">&lt;/p:otherwise&gt;</span>
      <span class="nt">&lt;/p:choose&gt;</span>
    <span class="nt">&lt;/p:declare-step&gt;</span>
    <span class="nt">&lt;p:for-each&gt;</span>
      <span class="nt">&lt;p:iteration-source</span> <span class="na">select=</span><span class="s">"/root/doc"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;p:identity/&gt;</span>
    <span class="nt">&lt;/p:for-each&gt;</span>
    <span class="nt">&lt;ix:sort</span> <span class="na">key=</span><span class="s">"/doc"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;p:wrap-sequence</span> <span class="na">wrapper=</span><span class="s">"root"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/p:declare-step&gt;</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="Zilog_Z80000_Assembly"><a href="https://en.wikipedia.org/wiki/Zilog_Z80000" class="extiw" title="wikipedia:Zilog Z80000">Zilog Z80000</a> <a href="https://en.wikipedia.org/wiki/Assembly_language" class="extiw" title="wikipedia:Assembly language">Assembly</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=42" title="Edit section: Zilog Z80000 Assembly">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This implementation is in z80 assembly code. The processor is really ancient, and so it's basically a register-stack recursion juggling feat. More on it and the author's comments <a rel="nofollow" class="external text" href="http://entelekheia.net">here</a>. It takes the register pairs BC and HL which point to the start and end memory locations to the list of one-byte elements to be sorted. All registers are filled with "garbage" data in the process, so they need to be pushed to the stack to be saved. The script is about 44 bytes long, and does not have pivot-optimizing code.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="c1">;</span>
<span class="c1">; Usage: bc-&gt;first, de-&gt;last,</span>
<span class="c1">;        call qsort</span>
<span class="c1">; Destroys: abcdefhl</span>
<span class="c1">;</span>
<span class="nf">qsort</span>   <span class="nv">ld</span>      <span class="nv">hl</span><span class="p">,</span><span class="mi">0</span>
        <span class="nf">push</span>    <span class="nv">hl</span>
<span class="nf">qsloop</span>  <span class="nv">ld</span>      <span class="nv">h</span><span class="p">,</span><span class="nv">b</span>
        <span class="nf">ld</span>      <span class="nv">l</span><span class="p">,</span><span class="nv">c</span>
        <span class="nf">or</span>      <span class="nv">a</span>
        <span class="nf">sbc</span>     <span class="nv">hl</span><span class="p">,</span><span class="nv">de</span>
        <span class="nf">jp</span>      <span class="nv">c</span><span class="p">,</span><span class="nv">next1</span> <span class="c1">;loop until lo&lt;hi</span>
        <span class="nf">pop</span>     <span class="nv">bc</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,</span><span class="nv">b</span>
        <span class="nf">or</span>      <span class="nv">c</span>
        <span class="nf">ret</span>     <span class="nv">z</span>       <span class="c1">;bottom of stack</span>
        <span class="nf">pop</span>     <span class="nv">de</span>
        <span class="nf">jp</span>      <span class="nv">qsloop</span>
<span class="nf">next1</span>   <span class="nv">push</span>    <span class="nv">de</span>      <span class="c1">;save hi,lo</span>
        <span class="nf">push</span>    <span class="nv">bc</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,(</span><span class="nv">bc</span><span class="p">)</span>  <span class="c1">;pivot</span>
        <span class="nf">ld</span>      <span class="nv">h</span><span class="p">,</span><span class="nv">a</span>
        <span class="nf">dec</span>     <span class="nv">bc</span>
        <span class="nf">inc</span>     <span class="nv">de</span>
<span class="nf">fleft</span>   <span class="nv">inc</span>     <span class="nv">bc</span>      <span class="c1">;do i++ while cur&lt;piv</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,(</span><span class="nv">bc</span><span class="p">)</span>
        <span class="nf">cp</span>      <span class="nv">h</span>
        <span class="nf">jp</span>      <span class="nv">c</span><span class="p">,</span><span class="nv">fleft</span>
<span class="nf">fright</span>  <span class="nv">dec</span>     <span class="nv">de</span>      <span class="c1">;do i-- while cur&gt;piv</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,(</span><span class="nv">de</span><span class="p">)</span>
        <span class="nf">ld</span>      <span class="nv">l</span><span class="p">,</span><span class="nv">a</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,</span><span class="nv">h</span>
        <span class="nf">cp</span>      <span class="nv">l</span>
        <span class="nf">jp</span>      <span class="nv">c</span><span class="p">,</span><span class="nv">fright</span>
        <span class="nf">push</span>    <span class="nv">hl</span>      <span class="c1">;save pivot</span>
        <span class="nf">ld</span>      <span class="nv">h</span><span class="p">,</span><span class="nv">d</span>     <span class="c1">;exit if lo&gt;hi</span>
        <span class="nf">ld</span>      <span class="nv">l</span><span class="p">,</span><span class="nv">e</span>
        <span class="nf">or</span>      <span class="nv">a</span>
        <span class="nf">sbc</span>     <span class="nv">hl</span><span class="p">,</span><span class="nv">bc</span>
        <span class="nf">jp</span>      <span class="nv">c</span><span class="p">,</span><span class="nv">next2</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,(</span><span class="nv">bc</span><span class="p">)</span>  <span class="c1">;swap (bc),(de)</span>
        <span class="nf">ld</span>      <span class="nv">h</span><span class="p">,</span><span class="nv">a</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,(</span><span class="nv">de</span><span class="p">)</span>
        <span class="nf">ld</span>      <span class="p">(</span><span class="nv">bc</span><span class="p">),</span><span class="nv">a</span>
        <span class="nf">ld</span>      <span class="nv">a</span><span class="p">,</span><span class="nv">h</span>
        <span class="nf">ld</span>      <span class="p">(</span><span class="nv">de</span><span class="p">),</span><span class="nv">a</span>
        <span class="nf">pop</span>     <span class="nv">hl</span>      <span class="c1">;restore pivot</span>
        <span class="nf">jp</span>      <span class="nv">fleft</span>
<span class="nf">next2</span>   <span class="nv">pop</span>     <span class="nv">hl</span>      <span class="c1">;restore pivot</span>
        <span class="nf">pop</span>     <span class="nv">hl</span>      <span class="c1">;pop lo</span>
        <span class="nf">push</span>    <span class="nv">bc</span>      <span class="c1">;stack=left-hi</span>
        <span class="nf">ld</span>      <span class="nv">b</span><span class="p">,</span><span class="nv">h</span>
        <span class="nf">ld</span>      <span class="nv">c</span><span class="p">,</span><span class="nv">l</span>     <span class="c1">;bc=lo,de=right</span>
        <span class="nf">jp</span>      <span class="nv">qsloop</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="TorqueScript"><a href="https://en.wikipedia.org/wiki/Torque_Game_Engine" class="extiw" title="wikipedia:Torque Game Engine">TorqueScript</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=43" title="Edit section: TorqueScript">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This is an implementation of Quicksort using script from the Torque game Builder (aka TorqueScript).</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="c1">// Sorts unordered set %uSet, which must be of the class SimSet.</span>
<span class="kd">function</span> <span class="nx">Quicksort</span><span class="p">(</span><span class="o">%</span><span class="nx">uSet</span><span class="p">)</span>
<span class="p">{</span>
    <span class="o">%</span><span class="nx">less</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimSet</span><span class="p">();</span>
    <span class="o">%</span><span class="nx">pivots</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimSet</span><span class="p">();</span>
    <span class="o">%</span><span class="nx">greater</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimSet</span><span class="p">();</span>

    <span class="k">if</span><span class="p">(</span><span class="o">%</span><span class="nx">uSet</span><span class="p">.</span><span class="nx">getCount</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">%</span><span class="nx">uSet</span><span class="p">;</span>

    <span class="o">%</span><span class="nx">pivotVal</span> <span class="o">=</span> <span class="o">%</span><span class="nx">uSet</span><span class="p">.</span><span class="nx">getObject</span><span class="p">(</span><span class="nx">getRandom</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">%</span><span class="nx">uSet</span><span class="p">.</span><span class="nx">getCount</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)).</span><span class="nx">myValue</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">%</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="o">%</span><span class="nx">uSet</span><span class="p">.</span><span class="nx">getCount</span><span class="p">();</span> <span class="o">%</span><span class="nx">i</span> <span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
       <span class="c1">// A new SimObject must be created in order to store it in a SimSet.</span>
       <span class="o">%</span><span class="nx">valObj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimObject</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span>
       <span class="p">{</span>
          <span class="nx">myValue</span> <span class="o">=</span> <span class="o">%</span><span class="nx">uSet</span><span class="p">.</span><span class="nx">getObject</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span><span class="p">).</span><span class="nx">myValue</span><span class="p">;</span>
       <span class="p">};</span>

        <span class="k">if</span><span class="p">(</span><span class="o">%</span><span class="nx">pivotVal</span> <span class="o">&gt;</span> <span class="o">%</span><span class="nx">valObj</span><span class="p">.</span><span class="nx">myValue</span><span class="p">)</span>
            <span class="o">%</span><span class="nx">less</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="o">%</span><span class="nx">valObj</span><span class="p">);</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="o">%</span><span class="nx">pivotVal</span> <span class="o">==</span> <span class="o">%</span><span class="nx">valObj</span><span class="p">.</span><span class="nx">myValue</span><span class="p">)</span>
            <span class="o">%</span><span class="nx">pivots</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="o">%</span><span class="nx">valObj</span><span class="p">);</span>
        <span class="k">else</span> <span class="c1">//if(%pivotVal &lt; %valObj.myValue)</span>
            <span class="o">%</span><span class="nx">greater</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="o">%</span><span class="nx">valObj</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">qConcatenate</span><span class="p">(</span><span class="nx">Quicksort</span><span class="p">(</span><span class="o">%</span><span class="nx">less</span><span class="p">),</span> <span class="o">%</span><span class="nx">pivots</span><span class="p">,</span> <span class="nx">Quicksort</span><span class="p">(</span><span class="o">%</span><span class="nx">greater</span><span class="p">));</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">qConcatenate</span><span class="p">(</span><span class="o">%</span><span class="nx">less</span><span class="p">,</span> <span class="o">%</span><span class="nx">equal</span><span class="p">,</span> <span class="o">%</span><span class="nx">greater</span><span class="p">)</span>
<span class="p">{</span>
    <span class="o">%</span><span class="nx">all</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimSet</span><span class="p">();</span>

    <span class="c1">// Concatenate the three arrays, adding them to the SimSet one at a time.</span>
    <span class="k">for</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">%</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="o">%</span><span class="nx">less</span><span class="p">.</span><span class="nx">getCount</span><span class="p">();</span> <span class="o">%</span><span class="nx">i</span> <span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">%</span><span class="nx">all</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="o">%</span><span class="nx">less</span><span class="p">.</span><span class="nx">getObject</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">%</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="o">%</span><span class="nx">equal</span><span class="p">.</span><span class="nx">getCount</span><span class="p">();</span> <span class="o">%</span><span class="nx">i</span> <span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">%</span><span class="nx">all</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="o">%</span><span class="nx">equal</span><span class="p">.</span><span class="nx">getObject</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">%</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="o">%</span><span class="nx">greater</span><span class="p">.</span><span class="nx">getCount</span><span class="p">();</span> <span class="o">%</span><span class="nx">i</span> <span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">%</span><span class="nx">all</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="o">%</span><span class="nx">greater</span><span class="p">.</span><span class="nx">getObject</span><span class="p">(</span><span class="o">%</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="o">%</span><span class="nx">all</span><span class="p">;</span>
<span class="p">}</span>
</pre>
      </div> 
      <h2><span class="mw-headline" id="FORTRAN_90.2F95"><a href="https://en.wikipedia.org/wiki/Fortran" class="extiw" title="wikipedia:Fortran">FORTRAN 90/95</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit&amp;section=44" title="Edit section: FORTRAN 90/95">edit</a><span class="mw-editsection-bracket">]</span></span></h2> 
      <p>This implementation of quicksort in <a href="https://en.wikipedia.org/wiki/Fortran" class="extiw" title="wikipedia:Fortran">FORTRAN</a> 90/95 is non-recursive, and choose as pivot element the median of three (the first, last and middle element of the list). It also uses <a href="/wiki/Algorithm_Implementation/Sorting/Insertion_sort" title="Algorithm Implementation/Sorting/Insertion sort">insertion sort</a> to sort lists with less than 10 elements.</p> 
      <p>This implementation of <a href="https://en.wikipedia.org/wiki/Quicksort" class="extiw" title="wikipedia:Quicksort">Quicksort</a> closely follows the one that can be found in the <a href="https://en.wikipedia.org/wiki/Fortran" class="extiw" title="wikipedia:Fortran">FORTRAN</a> 90/95 GPL library <a rel="nofollow" class="external text" href="http://sourceforge.net/projects/afnl">AFNL</a>.</p> 
      <div class="mw-highlight mw-content-ltr" dir="ltr"> 
       <pre>
<span class="c">! ***********************************</span>
<span class="c">! *</span>
  <span class="k">Subroutine </span><span class="n">Qsort</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ipt</span><span class="p">)</span>
<span class="c">! *</span>
<span class="c">! ***********************************</span>
<span class="c">! * Sort Array X(:) in ascendent order </span>
<span class="c">! * If present Ipt, a pointer with the </span>
<span class="c">! * changes is returned in Ipt.</span>
<span class="c">! ***********************************</span>

    <span class="k">Type </span><span class="n">Limits</span>
       <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span>
    <span class="k">End Type </span><span class="n">Limits</span>

    <span class="c">! For a list with Isw number of elements or</span>
    <span class="c">! less use Insrt</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Parameter</span> <span class="kd">::</span> <span class="n">Isw</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span><span class="p">(:)</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">Optional</span> <span class="kd">::</span> <span class="n">Ipt</span><span class="p">(:)</span>
    
    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">I</span><span class="p">,</span> <span class="n">Ipvn</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">,</span> <span class="n">ISpos</span><span class="p">,</span> <span class="n">ISmax</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Allocatable</span> <span class="kd">::</span> <span class="n">IIpt</span><span class="p">(:)</span>
    <span class="k">Type</span> <span class="p">(</span><span class="n">Limits</span><span class="p">),</span> <span class="k">Allocatable</span> <span class="kd">::</span> <span class="n">Stack</span><span class="p">(:)</span>
    
    
    <span class="k">Allocate</span><span class="p">(</span><span class="n">Stack</span><span class="p">(</span><span class="n">Size</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>

    <span class="n">Stack</span><span class="p">(:)%</span><span class="n">Ileft</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">If</span> <span class="p">(</span><span class="nb">Present</span><span class="p">(</span><span class="n">Ipt</span><span class="p">))</span> <span class="k">Then</span>
<span class="k">       Forall</span> <span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">Size</span><span class="p">(</span><span class="n">Ipt</span><span class="p">))</span> <span class="n">Ipt</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">I</span>

       <span class="c">! Iniitialize the stack</span>
       <span class="n">Ispos</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="n">Ismax</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="n">Stack</span><span class="p">(</span><span class="n">ISpos</span><span class="p">)%</span><span class="n">Ileft</span>  <span class="o">=</span> <span class="mi">1</span>
       <span class="n">Stack</span><span class="p">(</span><span class="n">ISpos</span><span class="p">)%</span><span class="n">Iright</span> <span class="o">=</span> <span class="n">Size</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
       
       <span class="k">Do While</span> <span class="p">(</span><span class="n">Stack</span><span class="p">(</span><span class="n">ISpos</span><span class="p">)%</span><span class="n">Ileft</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>

          <span class="n">Ileft</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">ISPos</span><span class="p">)%</span><span class="n">Ileft</span>
          <span class="n">Iright</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">ISPos</span><span class="p">)%</span><span class="n">Iright</span>
          <span class="k">If</span> <span class="p">(</span><span class="n">Iright</span><span class="o">-</span><span class="n">Ileft</span> <span class="o">&lt;=</span> <span class="n">Isw</span><span class="p">)</span> <span class="k">Then</span>
<span class="k">             CALL </span><span class="n">InsrtLC</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ipt</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span><span class="n">Iright</span><span class="p">)</span>
             <span class="n">ISpos</span> <span class="o">=</span> <span class="n">ISPos</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="k">Else</span>
<span class="k">             </span><span class="n">Ipvn</span> <span class="o">=</span> <span class="n">ChoosePiv</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>
             <span class="n">Ipvn</span> <span class="o">=</span> <span class="n">Partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">,</span> <span class="n">Ipvn</span><span class="p">,</span> <span class="n">Ipt</span><span class="p">)</span>
             
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Ileft</span> <span class="o">=</span> <span class="n">Ileft</span>
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">%</span><span class="n">Iright</span> <span class="o">=</span> <span class="n">Ipvn</span><span class="o">-</span><span class="mi">1</span>
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">Ileft</span> <span class="o">=</span> <span class="n">Ipvn</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">Iright</span> <span class="o">=</span> <span class="n">Iright</span>
             <span class="n">ISpos</span> <span class="o">=</span> <span class="n">ISpos</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">ISmax</span> <span class="o">=</span> <span class="n">ISmax</span> <span class="o">+</span> <span class="mi">2</span>
          <span class="k">End If</span>
<span class="k">       End Do</span>

<span class="k">    Else</span>

       <span class="c">! Iniitialize the stack</span>
       <span class="n">Ispos</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="n">Ismax</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="n">Stack</span><span class="p">(</span><span class="n">ISpos</span><span class="p">)%</span><span class="n">Ileft</span>  <span class="o">=</span> <span class="mi">1</span>
       <span class="n">Stack</span><span class="p">(</span><span class="n">ISpos</span><span class="p">)%</span><span class="n">Iright</span> <span class="o">=</span> <span class="n">Size</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
       
       <span class="k">Allocate</span><span class="p">(</span><span class="n">IIpt</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
       <span class="k">Do While</span> <span class="p">(</span><span class="n">Stack</span><span class="p">(</span><span class="n">ISpos</span><span class="p">)%</span><span class="n">Ileft</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<span class="c">!          Write(*,*)Ispos, ISmax</span>

          <span class="n">Ileft</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">ISPos</span><span class="p">)%</span><span class="n">Ileft</span>
          <span class="n">Iright</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">ISPos</span><span class="p">)%</span><span class="n">Iright</span>
          <span class="k">If</span> <span class="p">(</span><span class="n">Iright</span><span class="o">-</span><span class="n">Ileft</span> <span class="o">&lt;=</span> <span class="n">Isw</span><span class="p">)</span> <span class="k">Then</span>
<span class="k">             CALL </span><span class="n">InsrtLC</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">IIpt</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>
             <span class="n">ISpos</span> <span class="o">=</span> <span class="n">ISPos</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="k">Else</span>
<span class="k">             </span><span class="n">Ipvn</span> <span class="o">=</span> <span class="n">ChoosePiv</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>
             <span class="n">Ipvn</span> <span class="o">=</span> <span class="n">Partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">,</span> <span class="n">Ipvn</span><span class="p">)</span>
             
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Ileft</span> <span class="o">=</span> <span class="n">Ileft</span>
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">%</span><span class="n">Iright</span> <span class="o">=</span> <span class="n">Ipvn</span><span class="o">-</span><span class="mi">1</span>
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">Ileft</span> <span class="o">=</span> <span class="n">Ipvn</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">Stack</span><span class="p">(</span><span class="n">ISmax</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">Iright</span> <span class="o">=</span> <span class="n">Iright</span>
             <span class="n">ISpos</span> <span class="o">=</span> <span class="n">ISpos</span> <span class="o">+</span> <span class="mi">1</span>
             <span class="n">ISmax</span> <span class="o">=</span> <span class="n">ISmax</span> <span class="o">+</span> <span class="mi">2</span>
          <span class="k">End If</span>
<span class="k">       End Do</span>
<span class="k">       Deallocate</span><span class="p">(</span><span class="n">IIpt</span><span class="p">)</span>

    <span class="k">End If</span>

<span class="k">    Deallocate</span><span class="p">(</span><span class="n">Stack</span><span class="p">)</span>

    <span class="k">Return</span>
<span class="k">    </span>
<span class="k">  CONTAINS</span>

    <span class="c">! ***********************************</span>
    <span class="kt">Integer </span><span class="k">Function </span><span class="n">ChoosePiv</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">IIleft</span><span class="p">,</span> <span class="n">IIright</span><span class="p">)</span> <span class="k">Result</span> <span class="p">(</span><span class="n">IIpv</span><span class="p">)</span>
    <span class="c">! ***********************************</span>
    <span class="c">! * Choose a Pivot element from XX(Ileft:Iright)</span>
    <span class="c">! * for Qsort. This routine chooses the median</span>
    <span class="c">! * of the first, last and mid element of the </span>
    <span class="c">! * list.</span>
    <span class="c">! ***********************************</span>
      
      <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XX</span><span class="p">(:)</span>
      <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IIleft</span><span class="p">,</span> <span class="n">IIright</span>
      
      <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XXcp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">IIpt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">IImd</span>
      
      <span class="n">IImd</span> <span class="o">=</span> <span class="nb">Int</span><span class="p">((</span><span class="n">IIleft</span><span class="o">+</span><span class="n">IIright</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">XXcp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span><span class="p">(</span><span class="n">IIleft</span><span class="p">)</span>
      <span class="n">XXcp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span><span class="p">(</span><span class="n">IImd</span><span class="p">)</span>
      <span class="n">XXcp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span><span class="p">(</span><span class="n">IIright</span><span class="p">)</span>
      <span class="n">IIpt</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">)</span>
      
      <span class="k">CALL </span><span class="n">InsrtLC</span><span class="p">(</span><span class="n">XXcp</span><span class="p">,</span> <span class="n">IIpt</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
      
      <span class="k">Select Case</span> <span class="p">(</span><span class="n">IIpt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">Case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">IIpv</span> <span class="o">=</span> <span class="n">IIleft</span>
      <span class="k">Case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
         <span class="n">IIpv</span> <span class="o">=</span> <span class="n">IImd</span>
      <span class="k">Case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
         <span class="n">IIpv</span> <span class="o">=</span> <span class="n">IIright</span>
      <span class="k">End Select</span>

<span class="k">      Return</span>
<span class="k">    End Function </span><span class="n">ChoosePiv</span>

    <span class="c">! ***********************************</span>
    <span class="k">Subroutine </span><span class="n">InsrtLC</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">IIpt</span><span class="p">,</span> <span class="n">IIl</span><span class="p">,</span> <span class="n">IIr</span><span class="p">)</span>
    <span class="c">! ***********************************</span>
    <span class="c">! * Perform an insertion sort of the list </span>
    <span class="c">! * XX(:) between index values IIl and IIr.</span>
    <span class="c">! * IIpt(:) returns the permutations</span>
    <span class="c">! * made to sort.</span>
    <span class="c">! ***********************************</span>

      <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XX</span><span class="p">(:)</span>
      <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IIpt</span><span class="p">(:)</span>
      <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IIl</span><span class="p">,</span> <span class="n">IIr</span>
      
      <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RRtmp</span>
      <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">II</span><span class="p">,</span> <span class="n">JJ</span><span class="p">,</span> <span class="n">IItmp</span>

      <span class="k">Do </span><span class="n">II</span> <span class="o">=</span> <span class="n">IIl</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">IIr</span>
         <span class="n">RRtmp</span> <span class="o">=</span> <span class="n">XX</span><span class="p">(</span><span class="n">II</span><span class="p">)</span>
         <span class="k">Do </span><span class="n">JJ</span> <span class="o">=</span> <span class="n">II</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">If</span> <span class="p">(</span><span class="n">RRtmp</span> <span class="o">&lt;</span> <span class="n">XX</span><span class="p">(</span><span class="n">JJ</span><span class="p">))</span> <span class="k">Then</span>
<span class="k">               </span><span class="n">XX</span><span class="p">(</span><span class="n">JJ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XX</span><span class="p">(</span><span class="n">JJ</span><span class="p">)</span>
               <span class="k">CALL </span><span class="n">Swap_IN</span><span class="p">(</span><span class="n">IIpt</span><span class="p">,</span> <span class="n">JJ</span><span class="p">,</span> <span class="n">JJ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">Else</span>
<span class="k">               Exit</span>
<span class="k">            End If</span>
<span class="k">         End Do</span>
<span class="k">         </span><span class="n">XX</span><span class="p">(</span><span class="n">JJ</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RRtmp</span>
      <span class="k">End Do</span>
<span class="k">      </span>
<span class="k">      Return</span>
<span class="k">    End Subroutine </span><span class="n">InsrtLC</span>

  <span class="k">End Subroutine </span><span class="n">Qsort</span>

<span class="c">! ***********************************</span>
<span class="c">! *</span>
  <span class="kt">Integer </span><span class="k">Function </span><span class="n">Partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">,</span> <span class="n">Ipv</span><span class="p">,</span> <span class="n">Ipt</span><span class="p">)</span> <span class="k">Result</span> <span class="p">(</span><span class="n">Ipvfn</span><span class="p">)</span>
<span class="c">! *</span>
<span class="c">! ***********************************</span>
<span class="c">! * This routine arranges the array X</span>
<span class="c">! * between the index values Ileft and Iright</span>
<span class="c">! * positioning elements smallers than</span>
<span class="c">! * X(Ipv) at the left and the others </span>
<span class="c">! * at the right.</span>
<span class="c">! * Internal routine used by Qsort.</span>
<span class="c">! ***********************************</span>

    <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span><span class="p">(:)</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="p">,</span> <span class="n">Ipv</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">Optional</span> <span class="kd">::</span> <span class="n">Ipt</span><span class="p">(:)</span>
    
    <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Rpv</span>
    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">I</span>

    <span class="n">Rpv</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">Ipv</span><span class="p">)</span>
    <span class="k">CALL </span><span class="n">Swap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ipv</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>
    <span class="k">If</span> <span class="p">(</span><span class="nb">Present</span><span class="p">(</span><span class="n">Ipt</span><span class="p">))</span> <span class="k">CALL </span><span class="n">Swap_IN</span><span class="p">(</span><span class="n">Ipt</span><span class="p">,</span> <span class="n">Ipv</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>
    <span class="n">Ipvfn</span> <span class="o">=</span> <span class="n">Ileft</span>

    <span class="k">If</span> <span class="p">(</span><span class="nb">Present</span><span class="p">(</span><span class="n">Ipt</span><span class="p">))</span>  <span class="k">Then</span>
<span class="k">       Do </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">If</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Rpv</span><span class="p">)</span> <span class="k">Then</span>
<span class="k">             CALL </span><span class="n">Swap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Ipvfn</span><span class="p">)</span>
             <span class="k">CALL </span><span class="n">Swap_IN</span><span class="p">(</span><span class="n">Ipt</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Ipvfn</span><span class="p">)</span>
             <span class="n">Ipvfn</span> <span class="o">=</span> <span class="n">Ipvfn</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="k">End If</span>
<span class="k">       End Do</span>
<span class="k">    Else</span>
<span class="k">       Do </span><span class="n">I</span> <span class="o">=</span> <span class="n">Ileft</span><span class="p">,</span> <span class="n">Iright</span><span class="o">-</span><span class="mi">1</span>
          <span class="k">If</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Rpv</span><span class="p">)</span> <span class="k">Then</span>
<span class="k">             CALL </span><span class="n">Swap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Ipvfn</span><span class="p">)</span>
             <span class="n">Ipvfn</span> <span class="o">=</span> <span class="n">Ipvfn</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="k">End If</span>
<span class="k">       End Do</span>
<span class="k">    End If</span>

<span class="k">    CALL </span><span class="n">Swap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Ipvfn</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>
    <span class="k">If</span> <span class="p">(</span><span class="nb">Present</span><span class="p">(</span><span class="n">Ipt</span><span class="p">))</span> <span class="k">CALL </span><span class="n">Swap_IN</span><span class="p">(</span><span class="n">Ipt</span><span class="p">,</span> <span class="n">Ipvfn</span><span class="p">,</span> <span class="n">Iright</span><span class="p">)</span>

    <span class="k">Return</span>
<span class="k">  End Function </span><span class="n">Partition</span>

<span class="c">! ***********************************</span>
<span class="c">! *</span>
  <span class="k">Subroutine </span><span class="n">Swap</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
<span class="c">! *</span>
<span class="c">! ***********************************</span>
<span class="c">! * Swaps elements I and J of array X(:). </span>
<span class="c">! ***********************************</span>

    <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span><span class="p">(:)</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span>

    <span class="kt">Real</span> <span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Itmp</span>

    <span class="n">Itmp</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
    <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
    <span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">Itmp</span>

    <span class="k">Return</span>
<span class="k">  End Subroutine </span><span class="n">Swap</span>

<span class="c">! ***********************************</span>
<span class="c">! *</span>
  <span class="k">Subroutine </span><span class="n">Swap_IN</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
<span class="c">! *</span>
<span class="c">! ***********************************</span>
<span class="c">! * Swaps elements I and J of array X(:). </span>
<span class="c">! ***********************************</span>

    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span><span class="p">(:)</span>
    <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span>

    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">Itmp</span>

    <span class="n">Itmp</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
    <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
    <span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">Itmp</span>

    <span class="k">Return</span>
<span class="k">  End Subroutine </span><span class="n">Swap_IN</span>
</pre>
      </div> 
      <!-- 
NewPP limit report
Parsed by mw1261
Cached time: 20170913135118
Cache expiry: 1900800
Dynamic content: false
CPU time usage: 0.240 seconds
Real time usage: 8.496 seconds
Preprocessor visited node count: 923/1000000
Preprocessor generated node count: 0/1500000
Post?expand include size: 5207/2097152 bytes
Template argument size: 1473/2097152 bytes
Highest expansion depth: 21/40
Expensive parser function count: 1/500
Lua time usage: 0.007/10.000 seconds
Lua memory usage: 750 KB/50 MB
--> 
      <!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 8400.855      1 -total
  0.42%   34.969      1 Template:Subject
  0.23%   19.615      3 Template:BOOKPAGENAME
  0.22%   18.424      3 Template:BOOKPAGENAME/core
  0.11%    9.589      1 Template:Wikipedia
  0.10%    8.221      1 Template:BOOKCATEGORY
  0.10%    8.180      1 Template:Mbox-side
  0.10%    8.077      1 Template:Mergefrom
  0.09%    7.767      2 Template:ROOTBOOKNAME
  0.09%    7.192      1 Template:BOOKCATEGORY/core
--> 
     </div> 
     <!-- Saved in parser cache with key enwikibooks:pcache:idhash:77364-0!canonical and timestamp 20170913135110 and revision id 3251346
 --> 
     <noscript>
      <img src="//en.wikibooks.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;">
     </noscript>
    </div> 
    <div class="printfooter">
      Retrieved from "
     <a dir="ltr" href="https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;oldid=3251346">https://en.wikibooks.org/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;oldid=3251346</a>" 
    </div> 
    <div id="catlinks" class="catlinks" data-mw="interface">
     <div id="mw-normal-catlinks" class="mw-normal-catlinks">
      <a href="/wiki/Special:Categories" title="Special:Categories">Category</a>: 
      <ul>
       <li><a href="/wiki/Category:Book:Algorithm_Implementation" title="Category:Book:Algorithm Implementation">Book:Algorithm Implementation</a></li>
      </ul>
     </div>
     <div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">
      Hidden categories: 
      <ul>
       <li><a href="/wiki/Category:Pages_with_syntax_highlighting_errors" title="Category:Pages with syntax highlighting errors">Pages with syntax highlighting errors</a></li>
       <li><a href="/wiki/Category:Books_to_be_merged" title="Category:Books to be merged">Books to be merged</a></li>
      </ul>
     </div>
    </div> 
    <div class="visualClear"></div> 
   </div> 
  </div> 
  <div id="mw-navigation"> 
   <h2>Navigation menu</h2> 
   <div id="mw-head"> 
    <div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label"> 
     <h3 id="p-personal-label">Personal tools</h3> 
     <ul> 
      <li id="pt-anonuserpage">Not logged in</li>
      <li id="pt-anontalk"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [n]" accesskey="n">Discussion for this IP address</a></li>
      <li id="pt-anoncontribs"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [y]" accesskey="y">Contributions</a></li>
      <li id="pt-createaccount"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=Algorithm+Implementation%2FSorting%2FQuicksort" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
      <li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Algorithm+Implementation%2FSorting%2FQuicksort" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li> 
     </ul> 
    </div> 
    <div id="left-navigation"> 
     <div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label"> 
      <h3 id="p-namespaces-label">Namespaces</h3> 
      <ul> 
       <li id="ca-nstab-main" class="selected"><span><a href="/wiki/Algorithm_Implementation/Sorting/Quicksort" title="View the content page [c]" accesskey="c">Book</a></span></li> 
       <li id="ca-talk"><span><a href="/wiki/Talk:Algorithm_Implementation/Sorting/Quicksort" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li> 
      </ul> 
     </div> 
     <div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label"> 
      <h3 id="p-variants-label"> <span>Variants</span> </h3> 
      <div class="menu"> 
       <ul> 
       </ul> 
      </div> 
     </div> 
    </div> 
    <div id="right-navigation"> 
     <div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label"> 
      <h3 id="p-views-label">Views</h3> 
      <ul> 
       <li id="ca-view" class="selected"><span><a href="/wiki/Algorithm_Implementation/Sorting/Quicksort">Read</a></span></li> 
       <li id="ca-edit"><span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=edit" title="Edit this page [e]" accesskey="e">Edit</a></span></li> 
       <li id="ca-history" class="collapsible"><span><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li> 
      </ul> 
     </div> 
     <div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label"> 
      <h3 id="p-cactions-label"><span>More</span></h3> 
      <div class="menu"> 
       <ul> 
       </ul> 
      </div> 
     </div> 
     <div id="p-search" role="search"> 
      <h3> <label for="searchInput">Search</label> </h3> 
      <form action="/w/index.php" id="searchform"> 
       <div id="simpleSearch"> 
        <input type="search" name="search" placeholder="Search Wikibooks" title="Search Wikibooks [f]" accesskey="f" id="searchInput">
        <input type="hidden" value="Special:Search" name="title">
        <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton">
        <input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"> 
       </div> 
      </form> 
     </div> 
    </div> 
   </div> 
   <div id="mw-panel"> 
    <div id="p-logo" role="banner">
     <a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a>
    </div> 
    <div class="portal" role="navigation" id="p-Navigation" aria-labelledby="p-Navigation-label"> 
     <h3 id="p-Navigation-label">Navigation</h3> 
     <div class="body"> 
      <ul> 
       <li id="n-mainpage"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
       <li id="n-help"><a href="/wiki/Help:Contents" title="Find help on how to use and edit Wikibooks">Help</a></li>
       <li id="n-Browse"><a href="/wiki/Wikibooks:Card_Catalog_Office" title="Check out what Wikibooks has to offer">Browse</a></li>
       <li id="n-Cookbook"><a href="/wiki/Cookbook:Table_of_Contents" title="Learn recipes from around the world">Cookbook</a></li>
       <li id="n-Wikijunior"><a href="/wiki/Wikijunior" title="Books for children">Wikijunior</a></li>
       <li id="n-Featured-books"><a href="/wiki/Wikibooks:Featured_books" title="The best of Wikibooks">Featured books</a></li>
       <li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
       <li id="n-sitesupport"><a href="//donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&amp;utm_medium=sidebar&amp;utm_campaign=C13_en.wikibooks.org&amp;uselang=en" title="Support Wikibooks">Donations</a></li>
       <li id="n-randomrootpage"><a href="/wiki/Special:RandomRootpage">Random book</a></li>
       <li id="n-Using-Wikibooks"><a href="/wiki/Using_Wikibooks">Using Wikibooks</a></li> 
      </ul> 
     </div> 
    </div> 
    <div class="portal" role="navigation" id="p-Community" aria-labelledby="p-Community-label"> 
     <h3 id="p-Community-label">Community</h3> 
     <div class="body"> 
      <ul> 
       <li id="n-Reading-room"><a href="/wiki/Wikibooks:Reading_room" title="Discuss Wikibooks-related questions and concerns with others">Reading room</a></li>
       <li id="n-portal"><a href="/wiki/Wikibooks:Community_Portal" title="Find your way around the Wikibooks community">Community portal</a></li>
       <li id="n-currentevents"><a href="/wiki/Wikibooks:Reading_room/Bulletin_Board" title="Important community news">Bulletin Board</a></li>
       <li id="n-maintenance"><a href="/wiki/Wikibooks:Maintenance" title="Frequent tasks that you can help with">Help out!</a></li>
       <li id="n-Policies-and-guidelines"><a href="/wiki/Wikibooks:Policies_and_guidelines" title="Pages detailing important rules and procedures">Policies and guidelines</a></li>
       <li id="n-contact"><a href="/wiki/Wikibooks:Contact_us" title="Alternative methods of communication">Contact us</a></li> 
      </ul> 
     </div> 
    </div> 
    <div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label"> 
     <h3 id="p-tb-label">Tools</h3> 
     <div class="body"> 
      <ul> 
       <li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Algorithm_Implementation/Sorting/Quicksort" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
       <li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Algorithm_Implementation/Sorting/Quicksort" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
       <li id="t-upload"><a href="//commons.wikimedia.org/wiki/Special:UploadWizard?uselang=en" title="Upload files [u]" accesskey="u">Upload file</a></li>
       <li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
       <li id="t-permalink"><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;oldid=3251346" title="Permanent link to this revision of the page">Permanent link</a></li>
       <li id="t-info"><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;action=info" title="More information about this page">Page information</a></li>
       <li id="t-cite"><a href="/w/index.php?title=Special:CiteThisPage&amp;page=Algorithm_Implementation%2FSorting%2FQuicksort&amp;id=3251346" title="Information on how to cite this page">Cite this page</a></li> 
      </ul> 
     </div> 
    </div> 
    <div class="portal" role="navigation" id="p-lang" aria-labelledby="p-lang-label"> 
     <h3 id="p-lang-label">In other languages</h3> 
     <div class="body"> 
      <ul> 
       <li class="interlanguage-link interwiki-ru"><a href="https://ru.wikibooks.org/wiki/%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B_%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8_%D0%B1%D1%8B%D1%81%D1%82%D1%80%D0%BE%D0%B9_%D1%81%D0%BE%D1%80%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8" title="??????? ?????????? ??????? ??????????  Russian" lang="ru" hreflang="ru" class="interlanguage-link-target">???????</a></li> 
      </ul> 
      <div class="after-portlet after-portlet-lang">
       <span class="wb-langlinks-add wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:NewItem?site=enwikibooks&amp;page=Algorithm+Implementation%2FSorting%2FQuicksort" title="Add interlanguage links" class="wbc-editpage">Add links</a></span>
      </div> 
     </div> 
    </div> 
    <div class="portal" role="navigation" id="p-Sister_projects" aria-labelledby="p-Sister_projects-label"> 
     <h3 id="p-Sister_projects-label">Sister projects</h3> 
     <div class="body"> 
      <ul> 
       <li id="n-Wikipedia"><a href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a></li>
       <li id="n-Wikiversity"><a href="https://en.wikiversity.org/wiki/Wikiversity:Main_Page">Wikiversity</a></li>
       <li id="n-Wiktionary"><a href="https://en.wiktionary.org/wiki/Wiktionary:Main_Page">Wiktionary</a></li>
       <li id="n-Wikiquote"><a href="https://en.wikiquote.org/wiki/Main_Page">Wikiquote</a></li>
       <li id="n-Wikisource"><a href="https://en.wikisource.org/wiki/Main_Page">Wikisource</a></li>
       <li id="n-Wikinews"><a href="https://en.wikinews.org/wiki/Main_Page">Wikinews</a></li>
       <li id="n-Wikivoyage"><a href="https://en.wikivoyage.org/wiki/Main_Page">Wikivoyage</a></li>
       <li id="n-Commons"><a href="https://commons.wikimedia.org/wiki/Main_Page">Commons</a></li>
       <li id="n-Wikidata"><a href="https://www.wikidata.org/wiki/Wikidata:Main_Page">Wikidata</a></li> 
      </ul> 
     </div> 
    </div> 
    <div class="portal" role="navigation" id="p-coll-print_export" aria-labelledby="p-coll-print_export-label"> 
     <h3 id="p-coll-print_export-label">Print/export</h3> 
     <div class="body"> 
      <ul> 
       <li id="coll-create_a_book"><a href="/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=Algorithm+Implementation%2FSorting%2FQuicksort">Create a collection</a></li>
       <li id="coll-download-as-rdf2latex"><a href="/w/index.php?title=Special:ElectronPdf&amp;page=Algorithm+Implementation%2FSorting%2FQuicksort&amp;action=show-selection-screen&amp;coll-download-url=%2Fw%2Findex.php%3Ftitle%3DSpecial%3ABook%26bookcmd%3Drender_article%26arttitle%3DAlgorithm%2BImplementation%252FSorting%252FQuicksort%26returnto%3DAlgorithm%2BImplementation%252FSorting%252FQuicksort%26oldid%3D3251346%26writer%3Drdf2latex">Download as PDF</a></li>
       <li id="t-print"><a href="/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</a></li> 
      </ul> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div id="footer" role="contentinfo"> 
   <ul id="footer-info"> 
    <li id="footer-info-lastmod"> This page was last edited on 31 July 2017, at 00:55.</li> 
    <li id="footer-info-copyright">Text is available under the <a href="//creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License.</a>; additional terms may apply. By using this site, you agree to the <a href="//wikimediafoundation.org/wiki/Terms_of_Use">Terms of Use</a> and <a href="//wikimediafoundation.org/wiki/Privacy_policy">Privacy Policy.</a></li> 
   </ul> 
   <ul id="footer-places"> 
    <li id="footer-places-privacy"><a href="https://wikimediafoundation.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li> 
    <li id="footer-places-about"><a href="/wiki/Wikibooks:Welcome" title="Wikibooks:Welcome">About Wikibooks</a></li> 
    <li id="footer-places-disclaimer"><a href="/wiki/Wikibooks:General_disclaimer" title="Wikibooks:General disclaimer">Disclaimers</a></li> 
    <li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li> 
    <li id="footer-places-cookiestatement"><a href="https://wikimediafoundation.org/wiki/Cookie_statement">Cookie statement</a></li> 
    <li id="footer-places-mobileview"><a href="//en.m.wikibooks.org/w/index.php?title=Algorithm_Implementation/Sorting/Quicksort&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li> 
   </ul> 
   <ul id="footer-icons" class="noprint"> 
    <li id="footer-copyrightico"> <a href="https://wikimediafoundation.org/"><img src="/static/images/wikimedia-button.png" srcset="/static/images/wikimedia-button-1.5x.png 1.5x, /static/images/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation"></a> </li> 
    <li id="footer-poweredbyico"> <a href="//www.mediawiki.org/"><img src="/static/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/poweredby_mediawiki_132x47.png 1.5x, /static/images/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a> </li> 
   </ul> 
   <div style="clear:both"></div> 
  </div> 
  <script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.240","walltime":"8.496","ppvisitednodes":{"value":923,"limit":1000000},"ppgeneratednodes":{"value":0,"limit":1500000},"postexpandincludesize":{"value":5207,"limit":2097152},"templateargumentsize":{"value":1473,"limit":2097152},"expansiondepth":{"value":21,"limit":40},"expensivefunctioncount":{"value":1,"limit":500},"entityaccesscount":{"value":0,"limit":400},"timingprofile":["100.00% 8400.855      1 -total","  0.42%   34.969      1 Template:Subject","  0.23%   19.615      3 Template:BOOKPAGENAME","  0.22%   18.424      3 Template:BOOKPAGENAME/core","  0.11%    9.589      1 Template:Wikipedia","  0.10%    8.221      1 Template:BOOKCATEGORY","  0.10%    8.180      1 Template:Mbox-side","  0.10%    8.077      1 Template:Mergefrom","  0.09%    7.767      2 Template:ROOTBOOKNAME","  0.09%    7.192      1 Template:BOOKCATEGORY/core"]},"scribunto":{"limitreport-timeusage":{"value":"0.007","limit":"10.000"},"limitreport-memusage":{"value":767759,"limit":52428800}},"cachereport":{"origin":"mw1261","timestamp":"20170913135118","ttl":1900800,"transientcontent":false}}});});</script>
  <script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":82,"wgHostname":"mw1215"});});</script>   
 </body>
</html>