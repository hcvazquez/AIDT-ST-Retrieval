<!doctype html>
<html class="header-dark">
 <head> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
  <meta name="description" content="Node Js allows you to build backend applications with JavaScript. In this tutorial we'll take a look at how you can secure your Node Js applications with JSON Web Tokens (JWTs)."> 
  <!-- <meta property="fb:admins" content="YOUR_FB_USER_ID" /> --> 
  <meta property="fb:app_id" content="534074790006350"> 
  <meta property="og:title" content="Build and Authenticate a Node Js App with JSON Web Tokens"> 
  <meta property="og:site_name" content="Auth0 - Blog"> 
  <meta property="og:url" content="https://auth0.com/blog/building-and-authenticating-nodejs-apps/"> 
  <meta property="og:image" content="https://cdn.auth0.com/blog/nodejs-awesome-polls/nodejs_logo.png"> 
  <meta property="og:description" content="Node Js allows you to build backend applications with JavaScript. In this tutorial we'll take a look at how you can secure your Node Js a..."> 
  <meta property="og:type" content="article"> 
  <!-- Twitter Cards --> 
  <meta name="twitter:site" content="@auth0"> 
  <meta name="twitter:creator" content="@auth0"> 
  <meta name="twitter:title" content="Build and Authenticate a Node Js App with JSON Web Tokens"> 
  <meta name="twitter:url" content="https://auth0.com/blog/building-and-authenticating-nodejs-apps/"> 
  <meta name="twitter:description" content="Node Js allows you to build backend applications with JavaScript. In this tutorial we'll take a look at how you can secure your Node Js applications with JSON Web Tokens (JWTs)."> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:image" content="https://cdn.auth0.com/blog/nodejs-awesome-polls/nodejs_logo.png"> 
  <meta name="twitter:image:height" content="512"> 
  <meta name="twitter:image:width" content="1024"> 
  <meta name="HandheldFriendly" content="True"> 
  <meta name="MobileOptimized" content="320"> 
  <title>Build and Authenticate a Node Js App with JSON Web Tokens</title> 
  <!-- Swiftype for the posts --> 
  <meta class="swiftype" name="title" data-type="string" content="Build and Authenticate a Node Js App with JSON Web Tokens"> 
  <meta class="swiftype" name="type" data-type="enum" content="blog"> 
  <meta class="swiftype" name="popularity" data-type="integer" content="1"> 
  <link href="https://plus.google.com/+Auth0" rel="publisher"> 
  <link rel="manifest" href="/blog/manifest.json"> 
  <script src="//use.typekit.net/tde2fii.js"></script> 
  <script>try{Typekit.load();}catch(e){}</script> 
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> 
  <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script> 
  <script src="//cdn.auth0.com/w2/auth0-7.4.0.min.js"></script> 
  <script src="//cdn.auth0.com/js/lock/10.6.1/lock.min.js"></script> 
  <script src="//cdnjs.cloudflare.com/ajax/libs/react/15.2.0/react.min.js"></script> 
  <script src="//cdnjs.cloudflare.com/ajax/libs/react/15.2.0/react-dom.min.js"></script> 
  <link rel="stylesheet" href="https://cdn.auth0.com/website/web-header/4.0.32/web-header.css"> 
  <script src="https://cdn.auth0.com/website/web-header/4.0.32/web-header.js"></script> 
  <script src="//npmcdn.com/auth0-contact-form@2.0.3/cdn/contact-form.js"></script> 
  <link rel="stylesheet" href="//npmcdn.com/auth0-contact-form@2.0.3/cdn/contact-form.css"> 
  <script src="https://cdn.auth0.com/website/sliding-popup/1.0.23/sliding-popup.js"></script> 
  <script src="//cdn.auth0.com/js/m/metrics-1.min.js"></script> 
  <script type="text/javascript">
      !function(){
        var metricsLib = window.metricsLib = window.metricsLib || [];
        // A list of the methods in metrics.js to stub.
        metricsLib.methods = [
          'segment',
          'track',
          'setUserId',
          'identify',
          'alias',
          'page',
          'getData',
          'ready',
          'traits'
        ];
        metricsLib.factory = function(method){
          return function(){
            var args = Array.prototype.slice.call(arguments);
            args.unshift(method);
            metricsLib.push(args);
            return metricsLib;
          };
        };
        for (var i = 0; i < metricsLib.methods.length; i++) {
          var key = metricsLib.methods[i];
          metricsLib[key] = metricsLib.factory(key);
        }
        metricsLib.load = function(segmentKey, dwhEndpoint){
          if(null != window.Auth0Metrics){
            window.metricsLib = new Auth0Metrics(segmentKey, dwhEndpoint, 'blog');
          }else{
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.async = true;
            script.src = ('https:' === document.location.protocol
              ? 'https://' : 'http://')
              + 'cdn.auth0.com/js/m/metrics-1.min.js';
            script.onerror = function(){
              console.error("No metrics");
            }
            script.onload = function(){
              // Grab analytics and make it private
              window.metricsLib = new Auth0Metrics(segmentKey, dwhEndpoint, 'blog');
            }
            var first = document.getElementsByTagName('script')[0];
            first.parentNode.insertBefore(script, first);
          }
        };
        var SEGMENT_KEY =  'aaB6w2BsRwUcGbRSUY7X22FPAa1NL3BL' ;
        var DWH_ENDPOINT =  'https://dwh-tracking.it.auth0.com/dwh-metrics' ;
        if (DWH_ENDPOINT) {
          //- We should catch for an undefined DWH_ENDPOINT
          metricsLib.load(SEGMENT_KEY, DWH_ENDPOINT);
        } else {
          console.error("DWH_ENDPOINT must be defined for tracking to work.")
        }
        }();
    </script> 
  <script src="//cdn.auth0.com/js/ab/ab-1.min.js"></script> 
  <script src="//cdn.auth0.com/js/ab/ab-loader-1.min.js"></script> 
  <link rel="canonical" href="https://auth0.com/blog/building-and-authenticating-nodejs-apps/"> 
  <!-- amphtml

    
      
        <link rel="amphtml" href="https://auth0.com/blog/amp/building-and-authenticating-nodejs-apps/" />
      
     --> 
  <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/components/1.0.8/media/logos/img/favicon.png"> 
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://auth0.com/blog/rss.xml"> 
  <link type="application/opensearchdescription+xml" rel="search" href="https://auth0.com/blog/osd.xml"> 
  <link rel="preload" href="https://cdn.auth0.com/styleguide/core/2.0.4/fonts/fakt/FaktPro-Normal.woff2" as="font" type="font/woff2" crossorigin> 
  <link rel="stylesheet" href="https://cdn.auth0.com/styleguide/core/2.0.4/core.min.css"> 
  <link rel="stylesheet" href="https://cdn.auth0.com/styleguide/components/1.0.8/components.min.css"> 
  <link rel="stylesheet" href="/blog/css/index.css"> 
  <link rel="stylesheet" href="/blog/css/vendor/selection-sharer.min.css"> 
  <!-- <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css"> --> 
 </head> 
 <body itemscope itemtype="http://schema.org/WebPage"> 
  <div id="header"></div> 
  <aside id="popup"></aside> 
  <div class="container"> 
   <div class="pn-popup" role="alert"> 
    <div class="pn-popup-container"> 
     <p>?????Do you want to receive a desktop notification when new content is published?</p> 
     <div class="pn-buttons"> 
      <button id="push-allow">YES</button> 
      <button id="push-block">NO</button> 
     </div> 
     <div class="arrow"></div> 
    </div> 
   </div> 
  </div> 
  <script>
    (function () {
      var config = {
        auth0Domain: 'auth0.auth0.com',
        auth0ClientID: 'zEYfpoFzUMEzilhkHilcWoNkrFfJ3hAI',
        auth0CallbackURL: 'https://manage.auth0.com/callback',
      };
      var auth0js = new Auth0({
        domain: config.auth0Domain,
        clientID: config.auth0ClientID,
        callbackURL: config.auth0CallbackURL,
        responseType: 'token'
      });
      var lockOptions = {
        auth: { redirectUrl: config.auth0CallbackURL },
        theme: {
          logo: 'https://cdn.auth0.com/styleguide/components/1.0.8/media/logos/img/badge.png'
        },
        rememberLastLogin: true,
        integratedWindowsLogin: false,
        socialButtonStyle: 'big',
        languageDictionary: {
          emailInputPlaceholder: 'Work email',
          passwordInputPlaceholder: 'Your password',
          signUpTerms: 'By signing up, you agree to our <a href="/terms" target="_new">terms of service</a> and <a href="/privacy" target="_new">privacy policy</a>'
        }
      };
      var lock = window.lock = new Auth0Lock(
        config.auth0ClientID,
        config.auth0Domain,
        lockOptions
      );

      lock.on('signup ready', function () {
        metricsLib.track('open:signup', getBasicInfo());
      });

      lock.on('signin ready', function () {
        metricsLib.track('open:signin', getBasicInfo());
      });

      window.login = function login() {
        metricsLib.track('click:signin', getBasicInfo());
        lock.show({ initialScreen: 'login' });
      }

      window.signup = function() {
        metricsLib.track('click:signup', getBasicInfo());
        window.location.href = '/signup';
      }

      // Header
      var React = window.React;
      var ReactDOM = window.ReactDOM;
      var Auth0WebHeader = window.Auth0WebHeader.default;
      var Auth0ContactForm = window.Auth0ContactForm.default;
      var Header = React.createClass({
        getInitialState: function () {
          return {
            logged: false
          };
        },

        componentDidMount: function () {
          var _this = this;
          auth0js.getSSOData(false, function (err, data) {
            var logged = data.sso;
            _this.setState({ logged: logged });
          });

          var contactFormOptions = {
            onModalOpen: function () {
              metricsLib.track('open:talk-to-sales');
            },
            onFormSuccess: function (metricsData) {
              metricsLib.track('register:lead:talk-to-sales-modal', metricsData);
              metricsLib.track('sent:talk-to-sales', metricsData);
            },
            onFormFail: function (metricsData) {
              metricsLib.track('fail:register:lead:talk-to-sales-modal', metricsData);
              metricsLib.track('fail-sent:talk-to-sales', metricsData);
            }
          };
          var contactForm = new Auth0ContactForm(contactFormOptions);
          this.setState({
            showContactForm: function () {
              contactForm.show({includePhoneField: true });
            }
          });
        },

        render: function () {
          var HeaderProps = {
            logged: this.state.logged,
            showContactForm: this.state.showContactForm
          };
          var Auth0WebHeaderProps = toAuth0WebHeaderProps(HeaderProps);

          return React.createElement(Auth0WebHeader, Auth0WebHeaderProps);
        }
      });

      function toAuth0WebHeaderProps(props) {
        var Auth0WebHeaderProps = {
          theme: 'dark',
          talkToSalesButtonLink: null,
          talkToSalesButtonOnClick: props.showContactForm,
          loginButtonOnClick: window.login
        };

        if (props.logged) {
          Auth0WebHeaderProps.signupButtonLink = 'https://manage.auth0.com';
        } else {
          Auth0WebHeaderProps.signupButtonOnClick = window.signup;
        }

        return Auth0WebHeaderProps;
      }

      var SlidingPopup = window.Auth0SlidingPopup.default;
      ReactDOM.render(React.createElement(Header, null), document.getElementById('header'));
      ReactDOM.render(React.createElement(SlidingPopup, { source: 'blog' }), document.getElementById('popup'));

    })();
    </script> 
  <div id="pjax"> 
   <!-- Facebook --> 
   <div id="fb-root"></div> 
   <script>
        (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=534074790006350&version=v2.0";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
      </script> 
   <!-- Twitter --> 
   <script type="text/javascript">
        !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
      </script> 
   <!-- Twitter Conversion --> 
   <script src="//platform.twitter.com/oct.js" type="text/javascript"></script> 
   <!-- Twitter Conversion --> 
   <script type="text/javascript">
  twttr.conversion.trackPid('l4rua');
</script> 
   <noscript> 
    <img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=l4rua&amp;p_id=Twitter"> 
    <img height="1" width="1" style="display:none;" alt="" src="//t.co/i/adsct?txn_id=l4rua&amp;p_id=Twitter"> 
   </noscript> 
   <article itemprop="mainEntity" itemscope itemtype="http://schema.org/BlogPosting"> 
    <link itemprop="mainEntityOfPage" href="https://auth0.com/blog/building-and-authenticating-nodejs-apps/"> 
    <section class="banner banner-post" style="background: #333333"> 
     <div class="container banner-container"> 
      <i class="icon-budicon-697 hide"></i> 
      <h2 class="banner-subtitle"><a href="/blog/" target="_blank">Blog</a></h2> 
      <a href="/blog/building-and-authenticating-nodejs-apps/" style="

 

" class="entry-thumbnail"> 
       <div class="holder" itemprop="image" itemscope itemtype="http://schema.org/ImageObject"> 
        <img style="
  
 
  
    
  
 
  
 
  
" src="https://cdn.auth0.com/blog/nodejs-awesome-polls/nodejs_logo.png" alt="Build and Authenticate a Node Js App with JSON Web Tokens"> 
        <meta itemprop="url" content="https://cdn.auth0.com/blog/nodejs-awesome-polls/nodejs_logo.png"> 
        <meta itemprop="width" content="128"> 
        <meta itemprop="height" content="128"> 
       </div> </a> 
      <h1 class="entry-title"><a href="/blog/building-and-authenticating-nodejs-apps/" title="Published: November 21, 2016"><span itemprop="headline">Build and Authenticate a Node Js App with JSON Web Tokens</span></a></h1> 
      <div class="entry-content" itemprop="description"> 
       <p>Node Js allows you to build backend applications with JavaScript. In this tutorial we'll take a look at how you can secure your Node Js applications with JSON Web Tokens (JWTs).</p> 
      </div> 
      <div class="post-info"> 
       <div class="author"> 
        <a href="https://twitter.com/kukicado"><img src="https://s.gravatar.com/avatar/99c4080f412ccf46b9b564db7f482907?s=200" width="27" height="27"> <span class="name" itemprop="author">Ado Kukic</span></a> 
       </div> 
       <div class="date"> 
        <time datetime="November 21, 2016" class="published updated">November 21, 2016</time> 
        <meta itemprop="datePublished" content="2016-11-21"> 
       </div> 
       <div class="social-stats"> 
        <a href="#" data-url="https://auth0.com/blog/building-and-authenticating-nodejs-apps/" data-type="twitter" data-txt="Build and Authenticate a Node Js App with JSON Web Tokens" data-via="auth0" data-count="true" class="network"> 
         <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewbox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"> 
          <path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

      c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

      c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

      c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

      C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

      C436.339,160.061,450.668,145.174,462,128.223z" /> 
         </svg> </a> 
        <a href="#" data-url="https://auth0.com/blog/building-and-authenticating-nodejs-apps/" data-type="linkedin" data-txt="Build and Authenticate a Node Js App with JSON Web Tokens" data-count="true" class="network"> 
         <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewbox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"> 
          <path id="linkedin-icon" d="M411.945,50h-312c-27.614,0-50,22.386-50,50v312c0,27.614,22.386,50,50,50h312

      c27.614,0,50-22.386,50-50V100C461.945,72.386,439.56,50,411.945,50z M180.996,392.99h-56.537V210.336h56.537V392.99z

       M152.457,186.417c-18.465,0-33.432-15.09-33.432-33.703c0-18.614,14.967-33.704,33.432-33.704c18.463,0,33.432,15.09,33.432,33.704

      C185.889,171.327,170.92,186.417,152.457,186.417z M392.865,392.99h-56.262c0,0,0-69.582,0-95.881

      c0-26.296-9.988-40.974-30.781-40.974c-22.629,0-34.453,15.289-34.453,40.974c0,28.133,0,95.881,0,95.881h-54.223V210.336h54.223

      v24.599c0,0,16.309-30.171,55.041-30.171s66.455,23.648,66.455,72.572C392.865,326.262,392.865,392.99,392.865,392.99z" /> 
         </svg> </a> 
        <a href="#" data-url="https://auth0.com/blog/building-and-authenticating-nodejs-apps/" data-type="facebook" data-txt="Build and Authenticate a Node Js App with JSON Web Tokens" data-count="true" class="network"> 
         <svg width="17" height="17" viewbox="0 0 412 412" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"> 
          <g id="facebook-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> 
           <path d="M283.80119,412 L361.995375,412 C389.611494,412 412,389.612167 412,361.995375 L412,50.0046252 C412,22.3885058 389.612167,0 361.995375,0 L50.0046252,0 C22.3885058,0 0,22.3878333 0,50.0046252 L0,361.995375 C0,389.611494 22.3878333,412 50.0046252,412 L219.907783,412 L219.907783,254.137637 L166.482996,254.137637 L166.482996,192.266054 L219.907783,192.266054 L219.907783,146.637452 C219.907783,93.6867027 252.247398,64.8530656 299.484232,64.8530656 C322.110827,64.8530656 341.559134,66.5376524 347.225329,67.2916602 L347.225329,122.6301 L314.462578,122.644417 C288.775412,122.644417 283.80119,134.851707 283.80119,152.764958 L283.80119,192.266054 L345.068293,192.266054 L337.089173,254.137637 L283.80119,254.137637 L283.80119,412 Z" id="Rectangle-1" fill="#000000" sketch:type="MSShapeGroup"></path> 
          </g> 
         </svg> </a> 
       </div> 
      </div> 
     </div> 
    </section> 
    <div class="utility-bar"> 
     <div class="container"> 
      <div class="pull-left"> 
       <a href="javascript:signup()" class="signup-button btn btn-success btn-md mf-listen">Use Auth0 for Free</a> 
      </div> 
      <div class="pull-right share-container"> 
       <span class="share-label">Share this post</span> 
       <div class="social-stats"> 
        <a href="#" data-url="https://auth0.com/blog/building-and-authenticating-nodejs-apps/" data-type="twitter" data-txt="Build and Authenticate a Node Js App with JSON Web Tokens" data-via="auth0" data-count="true" class="network"> 
         <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewbox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"> 
          <path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

      c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

      c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

      c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

      C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

      C436.339,160.061,450.668,145.174,462,128.223z" /> 
         </svg> </a> 
        <a href="#" data-url="https://auth0.com/blog/building-and-authenticating-nodejs-apps/" data-type="linkedin" data-txt="Build and Authenticate a Node Js App with JSON Web Tokens" data-count="true" class="network"> 
         <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22" height="22" viewbox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"> 
          <path id="linkedin-icon" d="M411.945,50h-312c-27.614,0-50,22.386-50,50v312c0,27.614,22.386,50,50,50h312

      c27.614,0,50-22.386,50-50V100C461.945,72.386,439.56,50,411.945,50z M180.996,392.99h-56.537V210.336h56.537V392.99z

       M152.457,186.417c-18.465,0-33.432-15.09-33.432-33.703c0-18.614,14.967-33.704,33.432-33.704c18.463,0,33.432,15.09,33.432,33.704

      C185.889,171.327,170.92,186.417,152.457,186.417z M392.865,392.99h-56.262c0,0,0-69.582,0-95.881

      c0-26.296-9.988-40.974-30.781-40.974c-22.629,0-34.453,15.289-34.453,40.974c0,28.133,0,95.881,0,95.881h-54.223V210.336h54.223

      v24.599c0,0,16.309-30.171,55.041-30.171s66.455,23.648,66.455,72.572C392.865,326.262,392.865,392.99,392.865,392.99z" /> 
         </svg> </a> 
        <a href="#" data-url="https://auth0.com/blog/building-and-authenticating-nodejs-apps/" data-type="facebook" data-txt="Build and Authenticate a Node Js App with JSON Web Tokens" data-count="true" class="network"> 
         <svg width="17" height="17" viewbox="0 0 412 412" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"> 
          <g id="facebook-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"> 
           <path d="M283.80119,412 L361.995375,412 C389.611494,412 412,389.612167 412,361.995375 L412,50.0046252 C412,22.3885058 389.612167,0 361.995375,0 L50.0046252,0 C22.3885058,0 0,22.3878333 0,50.0046252 L0,361.995375 C0,389.611494 22.3878333,412 50.0046252,412 L219.907783,412 L219.907783,254.137637 L166.482996,254.137637 L166.482996,192.266054 L219.907783,192.266054 L219.907783,146.637452 C219.907783,93.6867027 252.247398,64.8530656 299.484232,64.8530656 C322.110827,64.8530656 341.559134,66.5376524 347.225329,67.2916602 L347.225329,122.6301 L314.462578,122.644417 C288.775412,122.644417 283.80119,134.851707 283.80119,152.764958 L283.80119,192.266054 L345.068293,192.266054 L337.089173,254.137637 L283.80119,254.137637 L283.80119,412 Z" id="Rectangle-1" fill="#000000" sketch:type="MSShapeGroup"></path> 
          </g> 
         </svg> </a> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div id="container" class="container"> 
     <div class="row sticky-container"> 
      <section class="col-md-8 content-column"> 
       <main class="blog-post blog-single"> 
        <div class="inner"> 
         <div class="entry-content js-entry-content" itemprop="articleBody"> 
          <hr> 
          <p><strong>TL;DR</strong> Node Js brings the simplicity of JavaScript to the backend. Today, we will build an entire application with Node JS, starting with a blank canvas and finishing with a fully functional application with multiple routes, authentication, and even remote data access. Check out the completed code example from our <a href="https://github.com/auth0-blog/nodejs-awesome-polls">GitHub repo</a>.</p> 
          <hr> 
          <p><a href="https://nodejs.org">Node Js</a>, or Node.js, NodeJS, or simply Node was first released in 2009 by Ryan Dahl and has become one of the most popular backend programming languages today. Node Js is for all intents and purposes JavaScript but instead of running in the users browser, Node Js code is executed on the backend. Developers familiar with JavaScript will be able to dive right in and write Node Js code.</p> 
          <p>In our tutorial today, we will write a complete Node Js application using one of the most popular web frameworks for Node, <a href="http://expressjs.com">Express Js</a>. We'll cover everything from project setup to routing, calling external API's, and more. Before we dive into the code let's understand why Node Js is so popular and widely used to give you a deeper understand of why you may want to use Node Js for your applications.</p> 
          <h2>The Rise of Node Js</h2> 
          <p>Node Js became an overnight sensation for multiple reasons. Performance played a huge factor. Node Js was built around an <a href="https://en.wikipedia.org/wiki/Event-driven_architecture">event-based architecture</a> and <a href="https://en.wikipedia.org/wiki/Asynchronous_I/O">asynchronous I/O</a>. This allowed Node Js applications to achieve superior I/O and load performance compared to other programming languages. Node Js code is compiled to machine code via Google's <a href="https://developers.google.com/v8/">V8 JavaScript Engine</a>. Let's take a look at a few other factors that led to the rise of Node Js:</p> 
          <h3>JavaScript on the Backend</h3> 
          <p>JavaScript as a programming language has many <a href="https://whydoesitsuck.com/why-does-javascript-suck/">flaws</a>. It is also the only language that runs in the web browser today. If you want your website or app to have any type of dynamic functionality, you'll have to implement it in JavaScript. This fact led many developers to learn JavaScript, and soon many open source libraries followed.</p> 
          <p>Due to Node Js being JavaScript, many of these libraries, such as <a href="https://lodash.com/">lodash</a>, <a href="http://momentjs.com/">Moment</a>, and <a href="https://github.com/request/request">request</a> could be used on the backend without any modification whatsoever. In many instances, developers were able to write their code once, and have it run on both the frontend and the backend allowing many to quickly become full-stack developers.</p> 
          <h3>Node Package Manager</h3> 
          <p>The <a href="https://www.npmjs.com/">Node Package Mananger</a> or npm is one of the biggest reasons for Node's popularity. NPM allowed developers to easily manage all of the wonderful libraries released by the open source community. Developers could simply type a command like <code>npm install lodash</code>, and the Node Package Manager would go out and download the latest version of lodash into a special <code>node_modules</code> directory and then the developer could access the lodash library by just requiring it in their code.</p> 
          <p>NPM was revolutionary and to this day remains one of the best package managers around. It was not the first package manager: <a href="https://www.nuget.org/">NuGet</a> exists for the .Net platform, <a href="https://pypi.python.org/pypi/pip">pip</a> for Python, <a href="https://rubygems.org/">gems</a> for Ruby, and so on, but the simplicity of NPM has had a major role in Node's success.</p> 
          <h3>Ecosystem</h3> 
          <p>Node Js is not limited to building web applications. With <a href="http://electron.atom.io/">Electron</a> for example, you can build native desktop applications with Node; we even have a tutorial on how to <a href="https://auth0.com/blog/create-a-desktop-app-with-angular-2-and-electron/">here</a>. Utilities and build systems are very popular candidates with Node Js, <a href="https://bower.io/">Bower</a> is a popular front-end package manager built with Node, while <a href="http://gulpjs.com/">Gulp</a>, <a href="http://gruntjs.com/">Grunt</a>, and <a href="https://webpack.github.io/">WebPack</a> are task runners and build systems built with Node that can improve workflows and increase developer efficiency.</p> 
          <p>Due to the small footprint and low resource requirements for running Node Js applications, Node Js is leading the charge in serverless computing with platforms like <a href="https://webtask.io/">Webtask</a>, <a href="https://aws.amazon.com/lambda/">AWS Lambda</a>, and <a href="https://cloud.google.com/functions/docs/">Google Cloud Functions</a> all supporting Node Js almost exclusively.</p> 
          <h2>Is Node Js For Me?</h2> 
          <p>The age-old debate and probably most difficult question to answer. It depends. This may seem like a cop-out answer, but it really depends. Here at Auth0, we use Node Js extensively and it's proven its worth in helping us scale. Check out our <a href="https://auth0.engineering/">Stories from the Trenches</a> blog for more in-depth coverage on how we make use of various technologies throughout our organization.</p> 
          <p>Node Js is great for many use cases, but not so good in others. If you need high I/O that doesn't require a lot of computation, such as serving assets or webpages, then Node will keep you satisfied. If you are doing complex operations, such as hashing passwords or running simulations, Node Js will likely underperform. Examine your use case carefully and use the right tool for the job.</p> 
          <blockquote class="tweet-quote"> 
           <a href="https://twitter.com/intent/tweet?text=&quot;Node Js excels in many use cases, but is not a silver bullet for everything.&quot; via @auth0 http://auth0.com/blog/building-and-authenticating-nodejs-apps/"> <p>"Node Js excels in many use cases, but is not a silver bullet for everything."</p> <p class="tweet-link">TWEET THIS <img src="https://cdn.auth0.com/blog/resources/twitter.svg"></p> </a> 
          </blockquote> 
          <script>
    $(function() {
        $('.tweet-quote').on('click', function() {
            metricsLib.track('blog:share:twitter_quote');
        });
    });
</script> 
          <h2>Building an Application with Node Js</h2> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/polls.png" alt="Node Js App - Awesome Polls"></p> 
          <p>Now that we know more about Node Js, we are ready to get coding and building our application. The application we'll be building today is called Awesome Polls. The United States just had its presidential elections and we are going to build an app to help us analyse the results. Imagine you're building this app for a news organization that wishes to have the most up to date data so that it can provide accurate reports to it's viewers.</p> 
          <p>For this tutorial we will assume that you have at least some JavaScript and general programming knowledge, but no Node Js exposure, so we'll take it step by step. As always, you can check out the completed code from the <a href="https://github.com/auth0-blog/nodejs-awesome-polls">GitHub repo</a> if you would like to just follow along.</p> 
          <h3>Installing Node Js and NPM</h3> 
          <p>To install Node Js head over to the official website located at <a href="https://nodejs.org">https://nodejs.org</a> and you'll see a giant green download button for your operating system. In our tutorial today, we'll be running the 6.x LTS version of Node. Simply download the executable, run it, and go through the steps to install Node Js on your system.</p> 
          <p>If you are on a Mac, you can also install Node Js and NPM via <a href="http://brew.sh/">Homebrew</a>. Simply run <code>homebrew install node</code> from your terminal and in seconds Node and NPM will be installed.</p> 
          <p>We will want to ensure that both NPM and Node are installed. Once you've gone through the installation steps, either manually or via homebrew, we'll confirm that the installation was successful. To do that, close and re-open your terminal window and run the command <code>node -v</code>. This command will let you know the current version of Node installed. Next, run <code>npm -v</code>, and likewise you should see the version of the Node Package Manager installed on your system.</p> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/test.png" alt="Verify Node Js Installation"></p> 
          <p><em>Note: Node.js has two versions. A 6.x stable/long-term support version and 7.x which is the cutting edge version, that supports some of the latest ES6 features. Both versions are production-ready, and for this tutorial we'll be using the 6.x version of Node.</em></p> 
          <h3>Node Js Project Setup</h3> 
          <p>Now that we have Node and NPM installed, we are ready to continue. One of the best things about Node applications, for me personally, is the ability to have your application live anywhere in the file system. Each Node application is self-contained, so to setup our project, let's just create a directory on our desktop called <code>awesome-polls</code> and we'll place our entire application in this directory.</p> 
          <p>The first file we'll add to this project is a <code>package.json</code> file. This file will keep track of all of our dependencies as well as provide some useful info about our application. You can either manually create this file, or run the command <code>npm init</code> and walk through the step-by-step process. <em>Remember to navigate to the <code>awesome-polls</code> directory in your terminal first, otherwise your <code>package.json</code> file will be created elsewhere.</em></p> 
          <p>Now that we have our <code>package.json</code> file, we can add and save our dependencies. There are multiple ways to do this. We could manually write our dependencies in the <code>package.json</code> file, for example, but the preferred way is to actually run the <code>npm install</code> command and pass the <code>--save</code> flag which will automatically add the dependency to your <code>package.json</code> file.</p> 
          <p>Let's see how this works. We will use the Express JavaScript web framework for building our application. Currently, we don't have Express installed on our machine. To get it, simply run <code>npm install express --save</code>. In just a few seconds, Express will be downloaded, and stored in a new directory in your file system called <code>node_modules</code>. This directory will be located in your <code>awesome-polls</code> directory and is a local dependency. You can also install global dependencies by passing a <code>-g</code> flag, but you probably won't want to do this for the majority of libraries you install. Utilities such as Webpack, you'd install globally.</p> 
          <p>You can also install multiple dependencies at once. Let's install the rest of our dependencies. Write the following:</p> 
          <pre><code class="sh">npm install body-parser connect-ensure-login cookie-parser debug dotenv express-session jade morgan passport passport-auth0 --save
</code></pre> 
          <p>These are all of the 3rd party open source libraries we will rely on to write our application. It's ok if you don't understand what many of these mean or do just yet, we'll get there. To close out this section, take a look at your <code>package.json</code> file and you'll see that there is a new section now called <code>dependencies</code> with the libraries we've included.</p> 
          <h3>Node Js Directory Structure</h3> 
          <p>Node Js and Express Js are both pretty unopionionated when it comes to directory structure. You are free to define your own and won't be penalized for having too many or too few layers of abstraction. At the end of the day, the code is compiled and code structure flattened, so feel free to experiment with what works best for you. This will also depend a lot on the size and scope of your application. Our demo app is fairly small so our structure will look like:</p> 
          <pre><code>.env - // We will store our global environmental variables here
package.json - // We will define our apps external dependencies here
app.js - // This file will be our entry point into the application
|- node_modules - // automatically generated, npm will store our external dependencies here
|- public
  |- stylesheets
    |- style.css - // We'll store our global styles here
|- routes
  |- index.js - // In this file we'll define our routes for the application
|- views - // We'll place all of our UI views here 
  |- error.jade - // Our view for the error
  |- index.jade - // Our main homepage view
  ...
</code></pre> 
          <p>Our directory structure is fairly simple. We'll build our app in an MVC style fashion. Our <code>views</code> directory will hold all of our front-end views, while the <code>routes</code> directory will handle the traditional controller logic. We won't have any models for this simple application. Again, it's ok if some of these files don't make sense just yet. I'll explain them all in detail shortly.</p> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/setup.png" alt="Node Js Directory Structure"></p> 
          <h3>Building Awesome Polls</h3> 
          <p>Let's write some Node Js code. The first piece of functionality that we will implement is our main entry point into the application. Open up the <code>app.js</code> file, or create it if you haven't already. For now, let's add the following:</p> 
          <pre><code class="js">// We saw how we could download dependencies via npm. To use those dependencies in our code we require them. The syntax to require a library is the keyword require and a string for the name of the library. We assign this require function to a variable and can then access methods from the library through that variable. Here we are requiring all of our dependencies at the top of the page as is good practice.
var express = require('express');
var path = require('path');
var logger = require('morgan');
var cookieParser = require('cookie-parser');
var bodyParser = require('body-parser');
var session = require('express-session');
var dotenv = require('dotenv');

// We are using the dotenv library to load our environmental variables from the .env file. We don't have anything in the .env file for now, but we will soon.
dotenv.load();

// Just like external libraries, we can import our application code using the require function. The major difference is that we have to give the exact path to our file. We saw in the directory structure section that we will have an index.js file in a routes directory. Go ahead and create it if you haven't already, otherwise you'll get errors when compiling the code.
var routes = require('./routes/index');

// This line of code instantiates the Express JS framework. We assign it to a variable called app, and will add our configruation to this variable.
var app = express();

// The .set method allows us to configure various options with the Express framework. Here we are setting our views directory as well as telling Express that our templating engine will be Jade. More on that soon.
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'jade');

// The .use method is similar to the .set method, where it allows us to set further configurations. The .use method also acts as a chain of events that will take place once a request hits our Node Js application. First we'll log the request data, parse any incoming data, and so on.
app.use(logger('dev'));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: false }));
app.use(cookieParser());
app.use(session({
  // Here we are creating a unique session identifier
  secret: 'shhhhhhhhh',
  resave: true,
  saveUninitialized: true
}));
app.use(express.static(path.join(__dirname, 'public')));

// catch 404 and forward to error handler.
app.use(function(req, res, next) {
  var err = new Error('Not Found');
  err.status = 404;
  next(err);
});

// If our applicatione encounters an error, we'll display the error and stacktrace accordingly.
app.use(function(err, req, res, next) {
  res.status(err.status || 500);
  res.send(err);
});

// Finally, we'll choose to have our app listen on port 3000. This means that once we launch our app, we'll be able to navigate to localhost:3000 and see our app in action. You are free to choose any port you want, so 8080, or 80, or really any number will work. The reason 3000 is typically used is because it's the lowest port number that can be used without requiring elevated privileges on Mac/Linux systems.
app.listen(3000);
</code></pre> 
          <p>Let's test our app so far. To run our app, we'll simply run the command <code>node app</code> in your terminal. Next, navigate to <code>locahost:3000</code> in your web browser. If all went as expected, you should just see a 404 page not found error. That is the expected behavior since we did not add any routes to our application, but we did add a page not found error handler. Next, let's add some routes.</p> 
          <h3>Express Js Routing</h3> 
          <p>If you followed along with our directory structure, you'll have created an <code>index.js</code> file in a directory titled <code>routes</code>. If you haven't already done so, go ahead and create this file, and open it. We will define our application routes here. To accomplish this, we'll write the following:</p> 
          <pre><code class="js">// Again we are importing the libraries we are going to use
var express = require('express');
var router = express.Router();

// On our router variable, we'll be able to include various methods. For our app we'll only make use of GET requests, so the method router.get will handle that interaction. This method takes a string as its first parameter and that is the url path, so for the first route we are just giving it '/', which means the default route. Next we are defining a Node Js callback function, that takes three parameters, a request (req), a response (res), and an optional next (next) parameter. Finally, in our callback function, we are just send the message "You are on the homepage".
router.get('/', function(req, res, next) {
  res.send('You are on the homepage');
});

// We are going to do the same thing for the remaining routes.
router.get('/login',function(req, res){
  res.send('You are on the login page');
});

router.get('/logout', function(req, res){
  res.send('You are on the logout page');
});

router.get('/polls', function(req, res){
  res.send('You are on the polls page');
})

router.get('/user', function(req, res, next) {
  res.send('You are on the user page');
});

// Finally, we export this module so that we can import it in our app.js file and gain access to the routes we defined.
module.exports = router;
</code></pre> 
          <p>Before moving on, let me briefly explain how routing in Express works. When we define a route, say our <code>/user</code> route, and pass the callback function, we are telling Express that when the browser points to <code>localhost:3000/user</code>, the specified callback function will be called.</p> 
          <p>The <code>req</code> parameter will have all the details of the request such as the IP address, parameters passed with the route, and even items we attach to it through Express middleware.</p> 
          <p>The <code>res</code> parameter handles our response from the server to the browser. Here we can return a view, an error, JSON data, and so on. Finally, we can optionally add a <code>next</code> parameter.</p> 
          <p>Calling <code>next</code> will exit the current function and move down the middleware stack. The way requests are processed in Express Js is that they go through a stack of functions. At the end of each function, you can either call <code>next</code> to go the next function in the stack, or call <code>res</code> and send a response to the browser. Once an appropriate <code>res</code> method has been called, the execution of that request is stopped. Middleware is a great way to separate our code into logical pieces. For example, we can have middleware that transforms our request or checks to see if a user is logged in before continuing. We'll see how to do that in the next section.</p> 
          <p>Let's get back to our routes. We have defined them, but if we run our application and try to access <code>localhost:3000/login</code> for example, we'll still see the 404 error. We haven't linked our routes to our app. Let's do that next. Open the <code>app.js</code> file and we'll make the following changes.</p> 
          <pre><code class="js">// We have commented out the existing code so that you can see where to add the new code.

//DO NOT COMMENT OUT ANYTHING IN YOUR FILE

// var express = require('express');
// var path = require('path');
// var logger = require('morgan');
// var cookieParser = require('cookie-parser');
// var bodyParser = require('body-parser');
// var session = require('express-session');
// var dotenv = require('dotenv');

// dotenv.load();

// Just like external libraries, we can import our application code using the require function. The major difference is, we have to give the exact path to our file. We saw in the directory structure section that we will have an index.js file in a routes directory. Go ahead and create it if you haven't already, otherwise you'll get errors when compiling the code.
var routes = require('./routes/index');

// var app = express();

// app.set('views', path.join(__dirname, 'views'));
// app.set('view engine', 'jade');

// app.use(logger('dev'));
// app.use(bodyParser.json());
// app.use(bodyParser.urlencoded({ extended: false }));
// app.use(cookieParser());
// app.use(session({
//  secret: 'shhhhhhhhh',
//  resave: true,
//  saveUninitialized: true
// }));
// app.use(express.static(path.join(__dirname, 'public')));

// Here we are going to use add our routes in a use statement which will link the routes we defined to our app.
app.use('/', routes);

// app.use(function(req, res, next) {
//  var err = new Error('Not Found');
//  err.status = 404;
//  next(err);
// });

// app.use(function(err, req, res, next) {
//  res.status(err.status || 500);
//  res.render('error', {
//    message: err.message,
//    error: err
//  });
// });

// app.listen(3000);
</code></pre> 
          <p>With this change saved, restart your Node server and now navigate to <code>localhost:3000/users</code> and you should just see the text "Your are on the users page" displayed. If we go to a route that we haven't defined like <code>localhost:3000/yo</code>, we'll get the 404 page like we'd expect. Alright, so far so good. We have our routes working, next let's go ahead and build our UI views.</p> 
          <h3>Building the UI</h3> 
          <p>Next, let's build our views. Node Js and Express are very extensible and we have a lot of choices and options when choosing a templating engine for our application. In this tutorial we will use <a href="https://pugjs.org/api/getting-started.html">Jade</a> (recently renamed to Pug). Jade is perhaps one of the oldest view engines, but other options such as <a href="http://www.embeddedjs.com/">EJS</a>, <a href="https://mustache.github.io/">Mustache</a>, <a href="http://www.dustjs.com/">Dust</a>, and so on exist. In our <code>app.js</code> file, we already declared that our view engine is going to be Jade, and that our views will be stored in a directory titled views. In this tutorial, we won't go over the Jade/Pug syntax, so if you are unfamiliar, please check out the <a href="https://pugjs.org/language/tags.html">official tutorial</a>.</p> 
          <p>We are going to build five unique views. Jade/Pug allows us to extend one layout and build on top of it, so we are going to do that in this simple application. Let's create a file named <code>layout.jade</code>. Our views will extend this layout and add on their unique properties. The contents of this file will be as follows:</p> 
          <pre><code class="jade">doctype html
html
  head
    meta(charset="utf-8")
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css", rel="stylesheet")
    link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css')
    script(src="https://cdn.auth0.com/js/lock/10.3/lock.min.js")
  body
    block content
</code></pre> 
          <p>Next, let's build our homepage. Our homepage will just display the name of our app and present the user a link to log in. Create a file called <code>index.jade</code> and paste in the following:</p> 
          <pre><code class="jade">extends layout

block content  
  h1 
    i.fa.fa-lg.fa-pie-chart 
    span Awesome Polls
  h2 Welcome to the Awesome Polls Administrator website.
  p To access the polls, please login.
  br
  a(href="/login")
    button() Login
</code></pre> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/main.png" alt="Awesome Polls Homepage"></p> 
          <p>For our next page, let's build the user details page. This is where we'll display the logged in user's information. Create a <code>user.jade</code> file and the implemenation is as follows:</p> 
          <pre><code class="jade">extends layout

block content
  img(src="#{user.picture}")
  h2 Welcome #{user.nickname}!
  br
  a(href='/logout') Logout
</code></pre> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/user.png" alt="Awesome Polls User Details Page"></p> 
          <p>With the users page done, next let's build the polls page. Create a file called <code>polls.jade</code>.</p> 
          <pre><code class="jade">extends layout

block content  
  div.clearfix
    div.pull-left
      i.fa.fa-lg.fa-pie-chart
      span Awesome Polls
    div.pull-right
      img(src="#{user.picture}", style="height:24px; border-radius: 30px;")  
      strong(style="margin: 0px 10px;") #{user.nickname} 
      a(href="/logout") Logout
  br
  div.jumbotron
    h1.text-center 2016 Presidential Election
  each poll, index in polls
    if (poll.estimates.length &gt; 0)
      div.col-sm-4
        div(class="panel panel-default", style="min-height: 150px;")
          div.panel-title
            div.panel-heading=poll.short_title
          div(class="panel-body", style="min-height: 100px;")
            ul.list-unstyled
              each person, index in poll.estimates
                li
                  if index == 0
                    p
                      strong #{person.choice}
                    div.progress
                      div(class="progress-bar progress-bar-success", style="width: #{person.value}%", role="progressbar")
                        span=person.value
                  else
                    p
                      span #{person.choice}
                    div.progress
                      div(class="progress-bar progress-bar-info", style="width: #{person.value}%", role="progressbar")
                        span=person.value
          div.panel-footer
            a.btn.btn-sm View Results  
            a.btn.btn-sm.write-report Write Report
</code></pre> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/polls.png" alt="Awesome Polls Details Page"></p> 
          <p>Next, let's pretty up our error page. We'll create a file called <code>error.jade</code> and paste the following code:</p> 
          <pre><code class="jade">extends layout

block content
  h1= message
  h2= error.status
  pre #{error.stack}
</code></pre> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/pretty-error.png" alt="Awesome Polls Error Page"></p> 
          <p>Lastly, we'll also create a stub for our login page by creating a file called <code>login.jade</code>, but we'll leave it blank for now.</p> 
          <h3>Wiring up our Views and Controllers</h3> 
          <p>Finally, we are ready to wire up our views and controllers with actual functionality. Remember, we are storing our controllers in the <code>routes/index.js</code> file. Let's open up that file and make the following adjustments:</p> 
          <pre><code class="js">var express = require('express');
var passport = require('passport');
var router = express.Router();
var ensureLoggedIn = require('connect-ensure-login').ensureLoggedIn();
var request = require('request');

// We are going to want to share some data between our server and UI, so we'll be sure to pass that data in an env variable.
var env = {
};

router.get('/', function(req, res, next) {
  // Now, rather then just sending the text "You are on the homepage", we are going to actually render the view we created using the res.render method. The second argument will allow us to pass in data from the backend to our view dynamically.
  res.render('index', { env: env });
});

router.get('/login',function(req, res){
  // Same thing for the login page.
  res.render('login', { env: env });
});

router.get('/logout', function(req, res){
  // For the logout page, we don't need to render a page, we just want the user to be logged out when they hit this page. We'll use the ExpressJS built in logout method, and then we'll redirect the user back to the homepage.
  req.logout();
  res.redirect('/');
});

router.get('/polls', ensureLoggedIn, function(req, res){
  // You may have noticed that we included two new require files, one of them being request. Request allows us to easily make HTTP requests. In our instance here, we are using the Huffington Post's API to pull the latest election results, and then we're sending that data to our polls view.
  // The second require was the connect-ensure-loggedin library, and from here we just required a method called ensureLoggedIn, which will check and see if the current user is logged in before rendering the page. If they are not, they will be redirected to the login page. We are doing this in a middleware pattern, we first call the ensureLoggedIn method, wait for the result of that action, and finally execute our /polls controller.
  request('http://elections.huffingtonpost.com/pollster/api/charts.json?topic=2016-president', function (error, response, body) {
    if (!error &amp;&amp; response.statusCode == 200) {
      var polls = JSON.parse(body);
      // For this view, we are not only sending our environmental information, but the polls and user information as well.
      res.render('polls', {env: env, user: req.user, polls: polls});
    } else {
      res.render('error');
    }
  })
})

router.get('/user', ensureLoggedIn, function(req, res, next) {
  // Same thing for our 
  res.render('user', { env: env, user: req.user });
});

module.exports = router;
</code></pre> 
          <p>This completes our controller's implementation. We did a lot in this section. We saw how we could send data between our server and front end, how to use the excellent Node Js request library to make calls to an external API, and also how to secure our routes and prevent unauthorized access. We haven't built the user authentication system just yet, we'll do that next.</p> 
          <p>Before we close out this section, let's make one quick change to our <code>app.js</code> file. If you recall, in our <code>app.js</code> file we built our error handler. In the last section, we created a pretty view for our errors, so let's make sure we're using that view.</p> 
          <pre><code class="js">app.use(function(err, req, res, next) {
  res.status(err.status || 500);
  //res.send(err)
  res.render('error', {
    message: err.message,
    error: err
  });
});
</code></pre> 
          <h2>Aside: Node Js Authentication with Auth0</h2> 
          <p>We set up a great foundation and our app is looking good. The final piece of the puzzle is to get authentication up and running, so users can log in and view the polls. We'll use <a href="https://auth0.com">Auth0</a> to accomplish this, but the <a href="http://passportjs.org/">Passport.js</a> library has strategies for all major authentication frameworks and providers.</p> 
          <p>To get started, you'll need an <a href="https://auth0.com">Auth0</a> account. If you don't already have one, you can sign up for a free account <a href="javascript:signup()">here</a>. Once you have an account, log in and navigate to the <a href="https://manage.auth0.com">management dashboard</a> and retrieve your Auth0 app specific keys. The three items you'll need specifically are: <strong>Client Id</strong>, <strong>Client Secret</strong>, and <strong>Domain</strong>.</p> 
          <p>Once you have these three items, go ahead and open up the <code>.env</code> file we created and create a variable for each of these. Your completed <code>.env</code> file should look like this:</p> 
          <pre><code>AUTH0_CLIENT_ID=mRgDS6qIasvBPUrqGwlG37anUNbh2OPD
AUTH0_DOMAIN=YOUR-AUTH0-DOMAIN.auth0.com
AUTH0_CLIENT_SECRET=cVQNk5uUFc8qTYF0MW7rkT5tEoCgkXo9VS1BAXoR1zdYdPvNxR0f5bBcjD32dMS
</code></pre> 
          <p>Next, open up the <code>app.js</code> file. Here we will create our Auth0 authentication strategy. Check out the changes below. We are including the original code we've written so far, but have commented it out so you can see the changes we are adding.</p> 
          <pre><code class="js">// We have commented out the existing code so that you can see where to add the new code.

//DO NOT COMMENT OUT ANYTHING IN YOUR FILE

// var express = require('express');
// var path = require('path');
// var logger = require('morgan');
// var cookieParser = require('cookie-parser');
// var bodyParser = require('body-parser');
// var session = require('express-session');
// var dotenv = require('dotenv');
// Passport is the most popular Node Js authentication library
var passport = require('passport');
// We are including the Auth0 authentication strategy for Passport
var Auth0Strategy = require('passport-auth0');

// dotenv.load();

//var routes = require('./routes/index');

// This will configure Passport to use Auth0
var strategy = new Auth0Strategy({
    domain:       process.env.AUTH0_DOMAIN,
    clientID:     process.env.AUTH0_CLIENT_ID,
    clientSecret: process.env.AUTH0_CLIENT_SECRET,
    callbackURL:  'http://localhost:3000/callback'
  }, function(accessToken, refreshToken, extraParams, profile, done) {
    // profile has all the information from the user
    return done(null, profile);
  });

// Here we are adding the Auth0 Strategy to our passport framework
passport.use(strategy);

// The searlize and deserialize user methods will allow us to get the user data once they are logged in.
passport.serializeUser(function(user, done) {
  done(null, user);
});

passport.deserializeUser(function(user, done) {
  done(null, user);
});

// var app = express();

// app.set('views', path.join(__dirname, 'views'));
// app.set('view engine', 'jade');

// app.use(logger('dev'));
// app.use(bodyParser.json());
// app.use(bodyParser.urlencoded({ extended: false }));
// app.use(cookieParser());
// app.use(session({
//  secret: 'shhhhhhhhh',
//  resave: true,
//  saveUninitialized: true
// }));
// We are also adding passport to our middleware flow
app.use(passport.initialize());
app.use(passport.session());
// app.use(express.static(path.join(__dirname, 'public')));

//app.use('/', routes);

// app.use(function(req, res, next) {
//  var err = new Error('Not Found');
//  err.status = 404;
//  next(err);
// });

// app.use(function(err, req, res, next) {
//  res.status(err.status || 500);
//  res.render('error', {
//    message: err.message,
//    error: err
//  });
// });

// app.listen(3000);
</code></pre> 
          <p>We have created an Auth0 authentication strategy and registered it with our application. We already have a login route, but we haven't implemented the UI, let's do that next. Open up the <code>login.jade</code> file and add the following code.</p> 
          <pre><code class="jade">extends layout

block content  
  div(id="root" style="width: 280px; margin: 40px auto; padding: 10px;")

  script.
    var lock = new Auth0Lock('#{env.AUTH0_CLIENT_ID}', '#{env.AUTH0_DOMAIN}', { auth: {
          redirectUrl: '#{env.AUTH0_CALLBACK_URL}'
        , responseType: 'code'
        , params: {
          scope: 'openid profile'
        }
      }});
    lock.show();
</code></pre> 
          <p><img src="https://cdn.auth0.com/blog/nodejs-awesome-polls/login.png" alt="Awesome Polls Login Page"></p> 
          <p>We will make use of the Auth0 <a href="https://auth0.com/lock">Lock</a> widget for our authentication flow. Lock allows us to easily and effortlessly add a login box that can handle traditional username and password, social, and enterprise login methods as well as additional features like multifactor authentication all with the flip of a switch.</p> 
          <p>You may have noticed in the <code>login.jade</code> file, we are requiring some data from the <code>env</code> variable, but we are currently not passing those specific variables. Let's fix that. Open up the <code>index.js</code> page in the <code>routes</code> directory and let's make some final adjustments here as well.</p> 
          <pre><code class="js">// ...
var env = {
  AUTH0_CLIENT_ID: process.env.AUTH0_CLIENT_ID,
  AUTH0_DOMAIN: process.env.AUTH0_DOMAIN,
  AUTH0_CALLBACK_URL: 'http://localhost:3000/callback'
};

// ...

// We are also going to implement the callback route which will redirect the logged in user to the polls page if authentication succeeds.
router.get('/callback',
  passport.authenticate('auth0', { failureRedirect: '/' }),
  function(req, res) {
    res.redirect(req.session.returnTo || '/polls');
  });
</code></pre> 
          <p>We are now finally ready to test our application. Restart the server and head over to <code>localhost:3000</code>. You will be greeted with the homepage.</p> 
          <p>Click on the login button, and you will be sent to the <code>/login</code> page, where the Lock widget will be opened and you will be able to sign up or log in. Log in, or sign up if you haven't alrady created a test account, and you will be redirected to the <code>/polls</code> page.</p> 
          <p>On this page, you will be able to see the results of all 50 states. We got this data using the Node Js request library and querying the Huffington Post API.</p> 
          <p>Finally, click on the logout link in the top right corner, and your user will be logged out and sent back to the homepage. Now that you are logged out, try accessing the <code>/polls</code> page and notice that since you are no longer logged in, you are redirected to the <code>/login</code> page.</p> 
          <p>Congrats! You just built an entire Node Js app and added authentication to it.</p> 
          <h2>Conclusion</h2> 
          <p>Node Js is a powerful language and framework for building modern applications. The community support through NPM is unrivaled and Auth0 can help secure your Node Js apps with not just state of the art authentication, but enhanced features like <a href="https://auth0.com/docs/multifactor-authentication">multifactor auth</a>, <a href="https://auth0.com/docs/anomaly-detection">anomaly detection</a>, <a href="https://auth0.com/docs/identityproviders">enterprise federation</a>, <a href="https://auth0.com/docs/sso">single sign on (SSO)</a>, and more. <a href="javascript:signup()">Sign up</a> today so you can focus on building features unique to your app.</p> 
          <blockquote class="tweet-quote"> 
           <a href="https://twitter.com/intent/tweet?text=&quot;With Auth0, you can add authentication to your Node Js app in minutes.&quot; via @auth0 http://auth0.com/blog/building-and-authenticating-nodejs-apps/"> <p>"With Auth0, you can add authentication to your Node Js app in minutes."</p> <p class="tweet-link">TWEET THIS <img src="https://cdn.auth0.com/blog/resources/twitter.svg"></p> </a> 
          </blockquote> 
          <script>
    $(function() {
        $('.tweet-quote').on('click', function() {
            metricsLib.track('blog:share:twitter_quote');
        });
    });
</script> 
         </div> 
        </div> 
       </main> 
       <div class="bottom-module"> 
        <section class="custom-try-banner  "> 
         <div class="banner-wrapper"> 
          <a href="https://auth0.com/" target="_blank" class="banner-logo"></a> 
          <p class="banner-text"> Auth0 makes it easy to add authentication to your NodeJs application. </p> 
          <a href="javascript:signup()" class="signup-button btn btn-success btn-md">Use Auth0 for Free</a> 
         </div> 
        </section> 
        <div class="try-banner" style="display:none;"> 
         <a href="javascript:signup()" class="signup-button btn btn-success   btn-lg">Use Auth0 for Free</a> 
        </div> 
       </div> 
       <div id="disqus_thread"></div> 
      </section> 
      <aside class="col-md-4 sidebar-column" data-sticky-padding="90" itemscope itemtype="http://schema.org/WPSideBar"> 
       <section id="newsletter-subs"> 
        <form class="newsletter-subscriber hide"> 
         <span data-close></span> 
         <h5 class="title">Subscribe to more awesome content!</h5> 
         <div class="fields"> 
          <button type="submit" class="btn btn-lg btn-success"> 
           <svg fill="#FFFFFF" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"> 
            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" /> 
            <path d="M0 0h24v24H0z" fill="none" /> 
           </svg> </button> 
          <span><input class="form-control" type="text" placeholder="your@email.com"></span> 
         </div> 
        </form> 
       </section> 
       <section class="popular-posts"> 
        <h5 class="section-title">Related Posts</h5> 
        <article class="popular-post"> 
         <div class="image-container"> 
          <a href="/blog/angular-2-ngmodules/" style="

 

" class="entry-thumbnail"> 
           <div class="holder" itemprop="image" itemscope itemtype="http://schema.org/ImageObject"> 
            <img style="
  
 
  
    
  
 
  
 
  
" src="https://cdn.auth0.com/blog/angular/logo3.png" alt="Use @NgModule to Manage Dependencies in your Angular 2 Apps"> 
            <meta itemprop="url" content="https://cdn.auth0.com/blog/angular/logo3.png"> 
            <meta itemprop="width" content="128"> 
            <meta itemprop="height" content="128"> 
           </div> </a> 
         </div> 
         <div class="text-container"> 
          <a href="/blog/angular-2-ngmodules/"><h2 class="popular-post-title h4">Use @NgModule to Manage Dependencies in your Angular 2 Apps</h2></a> 
          <span class="popular-post-author"><a href="#" rel="author">Martin Gontovnikas</a></span> 
         </div> 
        </article> 
        <article class="popular-post"> 
         <div class="image-container"> 
          <a href="/blog/create-a-desktop-app-with-angular-2-and-electron/" style="

  background: #fff;

 

" class="entry-thumbnail"> 
           <div class="holder" itemprop="image" itemscope itemtype="http://schema.org/ImageObject"> 
            <img style="
  
 
  
    
    max-width: 75%;
    
  
 
  
 
  
" src="https://cdn.auth0.com/blog/angular2-electron/angular2-electron-logo.png" alt="Create a Desktop App with Angular 2 and Electron"> 
            <meta itemprop="url" content="https://cdn.auth0.com/blog/angular2-electron/angular2-electron-logo.png"> 
            <meta itemprop="width" content="128"> 
            <meta itemprop="height" content="128"> 
           </div> </a> 
         </div> 
         <div class="text-container"> 
          <a href="/blog/create-a-desktop-app-with-angular-2-and-electron/"><h2 class="popular-post-title h4">Create a Desktop App with Angular 2 and Electron</h2></a> 
          <span class="popular-post-author"><a href="#" rel="author">Ryan Chenkie</a></span> 
         </div> 
        </article> 
        <article class="popular-post"> 
         <div class="image-container"> 
          <a href="/blog/introducing-angular2-jwt-a-library-for-angular2-authentication/" style="

  background: linear-gradient(#0143A3,#0273D4);

 

" class="entry-thumbnail"> 
           <div class="holder" itemprop="image" itemscope itemtype="http://schema.org/ImageObject"> 
            <img style="
  
 
  
    
    max-width: 70%;
    
  
 
  
 
  
" src="https://cdn.auth0.com/blog/angular2-series/angular2-logo.png" alt="Introducing angular2-jwt: A Library for Angular 2 Authentication"> 
            <meta itemprop="url" content="https://cdn.auth0.com/blog/angular2-series/angular2-logo.png"> 
            <meta itemprop="width" content="128"> 
            <meta itemprop="height" content="128"> 
           </div> </a> 
         </div> 
         <div class="text-container"> 
          <a href="/blog/introducing-angular2-jwt-a-library-for-angular2-authentication/"><h2 class="popular-post-title h4">Introducing angular2-jwt: A Library for Angular 2 Authentication</h2></a> 
          <span class="popular-post-author"><a href="#" rel="author">Ryan Chenkie</a></span> 
         </div> 
        </article> 
       </section> 
       <script type="text/javascript">
$('.popular-post a').click(function(e) {
  metricsLib.track('click:blog-related');
})
</script> 
       <section class="guest-author-widget"> 
        <article> 
         <h2 class="guest-author-title">Join the Auth0<br> Guest Author Program</h2> 
         <button data-close class="close-btn"> 
          <svg width="15px" height="15px" viewbox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
           <title>Button - Close</title> 
           <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" opacity="0.25999999"> 
            <g transform="translate(-1230.000000, -1219.000000)" fill="#000000"> 
             <g transform="translate(989.000000, 1204.000000)"> 
              <path d="M248.5,30 C252.642136,30 256,26.6421356 256,22.5 C256,18.3578644 252.642136,15 248.5,15 C244.357864,15 241,18.3578644 241,22.5 C241,26.6421356 244.357864,30 248.5,30 Z M244.75,19.8214286 L245.821429,18.75 L248.5,21.4285714 L251.178571,18.75 L252.25,19.8214286 L249.571429,22.5 L252.25,25.1785714 L251.178571,26.25 L248.5,23.5714286 L245.821429,26.25 L244.75,25.1785714 L247.428571,22.5 L244.75,19.8214286 Z" id="Button---Clear"></path> 
             </g> 
            </g> 
           </g> 
          </svg> </button> 
         <a class="img-link" href="https://auth0.com/guest-authors"><img class="guest-author-image" src="https://cdn.auth0.com/blog/guest-authors/pencil.png" alt="Auth0 Guest Author Program"></a> 
         <a class="guest-author-link" href="https://auth0.com/guest-authors" rel="external"> Learn More 
          <svg width="6px" height="9px" viewbox="0 0 6 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
           <title>Learn More</title> 
           <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> 
            <g transform="translate(-1166.000000, -1345.000000)" fill="#0A86B1"> 
             <g transform="translate(989.000000, 1204.000000)"> 
              <g transform="translate(87.000000, 132.000000)"> 
               <polygon id="Path" points="90 9 95.5514274 13.4411825 90 17.8820874"></polygon> 
              </g> 
             </g> 
            </g> 
           </g> 
          </svg> </a> 
        </article> 
        <script type="text/javascript">
(function() {
if (Math.random() >= .5) {
        title = document.getElementsByClassName("guest-author-title")[0];
        title.innerHTML = 'Join the Auth0<br> Ambassador Program'
        img = document.getElementsByClassName("guest-author-image")[0];
        img.src = 'https://cdn.auth0.com/website/assets/pages/ambassador-program/assets/ambassador-spaceman-stand-up-1x-c7f68dd805.gif'
        img.alt = 'Auth0 Ambassador Program'
        imgLink = document.getElementsByClassName("img-link")[0];
        imgLink.href = 'https://auth0.com/ambassador-program'
	learnLink = document.getElementsByClassName("guest-author-link")[0];
	learnLink.href = 'https://auth0.com/ambassador-program'
}})();
</script> 
       </section> 
      </aside> 
     </div> 
     <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization"> 
      <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject"> 
       <meta itemprop="url" content="https://i.cloudup.com/BngR4GufYd-3000x3000.png"> 
       <meta itemprop="width" content="100"> 
       <meta itemprop="height" content="37"> 
      </div> 
      <meta itemprop="name" content="Auth0"> 
     </div> 
     <script>

        var disqus_shortname = 'auth0blog'; // required: replace example with your forum shortname

        var disqus_config = function () {
            this.page.url = location.href.split('?')[0];
        };

        (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
            var d = document, s = d.createElement('script');

            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script> 
     <noscript>
      Please enable JavaScript to view the 
      <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
     </noscript> 
    </div> 
   </article> 
   <footer class="site-footer"> 
    <div class="container"> 
     <div class="logo">
      <img src="https://cdn.auth0.com/styleguide/components/1.0.8/media/logos/img/badge.png" width="30">
     </div> 
     <div class="footer-grid"> 
      <div class="column"> 
       <div class="item"> 
        <h6>Product</h6> 
       </div> 
       <div class="item">
        <a href="https://auth0.com/pricing">Pricing</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/why-auth0">Why Auth0</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/how-it-works">How It Works</a>
       </div> 
      </div> 
      <div class="column"> 
       <div class="item"> 
        <h6>Company</h6> 
       </div> 
       <div class="item">
        <a href="https://auth0.com/about">About Us</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/blog">Blog</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/jobs">Jobs</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/press">Press</a>
       </div> 
      </div> 
      <div class="column"> 
       <div class="item"> 
        <h6>Security</h6> 
       </div> 
       <div class="item">
        <a href="https://auth0.com/availability-trust">Availability &amp; Trust</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/security">Security</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/whitehat">White Hat</a>
       </div> 
      </div> 
      <div class="column"> 
       <div class="item"> 
        <h6>Learn</h6> 
       </div> 
       <div class="item">
        <a href="https://support.auth0.com">Help &amp; Support</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/docs">Documentation</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/opensource">Open Source</a>
       </div> 
      </div> 
      <div class="column"> 
       <div class="item"> 
        <h6>Extend</h6> 
       </div> 
       <div class="item">
        <a href="https://auth0.com/lock">Lock</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/wordpress">WordPress</a>
       </div> 
       <div class="item">
        <a href="https://auth0.com/docs/apiv2">API Explorer</a>
       </div> 
      </div> 
      <div class="contact"> 
       <div class="column"> 
        <div class="item"> 
         <h6>Contact</h6> 
        </div> 
        <div class="item item-text">
         10900 NE 8th St.
         <br>Suite 700
         <br>Bellevue, WA 98004
        </div> 
       </div> 
       <div class="column no-heading"> 
        <div class="item">
         <a href="tel:+18882352699">+1 (888) 235-2699</a>
        </div> 
        <div class="item">
         <a href="tel:+14253126521">+1 (425) 312-6521</a>
        </div> 
        <div class="item">
         <a href="https://support.auth0.com">Support Center</a>
        </div> 
       </div> 
      </div> 
     </div> 
     <div class="colophon"> 
      <div class="column"> 
       <div class="social"> 
        <div class="twitter"> 
         <iframe allowtransparency="true" frameborder="0" scrolling="no" src="//platform.twitter.com/widgets/follow_button.html?screen_name=auth0" class="twitter"></iframe> 
        </div> 
        <div class="facebook"> 
         <iframe src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Ffacebook.com%2Fgetauth0&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;show_count=false&amp;share=false&amp;height=21&amp;appId=507756515938786" scrolling="no" frameborder="0" allowtransparency="true" class="facebook"></iframe> 
        </div> 
       </div> 
      </div> 
      <div class="column"> 
       <ul class="list-inline text-right"> 
        <li><a href="https://auth0.com/privacy">Privacy Policy</a></li> 
        <li><a href="https://auth0.com/terms">Terms of Service</a></li> 
        <li><span> 2013-2016 Auth0  Inc. All Rights Reserved.</span> </li> 
       </ul> 
      </div> 
     </div> 
    </div> 
   </footer> 
  </div> 
  <script src="/blog/push-notification.js" type="text/javascript"></script> 
  <script src="/blog/js/vendor/js-cookie.js" type="text/javascript"></script> 
  <!-- btn ontact us  ---> 
  <script type="text/javascript">
      var Auth0ContactForm = window.Auth0ContactForm.default;
      var contactFormOptions = {
        onModalOpen: function () {
          metricsLib.track('open:talk-to-sales');
        },
        onFormSuccess: function (metricsData) {
          metricsLib.track('register:lead:talk-to-sales-modal', metricsData);
          metricsLib.track('sent:talk-to-sales', metricsData);
        },
        onFormFail: function (metricsData) {
          metricsLib.track('fail:register:lead:talk-to-sales-modal', metricsData);
          metricsLib.track('fail-sent:talk-to-sales', metricsData);
        }
      };
      var contactForm = new Auth0ContactForm(contactFormOptions);


      $('.contact-us').on('click', function() {
        contactForm.show({includePhoneField: true });
      });

    </script> 
  <script type="text/javascript">
    try {
      window.abTestingLib.load({ fetchFn: function () { return $.get('https://ab.it.auth0.com/?application=website'); }});
      window.abTestingLib.integration('auth0metrics').start({ metrics: window.metricsLib});
      window.abTestingLib.start().then(enhanceAnalytics).then(function () {
        try {
          window.abLoaded = true;
          // Save experiments on the global scope
          window.experiments = window.abTestingLib.getExperiments();
          executeABExperiments();

        } catch (e) {
          console.error('Error running AB experiments.');
          $('#pjax').css('visibility', 'visible');
          window.abLoaded = true;
        }
      });

      function enhanceAnalytics() {
        var analytics = window.abTestingLib.analytics;

        var originalSetCurrentVariantName = analytics.setCurrentVariantName.bind(analytics);
        var originalGetCurrentVariantName = analytics.getCurrentVariantName.bind(analytics);

        var enhancedSetCurrentVariantName = function (variantName, value) {
          setCurrentVariantName(variantName, value);
          originalSetCurrentVariantName(variantName, value);
        };

        var enhancedGetCurrentVariantName = function (variantName) {
          var originalValue = originalGetCurrentVariantName(variantName);
          var cookieValue = getCurrentVariantName(variantName);

          if (originalValue != cookieValue) {
            originalSetCurrentVariantName(variantName, cookieValue);
          }

          return cookieValue;
        };

        analytics.setCurrentVariantName = enhancedSetCurrentVariantName;
        analytics.getCurrentVariantName = enhancedGetCurrentVariantName;
        window.setVariant = enhancedSetCurrentVariantName;
        window.getVariant = enhancedGetCurrentVariantName;
      }

      function setCurrentVariantName(variantName, value) {
        var variants = loadCookieVariants();
        variants[variantName] = value;
        saveCookieVariants(variants);
      }

      function getCurrentVariantName(variantName) {
        var variants = loadCookieVariants();
        return variants[variantName];
      }

      function loadCookieVariants() {
        return JSON.parse(Cookies.get('ajs_ab.traits') || '{}');
      }

      function saveCookieVariants(variants) {
        return Cookies.set('ajs_ab.traits', JSON.stringify(variants), {
          expires: 365,
          path: '/'
        });
      }
    } catch (e) {
      console.error('Error initializing ABTesting lib. ABTesting will be disabled');
      $('#pjax').css('visibility', 'visible');
      window.abLoaded = true;
    }
    </script> 
  <script type="text/javascript">
    function executeABExperiments () {
      var path = window.location.pathname;
      var experiments = window.experiments;

      if(!window.abLoaded) {
        return;
      }

      if(!experiments) {
        // Restore content
        $('#pjax').css('visibility', 'visible');
        return;
      }

      try {
        var experimentsForPath = experiments.runAllByPath(path);
        var winningVariants = [];

        experimentsForPath.experiments.forEach(function (e) {
          winningVariants = winningVariants.concat(e.getCurrentVariant().getPropertiesByType('js'));
        });

        var variantContext = {};
        variantContext.$ = $;

        winningVariants.forEach(function(v) {
          v.runInContext(variantContext);
        });
      } catch (e) {
        console && console.error("Error running experiments for path:%s", path);
      } finally {
        // Restore content
        $('#pjax').css('visibility', 'visible');
      }
    }
    </script> 
  <script type="text/javascript">
      // ab-watchdog, after 1500ms, show the site content no matter the state
      // of the experiments
      setTimeout(function () {
        $('#pjax').css('visibility', 'visible');
      }, 400);
    </script> 
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css"> 
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script> 
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/go.min.js"></script> 
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/elm.min.js"></script> 
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.pjax/1.9.6/jquery.pjax.min.js"></script> 
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script> 
  <script src="/blog/js/vendor/nprogress.js"></script> 
  <script src="/blog/js/vendor/moment.min.js"></script> 
  <script src="/blog/js/vendor/jquery.csbuttons.min.js"></script> 
  <script async src="/blog/js/vendor/html2canvas.js"></script> 
  <script src="/blog/js/vendor/selection-sharer.min.js"></script> 
  <script src="/blog/js/vendor/jquery.sticky-kit.min.js"></script> 
  <script src="/blog/js/vendor/jquery.ba-throttle-debounce.min.js"></script> 
  <script type="text/javascript">
      var getBasicInfo = function () {
        return {
          path: window.location.pathname,
          url: window.location.toString(),
          title: document.title,
          referrer: document.referrer,
          category: 'Lock',
          label: 'blog'
        }
      };

      var getBlogImage = function(getDOM) {
          var img = $('.banner .entry-thumbnail img').first();

          if(img.length) {
              convertToDataURLviaCanvas(img.attr('src'), function(dataURL) {
                img.replaceWith('<img src="' + dataURL + '">');
              });
          }

          setTimeout(function() {
            var banner = $('.banner');
            var dom = $('.banner .entry-thumbnail');

            if(getDOM === 'banner') {
              dom = banner;
            } else {
              banner.addClass('export-icon');
            }

            banner.addClass('export');

            html2canvas(dom.get(0), {
              onrendered: function(canvas) {
                var img = canvas.toDataURL("image/png");

                banner.removeClass('export');

                window.location = img;
              }
            });
          }, 20);

          function convertToDataURLviaCanvas(url, callback, outputFormat){
            var img = new Image();

            img.crossOrigin = 'Anonymous';

            img.onload = function(){
                var canvas = document.createElement('CANVAS');
                var ctx = canvas.getContext('2d');
                var dataURL;

                canvas.height = this.height;
                canvas.width = this.width;
                ctx.drawImage(this, 0, 0);
                dataURL = canvas.toDataURL(outputFormat);
                callback(dataURL);
                canvas = null;
            };

            img.src = url;
          }
      };

      var getBlogBanner = function() {
          getBlogImage('banner');
      };

      $(function() {


        function stickyElements() {

          function stickElement($elem, options) {
            $elem.stick_in_parent(Object.assign({},{
              offset_top: parseInt($elem.attr("data-sticky-padding")) || 0
            }, options ));
          }

          stickElement($('.sidebar-column'));
          stickElement($('.utility-bar'));
          stickElement($('.blog-navigation'), {parent: "body"});
        }

        function initBlogSubscriber() {
          if(localStorage.isBlogSubscriber !== true) {
            $('form.newsletter-subscriber').removeClass('hide');
          }

          function closeSticky($module, animation) {
            $module.addClass('animated ' + animation );
            $module.on('animationend webkitAnimationEnd oAnimationEnd', function () {
              $module.remove()
              $(document.body).trigger("sticky_kit:recalc");
            });
          }

          $('form.newsletter-subscriber').on('click', '[data-close]', function() {
            var $module = $(this).closest('form');

            closeSticky($module, 'fadeOutUp');
          });

          $('.guest-author-widget').on('click', '[data-close]', function() {
            var $module = $(this).closest('section');
            closeSticky($module, 'fadeOutRight');
          });

          $('form.newsletter-subscriber').on('submit', function(e) {
            var $module = $(this);
            var o_content = $module.html();
            var value = $module.find('input').val();

            e.preventDefault();

            if(isValidEmail(value)) {
              onValid();
            } else {
              alert('Please enter a valid email');
            }

            function isValidEmail(val) {
              if(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(val)) {
                return true;
              }

              return false;
            }

            function onValid() {
              $module.find('.fields').html('<p class="loading">Sending...</p>');

              $.ajax({
                type: "POST",
                url: 'https://webtask.it.auth0.com/api/run/wt-martin-gon_to-0/auth0-blog-user?webtask_no_cache=1',
                data: {
                  email: value
                },
                success: onSuccess,
                error: onFail
              });
            }

            function onFail(response) {
              $module.find('.fields').html('<p class="subscription-failed">Theres a problem subscribing to the list right now. Please try again later or <a href="https://support.auth0.com">contact support</a>.</p>');
            }

            function onSuccess(response) {
              localStorage.setItem('isBlogSubscriber', true);

              var blogRegData = getBasicInfo();
              blogRegData.trackData = value;
              blogRegData.email = value;
              blogRegData.formId = '1052';
              blogRegData.lpId = '1117';
              blogRegData.Blog_Subs__c = true;
              metricsLib.track('register:lead:blog-newsletter', blogRegData);

              $module.find('.title').text('Thanks for subscribing');
              $module.find('.fields').html('<p>Youll be getting lots of awesome content!</p>');

            }
          });
        }

        function initialize() {
          initBlogSubscriber();

          $('pre code').each(function(i, block) {
             hljs.highlightBlock(block);
          });

          $('.post-info time').each(function() {
            var $current = $(this);
            var dateString = new Date($current.text());
            var diff = moment(dateString).diff(moment(new Date()), 'days');
            var dateFormat;

            dateFormat = moment(dateString).fromNow();

            if(diff > -10) {
              $current.text(dateFormat);
            }

            if (diff === 0) {
              $current.text('Today');
            }

            $current.addClass('rendered');
          });

          // Social Buttons
          $('.social-stats .network').cSButtons();

          // Force content links to _blank if not explicitly set to _self
          $('.entry-content a').each(function() {
            var _$this = $(this);
            var _target = _$this.attr('target');

            if (_target !== '_self') {
             _$this.attr('target', '_blank');
            }
          });

          // Handle scroll pos
          if($(window).data('navScroll')) {
            $(window).scrollTop($(window).data('navScroll'));

            $(window).data('navScroll', 0);
          } else {
            $(window).scrollTop(0);
          }

          stickyElements();
        }

        function setEvents() {
          hljs.configure({
            tabReplace: '  ', // 4 spaces
            classPrefix: ''
          });

          NProgress.configure({ showSpinner: false, trickleSpeed: 600 });

          metricsLib.page();

          $('p').selectionSharer();

          var selectionSharerFacebook = $('#selectionSharerPopover-inner .action.facebook')[0];
          $(selectionSharerFacebook).on('click', function() {
            metricsLib.track('blog:share:custom:facebook');
          });

          var selectionSharerTwitter = $('#selectionSharerPopover-inner .action.tweet')[0];
          $(selectionSharerTwitter).on('click', function() {
            metricsLib.track('blog:share:custom:twitter');
          });

          var selectionSharerEmail = $('#selectionSharerPopover-inner .action.email')[0];
          $(selectionSharerEmail).on('click', function() {
            metricsLib.track('blog:share:custom:email');
          });

          $(window).on('load', function() {
            $(document.body).trigger("sticky_kit:recalc");
          });


          $('body').on('click', '.blog-navigation a', function() {
            var tabs = $('.blog-navigation li');
            var activeTab = $(this).parent();

            $(window).data('navScroll', $(window).scrollTop());

            tabs.removeClass('active');
            activeTab.addClass('active');
          });

          initialize();
        }

        setEvents();
      });
    </script> 
  <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'auth0blog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script> 
  <script>
      (function(h,o,t,j,a,r){
          h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
          h._hjSettings={hjid:301495,hjsv:5};
          a=o.getElementsByTagName('head')[0];
          r=o.createElement('script');r.async=1;
          r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
          a.appendChild(r);
      })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
    </script>   
 </body>
</html>