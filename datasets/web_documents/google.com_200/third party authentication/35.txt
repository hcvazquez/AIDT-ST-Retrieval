<!--primary cat: NULL
page cat: object(WP_Error)#1610 (2) {
  ["errors"]=>
  array(1) {
    ["invalid_term"]=>
    array(1) {
      [0]=>
      string(10) "Empty Term"
    }
  }
  ["error_data"]=>
  array(0) {
  }
}
parents: array(0) {
}
second_cat: NULL
--><!doctype html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns#">
 <head> 
  <meta charset="UTF-8"> 
  <meta name="description" content="IT Security Training &amp; Resources by InfoSec Institute"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"> 
  <link rel="stylesheet" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/wpjobboard/public/css/wpjb-glyphs.css?ver=4.3.3" type="text/css" media="all"> 
  <link rel="stylesheet" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/style.css"> 
  <link rel="pingback" href="http://resources.infosecinstitute.com/xmlrpc.php"> 
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--> 
  <script>var ajaxUrl = 'http://resources.infosecinstitute.com/wp-admin/admin-ajax.php';</script> 
  <!-- This site is optimized with the Yoast SEO plugin v4.4 - https://yoast.com/wordpress/plugins/seo/ --> 
  <title>Creating an API authenticated with OAuth 2 in Node.js</title> 
  <meta name="description" content="Introduction In the second part of the Securing Web APIs series, we are going to shed light on the OAuth authorization framework and we are going to build"> 
  <meta name="robots" content="noodp"> 
  <link rel="canonical" href="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/"> 
  <meta property="og:locale" content="en_US"> 
  <meta property="og:type" content="article"> 
  <meta property="og:title" content="Creating an API authenticated with OAuth 2 in Node.js"> 
  <meta property="og:description" content="Introduction In the second part of the Securing Web APIs series, we are going to shed light on the OAuth authorization framework and we are going to build"> 
  <meta property="og:url" content="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/"> 
  <meta property="og:site_name" content="InfoSec Resources"> 
  <meta property="article:tag" content="general security"> 
  <meta property="article:section" content="Application Security"> 
  <meta property="article:published_time" content="2015-07-14T07:00:39-05:00"> 
  <meta property="article:modified_time" content="2015-07-14T09:04:59-05:00"> 
  <meta property="og:updated_time" content="2015-07-14T09:04:59-05:00"> 
  <meta property="og:image" content="http://resources.infosecinstitute.com/wp-content/uploads/API-Logo.gif"> 
  <meta property="og:image:width" content="650"> 
  <meta property="og:image:height" content="400"> 
  <!-- / Yoast SEO plugin. --> 
  <link rel="dns-prefetch" href="//a.optnmnstr.com"> 
  <link rel="dns-prefetch" href="//s.w.org"> 
  <link rel="alternate" type="application/rss+xml" title="InfoSec Resources » Creating an API authenticated with OAuth 2 in Node.js Comments Feed" href="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/feed/"> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/resources.infosecinstitute.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <link rel="stylesheet" id="cptch_stylesheet-css" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/captcha/css/front_end_style.css?ver=4.2.8" type="text/css" media="all"> 
  <link rel="stylesheet" id="dashicons-css" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/css/dashicons.min.css?ver=4.8.2" type="text/css" media="all"> 
  <link rel="stylesheet" id="cptch_desktop_style-css" href="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/captcha/css/desktop_style.css?ver=4.2.8" type="text/css" media="all"> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/jquery/jquery.js?ver=1.12.4"></script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/thrive-leads/tcb/editor/js/compat.min.js?ver=1.500.10"></script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/js/vendor/modernizr.min.js"></script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/js/vendor/device.min.js"></script> 
  <script type="text/javascript" data-cfasync="false" id="omapi-script" async src="//a.optnmnstr.com/app/js/api.min.js?ver=1.1.6.1"></script> 
  <link rel="https://api.w.org/" href="http://resources.infosecinstitute.com/wp-json/"> 
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://resources.infosecinstitute.com/xmlrpc.php?rsd"> 
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://resources.infosecinstitute.com/wp-includes/wlwmanifest.xml"> 
  <link rel="shortlink" href="http://resources.infosecinstitute.com/?p=32322"> 
  <link rel="alternate" type="application/json+oembed" href="http://resources.infosecinstitute.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fresources.infosecinstitute.com%2Fsecuring-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js%2F"> 
  <link rel="alternate" type="text/xml+oembed" href="http://resources.infosecinstitute.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fresources.infosecinstitute.com%2Fsecuring-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js%2F&amp;format=xml"> 
  <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async></script> 
  <script>

      window.OneSignal = window.OneSignal || [];

      OneSignal.push( function() {
        OneSignal.SERVICE_WORKER_UPDATER_PATH = "OneSignalSDKUpdaterWorker.js.php";
        OneSignal.SERVICE_WORKER_PATH = "OneSignalSDKWorker.js.php";
        OneSignal.SERVICE_WORKER_PARAM = { scope: '/' };

        OneSignal.setDefaultNotificationUrl("http://resources.infosecinstitute.com");
        var oneSignal_options = {};
        window._oneSignalInitOptions = oneSignal_options;

        oneSignal_options['wordpress'] = true;
oneSignal_options['appId'] = '82403f06-9838-44c2-baef-1450f7e65d9d';
oneSignal_options['autoRegister'] = true;
oneSignal_options['httpPermissionRequest'] = { };
oneSignal_options['httpPermissionRequest']['enable'] = true;
oneSignal_options['welcomeNotification'] = { };
oneSignal_options['welcomeNotification']['title'] = "InfoSec Resources";
oneSignal_options['welcomeNotification']['message'] = "";
oneSignal_options['subdomainName'] = "infosec";
oneSignal_options['promptOptions'] = { };
oneSignal_options['promptOptions']['siteName'] = 'Resources.InfoSecInstitute.com';
oneSignal_options['notifyButton'] = { };
oneSignal_options['notifyButton']['enable'] = true;
oneSignal_options['notifyButton']['position'] = 'bottom-right';
oneSignal_options['notifyButton']['theme'] = 'inverse';
oneSignal_options['notifyButton']['size'] = 'medium';
oneSignal_options['notifyButton']['prenotify'] = true;
oneSignal_options['notifyButton']['showCredit'] = false;
oneSignal_options['notifyButton']['text'] = {};
oneSignal_options['notifyButton']['colors'] = {};
oneSignal_options['notifyButton']['offset'] = {};
              OneSignal.init(window._oneSignalInitOptions);
                    });

      function documentInitOneSignal() {
        var oneSignal_elements = document.getElementsByClassName("OneSignal-prompt");

        var oneSignalLinkClickHandler = function(event) { OneSignal.push(['registerForPushNotifications']); event.preventDefault(); };        for(var i = 0; i < oneSignal_elements.length; i++)
          oneSignal_elements[i].addEventListener('click', oneSignalLinkClickHandler, false);
      }

      if (document.readyState === 'complete') {
           documentInitOneSignal();
      }
      else {
           window.addEventListener("load", function(event){
               documentInitOneSignal();
          });
      }
    </script> 
  <style type="text/css" id="syntaxhighlighteranchor"></style> 
  <!-- Google Tag Manager --> 
  <noscript>
   &lt;iframe src="//www.googletagmanager.com/ns.html?id=GTM-W9VWCG" height="0" width="0" style="display:none;visibility:hidden"&gt;
  </noscript> 
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W9VWCG');</script> 
  <!-- End Google Tag Manager --> 
 </head> 
 <body class="post-template-default single single-post postid-32322 single-format-standard with-series"> 
  <div id="fb-root"></div> 
  <header class="masthead"> 
   <div> 
    <div class="col-3-3"> 
     <nav class="top-left"> 
      <ul> 
       <li> <a href="https://www.infosecinstitute.com">InfoSec Institute</a> 
        <ul> 
         <li> <a href="https://www.infosecinstitute.com/topics/information-security">IT Security Boot Camps</a> </li> 
         <li> <a href="https://www.infosecinstitute.com/company">Contact InfoSec</a> </li> 
         <li> <a href="https://www.infosecinstitute.com/enterprise">Enterprise &amp; Government</a> </li> 
        </ul> </li> 
       <li> <a href="http://www.intenseschool.com">Intense School</a> </li> 
       <li> <a href="http://certs.infosecinstitute.com/">Certification Tracker</a> </li> 
      </ul> 
     </nav> 
     <nav class="top-right"> 
      <ul> 
      </ul> 
     </nav> 
    </div> 
   </div> 
   <div> 
    <div class="col-3-3"> 
     <div class="logo"> 
      <a href="http://resources.infosecinstitute.com"> <img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/assets/imagery/logo.png" alt="InfoSec Resources" title="InfoSec Resources" width="126"> </a> 
     </div> 
     <a class="menu-button mobile" href="#site-navigation" data-attr="main:toggle">Menu</a> 
     <nav class="main" id="site-navigation"> 
      <a class="mobile" href="#" data-attr="main:remove" aria-hidden="true">Close Menu</a> 
      <a class="mobile" href="#" data-attr="topics:remove" aria-hidden="true">Back</a> 
      <a class="mobile" href="#" data-attr="content-archives:remove" aria-hidden="true">Back</a> 
      <ul> 
       <li class="mobile menu-item menu-item-type-custom menu-item-object-custom menu-item-4748"><a href="http://infosec.wpengine.com">Return Home</a></li>
       <li class="has-dropdown  menu-item menu-item-type-custom menu-item-object-custom menu-item-4750 menu-item-has-children"><a href="" data-attr="topics:set">Topics</a>
        <ul data-menu-container="topics">
         <li><a href="http://resources.infosecinstitute.com/category/hacking-2/" title="Hacking"> Hacking </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/certifications-training/" title="IT Certifications"> IT Certifications </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/computerforensics/introduction/" title="Computer Forensics"> Computer Forensics </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/application-security-2/" title="Secure Coding"> Secure Coding </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/pen-testing-1/" title="Penetration Testing"> Penetration Testing </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/general-security-2/" title="General Security"> General Security </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/cloud-computing/" title="Cloud Computing"> Cloud Computing </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/virtualization-security/" title="Virtualization Security"> Virtualization Security </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/wireless-security/" title="Wireless Security"> Wireless Security </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/scada-2/" title="SCADA / ICS Security"> SCADA / ICS Security </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/reverse-engineering-2/" title="Reverse Engineering"> Reverse Engineering </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/data-recovery/" title="Data Recovery"> Data Recovery </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/exploit-development/" title="Exploit Development"> Exploit Development </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/certifications-training/cissp/" title="CISSP"> CISSP </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/certifications-training/securityplus/" title="Security+"> Security+ </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/compliance-auditing/" title="Management, Compliance, &amp; Auditing"> Management, Compliance, &amp; Auditing </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/incident-response-resources/" title="Incident Response"> Incident Response </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/enterprise/securityawareness/" title="Security Awareness"> Security Awareness </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/enterprise/phishing/" title="Phishing"> Phishing </a></li>
         <li><a href="http://resources.infosecinstitute.com/category/healthcare-information-security/" title="Healthcare Information Security"> Healthcare Information Security </a></li>
        </ul></li>
       <li class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-4758"><a href="http://resources.infosecinstitute.com/contributors/">Contributors</a></li>
       <li class="has-dropdown desktop menu-item menu-item-type-custom menu-item-object-custom menu-item-30046 menu-item-has-children"><a href="#" data-attr="archive:set">Archive</a>
        <ul data-menu-container="archive">
         <li><a href="http://resources.infosecinstitute.com/2017/" title="2017"> 2017 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2016/" title="2016"> 2016 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2015/" title="2015"> 2015 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2014/" title="2014"> 2014 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2013/" title="2013"> 2013 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2012" title="2012"> 2012 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2011" title="2011"> 2011 </a></li>
         <li><a href="http://resources.infosecinstitute.com/2010" title="2010"> 2010 </a></li>
        </ul></li>
       <li class="mobile menu-item menu-item-type-custom menu-item-object-custom menu-item-30121"><a href="http://resources.infosecinstitute.com/2015">Archive</a></li>
       <li class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-32427"><a href="http://resources.infosecinstitute.com/job-titles/">Careers</a></li>
       <li class=" menu-item menu-item-type-custom menu-item-object-custom menu-item-32598"><a href="https://securityiq.infosecinstitute.com">SIQ Phishing Simulator</a></li> 
      </ul> 
     </nav> 
     <nav class="search"> 
      <form class="search-form" action="http://www2.infosecinstitute.com/s/12882/ntpoCCBNQ1ttbNTP3ylPLZZeUqLrVgCT" method="get"> 
       <fieldset> 
        <input type="text" name="s" class="icon search" id="search" value=""> 
        <input type="submit" class="icon search" title="Search"> 
       </fieldset> 
      </form> 
     </nav> 
    </div> 
   </div> 
  </header> 
  <main> 
   <section class="hero full"> 
    <div class="col-3-3 wrapper hook" style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//API-Logo-980x0-c-default.gif');"> 
     <header> 
      <h2>Securing Web APIs - Part 2</h2> 
      <h1>Creating an API authenticated with OAuth 2 in Node.js</h1> 
     </header> 
     <nav class="jump"> 
      <label>Jump to</label> 
      <div class="dropdown"> 
       <span data-trigger>Select post section</span> 
       <ul> 
        <li> <a href="http://resources.infosecinstitute.com/securing-web-apis-the-basics-with-node-js-examples/#article">Part 1 - The Basics with Node.js Examples</a> </li> 
        <li class="current">Part 2 - Creating an API authenticated with OAuth 2 in Node.js</li> 
       </ul> 
       <select> <option value="http://resources.infosecinstitute.com/securing-web-apis-the-basics-with-node-js-examples/#article">Part 1 - The Basics with Node.js Examples</option> <option selected>Part 2 - Creating an API authenticated with OAuth 2 in Node.js</option> </select> 
      </div> 
     </nav> 
     <div class="share vertical"> 
      <ul> 
       <li class="twitter"> <a class="twitter-share-button" href="https://twitter.com/share" data-size="medium" data-url="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/" data-count-url="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/" data-count="vertical" data-via="InfosecEdu" data-related="infosecedu" data-hashtags="infosec" data-text="Creating an API authenticated with OAuth 2 in Node.js"> Tweet </a> </li> 
       <li class="google"> 
        <div class="g-plus" data-action="share" data-annotation="vertical-bubble"> 
        </div> </li> 
       <li class="linkedin"> <script type="IN/Share" data-counter="top"></script> </li> 
       <li class="reddit"> <script type="text/javascript" src="//www.redditstatic.com/button/button2.js"></script> </li> 
       <li class="facebook"> 
        <div class="fb-like" data-width="90" data-layout="box_count" data-action="like" data-show-faces="false" data-share="false"></div> </li> 
      </ul> 
     </div> 
    </div> 
   </section> 
   <section class="content full"> 
    <div class="col-3-3 wrapper"> 
     <div class="main post-col-3-3"> 
      <article class="post-content"> 
       <div id="article"></div> 
       <h2>Introduction</h2> 
       <p>In the second part of the Securing Web APIs series, we are going to shed light on the OAuth authorization framework and we are going to build a simple API with OAuth authentication/server in Node.js.</p> 
       <p>If you missed the first part, you can find it <a href="http://resources.infosecinstitute.com/securing-web-apis-the-basics-with-node-js-examples/" target="_blank">here</a>. In it, we discuss some of the basic methods to secure your Node.js API such as HTTP Basic Auth, HTTP Digest and we show some API conventions.</p> 
       <p>This article comes with a sample API/OAuth2 server with Node.js as back-end for you to examine and improve. Download it here:</p> 
       <div class="download-cta-clearfix"> 
        <a class="download-cta icon save-s" href="#download" rel="modal:open">Download</a> 
       </div> 
       <p><img src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads/071415_0039_SecuringWeb1.png" alt=""></p> 
       <h2>What is OAuth?</h2> 
       <p>OAuth allows for identity delegation. Identity delegation allows a resource provider (such as Facebook) to be informed of the fact that a resource owner (a particular user in Facebook) allows a third-party (some application other than Facebook) to access and/or change the data belonging to the resource owner that is stored with the resource provider (such as allowing the third-party application to update the user’s Facebook status or get a list with the user’s friends). OAuth 2 is becoming the standard when it comes to the security of APIs and many famous web apps have already implemented this authorization mechanism – such as Facebook, LinkedIn, Google and PayPal.</p> 
       <p>OAuth 2.0 involves four grant types. Grant types indicate exactly how the third party is going to be authorized to access the resource owner’s data stored with the resource provider. Most of the grant types allow the third-party application to access the user’s data in the resource provider without that third party ever being aware of the credentials (login) of that user.</p> 
       <p>Our API will require an access token upon which third-party apps would be able to get random or specific quotes. Of course, this does not really need an OAuth authorization as the quotes do not have anything to do with the resource owner but it could have been a good candidate for OAuth if the users added the quotes to their account themselves and the third-party needed to view their quotes and process them in some way.</p> 
       <h2>Grant Types in OAuth 2</h2> 
       <h3>Authorization Code</h3> 
       <p>We have implemented this grant type in the API we will be building, so we will show live examples.</p> 
       <p>To get an authorization code the third-party has to redirect the user to the resource provider’s website using the GET request method and pass three parameters: <em>response_type=code,client_id=THE_CLIENT_ID_WITH_THE_RESOURCE_PROVIDER, and redirect_uri=URL_WHERE_THE_CODE_WILL_BE_RETURNED.</em></p> 
       <p>Therefore, if http://infosecinstitute.com wants to get an authorization code for our quote API it should do a GET request like this: <strong>http://localhost:9999/oauth/authorise/?response_type=code&amp;client_id=TBrFXOaLFOlcghpA&amp;redirect_uri=http://www.infosecinstitute.com</strong></p> 
       <p>If the user who is redirected to our localhost:9999 from infosecinstitute is already logged in with the site in localhost:9999,then he will end up being asked to confirm the delegation and he will be redirected to http://infosecinstitute.com with a GET parameter called code where the authorization code will be passed. If he is not logged in, he would be redirected to the login page while the GET parameters (<em>response_type,client_id,redirect_uri</em>) remain intact and after he logs in and be asked to confirm that he authorizes the app to access his data he will finally be redirected to the URL provided in <em>redirect_uri with the code</em>. InfoSec Institute can then use the code in the GET parameter to get an access token and use the quote API to get the quotes of that user and process them in any way it likes. Here is a sample result/response from our <em>/oauth/authorise/ </em>call if the <em>redirect_uri</em> is set to http://infosecinstitute.com: <strong>http://www.infosecinstitute.com/?code=f1756264ecf620d679aa625467908aa91fa59dcb.</strong></p> 
       <p>Then, the third-party app could use what is in the GET code parameter to get an access token by providing the client id. The client secret that the third-party application received when registering itself as an app that works with the resource provider, the code itself and a grant type of <em>authorization_code</em> in a POST request to the resource provider.</p> 
       <p>Here is a request that we use in our API to get an access token from a received code.</p> 
       <p>PS C:\Users\Ivan&gt; <strong>curl –noproxy localhost:9999 localhost:9999/oauth/token –data “client_id=pE1Qz7LSOzTPSbP4&amp;client_secret=KaXS2LfnOUxXjTq5iikoz3LIgnPiM8&amp;grant_type=authorization_code&amp;code=3aa27400f59bddf55e39a396fa561f6d2a0f3277&amp;redirect_uri=http://www.dimoff.biz”</strong></p> 
       <p>We get the following JSON response:</p> 
       <p><em>{“token_type”:”bearer”,”access_token”:”31ae0ca214abbc4a303136dba375597f44933a69?,”expires_in”:86400}</em></p> 
       <p>You can see the POST request to<em> localhost:9999/oauth/token</em> with those parameters returns to us the access token that we can use to work with the user’s data and get the user’s quotes.</p> 
       <h3>How to use an access token with a resource provider?</h3> 
       <p>We can use an access token in two ways: either add it as a GET parameter to our API calls like this:<strong> curl “http://localhost:9999/api/random/?access_token=31ae0ca214abbc4a303136dba375597f44933a69”</strong></p> 
       <p>This will return a JSON-encoded string with a quote and its movie title in our sample API: <em>{“quote”:”[Elisabeth comments on how fast Patrick had begun sleeping with Holly when a\r\n guy comes out of her bedroom]\r\nPatrick Highsmith: What was that you were saying about 6 months of\r\n suffering?\r\nElisabeth: OK, so I’m a slut, you’re a slut, who wants coffee?\r\n\r\n\r\n”,”movieTitle”:” Doppelganger (1993)”}</em></p> 
       <p>If you want the access token not to be revealed in the URL and shown if the link is shared or in the browser’s history, you can do a request with<strong> Authorization</strong> header set to “<strong>Authorization: Bearer ACCESS_TOKEN”</strong>.</p> 
       <p>Here is an example of passing the token in a header using cURL:</p> 
       <p>PS C:\Users\Ivan&gt; <strong>curl “http://localhost:9999/api/random/” -H “Authorization: Bearer 31ae0ca214abbc4a303136dba375597f44933a69”</strong></p> 
       <h3>Password Credentials</h3> 
       <p>Using this grant type, applications can directly get an access token but would have to know the username and the password of the resource owner.</p> 
       <p>The third-party app has to make a POST request to the OAuth endpoint (in our case <em>/oauth/token</em>) with a HTTP Basic Auth header with contents being the app’s client id and client secret encoded in base64 and separated by a <span style="font-size: 12pt;"><strong>:</strong></span> (“Authorization: Basic CLIENT_ID:CLIENT_SECRET”). The app must also provide some POST data with the request – a grant type of password and the username and password of the resource owner who is delegating access.</p> 
       <p>Here is how we get an access token in our sample API with cURL:</p> 
       <p>PS C:\Users\Ivan&gt; <strong>curl localhost:9999/oauth/token -H “Authorization: Basic cEUxUXo3TFNPelRQU2JQNDpLYVhTMkxmbk9VeFhqVHE1aWlrb3ozTElnblBpTTg=” –data “grant_type=password&amp;username=tester2&amp;password=tester2”</strong></p> 
       <p>A sample response would be:</p> 
       <p>{“token_type”:”bearer”,”access_token”:”fc415000a8cf06ad2688b1421fa64f6ab24c44de”,”expires_in”:86400}</p> 
       <h2>How do we secure our API with OAuth in Node.js</h2> 
       <p>We have to provide a middleware before our API’s endpoint route is reached that would check if a valid access token is provided. Here is how we have achieved this with node-oauth2-server:</p> 
       <pre class="EnlighterJSRAW" data-enlighter-language="js">app.get("/api/random", app.oauth.authorise(), routes.getQuoteRandom);
app.get("/api/id/:id", app.oauth.authorise(), routes.getQuoteById);
</pre> 
       <p>If we want some points of our API to be public we just have to remove the <span style="color: #660e7a;"><strong><em>app</em></strong>.<span style="color: #660e7a;"><strong>oauth</strong>.authorise() middleware.</span></span></p> 
       <h3>OAuth and security</h3> 
       <p>If our app has received an access token for the user, <em>tester2 </em>the token would grant the app access only to the data of that user.</p> 
       <p>This token would only be valid for the user the access token was generated for (through his userId) and the resource provider would know all about the third-party application to which the user has delegated access. A UI could be built where users can reject access to third parties to which they have given access (such as Facebook – <a href="https://www.facebook.com/settings?tab=applications">https://www.facebook.com/settings?tab=applications</a>).</p> 
       <p><strong>A possible drawback is that access tokens could be brute-forced (for example, the bearer token is an arbitrary string and brute-forcing it is possible depending on its length amongst other measures that would discover brute-forcing attempts).</strong></p> 
       <h3>The most common OAuth 2 Vulnerability</h3> 
       <p>This vulnerability allows provider accounts to be linked to the client accounts of victims and involves CSRF.</p> 
       <p>The vulnerability allows attackers to hijack client accounts. For the vulnerability to be there, the client app has to support logging in with the OAuth provider and the ability to add OAuth provider logins in its settings. The attacker starts the authorization process by adding OAuth provider login without visiting the callback that he is attempted to be sent to (by blocking the redirect). Then, the victim has to use that callback’s URL (either directly or through an image or anchor somewhere) and if the victim is logged in in the vulnerable website the attack could be successful and the attacker only has to log in with that OAuth provider and he will be logged in directly to the victim’s account on that site.</p> 
       <p>To read more about the vulnerability visit: <a href="http://homakov.blogspot.com/2012/07/saferweb-most-common-oauth2.html">http://homakov.blogspot.com/2012/07/saferweb-most-common-oauth2.html</a></p> 
       <h3>Leaking authorization code</h3> 
       <p><strong>The OAuth documentation pinpoints that the redirect_uri with which the client application registered must match with the one used to obtain an access token</strong>. If the redirect_uri is not checked then a malicious user can insert an image or anchor on the client’s website (either through a vulnerability such as XSS or perfectly legal if it allows users to share links and images somewhere) with a URL pointing to the attacker’s website. Then he can construct a URL that requests for an authorization code in the resource provider’s domain with a redirect_uri pointing to an URL with the embedded by the attacker image/link. Whenever a user accesses the authorization code request URL, the attacker could see the authorization code through the script behind his embedded image/link via the <strong>Referer</strong> header (which will include the GET parameter called <strong>code </strong>and its value) because the redirect_uri would make a call to the attacker’s image in order to load it.</p> 
       <p>To protect yourself against this account hijacking vulnerability, you should avoid flexible redirect urls (our sample app does that) or store the redirect url for each code you issue in your database and when you create an access token with that code – check if the redirect url matches the redirect url that was given when the code was first created.</p> 
       <p>The sample server we have created provides the following error when the redirect_uri provided when getting an authorization code does not match the one with which the application first registered: <span style="color: black;">OAuth2Error: redirect_uri does not match</span></p> 
       <p>For a full cheat sheet with OAuth 2 vulnerabilities visit: <a href="http://www.oauthsecurity.com/">http://www.oauthsecurity.com/</a></p> 
       <h3>Authorization code implementation in our API</h3> 
       <p>Our API depends on Node.js <em>with Express, body and cookie parser, session, mongojs and mongodb for persistence and the node oauth2 server to facilitate the creation of the OAuth server.</em></p> 
       <p>We initialize our server with:</p> 
       <pre class="EnlighterJSRAW" data-enlighter-language="js">app.oauth = oauthserver({
    model: require('./model.js'), // See below for specification
    grants: ['password', 'authorization_code'],
    debug: true,
    accessTokenLifetime: 60 * 60 * 24,
    clientIdRegex: '^[A-Za-z0-9-_\^]{5,30}$'
});
</pre> 
       <p>We declare the model by requiring our custom module. We specify that we want to use two grant types – password and authorization code, set the app to development version ( debug: true), set the access token to last for 24 hours and declare that our client ids would consist of lower and uppercase Latin characters, numbers, -, _, ^ and would be between 5 and 30 characters in length.</p> 
       <p>The model in our MongoDB implementation uses the following collections:</p> 
       <pre class="EnlighterJSRAW" data-enlighter-language="js">collections = ['oauth_access_tokens', 'oauth_clients', "oauth_refresh_tokens", "users", 'oauth_codes'];
</pre> 
       <p><strong>oauth_clients</strong> contains the third-party apps that are going to get data from resource owners (their clientId,secretId and redirectUri), <strong>oauth_access_tokens</strong> contains the currently valid access tokens that were generated along with the client_id whose token this is, the user_id for which the token is valid and the expiry time of the token, <strong>users</strong> contains the username, the password and an id of the ordinary users and <strong>oauth_codes</strong> contains the authorization codes along with the client id and the user id associated with that code.</p> 
       <p>The documentation for node-oauth2-server could be found at: <a href="https://www.npmjs.com/package/node-oauth2-server">https://www.npmjs.com/package/node-oauth2-server</a>.</p> 
       <p>All dependencies could be installed with the node package manager (npm).</p> 
       <p>To enable the authorization code grant type, we add the <strong>saveAuthCode </strong>and <strong>getAuthCode</strong> to our OAuth model. getAuthCode finds a particular code in our database collection (when users attempt to use one) and saveAuthCode saves the code along with the client id (to identify the third-party application app) and user id (to identify the user whose data would be accessed by the third-party application) that the code belongs to.</p> 
       <p>In our routes (<em>routes.js</em>), we have allowed everybody to register as a user via <strong>getRegister</strong> and <strong>postRegister </strong>(the former shows the registration form while the latter adds the user to our database collection) and as a client (third-party app) through <strong>getClientRegister</strong> and<strong> postClientRegister </strong>(the former shows a form which only asks for a redirect URI while the latter generates a random client id and client secret and saves that data, along with the provided redirect URI, to a database collection.</p> 
       <p>Whenever a user issues a POST or a GET request to <em>/oauth/authorise</em>, we check if there is an existing session and if there is not – we ask him to login before getting the code. We presume the user allowed access to the app by setting allow to “yes” (an alternative should be introduced for live APIs that involves some sort of a prompt showing the application’s name and asking the user to confirm that he agrees the third-party application to use his data):</p> 
       <pre class="EnlighterJSRAW" data-enlighter-language="js">app.get('/oauth/authorise', function (req, res, next) {
    if (!req.session.user) {
        // If they aren't logged in, send them to your own login implementation
        return res.redirect('/login?redirect=' + req.path + '&amp;client_id=' +
        req.query.client_id + '&amp;redirect_uri=' + req.query.redirect_uri);
    }
    //TODO:  SHOW THEM  "do you authorise xyz app to access your content?" page

    req.body.allow = "yes";
    next();

}, app.oauth.authCodeGrant(function (req, next) {
    // The first param should to indicate an error
    // The second param should a bool to indicate if the user did authorise the app
    // The third param should for the user/uid (only used for passing to saveAuthCode)
    next(null, req.body.allow === 'yes', req.session.user, req.session.user);
}));
</pre> 
       <p>If the user is logged in – we redirect him to the provided website in redirect_uri with the code in the query string.</p> 
       <h2>Conclusion</h2> 
       <p>Creating an OAuth 2 server is not a task that should be taken lightly. There are many security loopholes that could be exploited, we have covered some of them and provided links for further examination. However, despite any possible vulnerabilities OAuth 2 is a great way to provide safe identity delegation between the users and the third party developers involved with your application. This is why we suggest that you catch up with the example OAuth 2 server/API we have set up and get a good idea of how OAuth2 ticks.</p> 
       <p>References:</p> 
       <p>1.Thom Seddon, ‘node-oauth2-server’, Available at: <a href="https://www.npmjs.com/package/node-oauth2-server">https://www.npmjs.com/package/node-oauth2-server</a></p> 
       <p>2. StackOverflow, ‘What exactly is oauthopen authorization’, Availableat: <a href="http://stackoverflow.com/questions/4201431/what-exactly-is-oauthopen-authorization">http://stackoverflow.com/questions/4201431/what-exactly-is-oauthopen-authorization</a></p> 
       <p>3. Egor Homakov, ‘The most Common OAuth 2 Vulnerability’, Available at: <a href="http://homakov.blogspot.com/2012/07/saferweb-most-common-oauth2.html">http://homakov.blogspot.com/2012/07/saferweb-most-common-oauth2.html</a></p> 
       <p>4. OAuth Security Cheat Sheet, Available at: <a href="http://www.oauthsecurity.com/">http://www.oauthsecurity.com/</a></p> 
       <p>5. SANS Institute InfoSec Reading Room, ‘Four Attacks on OAuth – How to Secure Your OAuth Implementation’, Available at: <a href="http://www.sans.org/reading-room/whitepapers/application/attacks-oauth-secure-oauth-implementation-33644">http://www.sans.org/reading-room/whitepapers/application/attacks-oauth-secure-oauth-implementation-33644</a></p> 
       <span id="tve_leads_end_content" style="display: block; visibility: hidden; border: 1px solid transparent;"></span>
       <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Computer Forensics Inline -->
       <div id="om-p9lcgn1lcvpid6p3lfub-holder"></div>
       <script>var p9lcgn1lcvpid6p3lfub,p9lcgn1lcvpid6p3lfub_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){p9lcgn1lcvpid6p3lfub_poll(function(){if(window['om_loaded']){if(!p9lcgn1lcvpid6p3lfub){p9lcgn1lcvpid6p3lfub=new OptinMonsterApp();return p9lcgn1lcvpid6p3lfub.init({"u":"23663.590981","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;p9lcgn1lcvpid6p3lfub=new OptinMonsterApp();p9lcgn1lcvpid6p3lfub.init({"u":"23663.590981","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
       <!-- / OptinMonster -->
       <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CISSP Inline -->
       <div id="om-uk4wn2utmtefqruz-holder"></div>
       <script>var uk4wn2utmtefqruz,uk4wn2utmtefqruz_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){uk4wn2utmtefqruz_poll(function(){if(window['om_loaded']){if(!uk4wn2utmtefqruz){uk4wn2utmtefqruz=new OptinMonsterApp();return uk4wn2utmtefqruz.init({"u":"23663.488458","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;uk4wn2utmtefqruz=new OptinMonsterApp();uk4wn2utmtefqruz.init({"u":"23663.488458","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
       <!-- / OptinMonster -->
       <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Hacking (2) -->
       <div id="om-hd2iobquwx6olkhr-holder"></div>
       <script>var hd2iobquwx6olkhr,hd2iobquwx6olkhr_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){hd2iobquwx6olkhr_poll(function(){if(window['om_loaded']){if(!hd2iobquwx6olkhr){hd2iobquwx6olkhr=new OptinMonsterApp();return hd2iobquwx6olkhr.init({"u":"23663.467922","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;hd2iobquwx6olkhr=new OptinMonsterApp();hd2iobquwx6olkhr.init({"u":"23663.467922","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
       <!-- / OptinMonster -->
       <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: SIQ Inline 2 -->
       <div id="om-gpztwxrnmljetile-holder"></div>
       <script>var gpztwxrnmljetile,gpztwxrnmljetile_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){gpztwxrnmljetile_poll(function(){if(window['om_loaded']){if(!gpztwxrnmljetile){gpztwxrnmljetile=new OptinMonsterApp();return gpztwxrnmljetile.init({"u":"23663.436119","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;gpztwxrnmljetile=new OptinMonsterApp();gpztwxrnmljetile.init({"u":"23663.436119","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
       <!-- / OptinMonster --> 
       <nav class="series-pagination"> 
        <ul> 
         <li class="prev"> <a href="http://resources.infosecinstitute.com/securing-web-apis-the-basics-with-node-js-examples/#article" rel="prev">Prev: The Basics with Node.js Examples</a> </li> 
        </ul> 
       </nav> 
      </article> 
      <section class="post-author large"> 
       <div class="image"> 
        <img alt="" src="http://0.gravatar.com/avatar/68c009556c0c9104aba8d570668efa2c?s=96&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/68c009556c0c9104aba8d570668efa2c?s=192&amp;d=mm&amp;r=g 2x" class="avatar avatar-96 photo" height="96" width="96"> 
       </div> 
       <div class="name"> 
        <span>Author</span> 
        <h5> <a href="http://resources.infosecinstitute.com/author/ivan-dimov">Ivan Dimov</a> </h5> 
       </div> 
       <div class="description">
         Ivan is a student of IT and Information Security. He is currently working toward a Master's degree in the field of Informatics in Sweden. He is also a freelance web developer engaged in both front-end and back-end coding and a tech writer. Whenever he is not in front of an Interned-enabled device, he is probably reading a print book or traveling. 
       </div> 
      </section> 
      <ul class="random-posts "> 
       <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//shutterstock_572805178_gray-237x237-c-default.png');"> <a class="icon post-l" href="http://resources.infosecinstitute.com/october-cybersecurity-awareness-month/" title="October is Cybersecurity Awareness Month"> <h3>October is Cybersecurity Awareness Month</h3> </a> </li> 
       <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//bigstock-Computer-Forensic-1266320-1-237x237-c-default.jpg');"> <a class="icon post-l" href="http://resources.infosecinstitute.com/mobile-forensics-process-steps-types/" title="The Mobile Forensics Process: Steps &amp; Types"> <h3>The Mobile Forensics Process: Steps &amp;…</h3> </a> </li> 
       <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//bigstock-Computer-Forensic-1266320-1-237x237-c-default.jpg');"> <a class="icon post-l" href="http://resources.infosecinstitute.com/evidence-acquisition-mobile-forensics/" title="Evidence Acquisition in Mobile Forensics"> <h3>Evidence Acquisition in Mobile Forensics</h3> </a> </li> 
       <li style="background-image: url('http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/uploads//bigstock-Computer-Forensic-1266320-1-237x237-c-default.jpg');"> <a class="icon post-l" href="http://resources.infosecinstitute.com/computer-forensics-forensic-science/" title="Computer Forensics: Forensic Science"> <h3>Computer Forensics: Forensic Science</h3> </a> </li> 
      </ul> 
      <div class="comments"> 
       <!-- You can start editing here. --> 
       <!-- If comments are open, but there are no comments. --> 
       <div id="respond" class="comment-respond"> 
        <h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/#respond" style="display:none;">Cancel reply</a></small></h3> 
        <form action="http://resources.infosecinstitute.com/wp-comments-post.php?wpe-comment-post=infosec" method="post" id="commentform" class="comment-form"> 
         <p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p>
         <p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required></textarea></p>
         <p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required="true" required></p> 
         <p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required></p> 
         <p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p> 
         <p class="cptch_block"><span class="cptch_wrap"> <label class="cptch_label" for="cptch_input_14"> <span class="cptch_span">8</span> <span class="cptch_span">&nbsp;+&nbsp;</span> <span class="cptch_span"><input id="cptch_input_14" class="cptch_input cptch_wp_comments" type="text" autocomplete="off" name="cptch_number" value="" maxlength="2" size="2" aria-required="true" required style="margin-bottom:0;display:inline;font-size: 12px;width: 40px;"></span> <span class="cptch_span">&nbsp;=&nbsp;</span> <span class="cptch_span">thirteen</span> <input type="hidden" name="cptch_result" value="nk8="> <input type="hidden" name="cptch_time" value="1507032990"> <input type="hidden" name="cptch_form" value="wp_comments"> </label><span class="cptch_reload_button_wrap hide-if-no-js"> 
            <noscript> 
             <style type="text/css">
							.hide-if-no-js {
								display: none !important;
							}
						</style> 
            </noscript> <span class="cptch_reload_button dashicons dashicons-update"></span> </span></span></p>
         <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="32322" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"> </p>
         <p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="ffbd3fa29d"></p>
         <p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="21"></p> 
        </form> 
       </div>
       <!-- #respond --> 
      </div> 
     </div> 
    </div> 
   </section> 
   <footer class="site-footer"> 
    <div class="ctas full"> 
     <div class="col-3-3 wrapper"> 
      <div class="col-1-3"> 
       <h6>About InfoSec</h6> 
       <p>InfoSec Institute is the best source for high quality <a href="http://www.infosecinstitute.com" style="color:#fff;">information security training</a>. We have been training Information Security and IT Professionals since 1998 with a diverse lineup of relevant training courses. In the past 16 years, over 50,000 individuals have trusted InfoSec Institute for their professional development needs! </p> 
      </div> 
      <div class="col-1-3"> 
       <h6>Connect with us</h6> 
       <p>Stay up to date with <a href="http://www.infosecinstitute.com" style="color:#fff;">InfoSec Institute</a> and <a href="http://www.intenseschool.com" style="color:#fff;">Intense School</a> - at info@infosecinstitute.com</p> 
       <ul class="footer-social"> 
        <li> 
         <div class="fb-like" data-href="http://resources.infosecinstitute.com" data-width="90" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div> </li> 
        <li> <a class="twitter-follow-button" href="https://twitter.com/infosecedu" data-show-count="false" data-lang="en">Follow @infosecedu</a> </li> 
       </ul> 
      </div> 
      <div class="col-1-3"> 
       <form action="https://go.pardot.com/l/12882/2016-08-24/2lhgfy" method="post" class="mailchimp has-loader" novalidate> 
        <aside> 
         <h6>Join our newsletter</h6> 
         <p>Get the latest news, updates &amp; offers straight to your inbox.</p> 
        </aside> 
        <fieldset> 
         <input type="email" title="Email address" value="" name="email" placeholder="Enter your email"> 
         <input type="submit" value="Subscribe" class="generic-cta green"> 
         <input type="hidden" name="url" value="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/"> 
        </fieldset> 
       </form> 
      </div> 
     </div> 
    </div> 
    <div class="navigation full"> 
     <div class="col-3-3 wrapper"> 
      <nav class="footer"> 
       <ul> 
       </ul> 
      </nav> 
      <div class="copyright">
       © InfoSec Resources 2017
      </div> 
     </div> 
    </div> 
   </footer> 
  </main> 
  <div class="modal"> 
   <div class="modal-inner"> 
    <a rel="modal:close">Close</a> 
    <div class="modal-content"></div> 
   </div> 
  </div> 
  <div id="modal-hidden"> 
   <div id="download"> 
    <div class="pardot form"> 
     <h4 class="pardot-title">File download</h4> 
     <form id="download-form" action="https://go.pardot.com/l/12882/2014-12-11/cqhcw" method="post">
      <input type="hidden" name="entry_title" value="Creating an API authenticated with OAuth 2 in Node.js"> 
      <input type="hidden" name="download_title" value="api security 2 --downloadables"> 
      <input type="hidden" name="resources_training" value=""> 
      <input type="hidden" name="url" value="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/"> 
      <input type="hidden" name="entry_id" value="32322"> 
      <input type="hidden" name="entry_url" value="http://resources.infosecinstitute.com/securing-web-apis-part-ii-creating-an-api-authenticated-with-oauth-2-in-node-js/"> 
      <input type="hidden" name="entry_type" value="Article"> 
      <ul> 
       <li data-required> <label>First Name</label> <input name="first_name"> </li> 
       <li data-required> <label>Last Name</label> <input name="last_name"> </li> 
       <li data-required> <label>Work Phone Number</label> <input name="phone"> </li> 
       <li data-required> <label>Work Email Address</label> <input name="email"> </li> 
       <li> <label>Job Title</label> <input name="job_title"> </li> 
       <li data-required class="training-why"> <label>Why Take This Training?</label> 
        <div class="dd"> 
         <select name="training_why"> <option value="I'm not interested in training" title="I'm not interested in training">I'm not interested in training</option> <option value="To get certified - company mandated" title="To get certified - company mandated">To get certified - company mandated</option> <option value="To get certified - my own reasons" title="To get certified - my own reasons">To get certified - my own reasons</option> <option value="To improve my skillset - get a promotion" title="To improve my skillset - get a promotion">To improve my skillset - get a promotion</option> <option value="To improve my skillset- for a new job" title="To improve my skillset- for a new job">To improve my skillset- for a new job</option> <option value="Other" title="Other">Other</option> </select> 
        </div> </li> 
       <li data-required class="training-fund" style="display: none;"> <label>How will you fund your training?</label> 
        <div class="dd"> 
         <select name="training_fund"> <option value="No current plan">No current plan</option> <option value="Employer Paid">Employer Paid</option> <option value="GI Bill">GI Bill</option> <option value="Tuition Assistance">Tuition Assistance</option> <option value="Self Pay">Self Pay</option> <option value="Other">Other</option> </select> 
        </div> </li> 
       <li data-required class="training-budget" style="display: none;"> <label>What is your training budget?</label> 
        <div class="dd"> 
         <select name="training_budget"> <option value="$500 and below">$500 and below</option> <option value="$1000-1499">$1000-1499</option> <option value="$1500-1999">$1500-1999</option> <option value="$2000-2499">$2000-2499</option> <option value="$2500-2999">$2500-2999</option> <option value="$3000 and up">$3000 and up</option> </select> 
        </div> </li> 
       <li class="full"> <input type="submit" class="generic-cta green" value="Download files"> </li> 
      </ul> 
      <p>InfoSec institute respects your privacy and will never use your personal information for anything other than to notify you of your requested course pricing. We will never sell your information to third parties. You will not be spammed.</p> 
      <div style="position:absolute; left:-9999px; top: -9999px;"> 
       <label for="pardot_extra_field">Comments</label> 
       <input type="text" id="pardot_extra_field" name="pardot_extra_field"> 
      </div> 
     </form> 
    </div> 
   </div> 
   <div id="skillset-modal"> 
    <div class="skillset window"> 
     <h4>What is Skillset?</h4> 
     <aside> 
      <div class="left"> 
       <h3>Skillset</h3> 
       <h5>Practice tests &amp; assessments.</h5> 
      </div> 
      <div class="right"> 
       <p>Practice for certification success with the Skillset library of over 100,000 practice test questions. We analyze your responses and can determine when you are ready to sit for the test. Along your journey to exam readiness, we will:</p> 
       <p></p> 
       <p>1. Determine which required skills your knowledge is sufficient<br> 2. Which required skills you need to work on<br> 3. Recommend specific skills to practice on next<br> 4. Track your progress towards a certification exam</p> 
      </div> 
     </aside> 
    </div> 
   </div> 
  </div> 
  <script src="//platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script> 
  <script>
window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
</script> 
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=552038044933986";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
  <script src="https://apis.google.com/js/platform.js" async defer></script> 
  <script src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/hideother.js"></script> 
  <script>var postID = 32322;</script> 
  <div id="tve_notification_box"></div>
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Computer Forensics - Full Screen -->
  <div id="om-ihligpdmbwl3n1dwoezx-holder"></div>
  <script>var ihligpdmbwl3n1dwoezx,ihligpdmbwl3n1dwoezx_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){ihligpdmbwl3n1dwoezx_poll(function(){if(window['om_loaded']){if(!ihligpdmbwl3n1dwoezx){ihligpdmbwl3n1dwoezx=new OptinMonsterApp();return ihligpdmbwl3n1dwoezx.init({"u":"23663.600047","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;ihligpdmbwl3n1dwoezx=new OptinMonsterApp();ihligpdmbwl3n1dwoezx.init({"u":"23663.600047","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CISA (Audit Keywords) -->
  <div id="om-lrikshcwqeyxzyxobg25-holder"></div>
  <script>var lrikshcwqeyxzyxobg25,lrikshcwqeyxzyxobg25_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){lrikshcwqeyxzyxobg25_poll(function(){if(window['om_loaded']){if(!lrikshcwqeyxzyxobg25){lrikshcwqeyxzyxobg25=new OptinMonsterApp();return lrikshcwqeyxzyxobg25.init({"u":"23663.624742","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;lrikshcwqeyxzyxobg25=new OptinMonsterApp();lrikshcwqeyxzyxobg25.init({"u":"23663.624742","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Data Recovery - Full Screen -->
  <div id="om-s4bygzypxogwvnknmct1-holder"></div>
  <script>var s4bygzypxogwvnknmct1,s4bygzypxogwvnknmct1_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){s4bygzypxogwvnknmct1_poll(function(){if(window['om_loaded']){if(!s4bygzypxogwvnknmct1){s4bygzypxogwvnknmct1=new OptinMonsterApp();return s4bygzypxogwvnknmct1.init({"u":"23663.602184","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;s4bygzypxogwvnknmct1=new OptinMonsterApp();s4bygzypxogwvnknmct1.init({"u":"23663.602184","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: VMware Resources (Virtualization KWs) -->
  <div id="om-ogeifq2oorrtxma5ndky-holder"></div>
  <script>var ogeifq2oorrtxma5ndky,ogeifq2oorrtxma5ndky_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){ogeifq2oorrtxma5ndky_poll(function(){if(window['om_loaded']){if(!ogeifq2oorrtxma5ndky){ogeifq2oorrtxma5ndky=new OptinMonsterApp();return ogeifq2oorrtxma5ndky.init({"u":"23663.599853","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;ogeifq2oorrtxma5ndky=new OptinMonsterApp();ogeifq2oorrtxma5ndky.init({"u":"23663.599853","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Penetration Testing (Pen-Test KWs) -->
  <div id="om-bd8g95xubycz6zxqh9l4-holder"></div>
  <script>var bd8g95xubycz6zxqh9l4,bd8g95xubycz6zxqh9l4_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){bd8g95xubycz6zxqh9l4_poll(function(){if(window['om_loaded']){if(!bd8g95xubycz6zxqh9l4){bd8g95xubycz6zxqh9l4=new OptinMonsterApp();return bd8g95xubycz6zxqh9l4.init({"u":"23663.599839","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;bd8g95xubycz6zxqh9l4=new OptinMonsterApp();bd8g95xubycz6zxqh9l4.init({"u":"23663.599839","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Penetration Testing (Pentest KWs) -->
  <div id="om-nlvf15z2pccrrqv0okfc-holder"></div>
  <script>var nlvf15z2pccrrqv0okfc,nlvf15z2pccrrqv0okfc_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){nlvf15z2pccrrqv0okfc_poll(function(){if(window['om_loaded']){if(!nlvf15z2pccrrqv0okfc){nlvf15z2pccrrqv0okfc=new OptinMonsterApp();return nlvf15z2pccrrqv0okfc.init({"u":"23663.599825","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;nlvf15z2pccrrqv0okfc=new OptinMonsterApp();nlvf15z2pccrrqv0okfc.init({"u":"23663.599825","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CISA (CISA Keywords) -->
  <div id="om-fil1gfkhsbvjkcfxcwet-holder"></div>
  <script>var fil1gfkhsbvjkcfxcwet,fil1gfkhsbvjkcfxcwet_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){fil1gfkhsbvjkcfxcwet_poll(function(){if(window['om_loaded']){if(!fil1gfkhsbvjkcfxcwet){fil1gfkhsbvjkcfxcwet=new OptinMonsterApp();return fil1gfkhsbvjkcfxcwet.init({"u":"23663.599841","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;fil1gfkhsbvjkcfxcwet=new OptinMonsterApp();fil1gfkhsbvjkcfxcwet.init({"u":"23663.599841","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: VMware Resources (VMware KWs) -->
  <div id="om-va7ijlqtrjbqswn562fi-holder"></div>
  <script>var va7ijlqtrjbqswn562fi,va7ijlqtrjbqswn562fi_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){va7ijlqtrjbqswn562fi_poll(function(){if(window['om_loaded']){if(!va7ijlqtrjbqswn562fi){va7ijlqtrjbqswn562fi=new OptinMonsterApp();return va7ijlqtrjbqswn562fi.init({"u":"23663.595175","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;va7ijlqtrjbqswn562fi=new OptinMonsterApp();va7ijlqtrjbqswn562fi.init({"u":"23663.595175","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Reverse Engineering - Full Screen -->
  <div id="om-yxdmfyy4qclclecx2s1e-holder"></div>
  <script>var yxdmfyy4qclclecx2s1e,yxdmfyy4qclclecx2s1e_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){yxdmfyy4qclclecx2s1e_poll(function(){if(window['om_loaded']){if(!yxdmfyy4qclclecx2s1e){yxdmfyy4qclclecx2s1e=new OptinMonsterApp();return yxdmfyy4qclclecx2s1e.init({"u":"23663.595155","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;yxdmfyy4qclclecx2s1e=new OptinMonsterApp();yxdmfyy4qclclecx2s1e.init({"u":"23663.595155","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: Penetration Testing (Penetration KWs) -->
  <div id="om-d6f4o6dqrdphcms8apee-holder"></div>
  <script>var d6f4o6dqrdphcms8apee,d6f4o6dqrdphcms8apee_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){d6f4o6dqrdphcms8apee_poll(function(){if(window['om_loaded']){if(!d6f4o6dqrdphcms8apee){d6f4o6dqrdphcms8apee=new OptinMonsterApp();return d6f4o6dqrdphcms8apee.init({"u":"23663.594919","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;d6f4o6dqrdphcms8apee=new OptinMonsterApp();d6f4o6dqrdphcms8apee.init({"u":"23663.594919","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: SIQ Overlay 3 -->
  <div id="om-ibybcxeinr9wvewm-holder"></div>
  <script>var ibybcxeinr9wvewm,ibybcxeinr9wvewm_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){ibybcxeinr9wvewm_poll(function(){if(window['om_loaded']){if(!ibybcxeinr9wvewm){ibybcxeinr9wvewm=new OptinMonsterApp();return ibybcxeinr9wvewm.init({"u":"23663.450140","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;ibybcxeinr9wvewm=new OptinMonsterApp();ibybcxeinr9wvewm.init({"u":"23663.450140","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CCSP Resources Articles - Full Screen -->
  <div id="om-rzuoi5lzba8jcqox-holder"></div>
  <script>var rzuoi5lzba8jcqox,rzuoi5lzba8jcqox_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){rzuoi5lzba8jcqox_poll(function(){if(window['om_loaded']){if(!rzuoi5lzba8jcqox){rzuoi5lzba8jcqox=new OptinMonsterApp();return rzuoi5lzba8jcqox.init({"u":"23663.477000","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;rzuoi5lzba8jcqox=new OptinMonsterApp();rzuoi5lzba8jcqox.init({"u":"23663.477000","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CISSP Resources Articles - Full Screen -->
  <div id="om-x0oxxeci9jeuf1ml-holder"></div>
  <script>var x0oxxeci9jeuf1ml,x0oxxeci9jeuf1ml_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){x0oxxeci9jeuf1ml_poll(function(){if(window['om_loaded']){if(!x0oxxeci9jeuf1ml){x0oxxeci9jeuf1ml=new OptinMonsterApp();return x0oxxeci9jeuf1ml.init({"u":"23663.474880","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="https://a.optnmstr.com/app/js/api.min.js",o.async=true,o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;x0oxxeci9jeuf1ml=new OptinMonsterApp();x0oxxeci9jeuf1ml.init({"u":"23663.474880","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
  <!-- / OptinMonster -->
  <script type="text/javascript">
<!--
piCId = '1951';
piAId = '13882';


(function() {
	function async_load(){
		var s = document.createElement('script'); s.type = 'text/javascript';
		s.src = ('https:' == document.location.protocol ? 'https://pi' : 'http://cdn') + '.pardot.com/pd.js';
		var c = document.getElementsByTagName('script')[0]; c.parentNode.insertBefore(s, c);
	}
	if(window.attachEvent) { window.attachEvent('onload', async_load); }
	else { window.addEventListener('load', async_load, false); }
})();
-->
</script> 
  <script type="text/javascript">var p9lcgn1lcvpid6p3lfub_shortcode = true;var uk4wn2utmtefqruz_shortcode = true;var hd2iobquwx6olkhr_shortcode = true;var gpztwxrnmljetile_shortcode = true;var ihligpdmbwl3n1dwoezx_shortcode = true;var lrikshcwqeyxzyxobg25_shortcode = true;var s4bygzypxogwvnknmct1_shortcode = true;var ogeifq2oorrtxma5ndky_shortcode = true;var bd8g95xubycz6zxqh9l4_shortcode = true;var nlvf15z2pccrrqv0okfc_shortcode = true;var fil1gfkhsbvjkcfxcwet_shortcode = true;var va7ijlqtrjbqswn562fi_shortcode = true;var yxdmfyy4qclclecx2s1e_shortcode = true;var d6f4o6dqrdphcms8apee_shortcode = true;var ibybcxeinr9wvewm_shortcode = true;var rzuoi5lzba8jcqox_shortcode = true;var x0oxxeci9jeuf1ml_shortcode = true;</script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/akismet/_inc/form.js?ver=3.3.4"></script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/themes/infosec/app.js"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var tve_dash_front = {"ajaxurl":"http:\/\/resources.infosecinstitute.com\/wp-admin\/admin-ajax.php","is_crawler":""};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/thrive-leads/thrive-dashboard/js/dist/frontend.min.js?ver=1.0.38"></script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-includes/js/wp-embed.min.js?ver=4.8.2"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var cptch_vars = {"nonce":"a690f59b75","ajaxurl":"http:\/\/resources.infosecinstitute.com\/wp-admin\/admin-ajax.php","enlarge":"0"};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://2we26u4fam7n16rz3a44uhbe1bq2.wpengine.netdna-cdn.com/wp-content/plugins/captcha/js/front_end_script.js?ver=4.8.2"></script> 
  <script type="text/javascript">/*<![CDATA[*/if ( !window.TL_Const ) var TL_Const={"security":"eba4d5e73d","ajax_url":"\/\/resources.infosecinstitute.com\/wp-admin\/admin-ajax.php","forms":[],"action_conversion":"tve_leads_ajax_conversion","action_impression":"tve_leads_ajax_impression","ajax_load":0,"custom_post_data":[],"current_screen":{"screen_type":4,"screen_id":32322},"ignored_fields":["email","_captcha_size","_captcha_theme","_captcha_type","_submit_option","_use_captcha","g-recaptcha-response","__tcb_lg_fc","__tcb_lg_msg","_state","_form_type","_error_message_option","_back_url","_submit_option","url","_asset_group","_asset_option","mailchimp_optin"]}/*]]> */</script> 
  <script type="text/javascript">var omapi_localized = { ajax: 'http://resources.infosecinstitute.com/wp-admin/admin-ajax.php?optin-monster-ajax-route=1', nonce: 'd71682f12d' };</script>  
 </body>
</html>