<!doctype html>
<html lang="en-US">
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <title>Spring Security using Custom Authentication Provider | Java Guide</title> 
  <title>Spring Security using Custom Authentication Provider – Java Guide</title> 
  <link rel="alternate" type="application/rss+xml" title="Java Guide » Spring Security using Custom Authentication Provider Comments Feed" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/feed/"> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/javainsimpleway.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.3"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <link rel="stylesheet" id="bwp-syntax-css" href="http://javainsimpleway.com/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax.css?ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="adsns-css" href="http://javainsimpleway.com/wp-content/plugins/adsense-plugin/css/adsns.css?v=1.40&amp;ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="cptch_stylesheet-css" href="http://javainsimpleway.com/wp-content/plugins/captcha/css/front_end_style.css?ver=4.2.8" type="text/css" media="all"> 
  <link rel="stylesheet" id="dashicons-css" href="http://javainsimpleway.com/wp-includes/css/dashicons.min.css?ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="cptch_desktop_style-css" href="http://javainsimpleway.com/wp-content/plugins/captcha/css/desktop_style.css?ver=4.2.8" type="text/css" media="all"> 
  <link rel="stylesheet" id="style-code-css" href="http://javainsimpleway.com/wp-content/plugins/code-highlight/css/style.css?ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="contact-form-7-css" href="http://javainsimpleway.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=4.4.1" type="text/css" media="all"> 
  <link rel="stylesheet" id="new_style-css" href="http://javainsimpleway.com/wp-content/plugins/responsive-attention-box/css/common.css?ver=1.0.0" type="text/css" media="all"> 
  <link rel="stylesheet" id="sab-plugin-css" href="http://javainsimpleway.com/wp-content/plugins/simple-author-box/css/simple-author-box.min.css?ver=v1.5" type="text/css" media="all"> 
  <link rel="stylesheet" id="nb-font-css" href="http://fonts.googleapis.com/css?family=Lato:400,100,100italic,300,300italic,400italic,700,700italic,900,900italic%7CMontserrat:400,700%7COpen+Sans:400,600,700,300%7CLibre+Baskerville:400,700%7CPlayfair:400,700%7CDroid+Serif:400,700%7CPT+Serif:400,700%7CNoto+Serif:400,700" type="text/css" media="all"> 
  <link rel="stylesheet" id="style-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/style.css" type="text/css" media="all"> 
  <link rel="stylesheet" id="bootstrap-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/bootstrap.css" type="text/css" media="all"> 
  <link rel="stylesheet" id="global-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/global.css" type="text/css" media="all"> 
  <link rel="stylesheet" id="font-awesome-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/font-awesome.css" type="text/css" media="all"> 
  <link rel="stylesheet" id="font-awesome-animation-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/font-awesome-animation.css" type="text/css" media="all"> 
  <link rel="stylesheet" id="main-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/nb-style.css" type="text/css" media="all"> 
  <link rel="stylesheet" id="desktop-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/desktop.css" type="text/css" media="screen and (min-width:768px)"> 
  <link rel="stylesheet" id="tablet-css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/tablet.css" type="text/css" media="screen and (min-width:768px) and (max-width:1023px)"> 
  <link rel="stylesheet" id="support.css-css" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/support.css" type="text/css" media="all"> 
  <!--[if lt IE 9]>
<link rel='stylesheet' id='ielt9-css-css'  href='http://javainsimpleway.com/wp-content/themes/nicebird/assets/css/all-ie.css' type='text/css' media='all' />
<![endif]--> 
  <link rel="stylesheet" id="sbscrbr_form_style-css" href="http://javainsimpleway.com/wp-content/plugins/subscriber/css/frontend_style.css?ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="tablepress-default-css" href="http://javainsimpleway.com/wp-content/plugins/tablepress/css/default.min.css?ver=1.7" type="text/css" media="all"> 
  <link rel="stylesheet" id="an_style-css" href="http://javainsimpleway.com/wp-content/uploads/2I3RAEoDZJ5K/WPt8PeQDh4P4.css?ver=2.0.9" type="text/css" media="all"> 
  <style id="an_style-inline-css" type="text/css">
/*	an_style.css	AdBlock Notify	Copyright: (c) 2016 Themeisle, themeisle.com	Version: 2.0.9*/.YcnlXb2PJUx9-bg {	display: none;	position: fixed;	z-index: 100;	top: 0;	left: 0;	width: 100%;	height: 100%;	background: #000;	background: rgba(0,0,0,0.75);}.YcnlXb2PJUx9 {	visibility: hidden;	position: fixed;	z-index: 101;	top: 100px;	right: 0;	left: 0;	max-width: 640px;	margin-right: auto;	margin-left: auto;	background: #fff;	-webkit-box-shadow: 0 3px 5px 2px rgba(0,0,0,0.25);	box-shadow: 0 3px 5px 2px rgba(0,0,0,0.25);	font-family: Arial, Helvetica, sans-serif;}.YcnlXb2PJUx9-default,.YcnlXb2PJUx9-ok {	padding: 30px 30px 15px;}.YcnlXb2PJUx9-image {	overflow: hidden;	position: relative;	width: 100%;}.YcnlXb2PJUx9-image .YcnlXb2PJUx9-left {	position: absolute;	top: 0;	left: 0;	width: 50%;	height: 100%;}.YcnlXb2PJUx9-image .YcnlXb2PJUx9-right {	float: right;	width: 50%;	padding: 30px;}.YcnlXb2PJUx9.small {	width: 200px;	margin-left: -140px;}.YcnlXb2PJUx9.medium {	width: 400px;	margin-left: -240px;}.YcnlXb2PJUx9.large {	width: 600px;	margin-left: -340px;}.YcnlXb2PJUx9.xlarge {	width: 800px;	margin-left: -440px;}.close-YcnlXb2PJUx9 {	display: inline-block;	position: absolute;	top: 15px;	right: 15px;	width: 30px;	height: 30px;	color: #bbb;	font-size: 32px;	font-weight: 700;	line-height: 30px;	text-align: center;	cursor: pointer;	-webkit-transition: 0.3s;	transition: 0.3s;}.close-YcnlXb2PJUx9:hover {	color: #252b37;}.YcnlXb2PJUx9 h1 {	margin-bottom: 15px;	padding: 0 30px;	color: #252b37;	font-size: 28px;	line-height: 1.25;	text-align: center;}.YcnlXb2PJUx9-right h1 {	padding: 0 30px 0 0;	text-align: left;}.YcnlXb2PJUx9 p {	margin-bottom: 15px;	color: #333745;	font-size: 14px;}.YcnlXb2PJUx9 p a {	color: #ff6160;}.YcnlXb2PJUx9-right .close-modal,.YcnlXb2PJUx9-footer .close-modal {	padding: 15px !important;	border-radius: 0 !important;	background-color: #ff6160;	font-size: 14px;	letter-spacing: 2px !important;	-webkit-transition: 0.3s;	transition: 0.3s;}.YcnlXb2PJUx9-right .close-modal:hover,.YcnlXb2PJUx9-footer .close-modal:hover {	background-color: #252b37 !important;}.YcnlXb2PJUx9-footer .grey-button-modal {	margin-right: 15px;	background-color: #a5a5a5;}.YcnlXb2PJUx9-footer {	display: block;	padding: 15px 30px;	background-color: #eff4f7;	text-align: right;}@media only screen and (max-width: 640px) {	.YcnlXb2PJUx9 {		right: 5%;		left: 5%;		max-width: 90%;	}	.YcnlXb2PJUx9-default {		padding: 20px;	}	.YcnlXb2PJUx9-image .YcnlXb2PJUx9-left {		width: 100%;		height: 250px;	}	.YcnlXb2PJUx9-image .YcnlXb2PJUx9-right {		float: left;		width: 100%;		margin-top: 250px;		padding: 20px;	}	.YcnlXb2PJUx9 h1 {		margin-bottom: 10px;		font-size: 20px;	}	.YcnlXb2PJUx9-right h1 {		padding: 0;	}	.YcnlXb2PJUx9 p {		margin-bottom: 10px;	}	.close-YcnlXb2PJUx9 {		color: #fcfcfc;		background-color: #252b37;	}	.close-YcnlXb2PJUx9:hover {		color: #252b37;		background-color: #fcfcfc;	}	.YcnlXb2PJUx9-footer {		padding: 15px 20px;	}}@media only screen and (max-width: 480px) {	.YcnlXb2PJUx9-image .YcnlXb2PJUx9-left {		height: 200px;	}	.YcnlXb2PJUx9-image .YcnlXb2PJUx9-right {		margin-top: 200px;	}	.YcnlXb2PJUx9-footer {		text-align: center;	}	.YcnlXb2PJUx9-footer .close-modal {		width: 80%;		margin: 5px 10%;	}}
</style> 
  <link rel="stylesheet" id="wpmu-animate-min-css-css" href="http://javainsimpleway.com/wp-content/plugins/wordpress-popup/css/animate.min.css?ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="font-awesome-css" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css?ver=4.5.3" type="text/css" media="all"> 
  <link rel="stylesheet" id="stbCoreCSS-css" href="http://javainsimpleway.com/wp-content/plugins/wp-special-textboxes/css/stb-core.css?ver=5.4.98" type="text/css" media="all"> 
  <link rel="stylesheet" id="stbCSS-css" href="http://javainsimpleway.com/wp-content/plugins/wp-special-textboxes/css/wp-special-textboxes.css.php?ver=5.4.98" type="text/css" media="all"> 
  <link rel="stylesheet" id="A2A_SHARE_SAVE-css" href="http://javainsimpleway.com/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.12" type="text/css" media="all"> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-includes/js/jquery/jquery.js?ver=1.12.4"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.5.3"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var sbscrbr_js_var = {"preloaderIconPath":"http:\/\/javainsimpleway.com\/wp-content\/plugins\/subscriber\/images\/preloader.gif"};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/subscriber/js/form_script.js?ver=4.5.3"></script> 
  <link rel="https://api.w.org/" href="http://javainsimpleway.com/wp-json/"> 
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://javainsimpleway.com/xmlrpc.php?rsd"> 
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://javainsimpleway.com/wp-includes/wlwmanifest.xml"> 
  <link rel="prev" title="SIB,IIB and Examples on SIB and IIB" href="http://javainsimpleway.com/sibiib-and-examples-on-sib-and-iib/"> 
  <link rel="next" title="Spring MVC file download" href="http://javainsimpleway.com/spring-mvc-file-download/"> 
  <meta name="generator" content="WordPress 4.5.3"> 
  <link rel="canonical" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/"> 
  <link rel="shortlink" href="http://javainsimpleway.com/?p=520"> 
  <link rel="alternate" type="application/json+oembed" href="http://javainsimpleway.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F"> 
  <link rel="alternate" type="text/xml+oembed" href="http://javainsimpleway.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F&amp;format=xml"> 
  <script type="text/javascript"><!--
var a2a_config=a2a_config||{},wpa2a={done:false,html_done:false,script_ready:false,script_load:function(){var a=document.createElement('script'),s=document.getElementsByTagName('script')[0];a.type='text/javascript';a.async=true;a.src='http://static.addtoany.com/menu/page.js';s.parentNode.insertBefore(a,s);wpa2a.script_load=function(){};},script_onready:function(){wpa2a.script_ready=true;if(wpa2a.html_done)wpa2a.init();},init:function(){for(var i=0,el,target,targets=wpa2a.targets,length=targets.length;i<length;i++){el=document.getElementById('wpa2a_'+(i+1));target=targets[i];a2a_config.linkname=target.title;a2a_config.linkurl=target.url;if(el){a2a.init('page',{target:el});el.id='';}wpa2a.done=true;}wpa2a.targets=[];}};a2a_config.callbacks=a2a_config.callbacks||[];a2a_config.callbacks.push({ready:wpa2a.script_onready});a2a_config.templates=a2a_config.templates||{};
//--></script> 
  <meta name="google-site-verification" content="zke7WQayxG_iRPcuuLd8TPQ7daIwmnvuvUVxdUsz110">
  <meta name="google-site-verification" content="zke7WQayxG_iRPcuuLd8TPQ7daIwmnvuvUVxdUsz110">
  <link rel="stylesheet/less" href="http://javainsimpleway.com/wp-content/themes/nicebird/assets/options/skin.less"> 
  <link rel="shortcut icon" type="image/x-icon" href="http://javainsimpleway.com/wp-content/uploads/2016/09/logo_final.jpg"> 
  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
<![endif]-->
  <script>
                    /* <![CDATA[ */
                    var nbSliderEffectOption = 'slide';
                    /* ]]> */
        </script> 
  <style type="text/css">.saboxplugin-wrap .saboxplugin-gravatar img {-webkit-border-radius:50%;-moz-border-radius:50%;-ms-border-radius:50%;-o-border-radius:50%;border-radius:50%;}.saboxplugin-wrap .saboxplugin-authorname a {color:#000000;}.saboxplugin-wrap {margin-top:0px;}.saboxplugin-wrap {margin-bottom:0px;}.saboxplugin-wrap .saboxplugin-authorname {font-size:20px; line-height:27px;}.saboxplugin-wrap .saboxplugin-desc {font-size:14px; line-height:21px;}.saboxplugin-wrap .saboxplugin-web {font-size:14px;}.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-color {font-size:21px;}.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-color:before {width:36px; height:36px; line-height:37px; }.saboxplugin-wrap .saboxplugin-socials .saboxplugin-icon-grey {font-size:18px;}</style>
  <meta data-pso-pv="1.2.1" data-pso-pt="singlePost" data-pso-th="a3182b677eda9c895010876789a15d10">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script pagespeed_no_defer="" data-pso-version="20170403_083938">window.dynamicgoogletags={config:[]};dynamicgoogletags.config=["ca-pub-9157887158094484",[[]],[[[[null,[[120,139]],null,19,1,1],[null,[[280,299]],null,30,1,1],[null,[[360,399],[460,519]],null,33,1,1]],[[["BODY",0,null,[]],["10px","10px",1],1,[4],null,0,null,null,2],[["BODY",0,null,[]],["10px","10px",1],2,[5],null,0,null,null,2],[["HEADER",0,null,[]],["10px","10px",1],1,[4],null,0,null,null,4],[["HEADER",0,null,[]],["10px","10px",1],2,[2],null,0,null,null,4],[["HEADER",0,null,[]],["10px","10px",1],3,[2],null,0,null,null,4],[["DIV",null,null,["header-wrap"]],["10px","10px",1],0,[4],null,0,null,null,5],[["LI",null,null,["selected"]],["10px","10px",1],2,[2],null,0,null,null,9],[["DIV",null,null,["single-page-paging"]],["10px","10px",1],0,[1],null,0,null,null,8],[["DIV",null,"comments",[]],["10px","10px",1],0,[1],null,0,null,null,9],[["DIV",null,"respond",[]],["10px","10px",1],3,[3],null,0,null,null,10],[["DIV",null,null,["footer-logo"]],["10px","23px",1],3,[3],null,0,null,null,8],[["DIV",0,null,["post-content-body"],1],["10px","20px",0],0,[0],null,0,null,null,10],[["DIV",0,null,["post-content-body"],2],["10px","10px",0],0,[0],null,0],[["DIV",0,null,["post-content-body"],3],["10px","10px",0],0,[0],null,0],[["DIV",0,null,["post-content-body"],-1],["10px","20px",0],3,[0],null,0,null,null,10],[["DIV",null,"respond",[]],["10px","20px",1],0,[1],null,0,null,null,10]],["1972339457","3449072654","4925805851","6402539052","7879272258"],["DIV",null,null,["post-content-body"]],"20170214_040801",3]],"WordPressSinglePost","6744828251",null,0.01,null,[null,1494921232715],0.01,0,null,null,"http://javainsimpleway.com"];(function(){var h=this,aa=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},p=function(a){return"number"==typeof a},ba=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}},r=function(a,b){function c(){}c.prototype=b.prototype;a.Ra=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ta=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,
d)}};var ca=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},da=function(a,b){return a<b?-1:a>b?1:0},ea=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};var fa=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e="string"==typeof a?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};var ga=function(a){ga[" "](a);return a};ga[" "]=function(){};var ia=function(a,b){var c=ha;Object.prototype.hasOwnProperty.call(c,a)||(c[a]=b(a))};var t;a:{var ja=h.navigator;if(ja){var ka=ja.userAgent;if(ka){t=ka;break a}}t=""}var v=function(a){return-1!=t.indexOf(a)};var la=v("Opera"),w=v("Trident")||v("MSIE"),ma=v("Edge"),na=v("Gecko")&&!(-1!=t.toLowerCase().indexOf("webkit")&&!v("Edge"))&&!(v("Trident")||v("MSIE"))&&!v("Edge"),oa=-1!=t.toLowerCase().indexOf("webkit")&&!v("Edge"),pa=function(){var a=h.document;return a?a.documentMode:void 0},qa;
a:{var ra="",sa=function(){var a=t;if(na)return/rv\:([^\);]+)(\)|;)/.exec(a);if(ma)return/Edge\/([\d\.]+)/.exec(a);if(w)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(oa)return/WebKit\/(\S+)/.exec(a);if(la)return/(?:Version)[ \/]?(\S+)/.exec(a)}();sa&&(ra=sa?sa[1]:"");if(w){var ta=pa();if(null!=ta&&ta>parseFloat(ra)){qa=String(ta);break a}}qa=ra}
var ua=qa,ha={},va=function(a){ia(a,function(){for(var b=0,c=ca(String(ua)).split("."),d=ca(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"";do{g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];k=/(\d*)(\D*)(.*)/.exec(k)||["","","",""];if(0==g[0].length&&0==k[0].length)break;b=da(0==g[1].length?0:parseInt(g[1],10),0==k[1].length?0:parseInt(k[1],10))||da(0==g[2].length,0==k[2].length)||da(g[2],k[2]);g=g[3];k=k[3]}while(0==b)}return 0<=b})},wa;var xa=h.document;
wa=xa&&w?pa()||("CSS1Compat"==xa.compatMode?parseInt(ua,10):5):void 0;var x=function(){},ya="function"==typeof Uint8Array,z=function(a,b,c){a.a=null;b||(b=[]);a.Va=void 0;a.M=-1;a.l=b;a:{if(a.l.length){b=a.l.length-1;var d=a.l[b];if(d&&"object"==typeof d&&"array"!=aa(d)&&!(ya&&d instanceof Uint8Array)){a.R=b-a.M;a.G=d;break a}}a.R=Number.MAX_VALUE}a.Ua={};if(c)for(b=0;b<c.length;b++)d=c[b],d<a.R?(d+=a.M,a.l[d]=a.l[d]||y):a.G[d]=a.G[d]||y},y=[],A=function(a,b){if(b<a.R){b+=a.M;var c=a.l[b];return c===y?a.l[b]=[]:c}c=a.G[b];return c===y?a.G[b]=[]:c},Aa=function(a){a=
A(za,a);return null==a?a:+a},B=function(a,b,c){b<a.R?a.l[b+a.M]=c:a.G[b]=c},C=function(a,b,c){a.a||(a.a={});if(!a.a[c]){var d=A(a,c);d&&(a.a[c]=new b(d))}return a.a[c]},D=function(a,b,c){a.a||(a.a={});if(!a.a[c]){for(var d=A(a,c),e=[],f=0;f<d.length;f++)e[f]=new b(d[f]);a.a[c]=e}b=a.a[c];b==y&&(b=a.a[c]=[]);return b},Ba=function(a,b,c){a.a||(a.a={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=E(c[e]);a.a[b]=c;B(a,b,d)},Ca=function(a){if(a.a)for(var b in a.a){var c=a.a[b];if("array"==aa(c))for(var d=
0;d<c.length;d++)c[d]&&E(c[d]);else c&&E(c)}},E=function(a){Ca(a);return a.l};x.prototype.toString=function(){Ca(this);return this.l.toString()};var Da=function(a){var b;if("array"==aa(a)){for(var c=Array(a.length),d=0;d<a.length;d++)null!=(b=a[d])&&(c[d]="object"==typeof b?Da(b):b);return c}if(ya&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(d in a)null!=(b=a[d])&&(c[d]="object"==typeof b?Da(b):b);return c};var Ea=function(a,b){this.events=[];this.Ga=b||h;var c=null;b&&(b.google_js_reporting_queue=b.google_js_reporting_queue||[],this.events=b.google_js_reporting_queue,c=b.google_measure_js_timing);this.ia=null!=c?c:Math.random()<a};Ea.prototype.disable=function(){fa(this.events,this.ya,this);this.events.length=0;this.ia=!1};Ea.prototype.ya=function(a){var b=this.Ga.performance;a&&b&&b.clearMarks&&(b.clearMarks("goog_"+a.uniqueId+"_start"),b.clearMarks("goog_"+a.uniqueId+"_end"))};var Fa=function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});h.addEventListener("test",null,b)}catch(c){}return a}();var Ha=function(){var a=Ga;try{var b;if(b=!!a&&null!=a.location.href)a:{try{ga(a.foo);b=!0;break a}catch(c){}b=!1}return b}catch(c){return!1}},Ia=function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.call(void 0,a[c],c,a)};var Ja=function(a,b,c,d,e){this.la=c||4E3;this.H=a||"&";this.wa=b||",$";this.T=void 0!==d?d:"trn";this.Sa=e||null;this.va=!1;this.V={};this.Ja=0;this.L=[]},Ma=function(a,b,c,d){b=b+"//"+c+d;var e=Ka(a)-d.length-0;if(0>e)return"";a.L.sort(function(a,b){return a-b});d=null;c="";for(var f=0;f<a.L.length;f++)for(var g=a.L[f],k=a.V[g],m=0;m<k.length;m++){if(!e){d=null==d?g:d;break}var l=La(k[m],a.H,a.wa);if(l){l=c+l;if(e>=l.length){e-=l.length;b+=l;c=a.H;break}else a.va&&(c=e,l[c-1]==a.H&&--c,b+=l.substr(0,
c),c=a.H,e=0);d=null==d?g:d}}f="";a.T&&null!=d&&(f=c+a.T+"="+(a.Sa||d));return b+f+""},Ka=function(a){if(!a.T)return a.la;var b=1,c;for(c in a.V)b=c.length>b?c.length:b;return a.la-a.T.length-b-a.H.length-1},La=function(a,b,c,d,e){var f=[];Ia(a,function(a,k){(a=Na(a,b,c,d,e))&&f.push(k+"="+a)});return f.join(b)},Na=function(a,b,c,d,e){if(null==a)return"";b=b||"&";c=c||",$";"string"==typeof c&&(c=c.split(""));if(a instanceof Array){if(d=d||0,d<c.length){for(var f=[],g=0;g<a.length;g++)f.push(Na(a[g],
b,c,d+1,e));return f.join(c[d])}}else if("object"==typeof a)return e=e||0,2>e?encodeURIComponent(La(a,b,c,d,e+1)):"...";return encodeURIComponent(String(a))};var Ra=function(a,b,c,d){var e=Pa;if((c?e.Pa:Math.random())<(d||e.za))try{var f;b instanceof Ja?f=b:(f=new Ja,Ia(b,function(a,b){var c=f,d=c.Ja++,e={};e[b]=a;a=[e];c.L.push(d);c.V[d]=a}));var g=Ma(f,e.Ma,e.Ba,e.La+a+"&");g&&Qa(g)}catch(k){}},Qa=function(a){h.google_image_requests||(h.google_image_requests=[]);var b=h.document.createElement("img");b.src=a;h.google_image_requests.push(b)};var Sa;if(!(Sa=!na&&!w)){var Ta;if(Ta=w)Ta=9<=Number(wa);Sa=Ta}Sa||na&&va("1.9.1");w&&va("9");var F=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};F.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};var Ua=document,Va=window;var Wa=!!window.google_async_iframe_id,Ga=Wa&&window.parent||window;var Pa,G;if(Wa&&!Ha()){var Xa="."+Ua.domain;try{for(;2<Xa.split(".").length&&!Ha();)Ua.domain=Xa=Xa.substr(Xa.indexOf(".")+1),Ga=window.parent}catch(a){}Ha()||(Ga=window)}G=Ga;var Ya=new Ea(1,G);Pa=new function(){this.Ma="http:"===Va.location.protocol?"http:":"https:";this.Ba="pagead2.googlesyndication.com";this.La="/pagead/gen_204?id=";this.za=.01;this.Pa=Math.random()};
if("complete"==G.document.readyState)G.google_measure_js_timing||Ya.disable();else if(Ya.ia){var Za=function(){G.google_measure_js_timing||Ya.disable()};G.addEventListener?G.addEventListener("load",Za,Fa?void 0:!1):G.attachEvent&&G.attachEvent("onload",Za)};var H=function(a){this.na={};this.na.c=a;this.o=[];this.u=null;this.v=[];this.ea=0};H.prototype.g=function(a){for(var b=0;b<this.o.length;b++)if(this.o[b]==a)return this;this.o.push(a);return this};var $a=function(a,b){a.u=a.u?a.u:b;return a};H.prototype.C=function(a){for(var b=0;b<this.v.length;b++)if(this.v[b]==a)return this;this.v.push(a);return this};
H.prototype.getData=function(a){var b=this.na,c={},d;for(d in b)c[d]=b[d];0<this.ea&&(c.t=this.ea);c.err=this.o.join();c.warn=this.v.join();if(this.u){c.excp_n=this.u.name;c.excp_m=this.u.message&&this.u.message.substring(0,512);if(b=this.u.stack){d=this.u.stack;try{-1==d.indexOf("")&&(d="\n"+d);for(var e;d!=e;)e=d,d=d.replace(/((https?:\/..*\/)[^\/:]*:\d+(?:.|\n)*)\2/,"$1");b=d.replace(/\n */g,"\n")}catch(f){b=""}}c.excp_s=b}c.w=0<a.innerWidth?a.innerWidth:null;c.h=0<a.innerHeight?a.innerHeight:
null;return c};var bb=function(a,b){ab(a,a.Ea,a.X,b)},ab=function(a,b,c,d){var e=d.u;d=d.getData(a.K);a.Ha?(d.type=b,a.K.console.log(d),e&&a.K.console.error(e)):0<c&&(d.r=c,Ra(b,d,"jserror"!=b,c))};var I=function(a){return a.dynamicgoogletags=a.dynamicgoogletags||{}};var J=function(a){z(this,a,cb)};r(J,x);var cb=[4];J.prototype.getId=function(){return A(this,3)};var K=function(a){z(this,a,null)};r(K,x);var db=function(a){z(this,a,null)};r(db,x);var L=function(a){return C(a,J,1)},fb=function(a){z(this,a,eb)};r(fb,x);var eb=[1];fb.prototype.i=function(){return D(this,db,1)};fb.prototype.pa=function(a){Ba(this,1,a)};var M=function(a){z(this,a,gb)};r(M,x);var gb=[2];M.prototype.ka=function(){return A(this,3)};M.prototype.qa=function(a){B(this,3,a)};var hb=function(a){z(this,a,null)};r(hb,x);var N=function(a){z(this,a,ib)};r(N,x);var ib=[1,2,3];N.prototype.i=function(){return D(this,db,2)};
N.prototype.pa=function(a){Ba(this,2,a)};var O=function(a){z(this,a,jb)};r(O,x);var jb=[3];O.prototype.A=function(){return A(this,1)};O.prototype.D=function(){return C(this,fb,2)};O.prototype.O=function(){return A(this,4)};O.prototype.ka=function(){return A(this,5)};O.prototype.qa=function(a){B(this,5,a)};O.prototype.N=function(){return C(this,kb,9)};var kb=function(a){z(this,a,null)};r(kb,x);var lb=function(a){this.m=a;this.sa=[]};lb.prototype.f=function(){return 0<D(this.m,N,3).length?D(this.m,N,3)[0]:null};var mb=function(a){var b=["adsbygoogle-placeholder"];a=a.className?a.className.split(/\s+/):[];for(var c={},d=0;d<a.length;++d)c[a[d]]=!0;for(d=0;d<b.length;++d)if(!c[b[d]])return!1;return!0};var nb=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=ea(d.Wa);a[e]=d.value}},qb=function(a,b){var c=ob;b.setAttribute("data-adsbygoogle-status","reserved");b={element:b};(c=c&&c.Na)&&(b.params=c);pb(a).push(b)},pb=function(a){return a.adsbygoogle=a.adsbygoogle||[]};var rb=function(a,b){if(!a)return!1;a=b.getComputedStyle?b.getComputedStyle(a,null):a.currentStyle;if(!a)return!1;a=a.cssFloat||a.styleFloat;return"left"==a||"right"==a},sb=function(a){for(a=a.previousSibling;a&&1!=a.nodeType;)a=a.previousSibling;return a?a:null},tb=function(a){return!!a.nextSibling||!!a.parentNode&&tb(a.parentNode)};var ub=function(a,b){var c=a.length;if(null!=c)for(var d=0;d<c;d++)b.call(void 0,a[d],d)};var vb=function(a,b,c,d){this.ma=a;this.$=b;this.aa=c;this.P=d};vb.prototype.query=function(a){var b=[];try{b=a.querySelectorAll(this.ma)}catch(f){}if(!b.length)return[];a=b;b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];a=c}else a=[];a=wb(this,a);p(this.$)&&(b=this.$,0>b&&(b+=a.length),a=0<=b&&b<a.length?[a[b]]:[]);if(p(this.aa)){b=[];for(c=0;c<a.length;c++){var d=xb(a[c]),e=this.aa;0>e&&(e+=d.length);0<=e&&e<d.length&&b.push(d[e])}a=b}return a};
vb.prototype.toString=function(){return JSON.stringify({nativeQuery:this.ma,occurrenceIndex:this.$,paragraphIndex:this.aa,ignoreMode:this.P})};
var wb=function(a,b){if(null==a.P)return b;switch(a.P){case 1:return b.slice(1);case 2:return b.slice(0,b.length-1);case 3:return b.slice(1,b.length-1);case 0:return b;default:throw Error("Unknown ignore mode: "+a.P);}},xb=function(a){var b=[];ub(a.getElementsByTagName("p"),function(a){100<=yb(a)&&b.push(a)});return b},yb=function(a){if(3==a.nodeType)return a.length;if(1!=a.nodeType||"SCRIPT"==a.tagName)return 0;var b=0;ub(a.childNodes,function(a){b+=yb(a)});return b},zb=function(a){return 0==a.length||
isNaN(a[0])?a:"\\"+(30+parseInt(a[0],10))+" "+a.substring(1)};var Ab=function(a,b){var c=0,d=A(a,6);if(void 0!==d)switch(d){case 0:c=1;break;case 1:c=2;break;case 2:c=3}var d=null,e=A(a,7);if(A(a,1)||a.getId()||0<A(a,4).length){var f=a.getId(),g=A(a,1),e=A(a,4),d=A(a,2);a=A(a,5);var k="";g&&(k+=g);f&&(k+="#"+zb(f));if(e)for(f=0;f<e.length;f++)k+="."+zb(e[f]);d=(e=k)?new vb(e,d,a,c):null}else e&&(d=new vb(e,A(a,2),A(a,5),c));return d?d.query(b):[]},Bb=function(a,b){if(a==b)return!0;if(!a||!b||A(a,1)!=A(b,1)||A(a,2)!=A(b,2)||a.getId()!=b.getId()||A(a,7)!=A(b,
7)||A(a,5)!=A(b,5)||A(a,6)!=A(b,6))return!1;a=A(a,4);b=A(b,4);if(a||b)if(a&&b&&a.length==b.length)for(var c=0;c<a.length;c++){if(a[c]!=b[c])return!1}else return!1;return!0};var Cb=function(a){a=a.document;return("CSS1Compat"==a.compatMode?a.documentElement:a.body)||{}},Db=function(a){return void 0===a.pageYOffset?(a.document.documentElement||a.document.body.parentNode||a.document.body).scrollTop:a.pageYOffset};var Eb=function(a,b){b=L(b);if(!b)return null;a=Ab(b,a);return 0<a.length?a[0]:null},Gb=function(a,b){b=Fb(a,b,!0);return p(b)&&!(b<=Cb(a).clientHeight)},Hb=function(a,b){return a.body?b-a.body.getBoundingClientRect().top:b},Fb=function(a,b,c){if(!c||!p(A(b,8))){var d=Eb(a.document,b);if(d){var e=null!=C(b,K,2)?A(C(b,K,2),3):void 0;c=a.document.createElement("div");c.className="googlepublisherpluginad";var f=c.style;f.textAlign="center";f.width="100%";f.height="0px";f.clear=e?"both":"none";Ib(c,d,
A(b,3));d=c.getBoundingClientRect().top+Db(a);c.parentNode.removeChild(c);B(b,8,d)}}b=A(b,8);return p(b)?b-Db(a):null},Jb={0:0,1:1,2:2,3:3},Kb={0:"auto",1:"horizontal",2:"vertical",3:"rectangle"},Lb=function(a,b){a.sort(function(a,d){a=Fb(b,a,!0);a=p(a)?a:Number.POSITIVE_INFINITY;d=Fb(b,d,!0);d=p(d)?d:Number.POSITIVE_INFINITY;return a-d})},Ib=function(a,b,c){switch(Jb[c]){case 0:b.parentNode&&b.parentNode.insertBefore(a,b);break;case 3:if(c=b.parentNode){var d=b.nextSibling;if(d&&d.parentNode!=c)for(;d&&
8==d.nodeType;)d=d.nextSibling;c.insertBefore(a,d)}break;case 1:b.insertBefore(a,b.firstChild);break;case 2:b.appendChild(a)}if(1!=b.nodeType?0:"INS"==b.tagName&&mb(b))b.style.display="block"};var ob=new function(){this.ha="googlepublisherpluginad";this.Na={google_tag_origin:"pso"}},P=function(a){this.b=a;this.j=[];this.da=0;this.o=[];this.v=[];this.Y=null;this.oa=!1},Mb=function(a,b){a=C(a.f(),J,4);if(!(a&&b&&A(b,1)==A(a,1)&&b.getId()==a.getId()&&p(A(b,2))&&p(A(b,5))))return!1;a=A(a,4);b=A(b,4);if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(b[c]!=a[c])return!1;return!0},Nb=function(a){var b=p(void 0)?void 0:20,c=a.f(),d=c.i(),e=C(c,J,4);if(!(a.oa||0>=b)&&e&&0!=Ab(e,a.b.document).length){a.oa=
!0;for(var c=[],f=0;f<d.length;++f){var g=d[f],k=L(g);if(Mb(a,k)){var m=A(k,2),k=A(k,5);null!=m&&null!=k&&0<=m&&0<=k&&(!c[m]||A(L(c[m]),5)<k)&&(c[m]=g)}}k=0;d=Ab(e,a.b.document);for(m=0;m<c.length&&k<b;++m){var e=k,f=a,l=d[m],g=c[m],k=b-k,u=f.f().i(),q=0;if(l&&g){l=xb(l).length;switch(A(L(g),6)){case 0:case 1:--l;break;case 2:l-=2}for(var n=A(L(g),5)+1;n<l&&q<k;++n){var Oa=new g.constructor(Da(E(g))),Hc=L(Oa);B(Hc,5,n);u.push(Oa);q++}}q&&f.f().pa(u);k=e+q}}};
P.prototype.g=function(a){for(var b=0;b<this.o.length;++b)if(this.o[b]==a)return;this.o.push(a)};P.prototype.C=function(a){for(var b=0;b<this.v.length;++b)if(this.v[b]==a)return;this.v.push(a)};
var Ob=function(a,b,c){var d=Jb[A(b,3)],e=Eb(a.b.document,b);if(e){var f=L(b)?A(L(b),2):void 0,g;a:{g=a.b;if(null!=f)switch(d){case 0:g=rb(sb(e),g);break a;case 3:g=rb(e,g);break a;case 2:f=e.lastChild;g=rb(f?1==f.nodeType?f:sb(f):null,g);break a}g=!1}if(!g&&(c||2!=d||tb(e))&&(c=1==d||2==d?e:e.parentNode,!c||(1!=c.nodeType?0:"INS"==c.tagName&&mb(c))||!(0>=c.offsetWidth)))a:if(A(b,7))a.C(8);else{b:if(A(b,5))c=A(b,5);else{if(c=Q(a).f())if(c=A(c,3),a.da<c.length){c=c[a.da++];break b}a.g(4);c=null}if(null!=
c){B(b,7,!0);d=[];(g=a.O())&&d.push(g);g=Q(a).sa;for(f=0;f<g.length;++f)d.push(g[f]);p(A(b,9))&&d.push("pso-lv-"+A(b,9));var k=a.b.document;g=a.A();var f=A(b,6),f=null!=f?Kb[f]:f,m=C(b,K,2),l={};m&&(l.ra=A(m,1),l.ga=A(m,2),l.xa=!!A(m,3));var m=c,u=ob,q=k.createElement("div"),n=q.style;n.textAlign="center";n.width="100%";n.height="auto";n.clear=l.xa?"both":"none";l.Ka&&nb(n,l.Ka);k=k.createElement("ins");n=k.style;n.display="block";n.margin="auto";n.backgroundColor="transparent";l.ra&&(n.marginTop=
l.ra);l.ga&&(n.marginBottom=l.ga);l.ta&&nb(n,l.ta);q.appendChild(k);k.setAttribute("data-ad-format",f?f:"auto");if(f=u&&u.ha)q.className=f;k.className="adsbygoogle";k.setAttribute("data-ad-client",g);m&&k.setAttribute("data-ad-slot",m);d.length&&k.setAttribute("data-ad-channel",d.join("+"));Ib(q,e,A(b,3));try{qb(a.b,k)}catch(Oa){A(b,5)!=c&&a.da--;B(b,7,!1);a.C(6);q&&q.parentNode&&q.parentNode.removeChild(q);break a}a.j.push(q)}}}},Pb=function(a,b){for(var c=Number.POSITIVE_INFINITY,d=0;d<a.j.length;++d)var e=
a.j[d].getBoundingClientRect().top,f=a.j[d].getBoundingClientRect().bottom,c=Math.min(c,b<e?e-b:f<b?b-f:0);return c},Q=function(a){a=I(a.b).ps||null;if(!a)throw Error("No placementState");return a},Qb=function(a,b){var c=Q(a).m;if(!c||!c.A())return a.g(5),!1;c=D(c,N,3)[0];return c?A(c,3).length<b?(a.g(4),a.g(5),!1):!0:(a.g(5),!1)};P.prototype.A=function(){return Q(this).m.A()||""};P.prototype.O=function(){return Q(this).m.O()||void 0};P.prototype.D=function(){return Q(this).m.D()||new fb};
P.prototype.f=function(){var a=Q(this).f();if(!a)throw Error("No mConfig");return a};var Rb=function(a){a=A(a.f(),6);return null!=a&&0<a};var Sb=function(){this.I=this.J=this.ba=null};var R=function(a){P.call(this,a)};r(R,P);R.prototype.apply=function(a){var b;(b=Q(this).m)&&b.A()&&b.D()?b=!0:(this.g(5),b=!1);if(b){b=this.D().i();for(var c=0;c<b.length;c++){var d=b[c];A(d,7)||Ob(this,d,a)}}};R.prototype.B=function(){return(0==this.D().i().length||0<this.j.length)&&0==this.o.length};var Tb=function(a){P.call(this,a);if(Qb(this,0)){a=this.D().i();for(var b=this.f().i(),c=0;c<a.length;c++){var d=a[c],e;a:{e=d;var f=b;if(e&&L(e))for(var g=0;g<f.length;g++){var k=f[g];if(A(e,3)==A(k,3)&&Bb(L(e),L(k))){e=k;break a}}e=null}e&&C(e,K,2)&&(e=C(e,K,2),d.a||(d.a={}),f=e?E(e):e,d.a[2]=e,B(d,2,f))}}};r(Tb,R);var Vb=function(a,b){var c=void 0===b.pageXOffset?(b.document.documentElement||b.document.body.parentNode||b.document.body).scrollLeft:b.pageXOffset,d=Db(b);if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),Ub(a)?new F(a.top+d,a.right+c,a.bottom+d,a.left+c):new F(0,0,0,0);b=b.document.createRange();b.selectNodeContents(a);return b.collapsed?new F(0,0,0,0):b.getBoundingClientRect?(a=b.getBoundingClientRect(),Ub(a)?new F(a.top+d,a.right+c,a.bottom+d,a.left+c):new F(0,0,0,0)):new F(0,0,0,
0)},Ub=function(a){return!!a&&p(a.top)&&!isNaN(a.top)&&p(a.right)&&!isNaN(a.right)&&p(a.bottom)&&!isNaN(a.bottom)&&p(a.left)&&!isNaN(a.left)};var $b=function(a){this.K=a;this.Fa=Wb(a);this.ua=S("ins.adsbygoogle",a);this.fa=Xb(a);this.Oa=S("[__lsu_res=reserved]",a);this.U=[];a=Yb(this);for(var b=0;b<a.length;b++)this.U.push(new Zb(a[b]))},Wb=function(a){var b=a.googletag;if(!b||"function"!=typeof b.pubads)return S("div[id^=div-gpt-ad]",a);var c=[];try{for(var d=b.pubads().getSlots(),b=0;b<d.length;b++){var e=d[b].getSlotElementId(),f=a.document.getElementById(e);null!=f&&c.push(f)}}catch(g){Ra("ladd_evt",{ok:0,err:g.toString()},!0,.1)}return c},
Xb=function(a){return S("iframe[id^=aswift_],iframe[id^=google_ads_frame]",a)},S=function(a,b){return Array.prototype.slice.call(b.document.querySelectorAll(a))},Yb=function(a){return[].concat(a.Fa,a.ua,a.fa,a.Oa)},Zb=function(a){this.Ca=a;this.W=null};var T=function(a){P.call(this,a)};r(T,P);T.prototype.apply=function(){};T.prototype.B=function(){var a;if(Rb(this)){a=this.b;var b=Wb(a);a=0<[].concat(b,S("ins.adsbygoogle",a),Xb(a),S("[__lsu_res=reserved]",a)).length}else a=!0;return a};var ac=function(a){P.call(this,a);this.F=null};r(ac,P);
ac.prototype.apply=function(a){if(a&&Qb(this,2)){Nb(this);a=Cb(this.b).clientHeight||640;null==this.F&&(this.F=new $b(this.b));var b=this.F.fa.length;if(!(5<=b)){var b=Math.min(2,5-b),c=this.f().i();Lb(c,this.b);for(var d=0;d<c.length&&this.j.length<b;++d){var e=c[d];if(Gb(this.b,e)){var f=Fb(this.b,e,!0);if(void 0!==f){var g;a:{g=this.F;for(var k=a,m=f,l=0;l<g.U.length;l++){var u=m,q=k,n;n=g.U[l];n.W||(n.W=Vb(n.Ca,g.K));n=n.W;if(n.top-q<u&&u<n.bottom+q){g=!0;break a}}g=!1}g||Pb(this,f)<a||Ob(this,
e,!0)}}}0==this.j.length&&this.C(1)}}};ac.prototype.B=function(){return Rb(this)?0<Yb(this.F).length:!0};var bc=function(a){P.call(this,a);this.Z=!1};r(bc,T);
bc.prototype.apply=function(a){if(a&&!this.Z){var b;a:{var c=this.b.document;b=c.body;if(a&&b){a=this.A();var d=ob,e=c.createElement("div");e.style.display="block";if(d=d&&d.ha)e.className=d;c=c.createElement("ins");c.className="adsbygoogle";c.setAttribute("data-ad-client",a);c.setAttribute("data-reactive-ad-format","1");c.style.display="none";e.appendChild(c);Ib(e,b,2);try{qb(this.b,c)}catch(f){this.C(6);e&&e.parentNode&&e.parentNode.removeChild(e);b=5;break a}this.j.push(e);b=0}else b=4}this.Z=
0==b}};bc.prototype.B=function(){return this.Z&&T.prototype.B.call(this)};var cc=function(a){P.call(this,a);a=Cb(a).clientHeight;this.Aa=.1*a;this.Ia=.75*a};r(cc,P);
cc.prototype.apply=function(a){if(Qb(this,3)&&!this.B()){Nb(this);var b=this.f().i();Lb(b,this.b);var c;c=this.Aa;var d;d=document;d=d.querySelectorAll?d.querySelectorAll("header,#header,#masthead,.header,.site-header"):[];for(var e=d.length,f=0<e?d[0]:null,g=1;g<e;g++)d[g].getBoundingClientRect().top<f.getBoundingClientRect().top&&(f=d[g]);(d=f)&&(d=d.getBoundingClientRect())&&d.top!=d.bottom&&d.left!=d.right&&(c=Math.min(c,Hb(document,d.bottom)));for(d=0;d<b.length&&3>this.j.length;d++){e=b[d];
var f=c,g=this.b.document,k=Fb(this.b,e,!1);!p(k)||Hb(g,k)<f?f=!1:(f=Pb(this,k),f=this.Ia<f);f&&(f=Gb(this.b,e),g=A(e,6)||0,f&&0==g&&B(e,6,3),!f&&a||Ob(this,e,a))}}};cc.prototype.B=function(){return 3==this.j.length};var U={};U[16]=R;U[17]=R;U[19]=T;U[29]=ac;U[33]=T;U[30]=bc;U[28]=cc;U[34]=cc;U[32]=Tb;U[1]=R;U[8]=T;U[11]=R;var dc=[19,29,33,30,16,32,17,34],ec=[16,19,33,30,17,1,6,8,11];var fc=function(a,b){a=a.google_ad_modifications=a.google_ad_modifications||{};(a.ad_channels=a.ad_channels||[]).push(b)};var gc=function(a){return 0>a||99<a?null:10>a?"0"+a:""+a};var hc=function(a,b){a=a.google_ad_modifications=a.google_ad_modifications||{};a=a.loeids=a.loeids||[];for(var c=0;c<b.length;c++)a.push(b[c])};var ic=function(a,b,c){this.ja=a;this.Da=c?c:new kb};ic.prototype.N=function(){return this.Da||new kb};var jc=function(a){if(!p(a))return!1;for(var b=0;b<dc.length;++b)if(a==dc[b])return!1;return!0},oc=function(){var a=V,b=kc,c=lc,d=b.f();if(!d)return mc(16);var e=null,f;a:{var g=D(d,M,1);for(f=0;f<g.length;++f){for(var k=!0,m=0;m<ec.length;++m)A(g[f],4)==ec[m]&&(k=!1);if(k){g=[];0==d.i().length&&g.push("PsoInvalidVariant");0==A(d,3).length&&g.push("PsoNoAdSlotCodes");f=g;break a}}f=[]}g=c.ja;if(0==f.length)a:{e=D(d,M,1);if(p(g))for(f=0;f<e.length;f++)if(k=e[f],U[A(k,4)])for(var m=D(k,hb,2),l=0;l<
m.length;l++){var u=m[l],q=A(u,1),u=A(u,2);if(p(q)&&p(u)&&g>=q&&g<=u){e=k;break a}}e=null}else for(k=0;k<f.length;++k)b.sa.push(f[k]);if(!e){f=D(d,M,1);e={};for(k=0;k<f.length;k++)e[A(f[k],4)]=!0;f=null;e[19]||e[8]?f=19:e[16]||e[1]?f=16:0<d.i().length&&0<A(d,3).length&&e[34]&&(f=34);null!=f?(e=new M,B(e,6,3),B(e,4,f),16!=f&&19!=f&&e.qa("pso-ama-fallback")):e=null}(f=!e)||(!p(g)||800>g?f=!1:820>g?(hc(a,["26835111"]),f=!0):(840>g&&hc(a,["26835112"]),f=!1));if(f)return mc(16);(g=e.ka())&&fc(a,g);g=!0;
A(c.N(),2)&&(Date.now?Date.now():+new Date)<A(c.N(),2)||(fc(a,"pso-ama-exd"),g=!1);A(b.m,11)&&(fc(a,"pso-ama-stl-tmp"),g=!1);g&&fc(a,"pso-ama-elig");2==A(e,6)&&(b=A(e,1),null!=b&&hc(a,[""+b]));if(g&&(2==A(e,6)||1==A(e,6))){d=D(d,M,1);if(null===c.ja)c=[];else{b={};c=[];for(g=0;g<d.length;g++)f=nc(d[g]),null==f||b[f]||(b[f]=!0,c.push(f));b=nc(e);if(null!=b){d=[];b=gc(b);g=!1;if(b)for(f=0;f<c.length;f++)k=gc(c[f]),b==k&&(g=!0),k&&d.push("950"+b+k);g||(d=[]);c=d}else c=[]}hc(a,c)}a=new Sb;a.ba=A(e,5);
a.J=A(e,4);return a},mc=function(a){var b=new Sb;b.J=a;return b},pc=function(a){a=a.google_ad_modifications=a.google_ad_modifications||{};a.remove_ads_by_default=!0;a.ad_whitelist=[{ad_tag_origin:"pso"}];a.ad_blacklist=[];a.space_collapsing="slot"},nc=function(a){var b;switch(A(a,6)){case 1:b=A(a,4);break;case 2:b=A(a,7)}return null!=b?b:null};var qc=function(a){this.document=a};var W=function(a){H.call(this,a)};r(W,H);W.prototype.getData=function(a){var b=W.Ra.getData.call(this,a),c;a:{c=(new qc(a.document)).document.getElementsByTagName("script");for(var d=0;d<c.length;++d)if(c[d].hasAttribute("data-pso-version")){c=c[d].getAttribute("data-pso-version");break a}c=null}b.sv=c;if(d=I(a).ps||null){c=d.m;var d=d.f(),e=b.wpc;b.wpc=null!=e?e:c.A();b.su=A(c,14);b.tn=c.O();b.ev=d&&A(d,5)}if(a=I(a).ss||null)b.s=a.J,b.st=a.ba;return b};var rc=null,sc=!1,vc=function(a){var b=tc,c=uc;b.addEventListener?(a&&b.addEventListener("DOMContentLoaded",a,!1),c&&b.addEventListener("load",c,!1)):b.attachEvent&&c&&b.attachEvent("onload",c)},xc=function(a){p(rc)&&a.clearInterval&&(a.clearInterval(rc),rc=null);sc||wc(a,!1);wc(a,!0)},yc=function(a,b){try{xc(b);var c=I(b).ss||null;if(c&&c.I){var d=c.I,e=d.B(),f=d.o,g=d.v,k=d.Y,m=d.j.length;e||0!=m||f.push(6);for(var l=new W(m),c=0;c<g.length;c++)l.C(g[c]);if(e&&0==f.length&&null===k)ab(a,a.Qa,a.ca,
l);else{for(e=0;e<f.length;e++)l.g(f[e]);bb(a,$a(l,k))}}else bb(a,(new W(0)).g(2))}catch(u){bb(a,$a((new W(0)).g(1),u))}I(b).loaded=!0},wc=function(a,b){b||(sc=!0);if((a=I(a).ss||null)&&a.I){a=a.I;try{a.apply(b)}catch(c){a.g(1),null===a.Y&&(a.Y=c)}}},zc=function(){wc(window,!1)};var X=new function(a){this.Qa="pso_success";this.Ea="pso_failure";this.X=this.ca=.01;this.Ha=!1;this.K=a}(window);
try{var V=window,za,Ac=I(V).config;za=Ac?new O(Ac):null;if(!za)throw Error("No config");var Bc=Aa(10),Cc=Aa(7);X.ca=null!=Bc?Bc:X.ca;X.X=null!=Cc?Cc:X.X;var kc=new lb(za),Dc=kc;I(V).ps=Dc;var Y,lc;if(v("iPad")||v("Android")&&!v("Mobile")||v("Silk")||!(v("iPod")||v("iPhone")||v("Android")||v("IEMobile")))Y=mc(16);else{var Ec,Fc=/^#([^=]*)=(\d+)$/.exec(V.location.hash);if((Ec=Fc&&3==Fc.length&&"pso_strategy"==Fc[1]?+Fc[2]:null)&&U[Ec]){Y=mc(Ec);var Gc=V;jc(Ec)&&pc(Gc)}else{var Ic=V,Jc=kc.m.N(),Z;try{var Kc=
parseInt(Ic.localStorage.getItem("PSO_EXP0"),10);Z=isNaN(Kc)?null:Kc}catch(a){Z=null}if(null==Z){Z=Math.floor(1024*Math.random());var Lc=Z;try{Ic.localStorage.setItem("PSO_EXP0",Lc.toString())}catch(a){}}lc=new ic(Z,0,Jc);Y=oc()}if(1==Y.ba){var Mc=V;jc(Y.J)&&pc(Mc)}}if(!Y)throw Error("No strategyState created!");var Nc=Y;I(V).ss=Nc;var Oc=V,Pc=Y,Qc=Pc.J;if(p(Qc)){var Rc=U[Qc];Qc&&Rc&&(Pc.I=new Rc(Oc))}var tc=V,uc=ba(yc,X,tc),Sc=ba(xc,tc);switch(tc.document.readyState){case "complete":uc();break;case "interactive":Sc();
vc();break;default:var Tc=tc,Uc=pb(Tc);Uc.loaded||(Uc.onload=zc);rc=Tc.setInterval(zc,10);vc(Sc)}}catch(a){bb(X,$a(new W(0),a))};})();
</script> 
 </head> 
 <body class="single single-post postid-520 single-format-standard"> 
  <!-- Wrapper Starts Here --> 
  <div id="wrapper"> 
   <!-- Header Section Starts Here --> 
   <header id="header"> 
    <div class="top-header"> 
     <div class="container "> 
      <div class="row"> 
       <div class="col-sm-12"> 
        <a href="#author-info" id="au">About Author</a> 
        <a href="https://www.facebook.com/javainsimpleway/">
         <div style="color:yellow">
           Connect with me here 
         </div></a> 
        <a href="http://javainsimpleway.com/subscribe-us/">Subscribe Us</a> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div class="header-wrap"> 
     <style>
		.header-navigation .header-nav > li:hover > a, .header-navigation .header-nav > li.current-menu-item > a {
    border-top: 3px solid #ab1b42 !important;
    color: #ab1b42 !important;
}
.header-navigation .header-nav > li:hover > a, .header-navigation .header-nav > li.current-post-ancestor  > a {
    border-top: 3px solid #ab1b42 !important;
    color: #ab1b42 !important;
}
		</style> 
     <div class="secondary-header nb-header-nav-menu"> 
      <div class="container"> 
       <div class="row"> 
        <div class="col-xs-12 col-sm-3 logo-image"> 
         <a href="http://javainsimpleway.com/"><img src="http://javainsimpleway.com/wp-content/uploads/2016/09/logo_final.jpg" alt="Java Guide" title="Java Guide"><p><strong class="header-text">Java Guide</strong><strong class="header-description">Simple way to learn java</strong></p></a> 
        </div> 
        <div class="col-xs-12 col-sm-7"> 
         <nav class="header-navigation cl-effect-1"> 
          <a href="javascript:void(0);" class="nav-icon visible-xs">Menu <i class="fa fa-bars"></i></a> 
          <ul id="menu-website" class="header-nav">
           <li id="menu-item-457" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-457"><a href="http://javainsimpleway.com/category/java/">Java</a> 
            <ul class="sub-menu"> 
             <li id="menu-item-1236" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1236"><a href="http://javainsimpleway.com/java-brief-history/">Core java</a></li> 
             <li id="menu-item-1237" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1237"><a href="http://javainsimpleway.com/java-8-setup-for-keplers-eclipse-version/">Java 8</a></li> 
            </ul> </li> 
           <li id="menu-item-459" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-459"><a href="http://javainsimpleway.com/category/spring/">Spring</a> 
            <ul class="sub-menu"> 
             <li id="menu-item-1240" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1240"><a href="http://javainsimpleway.com/ioc-container/">Spring Core</a></li> 
             <li id="menu-item-1241" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1241"><a href="http://javainsimpleway.com/aop-overview/">Spring AOP</a></li> 
             <li id="menu-item-1242" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1242"><a href="http://javainsimpleway.com/spring-mvc-architecture/">Spring MVC</a></li> 
             <li id="menu-item-1243" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1243"><a href="http://javainsimpleway.com/spring-security-hello-world-project/">Spring Security</a></li> 
            </ul> </li> 
           <li id="menu-item-450" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-450"><a href="http://javainsimpleway.com/design-patterns/">Design Patterns</a></li> 
           <li id="menu-item-501" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-501"><a href="http://javainsimpleway.com/hibernate/">Hibernate</a></li> 
           <li id="menu-item-2618" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-2618"><a title="Web Service" href="http://javainsimpleway.com/category/web-service/">Web Service</a> 
            <ul class="sub-menu"> 
             <li id="menu-item-2619" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-2619"><a title="REST Service" href="http://javainsimpleway.com/rest-service-overview/">REST Service</a></li> 
             <li id="menu-item-3023" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-3023"><a title="Spring Rest service" href="http://javainsimpleway.com/spring-rest-service-hello-world-with-xml/">Spring Rest service</a></li> 
             <li id="menu-item-2620" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-2620"><a title="SOAP Service" href="http://javainsimpleway.com/web-service-overview/">SOAP Service</a></li> 
            </ul> </li> 
           <li id="menu-item-1937" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1937"><a href="http://javainsimpleway.com/category/hybris-ecommerce/">Hybris</a> 
            <ul class="sub-menu"> 
             <li id="menu-item-1939" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1939"><a title="Hybris Core" href="http://javainsimpleway.com/hybris-installation/">Hybris Core</a></li> 
             <li id="menu-item-1938" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-1938"><a title="Hybris Commerce" href="http://javainsimpleway.com/solr-overview-in-hybris/">Hybris Commerce</a></li> 
            </ul> </li> 
           <li id="menu-item-1502" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1502"><a href="http://javainsimpleway.com/category/more/">More</a> 
            <ul class="sub-menu"> 
             <li id="menu-item-3420" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-3420"><a title="Solr" href="http://javainsimpleway.com/solr-overview-setup/">Solr</a></li> 
            </ul> </li> 
           <li id="menu-item-4757" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-4757"><a href="http://javainsimpleway.com/category/feedback/">Training</a> 
            <ul class="sub-menu"> 
             <li id="menu-item-4761" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-4761"><a href="http://javainsimpleway.com/hybris-training-details-and-feedback/">Hybris</a></li> 
            </ul> </li> 
          </ul> 
         </nav> 
        </div> 
        <div class="col-xs-12 col-sm-2 header-search-box"> 
         <div class="header-search"> 
          <form role="search" method="get" class="search-form form-inline" action="http://javainsimpleway.com/"> 
           <div class="form-group"> 
            <input type="search" class="search-field form-control" onfocus="if (this.value == this.defaultValue)
                                    this.value = '';" onblur="if (this.value == '')
                                                this.value = this.defaultValue;" value="Search" name="s" title="Search for:"> 
           </div> 
           <button class="search-submit-icon" type="submit"><i class="fa fa-search"></i></button> 
          </form> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
   </header> 
   <!--Header Section Ends Here --> 
   <!--Content Section Starts Here--> 
   <div id="content" class="abc"> 
    <div class="container"> 
     <div class="row"> 
      <aside class="col-sm-4 col-lg-2 sidebar sidebar-full "> 
       <h3 class="h4">Spring Security</h3> 
       <ul class="sib_demo"> 
        <li> <a href="http://javainsimpleway.com/spring-security-hello-world-project/">Spring security Hello world project</a> </li> 
        <li> <a href="http://javainsimpleway.com/spring-security-using-custom-login-form/">Spring security using custom login form</a> </li> 
        <li> <a href="http://javainsimpleway.com/spring-security-using-database-authentication/">Spring Security using Database Authentication</a> </li> 
        <li> <a href="http://javainsimpleway.com/spring-security-with-site-minder-integration/">Spring security with site minder integration</a> </li> 
        <li class="selected"> <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/">Spring Security using Custom Authentication Provider</a> </li> 
       </ul> 
      </aside> 
      <section class="col-sm-8 col-lg-10 post-detail-page"> 
       <article class="post-content"> 
        <div class="post-content-header"> 
         <h1 class="post-title">Spring Security using Custom Authentication Provider</h1> 
         <ul class="post-details clearfix"> 
          <li class="admin-icon"> <i class="fa fa-user"></i> <a href="http://javainsimpleway.com/author/karibasappagc/" title="Posts by Karibasappa G C (KB)" rel="author">Karibasappa G C (KB)</a> </li> 
          <li><i class="fa fa-clock-o"></i> <a href="http://javainsimpleway.com/2015/08/" title="Post Date">15th Aug 2015</a> </li> 
          <li> <i class="fa fa-comments-o"></i> <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#respond" title="Post Comment">57</a> </li> 
          <li> <i class="fa fa-eye "></i> <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/" title="Post View">60931</a> </li> 
         </ul> 
        </div> 
        <div class="post-content-body"> 
         <!--Ad Injection:top--> 
         <div style="">
          <center>
           <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
           <!-- ad1 --> 
           <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9157887158094484" data-ad-slot="5922399857" data-ad-format="auto"></ins> 
           <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
          </center>
         </div>
         <p>Tools and Technologies used<br> 1)Eclipse IDE Mars Release (4.5.0)<br> 2)Java 8<br> 3)Spring framework 4.2.0<br> 4)Spring security 3.2<br> 5)Tomcat 8</p> 
         <p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br> 
          <!-- ad1 --><br> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9157887158094484" data-ad-slot="5922399857" data-ad-format="auto"></ins><br> <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p> 
         <p>Follow steps from the <a href="http://javainsimpleway.com/?p=471">Spring MVC project</a> link to setup a spring maven hello world project.</p> 
         <p>Project Structure</p> 
         <p><img alt="" class="alignnone size-full wp-image-533 " src="http://javainsimpleway.com/wp-content/uploads/2015/08/img_55cf989ceaf48.png"></p> 
         <p>Then follow below steps to achieve spring security using custom Authentication Provider.</p> 
         <p>Modify pom.xml as below to have spring security dependencies</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre></td>
              <td class="de1"><pre class="de1"><span class="sy0">&lt;</span>project xmlns<span class="sy0">=</span><span class="st0">"http://maven.apache.org/POM/4.0.0"</span> xmlns<span class="sy0">:</span>xsi<span class="sy0">=</span><span class="st0">"http://www.w3.org/2001/XMLSchema-instance"</span>
&nbsp; xsi<span class="sy0">:</span>schemaLocation<span class="sy0">=</span><span class="st0">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span><span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>modelVersion<span class="sy0">&gt;</span>4.0.0<span class="sy0">&lt;/</span>modelVersion<span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>SpringSecurity<span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>SpringSecurityCustomAuthenticationProvider<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>packaging<span class="sy0">&gt;</span>war<span class="sy0">&lt;/</span>packaging<span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>0.0.1<span class="sy0">-</span>SNAPSHOT<span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>name<span class="sy0">&gt;</span>SpringSecurityCustomAuthenticationProvider Maven Webapp<span class="sy0">&lt;/</span>name<span class="sy0">&gt;</span>
&nbsp; <span class="sy0">&lt;</span>url<span class="sy0">&gt;</span>http<span class="sy0">:</span><span class="co1">//maven.apache.org&lt;/url&gt;</span>
&nbsp; <span class="sy0">&lt;</span>properties<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>org.<span class="me1">springframework</span>.<span class="me1">version</span><span class="sy0">&gt;</span>4.2.0.<span class="me1">RELEASE</span><span class="sy0">&lt;/</span>org.<span class="me1">springframework</span>.<span class="me1">version</span><span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>spring<span class="sy0">-</span>security.<span class="me1">version</span><span class="sy0">&gt;</span>3.2.7.<span class="me1">RELEASE</span><span class="sy0">&lt;/</span>spring<span class="sy0">-</span>security.<span class="me1">version</span><span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>properties<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span>dependencies<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>junit<span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>junit<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>3.8.1<span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>scope<span class="sy0">&gt;</span>test<span class="sy0">&lt;/</span>scope<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;!--</span> Spring MVC depends on these modules spring<span class="sy0">-</span>core, spring<span class="sy0">-</span>beans, spring<span class="sy0">-</span>context, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spring<span class="sy0">-</span>web <span class="sy0">--&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>org.<span class="me1">springframework</span><span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>spring<span class="sy0">-</span>web<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>$<span class="br0">{</span>org.<span class="me1">springframework</span>.<span class="me1">version</span><span class="br0">}</span><span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>dependency<span class="sy0">&gt;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>org.<span class="me1">springframework</span><span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>spring<span class="sy0">-</span>webmvc<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>$<span class="br0">{</span>org.<span class="me1">springframework</span>.<span class="me1">version</span><span class="br0">}</span><span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">&lt;!--</span> Spring <span class="kw3">Security</span> Dependencies <span class="sy0">--&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>org.<span class="me1">springframework</span>.<span class="me1">security</span><span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>spring<span class="sy0">-</span>security<span class="sy0">-</span>core<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>$<span class="br0">{</span>spring<span class="sy0">-</span>security.<span class="me1">version</span><span class="br0">}</span><span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">&lt;/</span>dependency<span class="sy0">&gt;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">&lt;</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>org.<span class="me1">springframework</span>.<span class="me1">security</span><span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>spring<span class="sy0">-</span>security<span class="sy0">-</span>web<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>$<span class="br0">{</span>spring<span class="sy0">-</span>security.<span class="me1">version</span><span class="br0">}</span><span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>dependency<span class="sy0">&gt;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>org.<span class="me1">springframework</span>.<span class="me1">security</span><span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>spring<span class="sy0">-</span>security<span class="sy0">-</span>config<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>$<span class="br0">{</span>spring<span class="sy0">-</span>security.<span class="me1">version</span><span class="br0">}</span><span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>dependency<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; <span class="sy0">&lt;/</span>dependencies<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span>build<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">&lt;</span>finalName<span class="sy0">&gt;</span>SpringSecurityCustomAuthenticationProvider<span class="sy0">&lt;/</span>finalName<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>plugins<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>plugin<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>groupId<span class="sy0">&gt;</span>org.<span class="me1">apache</span>.<span class="me1">maven</span>.<span class="me1">plugins</span><span class="sy0">&lt;/</span>groupId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>artifactId<span class="sy0">&gt;</span>maven<span class="sy0">-</span>compiler<span class="sy0">-</span>plugin<span class="sy0">&lt;/</span>artifactId<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>version<span class="sy0">&gt;</span>2.5.1<span class="sy0">&lt;/</span>version<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>configuration<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>source<span class="sy0">&gt;</span><span class="nu0">1.8</span><span class="sy0">&lt;/</span>source<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>target<span class="sy0">&gt;</span><span class="nu0">1.8</span><span class="sy0">&lt;/</span>target<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>configuration<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>plugin<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>plugins<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>build<span class="sy0">&gt;</span>
&nbsp;
<span class="sy0">&lt;/</span>project<span class="sy0">&gt;</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;SpringSecurity&lt;/groupId&gt;
  &lt;artifactId&gt;SpringSecurityCustomAuthenticationProvider&lt;/artifactId&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;
  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;SpringSecurityCustomAuthenticationProvider Maven Webapp&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
  &lt;properties&gt;
		&lt;org.springframework.version&gt;4.2.0.RELEASE&lt;/org.springframework.version&gt;
		&lt;spring-security.version&gt;3.2.7.RELEASE&lt;/spring-security.version&gt;
	&lt;/properties&gt;
	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;junit&lt;/groupId&gt;
			&lt;artifactId&gt;junit&lt;/artifactId&gt;
			&lt;version&gt;3.8.1&lt;/version&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;!-- Spring MVC depends on these modules spring-core, spring-beans, spring-context, 
			spring-web --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-web&lt;/artifactId&gt;
			&lt;version&gt;${org.springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;

		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
			&lt;version&gt;${org.springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;
		
		 &lt;!-- Spring Security Dependencies --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-core&lt;/artifactId&gt;
            &lt;version&gt;${spring-security.version}&lt;/version&gt;
         &lt;/dependency&gt; 
         &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;
            &lt;version&gt;${spring-security.version}&lt;/version&gt;
          &lt;/dependency&gt; 
          &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
            &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;
            &lt;version&gt;${spring-security.version}&lt;/version&gt;
          &lt;/dependency&gt;
          
	&lt;/dependencies&gt;
	&lt;build&gt;
		   &lt;finalName&gt;SpringSecurityCustomAuthenticationProvider&lt;/finalName&gt;
		&lt;plugins&gt;
			&lt;plugin&gt;
				&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
				&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
				&lt;version&gt;2.5.1&lt;/version&gt;
				&lt;configuration&gt;
					&lt;source&gt;1.8&lt;/source&gt;
					&lt;target&gt;1.8&lt;/target&gt;
				&lt;/configuration&gt;
			&lt;/plugin&gt;
		&lt;/plugins&gt;
	&lt;/build&gt;
 
&lt;/project&gt;</pre>
          </div>
         </div> 
         <p>Modify web.xml to add spring security filter as below</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td>
              <td class="de1"><pre class="de1"><span class="sy0">&lt;</span>web<span class="sy0">-</span>app xmlns<span class="sy0">=</span><span class="st0">"http://xmlns.jcp.org/xml/ns/javaee"</span> xmlns<span class="sy0">:</span>xsi<span class="sy0">=</span><span class="st0">"http://www.w3.org/2001/XMLSchema-instance"</span>
&nbsp; &nbsp; xsi<span class="sy0">:</span>schemaLocation<span class="sy0">=</span><span class="st0">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span>
&nbsp; &nbsp; version<span class="sy0">=</span><span class="st0">"3.1"</span><span class="sy0">&gt;</span>
&nbsp;
&nbsp; <span class="sy0">&lt;</span>display<span class="sy0">-</span>name<span class="sy0">&gt;</span>Archetype Created Web Application<span class="sy0">&lt;/</span>display<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; 
&nbsp; <span class="sy0">&lt;!--</span> Spring MVC dispatcher servlet <span class="sy0">--&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span>servlet<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>servlet<span class="sy0">-</span>name<span class="sy0">&gt;</span>mvc<span class="sy0">-</span>dispatcher<span class="sy0">&lt;/</span>servlet<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>servlet<span class="sy0">-</span>class<span class="sy0">&gt;</span>org.<span class="me1">springframework</span>.<span class="me1">web</span>.<span class="me1">servlet</span>.<span class="me1">DispatcherServlet</span><span class="sy0">&lt;/</span>servlet<span class="sy0">-</span>class<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>init<span class="sy0">-</span>param<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>param<span class="sy0">-</span>name<span class="sy0">&gt;</span>contextConfigLocation<span class="sy0">&lt;/</span>param<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>param<span class="sy0">-</span>value<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">/</span>WEB<span class="sy0">-</span>INF<span class="sy0">/</span>spring<span class="sy0">-</span>mvc.<span class="me1">xml</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">/</span>WEB<span class="sy0">-</span>INF<span class="sy0">/</span>spring<span class="sy0">-</span>security.<span class="me1">xml</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>param<span class="sy0">-</span>value<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>init<span class="sy0">-</span>param<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>load<span class="sy0">-</span>on<span class="sy0">-</span>startup<span class="sy0">&gt;</span><span class="nu0">1</span><span class="sy0">&lt;/</span>load<span class="sy0">-</span>on<span class="sy0">-</span>startup<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>servlet<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span>servlet<span class="sy0">-</span>mapping<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>servlet<span class="sy0">-</span>name<span class="sy0">&gt;</span>mvc<span class="sy0">-</span>dispatcher<span class="sy0">&lt;/</span>servlet<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>url<span class="sy0">-</span>pattern<span class="sy0">&gt;/&lt;/</span>url<span class="sy0">-</span>pattern<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>servlet<span class="sy0">-</span>mapping<span class="sy0">&gt;</span>
&nbsp;
&nbsp; &nbsp; <span class="sy0">&lt;</span>listener<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>listener<span class="sy0">-</span>class<span class="sy0">&gt;</span>org.<span class="me1">springframework</span>.<span class="me1">web</span>.<span class="me1">context</span>.<span class="me1">ContextLoaderListener</span><span class="sy0">&lt;/</span>listener<span class="sy0">-</span>class<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>listener<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;!--</span> Loads Spring <span class="kw3">Security</span> configuration file <span class="sy0">--&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span>context<span class="sy0">-</span>param<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>param<span class="sy0">-</span>name<span class="sy0">&gt;</span>contextConfigLocation<span class="sy0">&lt;/</span>param<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>param<span class="sy0">-</span>value<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">/</span>WEB<span class="sy0">-</span>INF<span class="sy0">/</span>spring<span class="sy0">-</span>mvc.<span class="me1">xml</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">/</span>WEB<span class="sy0">-</span>INF<span class="sy0">/</span>spring<span class="sy0">-</span>security.<span class="me1">xml</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;/</span>param<span class="sy0">-</span>value<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>context<span class="sy0">-</span>param<span class="sy0">&gt;</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;!--</span> Spring <span class="kw3">Security</span> filter <span class="sy0">--&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span>filter<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>filter<span class="sy0">-</span>name<span class="sy0">&gt;</span>springSecurityFilterChain<span class="sy0">&lt;/</span>filter<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>filter<span class="sy0">-</span>class<span class="sy0">&gt;</span>org.<span class="me1">springframework</span>.<span class="me1">web</span>.<span class="me1">filter</span>.<span class="me1">DelegatingFilterProxy</span><span class="sy0">&lt;/</span>filter<span class="sy0">-</span>class<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>filter<span class="sy0">&gt;</span>
&nbsp;
&nbsp; &nbsp; <span class="sy0">&lt;</span>filter<span class="sy0">-</span>mapping<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>filter<span class="sy0">-</span>name<span class="sy0">&gt;</span>springSecurityFilterChain<span class="sy0">&lt;/</span>filter<span class="sy0">-</span>name<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>url<span class="sy0">-</span>pattern<span class="sy0">&gt;</span><span class="coMULTI">/*&lt;/url-pattern&gt;</span>
<span class="coMULTI">&nbsp; &nbsp; &lt;/filter-mapping&gt;</span>
<span class="coMULTI">&nbsp; &nbsp; </span>
<span class="coMULTI">&lt;/web-app&gt;</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
	version="3.1"&gt;

  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;
  
  &lt;!-- Spring MVC dispatcher servlet --&gt;
	&lt;servlet&gt;
		&lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;
		&lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
		&lt;init-param&gt;
			&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
			&lt;param-value&gt;
			/WEB-INF/spring-mvc.xml,
			/WEB-INF/spring-security.xml
		&lt;/param-value&gt;
		&lt;/init-param&gt;
		&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
	&lt;/servlet&gt;
	&lt;servlet-mapping&gt;
		&lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;
		&lt;url-pattern&gt;/&lt;/url-pattern&gt;
	&lt;/servlet-mapping&gt;

	&lt;listener&gt;
		&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
	&lt;/listener&gt;
	&lt;!-- Loads Spring Security configuration file --&gt;
	&lt;context-param&gt;
		&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
		&lt;param-value&gt;
			/WEB-INF/spring-mvc.xml,
			/WEB-INF/spring-security.xml
		&lt;/param-value&gt;
	&lt;/context-param&gt;
	
		&lt;!-- Spring Security filter --&gt;
	&lt;filter&gt;
		&lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;
		&lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;
	&lt;/filter&gt;

	&lt;filter-mapping&gt;
		&lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;
		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
	&lt;/filter-mapping&gt;
	
&lt;/web-app&gt;</pre>
          </div>
         </div> 
         <p>Add spring security config file as below</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
              <td class="de1"><pre class="de1"><span class="sy0">&lt;</span>beans<span class="sy0">:</span>beans xmlns<span class="sy0">=</span><span class="st0">"http://www.springframework.org/schema/security"</span>
&nbsp; xmlns<span class="sy0">:</span>beans<span class="sy0">=</span><span class="st0">"http://www.springframework.org/schema/beans"</span>
&nbsp; xmlns<span class="sy0">:</span>xsi<span class="sy0">=</span><span class="st0">"http://www.w3.org/2001/XMLSchema-instance"</span>
&nbsp; xsi<span class="sy0">:</span>schemaLocation<span class="sy0">=</span><span class="st0">"http://www.springframework.org/schema/beans</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://www.springframework.org/schema/security</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;http://www.springframework.org/schema/security/spring-security-3.2.xsd"</span><span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="sy0">&lt;</span>http auto<span class="sy0">-</span>config<span class="sy0">=</span><span class="st0">'true'</span><span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>intercept<span class="sy0">-</span>url pattern<span class="sy0">=</span><span class="st0">"/secured/*"</span> access<span class="sy0">=</span><span class="st0">"ROLE_USER"</span> <span class="sy0">/&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>http<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="sy0">&lt;</span>authentication<span class="sy0">-</span>manager<span class="sy0">&gt;</span>
&nbsp; &nbsp; &nbsp; <span class="sy0">&lt;</span>authentication<span class="sy0">-</span>provider ref<span class="sy0">=</span><span class="st0">"customAuthenticationProvider"</span><span class="sy0">/&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;/</span>authentication<span class="sy0">-</span>manager<span class="sy0">&gt;</span> &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
<span class="sy0">&lt;/</span>beans<span class="sy0">:</span>beans<span class="sy0">&gt;</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">&lt;beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.2.xsd"&gt;
           
    &lt;http auto-config='true'&gt;
      &lt;intercept-url pattern="/secured/*" access="ROLE_USER" /&gt;
    &lt;/http&gt;
       
    &lt;authentication-manager&gt;
      &lt;authentication-provider ref="customAuthenticationProvider"/&gt;
    &lt;/authentication-manager&gt;   
           
&lt;/beans:beans&gt;</pre>
          </div>
         </div> 
         <p>Provide Authentication provider reference to our custom class which can handle custom authentication mechanism.<br> Create controller class as below</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td>
              <td class="de1"><pre class="de1"><span class="kw1">package</span> <span class="co2">com.kb.controller</span><span class="sy0">;</span>
&nbsp;
&nbsp;
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.context.SecurityContextHolder</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.userdetails.User</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.stereotype.Controller</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.ui.ModelMap</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.web.bind.annotation.RequestMapping</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.web.bind.annotation.RequestMethod</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">com.kb.model.CustomUser</span><span class="sy0">;</span>
&nbsp;
&nbsp;
@Controller
<span class="kw1">public</span> <span class="kw1">class</span> HomeController <span class="br0">{</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; 
&nbsp; &nbsp; @RequestMapping<span class="br0">(</span>value<span class="sy0">=</span><span class="st0">"/helloworld"</span>, method <span class="sy0">=</span> RequestMethod.<span class="me1">GET</span><span class="br0">)</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> helloWorld<span class="br0">(</span>ModelMap model<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; model.<span class="me1">addAttribute</span><span class="br0">(</span><span class="st0">"message"</span>, <span class="st0">"Welcome to the Hello World page"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">"helloworld"</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; @RequestMapping<span class="br0">(</span>value<span class="sy0">=</span><span class="st0">"/secured/home"</span>, method <span class="sy0">=</span> RequestMethod.<span class="me1">GET</span><span class="br0">)</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> securedHome<span class="br0">(</span>ModelMap model<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">Object</span> principal <span class="sy0">=</span> SecurityContextHolder.<span class="me1">getContext</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getAuthentication</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getPrincipal</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; CustomUser user<span class="sy0">=</span><span class="kw2">null</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>principal <span class="kw1">instanceof</span> CustomUser<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; user <span class="sy0">=</span> <span class="br0">(</span><span class="br0">(</span>CustomUser<span class="br0">)</span>principal<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw3">String</span> name <span class="sy0">=</span> user.<span class="me1">getUsername</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; model.<span class="me1">addAttribute</span><span class="br0">(</span><span class="st0">"username"</span>, name<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; model.<span class="me1">addAttribute</span><span class="br0">(</span><span class="st0">"message"</span>, <span class="st0">"Welcome to the secured page"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">"home"</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">package com.kb.controller;


import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

import com.kb.model.CustomUser;


@Controller
public class HomeController {
	
	
	@RequestMapping(value="/helloworld", method = RequestMethod.GET)
	public String helloWorld(ModelMap model) {
	model.addAttribute("message", "Welcome to the Hello World page");
	return "helloworld";
	 
	}
	
	@RequestMapping(value="/secured/home", method = RequestMethod.GET)
	public String securedHome(ModelMap model) {
		Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal();
		CustomUser user=null;
		if (principal instanceof CustomUser) {
		user = ((CustomUser)principal);
		}
	 
	String name = user.getUsername();
	model.addAttribute("username", name);
	model.addAttribute("message", "Welcome to the secured page");
	return "home";
	 
	}

}</pre>
          </div>
         </div> 
         <p> Create a custom authentication provider class as below</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td>
              <td class="de1"><pre class="de1"><span class="kw1">package</span> <span class="co2">com.kb.authentication.provider</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">java.util.Collection</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">org.springframework.beans.factory.annotation.Autowired</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.authentication.AuthenticationProvider</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.authentication.BadCredentialsException</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.authentication.UsernamePasswordAuthenticationToken</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.Authentication</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.AuthenticationException</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.GrantedAuthority</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.stereotype.Component</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">com.kb.model.CustomUser</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">com.kb.service.CustomUserService</span><span class="sy0">;</span>
&nbsp;
@<span class="kw3">Component</span>
<span class="kw1">public</span> <span class="kw1">class</span> CustomAuthenticationProvider <span class="kw1">implements</span> AuthenticationProvider<span class="br0">{</span>
&nbsp;
&nbsp; &nbsp; @Autowired
&nbsp; &nbsp; <span class="kw1">private</span> CustomUserService userService<span class="sy0">;</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; <span class="kw1">public</span> Authentication authenticate<span class="br0">(</span>Authentication authentication<span class="br0">)</span> <span class="kw1">throws</span> <span class="kw3">AuthenticationException</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">String</span> username <span class="sy0">=</span> authentication.<span class="me1">getName</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">String</span> password <span class="sy0">=</span> <span class="br0">(</span><span class="kw3">String</span><span class="br0">)</span> authentication.<span class="me1">getCredentials</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CustomUser user <span class="sy0">=</span> userService.<span class="me1">loadUserByUsername</span><span class="br0">(</span>username<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>user <span class="sy0">==</span> <span class="kw2">null</span> <span class="sy0">||</span> <span class="sy0">!</span>user.<span class="me1">getUsername</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">equalsIgnoreCase</span><span class="br0">(</span>username<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">throw</span> <span class="kw1">new</span> BadCredentialsException<span class="br0">(</span><span class="st0">"Username not found."</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>password.<span class="me1">equals</span><span class="br0">(</span>user.<span class="me1">getPassword</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">throw</span> <span class="kw1">new</span> BadCredentialsException<span class="br0">(</span><span class="st0">"Wrong password."</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Collection<span class="sy0">&lt;?</span> <span class="kw1">extends</span> GrantedAuthority<span class="sy0">&gt;</span> authorities <span class="sy0">=</span> user.<span class="me1">getAuthorities</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw1">new</span> UsernamePasswordAuthenticationToken<span class="br0">(</span>user, password, authorities<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">boolean</span> supports<span class="br0">(</span>Class<span class="sy0">&lt;?&gt;</span> arg0<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw2">true</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">package com.kb.authentication.provider;

import java.util.Collection;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.authentication.AuthenticationProvider;
import org.springframework.security.authentication.BadCredentialsException;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.AuthenticationException;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.stereotype.Component;

import com.kb.model.CustomUser;
import com.kb.service.CustomUserService;

@Component
public class CustomAuthenticationProvider implements AuthenticationProvider{

	@Autowired
	private CustomUserService userService;
	
	public Authentication authenticate(Authentication authentication) throws AuthenticationException {
		  String username = authentication.getName();
	      String password = (String) authentication.getCredentials();
	 
	        CustomUser user = userService.loadUserByUsername(username);
	 
	        if (user == null || !user.getUsername().equalsIgnoreCase(username)) {
	            throw new BadCredentialsException("Username not found.");
	        }
	 
	        if (!password.equals(user.getPassword())) {
	            throw new BadCredentialsException("Wrong password.");
	        }
	 
	        Collection&lt;? extends GrantedAuthority&gt; authorities = user.getAuthorities();
	 
	        return new UsernamePasswordAuthenticationToken(user, password, authorities);
	}

	public boolean supports(Class&lt;?&gt; arg0) {
		return true;
	}

}</pre>
          </div>
         </div> 
         <p>Our custom class implements AuthenticationProvider interface provided by spring security<br> And authenticate method is overridden with our logic.<br> We will call service class method to load the user based on user name.<br> If the user is not found or password mismatch then throw an exception , if he is a valid user return the authentication token which is expected by spring security.</p>
         <!--Ad Injection:random--> 
         <div style="">
          <center>
           <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
           <!-- javainsimpleway_ad2 --> 
           <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9157887158094484" data-ad-slot="2945253859" data-ad-format="auto"></ins> 
           <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
          </center>
         </div> 
         <p>Create a user service class to obtain the user details.</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td>
              <td class="de1"><pre class="de1"><span class="kw1">package</span> <span class="co2">com.kb.service</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">org.springframework.beans.factory.annotation.Autowired</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.userdetails.UserDetailsService</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.userdetails.UsernameNotFoundException</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">org.springframework.stereotype.Service</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">com.kb.dao.UserDAOImpl</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">com.kb.model.CustomUser</span><span class="sy0">;</span>
&nbsp;
@Service
<span class="kw1">public</span> <span class="kw1">class</span> CustomUserService <span class="kw1">implements</span> UserDetailsService <span class="br0">{</span>
&nbsp;
&nbsp; &nbsp; &nbsp;@Autowired
&nbsp; &nbsp; &nbsp;<span class="kw1">private</span> UserDAOImpl userDao<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> CustomUser loadUserByUsername<span class="br0">(</span><span class="kw3">String</span> username<span class="br0">)</span> <span class="kw1">throws</span> UsernameNotFoundException <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> userDao.<span class="me1">loadUserByUsername</span><span class="br0">(</span>username<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">package com.kb.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;

import com.kb.dao.UserDAOImpl;
import com.kb.model.CustomUser;

@Service
public class CustomUserService implements UserDetailsService {

	 @Autowired
	 private UserDAOImpl userDao;
	 
	 
	public CustomUser loadUserByUsername(String username) throws UsernameNotFoundException {
		return userDao.loadUserByUsername(username);
	}

}</pre>
          </div>
         </div> 
         <p>Service class calls the DAO layer to obtain the user data based on user name</p> 
         <p>Create the User DAO class which returns the user based on username supplied.</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td>
              <td class="de1"><pre class="de1"><span class="kw1">package</span> <span class="co2">com.kb.dao</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">java.util.ArrayList</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">java.util.List</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">org.springframework.stereotype.Repository</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">com.kb.model.CustomUser</span><span class="sy0">;</span>
<span class="kw1">import</span> <span class="co2">com.kb.model.Role</span><span class="sy0">;</span>
&nbsp;
@<span class="kw3">Repository</span>
<span class="kw1">public</span> <span class="kw1">class</span> UserDAOImpl <span class="br0">{</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;<span class="kw1">public</span> CustomUser loadUserByUsername<span class="br0">(</span><span class="kw1">final</span> <span class="kw3">String</span> username<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">//Write your DB call code to get the user details from DB,But I am just hard coding the user</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CustomUser user <span class="sy0">=</span> <span class="kw1">new</span> CustomUser<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.<span class="me1">setFirstName</span><span class="br0">(</span><span class="st0">"kb"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.<span class="me1">setLastName</span><span class="br0">(</span><span class="st0">"gc"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.<span class="me1">setUsername</span><span class="br0">(</span><span class="st0">"kb"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.<span class="me1">setPassword</span><span class="br0">(</span><span class="st0">"1234"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Role r <span class="sy0">=</span> <span class="kw1">new</span> Role<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r.<span class="me1">setName</span><span class="br0">(</span><span class="st0">"ROLE_USER"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List<span class="sy0">&lt;</span>Role<span class="sy0">&gt;</span> roles <span class="sy0">=</span> <span class="kw1">new</span> ArrayList<span class="sy0">&lt;</span>Role<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; roles.<span class="me1">add</span><span class="br0">(</span>r<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.<span class="me1">setAuthorities</span><span class="br0">(</span>roles<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> user<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">package com.kb.dao;

import java.util.ArrayList;
import java.util.List;

import org.springframework.stereotype.Repository;

import com.kb.model.CustomUser;
import com.kb.model.Role;

@Repository
public class UserDAOImpl {
	
	 public CustomUser loadUserByUsername(final String username) {
		 //Write your DB call code to get the user details from DB,But I am just hard coding the user
		 	CustomUser user = new CustomUser();
	        user.setFirstName("kb");
	        user.setLastName("gc");
	        user.setUsername("kb");
	        user.setPassword("1234");
	        Role r = new Role();
	        r.setName("ROLE_USER");
	        List&lt;Role&gt; roles = new ArrayList&lt;Role&gt;();
	        roles.add(r);
	        user.setAuthorities(roles);
	        return user;
	    }

}</pre>
          </div>
         </div> 
         <p>Create our own user class as below</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre></td>
              <td class="de1"><pre class="de1"><span class="kw1">package</span> <span class="co2">com.kb.model</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">java.util.List</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.userdetails.UserDetails</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">public</span> <span class="kw1">class</span> CustomUser <span class="kw1">implements</span> UserDetails <span class="br0">{</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw3">String</span> username<span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw3">String</span> password<span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw3">String</span> email<span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw3">String</span> firstName<span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw3">String</span> lastName<span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; <span class="coMULTI">/* Spring Security related fields*/</span>
&nbsp; &nbsp; <span class="kw1">private</span> List<span class="sy0">&lt;</span>Role<span class="sy0">&gt;</span> authorities<span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw4">boolean</span> accountNonExpired <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw4">boolean</span> accountNonLocked <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw4">boolean</span> credentialsNonExpired <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw4">boolean</span> enabled <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getUsername<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> username<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setUsername<span class="br0">(</span><span class="kw3">String</span> username<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">username</span> <span class="sy0">=</span> username<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getPassword<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> password<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setPassword<span class="br0">(</span><span class="kw3">String</span> password<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">password</span> <span class="sy0">=</span> password<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getEmail<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> email<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setEmail<span class="br0">(</span><span class="kw3">String</span> email<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">email</span> <span class="sy0">=</span> email<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getFirstName<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> firstName<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setFirstName<span class="br0">(</span><span class="kw3">String</span> firstName<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">firstName</span> <span class="sy0">=</span> firstName<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getLastName<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> lastName<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setLastName<span class="br0">(</span><span class="kw3">String</span> lastName<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">lastName</span> <span class="sy0">=</span> lastName<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> List<span class="sy0">&lt;</span>Role<span class="sy0">&gt;</span> getAuthorities<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> authorities<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setAuthorities<span class="br0">(</span>List<span class="sy0">&lt;</span>Role<span class="sy0">&gt;</span> authorities<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">authorities</span> <span class="sy0">=</span> authorities<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">boolean</span> isAccountNonExpired<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> accountNonExpired<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setAccountNonExpired<span class="br0">(</span><span class="kw4">boolean</span> accountNonExpired<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">accountNonExpired</span> <span class="sy0">=</span> accountNonExpired<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">boolean</span> isAccountNonLocked<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> accountNonLocked<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setAccountNonLocked<span class="br0">(</span><span class="kw4">boolean</span> accountNonLocked<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">accountNonLocked</span> <span class="sy0">=</span> accountNonLocked<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">boolean</span> isCredentialsNonExpired<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> credentialsNonExpired<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setCredentialsNonExpired<span class="br0">(</span><span class="kw4">boolean</span> credentialsNonExpired<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">credentialsNonExpired</span> <span class="sy0">=</span> credentialsNonExpired<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">boolean</span> isEnabled<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> enabled<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setEnabled<span class="br0">(</span><span class="kw4">boolean</span> enabled<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">enabled</span> <span class="sy0">=</span> enabled<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
<span class="br0">}</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">package com.kb.model;

import java.util.List;

import org.springframework.security.core.userdetails.UserDetails;

public class CustomUser implements UserDetails {
	
	private String username;
    private String password;
    private String email;
    private String firstName;
    private String lastName;
 
    /* Spring Security related fields*/
    private List&lt;Role&gt; authorities;
    private boolean accountNonExpired = true;
    private boolean accountNonLocked = true;
    private boolean credentialsNonExpired = true;
    private boolean enabled = true;
	public String getUsername() {
		return username;
	}
	public void setUsername(String username) {
		this.username = username;
	}
	public String getPassword() {
		return password;
	}
	public void setPassword(String password) {
		this.password = password;
	}
	public String getEmail() {
		return email;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public String getFirstName() {
		return firstName;
	}
	public void setFirstName(String firstName) {
		this.firstName = firstName;
	}
	public String getLastName() {
		return lastName;
	}
	public void setLastName(String lastName) {
		this.lastName = lastName;
	}
	public List&lt;Role&gt; getAuthorities() {
		return authorities;
	}
	public void setAuthorities(List&lt;Role&gt; authorities) {
		this.authorities = authorities;
	}
	public boolean isAccountNonExpired() {
		return accountNonExpired;
	}
	public void setAccountNonExpired(boolean accountNonExpired) {
		this.accountNonExpired = accountNonExpired;
	}
	public boolean isAccountNonLocked() {
		return accountNonLocked;
	}
	public void setAccountNonLocked(boolean accountNonLocked) {
		this.accountNonLocked = accountNonLocked;
	}
	public boolean isCredentialsNonExpired() {
		return credentialsNonExpired;
	}
	public void setCredentialsNonExpired(boolean credentialsNonExpired) {
		this.credentialsNonExpired = credentialsNonExpired;
	}
	public boolean isEnabled() {
		return enabled;
	}
	public void setEnabled(boolean enabled) {
		this.enabled = enabled;
	}

}</pre>
          </div>
         </div> 
         <p>Create a class Role</p> 
         <div class="bwp-syntax-block clearfix"> 
          <div class="bwp-syntax-toolbar">
           <div class="bwp-syntax-control">
            <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
           </div>
          </div> 
          <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
           <table class="java">
            <tbody>
             <tr class="li1">
              <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td>
              <td class="de1"><pre class="de1"><span class="kw1">package</span> <span class="co2">com.kb.model</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">java.util.List</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">import</span> <span class="co2">org.springframework.security.core.GrantedAuthority</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">public</span> <span class="kw1">class</span> Role <span class="kw1">implements</span> GrantedAuthority<span class="br0">{</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; <span class="kw1">private</span> <span class="kw3">String</span> name<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp;
&nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getName<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> name<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw4">void</span> setName<span class="br0">(</span><span class="kw3">String</span> name<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span>.<span class="me1">name</span> <span class="sy0">=</span> name<span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw3">String</span> getAuthority<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw1">this</span>.<span class="me1">name</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">}</span>
<span class="br0">}</span></pre></td>
             </tr>
            </tbody>
           </table>
          </div> 
          <div class="bwp-syntax-source">
           <pre class="no-parse">package com.kb.model;

import java.util.List;

import org.springframework.security.core.GrantedAuthority;

public class Role implements GrantedAuthority{
	
	private String name;
	 

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public String getAuthority() {
		return this.name;
	}
}</pre>
          </div>
         </div> 
         <p>Right click on the project and run as Maven install, copy the war file into webapps folder of server and start the server.<br> Let’s access the public url which is not intercepted by spring security</p> 
         <p>http://localhost:8080/SpringSecurityCustomAuthenticationProvider/helloworld</p> 
         <p><img alt="" class="alignnone size-full wp-image-522 " src="http://javainsimpleway.com/wp-content/uploads/2015/08/img_55cf923a04d18.png"></p> 
         <p>Let’s access the secured url which is intercepted by spring security</p> 
         <p>http://localhost:8080/SpringSecurityCustomAuthenticationProvider/secured/home</p> 
         <p><img alt="" class="alignnone size-full wp-image-523 " src="http://javainsimpleway.com/wp-content/uploads/2015/08/img_55cf924f80bad.png"></p> 
         <p>Let’s put invalid username and check the output</p> 
         <p><img alt="" class="alignnone size-full wp-image-526 " src="http://javainsimpleway.com/wp-content/uploads/2015/08/img_55cf940e852eb.png"></p> 
         <p>Let’s put invalid password and check the output</p> 
         <p><img alt="" class="alignnone size-full wp-image-527 " src="http://javainsimpleway.com/wp-content/uploads/2015/08/img_55cf94484f407.png"></p> 
         <p>Note : The error messages are coming as we mentioned in our provider class.</p> 
         <p>Let’s put valid credentials and check the output</p> 
         <p><img alt="" class="alignnone size-full wp-image-521 " src="http://javainsimpleway.com/wp-content/uploads/2015/08/img_55cf91464aaad.png"></p> 
         <p></p>
         <div id="stb-container-1500" class="stb-container-css stb-download-container stb-image-big stb-ltr stb-corners stb-shadow stb-side">
          <aside class="stb-icon">
           <img src="http://javainsimpleway.com/wp-content/stb-themes/stb-light/download.png">
          </aside>
          <div id="stb-box-1500" class="stb-download_box stb-box">
           Download this project 
           <a href="http://javainsimpleway.com/wp-content/uploads/2015/10/SpringSecurityCustomAuthenticationProvider.zip">SpringSecurityCustomAuthenticationProvider.zip</a>
          </div>
         </div> 
         <div class="author-info"> 
          <h2>About the Author</h2> 
         </div> 
         <div id="author-info" class="saboxplugin-wrap"> 
          <div class="saboxplugin-gravatar">
           <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="100" height="100" alt="Karibasappa G C (KB)" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 alignnone photo">
          </div> 
          <div class="saboxplugin-authorname">
           <a href="http://javainsimpleway.com/author/karibasappagc/">Karibasappa G C (KB)</a>
          </div> 
          <div class="saboxplugin-desc"> 
           <div class="vcard author">
            <span class="fn">Founder of javainsimpleway.com<br> I love Java and open source technologies and very much passionate about software development.<br> I like to share my knowledge with others especially on technology ?<br> I have given all the examples as simple as possible to understand for the beginners.<br> All the code posted on my blog is developed,compiled and tested in my development environment.<br> If you find any mistakes or bugs, Please drop an email to <b>kb.knowledge.sharing@gmail.com</b><p></p> <p>Connect with me on <a href="http://www.facebook.com/javainsimpleway"><b>Facebook</b></a> for more updates</p></span>
           </div> 
          </div> 
          <div class="clearfix"></div> 
          <div class="saboxplugin-socials "></div> 
         </div> 
         <!--Ad Injection:bottom--> 
         <div style="">
          <center>
           <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
           <ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-9157887158094484" data-ad-slot="2073179054"></ins> 
           <script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
          </center>
         </div>
         <div class="addtoany_share_save_container addtoany_content_bottom">
          <div class="addtoany_header">
           Share this article on
          </div>
          <div class="a2a_kit a2a_kit_size_50 addtoany_list a2a_target" id="wpa2a_1">
           <a class="a2a_button_facebook" href="http://www.addtoany.com/add_to/facebook?linkurl=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F&amp;linkname=Spring%20Security%20using%20Custom%20Authentication%20Provider" title="Facebook" rel="nofollow" target="_blank"></a>
           <a class="a2a_button_twitter" href="http://www.addtoany.com/add_to/twitter?linkurl=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F&amp;linkname=Spring%20Security%20using%20Custom%20Authentication%20Provider" title="Twitter" rel="nofollow" target="_blank"></a>
           <a class="a2a_button_google_plus" href="http://www.addtoany.com/add_to/google_plus?linkurl=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F&amp;linkname=Spring%20Security%20using%20Custom%20Authentication%20Provider" title="Google+" rel="nofollow" target="_blank"></a>
           <a class="a2a_button_linkedin" href="http://www.addtoany.com/add_to/linkedin?linkurl=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F&amp;linkname=Spring%20Security%20using%20Custom%20Authentication%20Provider" title="LinkedIn" rel="nofollow" target="_blank"></a>
           <a class="a2a_button_whatsapp" href="http://www.addtoany.com/add_to/whatsapp?linkurl=http%3A%2F%2Fjavainsimpleway.com%2Fspring-security-using-custom-authentication-provider%2F&amp;linkname=Spring%20Security%20using%20Custom%20Authentication%20Provider" title="WhatsApp" rel="nofollow" target="_blank"></a>
           <a class="a2a_dd addtoany_share_save" href="https://www.addtoany.com/share"></a> 
           <script type="text/javascript"><!--
if(wpa2a)wpa2a.script_load();
//--></script> 
          </div>
         </div> 
        </div> 
        <div id="author-info"></div> 
       </article> 
       <div class="single-page-paging"> 
        <div class="nb-prepost"> 
         <a rel="prev" href="http://javainsimpleway.com/spring-security-with-site-minder-integration/"> <span class="meta-nav">&lt;</span> Prev </a> 
        </div> 
        <div class="nb-nextpost"> 
         <a rel="next" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/">Next <span class="meta-nav">&gt;</span></a> 
        </div> 
       </div> 
       <div class="post-comment-form"> 
        <div id="comments" class="comments-area"> 
         <h2 class="comments-title"> Comment <a href="javascript:void(0);">(57)</a> </h2> 
         <ol class="commentlist"> 
          <li class="comment even thread-even depth-1" id="li-comment-112345"> 
           <article id="comment-112345" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">Chuck</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112345" class="post-date-section"><time datetime="2017-05-24T21:05:38+00:00">May 24, 2017 at 9:05 pm</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hello. Thank you for a great tutorial! I’ve implemented this in my project and it mostly works. I’m using Postman to test and if I don’t provide any authentication header my custom auth class (CustomAuthenticationProvider) is never called and I am able to access my REST service.</p> 
              <p>It seems as if Anonymous requests bypass this security. How can I prevent all Anonymous requests?</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112345#respond" onclick="return addComment.moveForm( &quot;comment-112345&quot;, &quot;112345&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Chuck">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment odd alt depth-2" id="li-comment-112346"> 
             <article id="comment-112346" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Chuck</b> </cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112346" class="post-date-section"><time datetime="2017-05-24T21:21:40+00:00">May 24, 2017 at 9:21 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>I should add that I’m using XML configuration.</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112346#respond" onclick="return addComment.moveForm( &quot;comment-112346&quot;, &quot;112346&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Chuck">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> 
             <ol class="children"> 
              <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-3" id="li-comment-112352"> 
               <article id="comment-112352" class="comment clearfix"> 
                <header class="comment-meta comment-author vcard"> 
                 <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                 <div class="date-author clearfix"> 
                  <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                  <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112352" class="post-date-section"><time datetime="2017-05-25T03:24:34+00:00">May 25, 2017 at 3:24 am</time></a> 
                 </div> 
                </header>
                <!-- .comment-meta --> 
                <div class="comment-wrapper"> 
                 <section class="comment-content comment"> 
                  <p>Hi,</p> 
                  <p>Great, Thank you !!</p> 
                 </section>
                 <!-- .comment-content --> 
                 <div class="comment-reply"> 
                  <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112352#respond" onclick="return addComment.moveForm( &quot;comment-112352&quot;, &quot;112352&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                 </div>
                 <!-- .reply --> 
                </div> 
               </article>
               <!-- #comment-## --> 
               <ol class="children"> 
                <li class="comment odd alt depth-4" id="li-comment-112363"> 
                 <article id="comment-112363" class="comment clearfix"> 
                  <header class="comment-meta comment-author vcard"> 
                   <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                   <div class="date-author clearfix"> 
                    <cite><b class="fn">Chuck</b> </cite>
                    <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112363" class="post-date-section"><time datetime="2017-05-25T12:48:12+00:00">May 25, 2017 at 12:48 pm</time></a> 
                   </div> 
                  </header>
                  <!-- .comment-meta --> 
                  <div class="comment-wrapper"> 
                   <section class="comment-content comment"> 
                    <p>Do you have an answer for my question?<br> It seems as if Anonymous requests bypass this security. How can I prevent all Anonymous requests?</p> 
                   </section>
                   <!-- .comment-content --> 
                   <div class="comment-reply"> 
                    <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112363#respond" onclick="return addComment.moveForm( &quot;comment-112363&quot;, &quot;112363&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Chuck">Reply</a> 
                   </div>
                   <!-- .reply --> 
                  </div> 
                 </article>
                 <!-- #comment-## --> 
                 <ol class="children"> 
                  <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-5" id="li-comment-112364"> 
                   <article id="comment-112364" class="comment clearfix"> 
                    <header class="comment-meta comment-author vcard"> 
                     <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                     <div class="date-author clearfix"> 
                      <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                      <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112364" class="post-date-section"><time datetime="2017-05-25T12:54:06+00:00">May 25, 2017 at 12:54 pm</time></a> 
                     </div> 
                    </header>
                    <!-- .comment-meta --> 
                    <div class="comment-wrapper"> 
                     <section class="comment-content comment"> 
                      <p>&lt; intercept-url pattern="/secured/*" access="ROLE_USER" / &gt; </p> 
                      <p>This line should allow to access only for those users who have ROLE_USER, It should not allow for anonymous as they don’t have this role….Please let me know if its any specific case.</p> 
                     </section>
                     <!-- .comment-content --> 
                     <div class="comment-reply"> 
                      <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112364#respond" onclick="return addComment.moveForm( &quot;comment-112364&quot;, &quot;112364&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                     </div>
                     <!-- .reply --> 
                    </div> 
                   </article>
                   <!-- #comment-## --> 
                   <ol class="children"> 
                    <li class="comment odd alt depth-6" id="li-comment-112367"> 
                     <article id="comment-112367" class="comment clearfix"> 
                      <header class="comment-meta comment-author vcard"> 
                       <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                       <div class="date-author clearfix"> 
                        <cite><b class="fn">Chuck</b> </cite>
                        <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112367" class="post-date-section"><time datetime="2017-05-25T13:23:06+00:00">May 25, 2017 at 1:23 pm</time></a> 
                       </div> 
                      </header>
                      <!-- .comment-meta --> 
                      <div class="comment-wrapper"> 
                       <section class="comment-content comment"> 
                        <p>What line? Was there supposed to be code in your last response?</p> 
                        <p>Here is how I have my Spring security xml setup now.</p> 
                        <p>I appreciate the help!</p> 
                       </section>
                       <!-- .comment-content --> 
                       <div class="comment-reply"> 
                        <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112367#respond" onclick="return addComment.moveForm( &quot;comment-112367&quot;, &quot;112367&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Chuck">Reply</a> 
                       </div>
                       <!-- .reply --> 
                      </div> 
                     </article>
                     <!-- #comment-## --> 
                     <ol class="children"> 
                      <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-7" id="li-comment-112368"> 
                       <article id="comment-112368" class="comment clearfix"> 
                        <header class="comment-meta comment-author vcard"> 
                         <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                         <div class="date-author clearfix"> 
                          <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                          <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112368" class="post-date-section"><time datetime="2017-05-25T13:35:31+00:00">May 25, 2017 at 1:35 pm</time></a> 
                         </div> 
                        </header>
                        <!-- .comment-meta --> 
                        <div class="comment-wrapper"> 
                         <section class="comment-content comment"> 
                          <p>yes. Please check the previous reply.</p> 
                          <p>I could not see any xml in the reply.</p> 
                         </section>
                         <!-- .comment-content --> 
                         <div class="comment-reply"> 
                          <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112368#respond" onclick="return addComment.moveForm( &quot;comment-112368&quot;, &quot;112368&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                         </div>
                         <!-- .reply --> 
                        </div> 
                       </article>
                       <!-- #comment-## --> 
                       <ol class="children"> 
                        <li class="comment odd alt depth-8" id="li-comment-112370"> 
                         <article id="comment-112370" class="comment clearfix"> 
                          <header class="comment-meta comment-author vcard"> 
                           <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                           <div class="date-author clearfix"> 
                            <cite><b class="fn">Chuck</b> </cite>
                            <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112370" class="post-date-section"><time datetime="2017-05-25T13:53:53+00:00">May 25, 2017 at 1:53 pm</time></a> 
                           </div> 
                          </header>
                          <!-- .comment-meta --> 
                          <div class="comment-wrapper"> 
                           <section class="comment-content comment"> 
                            <p>It looks like the web site is stripping XML from the comment. I’ll try replacing the with %</p> 
                            <p>The only way I was able to see yours was to view the source for the page.</p> 
                            <p> %http auto-config=’true’%<br> %intercept-url pattern=”/services/**” access=”ROLE_USER” /%<br> %csrf disabled=”true”/%<br> %anonymous enabled=’false’/%<br> %/http%</p> 
                           </section>
                           <!-- .comment-content --> 
                           <div class="comment-reply"> 
                            <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112370#respond" onclick="return addComment.moveForm( &quot;comment-112370&quot;, &quot;112370&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Chuck">Reply</a> 
                           </div>
                           <!-- .reply --> 
                          </div> 
                         </article>
                         <!-- #comment-## --> 
                         <ol class="children"> 
                          <li class="comment even depth-9" id="li-comment-112374"> 
                           <article id="comment-112374" class="comment clearfix"> 
                            <header class="comment-meta comment-author vcard"> 
                             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                             <div class="date-author clearfix"> 
                              <cite><b class="fn">Chuck</b> </cite>
                              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112374" class="post-date-section"><time datetime="2017-05-25T14:55:01+00:00">May 25, 2017 at 2:55 pm</time></a> 
                             </div> 
                            </header>
                            <!-- .comment-meta --> 
                            <div class="comment-wrapper"> 
                             <section class="comment-content comment"> 
                              <p>I figured it out. My “context-root” wasn’t set right in jboss-web.xml</p> 
                              <p>It was set to “/services”</p> 
                              <p>When I change it to “/” everything works.</p> 
                              <p>Thank you for the help!</p> 
                             </section>
                             <!-- .comment-content --> 
                             <div class="comment-reply"> 
                              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=112374#respond" onclick="return addComment.moveForm( &quot;comment-112374&quot;, &quot;112374&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Chuck">Reply</a> 
                             </div>
                             <!-- .reply --> 
                            </div> 
                           </article>
                           <!-- #comment-## --> 
                           <ol class="children"> 
                            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-10" id="li-comment-112380"> 
                             <article id="comment-112380" class="comment clearfix"> 
                              <header class="comment-meta comment-author vcard"> 
                               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                               <div class="date-author clearfix"> 
                                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-112380" class="post-date-section"><time datetime="2017-05-25T19:43:30+00:00">May 25, 2017 at 7:43 pm</time></a> 
                               </div> 
                              </header>
                              <!-- .comment-meta --> 
                              <div class="comment-wrapper"> 
                               <section class="comment-content comment"> 
                                <p>Great !!</p> 
                               </section>
                               <!-- .comment-content --> 
                               <div class="comment-reply"> 
                               </div>
                               <!-- .reply --> 
                              </div> 
                             </article>
                             <!-- #comment-## --> </li>
                            <!-- #comment-## --> 
                           </ol>
                           <!-- .children --> </li>
                          <!-- #comment-## --> 
                         </ol>
                         <!-- .children --> </li>
                        <!-- #comment-## --> 
                       </ol>
                       <!-- .children --> </li>
                      <!-- #comment-## --> 
                     </ol>
                     <!-- .children --> </li>
                    <!-- #comment-## --> 
                   </ol>
                   <!-- .children --> </li>
                  <!-- #comment-## --> 
                 </ol>
                 <!-- .children --> </li>
                <!-- #comment-## --> 
               </ol>
               <!-- .children --> </li>
              <!-- #comment-## --> 
             </ol>
             <!-- .children --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-odd thread-alt depth-1" id="li-comment-111738"> 
           <article id="comment-111738" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://1.gravatar.com/avatar/a03a8a7ed8baad3db7cf710d5492f5d5?s=50&amp;d=http%3A%2F%2Fjavainsimpleway.com%2Fwp-content%2Fplugins%2Fwp-user-avatar%2Fimages%2Fwpua-96x96.png&amp;r=g" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">Gil9091</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-111738" class="post-date-section"><time datetime="2017-04-24T06:52:14+00:00">April 24, 2017 at 6:52 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hello. Good post. </p> 
              <p>I would like to know if it is possible to perform several authentication methods with spring security. That is to say, the case of authenticating users through a form or that the same can be authenticated using another means for example with your gmail account through gmail. I know that with spring security there is the possibility of performing encrypted token authentication but I have not seen that it can be done both ways in the same application using spring security.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=111738#respond" onclick="return addComment.moveForm( &quot;comment-111738&quot;, &quot;111738&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Gil9091">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-111743"> 
             <article id="comment-111743" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-111743" class="post-date-section"><time datetime="2017-04-24T13:13:41+00:00">April 24, 2017 at 1:13 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Good question!!</p> 
                <p>We can do that in spring security.</p> 
                <p>For applications to authenticate users through third parties .The best option to use is OAUTH using tokens which is more secure and widely accepted one.</p> 
                <p>Please check <a href="http://javainsimpleway.com/oauth-overview/"><strong>this article</strong></a> on the same.</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=111743#respond" onclick="return addComment.moveForm( &quot;comment-111743&quot;, &quot;111743&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> 
             <ol class="children"> 
              <li class="comment even depth-3" id="li-comment-111744"> 
               <article id="comment-111744" class="comment clearfix"> 
                <header class="comment-meta comment-author vcard"> 
                 <img src="http://1.gravatar.com/avatar/a03a8a7ed8baad3db7cf710d5492f5d5?s=50&amp;d=http%3A%2F%2Fjavainsimpleway.com%2Fwp-content%2Fplugins%2Fwp-user-avatar%2Fimages%2Fwpua-96x96.png&amp;r=g" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                 <div class="date-author clearfix"> 
                  <cite><b class="fn">Gil9091</b> </cite>
                  <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-111744" class="post-date-section"><time datetime="2017-04-24T15:10:06+00:00">April 24, 2017 at 3:10 pm</time></a> 
                 </div> 
                </header>
                <!-- .comment-meta --> 
                <div class="comment-wrapper"> 
                 <section class="comment-content comment"> 
                  <p>Thanks for your answer.</p> 
                  <p>I have read the article and it is very clear, excellent. To which also in another project that I was working with spring security I implemented using OAuth2.</p> 
                  <p>But I have not yet managed to perform an authentication integrating both: authentication using credentials user and password, or, when it is authentication using a third party login for example through facebook, but this within the same application. That is, in case of using the authentication of my app will be validated with the records of the DB but in case of the authentication through third party login, authenticate it in my app through a security token.</p> 
                  <p>Thank you again for your attention.</p> 
                 </section>
                 <!-- .comment-content --> 
                 <div class="comment-reply"> 
                  <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=111744#respond" onclick="return addComment.moveForm( &quot;comment-111744&quot;, &quot;111744&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Gil9091">Reply</a> 
                 </div>
                 <!-- .reply --> 
                </div> 
               </article>
               <!-- #comment-## --> 
               <ol class="children"> 
                <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-4" id="li-comment-111745"> 
                 <article id="comment-111745" class="comment clearfix"> 
                  <header class="comment-meta comment-author vcard"> 
                   <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                   <div class="date-author clearfix"> 
                    <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                    <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-111745" class="post-date-section"><time datetime="2017-04-24T17:10:05+00:00">April 24, 2017 at 5:10 pm</time></a> 
                   </div> 
                  </header>
                  <!-- .comment-meta --> 
                  <div class="comment-wrapper"> 
                   <section class="comment-content comment"> 
                    <p>Ok you are welcome ?</p> 
                   </section>
                   <!-- .comment-content --> 
                   <div class="comment-reply"> 
                    <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=111745#respond" onclick="return addComment.moveForm( &quot;comment-111745&quot;, &quot;111745&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                   </div>
                   <!-- .reply --> 
                  </div> 
                 </article>
                 <!-- #comment-## --> </li>
                <!-- #comment-## --> 
               </ol>
               <!-- .children --> </li>
              <!-- #comment-## --> 
             </ol>
             <!-- .children --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-even depth-1" id="li-comment-110783"> 
           <article id="comment-110783" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">Maneesh</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-110783" class="post-date-section"><time datetime="2017-01-07T00:40:24+00:00">January 7, 2017 at 12:40 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Karibasappa,</p> 
              <p>Great tutorial!</p> 
              <p>I have a small doubt. In the code below, how can I catch the message given in the bad credentials exception in a Spring MVC controller where I call the custom authentication code.</p> 
              <p> if (user == null || !user.getUsername().equalsIgnoreCase(username)) {<br> throw new BadCredentialsException(“Username not found.”);<br> }</p> 
              <p> if (!password.equals(user.getPassword())) {<br> throw new BadCredentialsException(“Wrong password.”);<br> }</p> 
              <p>Thanks.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=110783#respond" onclick="return addComment.moveForm( &quot;comment-110783&quot;, &quot;110783&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Maneesh">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-110787"> 
             <article id="comment-110787" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-110787" class="post-date-section"><time datetime="2017-01-07T14:20:37+00:00">January 7, 2017 at 2:20 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Hi Maneesh,</p> 
                <p>Thank you!!</p> 
                <p>You can catch the message of any Exception thrown by the Authentication provider in the controller using SPRING_SECURITY_LAST_EXCEPTION session attribute</p> 
                <p>Its a session attribute set by spring security whenever any exception is thrown in the authentication provider.</p> 
                <p>So in your controller, you can use the below code and get the exception message </p> 
                <div class="bwp-syntax-block clearfix"> 
                 <div class="bwp-syntax-toolbar">
                  <div class="bwp-syntax-control">
                   <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                  </div>
                 </div> 
                 <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                  <table class="java">
                   <tbody>
                    <tr class="li1">
                     <td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td>
                     <td class="de1"><pre class="de1"><span class="kw3">Object</span> lastException &nbsp;<span class="sy0">=</span> request.<span class="me1">getSession</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getAttribute</span><span class="br0">(</span><span class="st0">"SPRING_SECURITY_LAST_EXCEPTION"</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">(</span>lastException &nbsp;<span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<span class="kw3">String</span> exceptionMsg <span class="sy0">=</span> <span class="br0">(</span><span class="br0">(</span><span class="kw3">Exception</span><span class="br0">)</span> lastException<span class="br0">)</span>.<span class="me1">getMessage</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span></pre></td>
                    </tr>
                   </tbody>
                  </table>
                 </div> 
                 <div class="bwp-syntax-source">
                  <pre class="no-parse">Object lastException  = request.getSession().getAttribute("SPRING_SECURITY_LAST_EXCEPTION");

if (lastException  != null)
		{
			
String exceptionMsg = ((Exception) lastException).getMessage();
}</pre>
                 </div>
                </div> 
                <p>You can add it in the model attribute to send it to JSP page.</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=110787#respond" onclick="return addComment.moveForm( &quot;comment-110787&quot;, &quot;110787&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> 
             <ol class="children"> 
              <li class="comment even depth-3" id="li-comment-110807"> 
               <article id="comment-110807" class="comment clearfix"> 
                <header class="comment-meta comment-author vcard"> 
                 <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                 <div class="date-author clearfix"> 
                  <cite><b class="fn">Maneesh</b> </cite>
                  <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-110807" class="post-date-section"><time datetime="2017-01-09T18:38:33+00:00">January 9, 2017 at 6:38 pm</time></a> 
                 </div> 
                </header>
                <!-- .comment-meta --> 
                <div class="comment-wrapper"> 
                 <section class="comment-content comment"> 
                  <p>That helped. Thanks a lot!</p> 
                 </section>
                 <!-- .comment-content --> 
                 <div class="comment-reply"> 
                  <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=110807#respond" onclick="return addComment.moveForm( &quot;comment-110807&quot;, &quot;110807&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Maneesh">Reply</a> 
                 </div>
                 <!-- .reply --> 
                </div> 
               </article>
               <!-- #comment-## --> 
               <ol class="children"> 
                <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-4" id="li-comment-110810"> 
                 <article id="comment-110810" class="comment clearfix"> 
                  <header class="comment-meta comment-author vcard"> 
                   <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                   <div class="date-author clearfix"> 
                    <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                    <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-110810" class="post-date-section"><time datetime="2017-01-10T02:07:36+00:00">January 10, 2017 at 2:07 am</time></a> 
                   </div> 
                  </header>
                  <!-- .comment-meta --> 
                  <div class="comment-wrapper"> 
                   <section class="comment-content comment"> 
                    <p>you are welcome !!</p> 
                   </section>
                   <!-- .comment-content --> 
                   <div class="comment-reply"> 
                    <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=110810#respond" onclick="return addComment.moveForm( &quot;comment-110810&quot;, &quot;110810&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                   </div>
                   <!-- .reply --> 
                  </div> 
                 </article>
                 <!-- #comment-## --> </li>
                <!-- #comment-## --> 
               </ol>
               <!-- .children --> </li>
              <!-- #comment-## --> 
             </ol>
             <!-- .children --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-odd thread-alt depth-1" id="li-comment-110744"> 
           <article id="comment-110744" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">John</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-110744" class="post-date-section"><time datetime="2017-01-03T04:58:09+00:00">January 3, 2017 at 4:58 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hi,</p> 
              <p>Interesting post. I have a question. You used AuthenticationProvider to wire-up your code which performs both authentication and authorization. Although this approach is simple to implement but your custom AuthenticationProvider should be doing authentication only and not both.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=110744#respond" onclick="return addComment.moveForm( &quot;comment-110744&quot;, &quot;110744&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to John">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-110749"> 
             <article id="comment-110749" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-110749" class="post-date-section"><time datetime="2017-01-03T18:11:12+00:00">January 3, 2017 at 6:11 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Hi John, </p> 
                <p>If you look at my authentication provider, I am not doing any authorization there, I have just taken the user roles and passing it to Spring security using UsernamePasswordAuthenticationToken as below</p> 
                <div class="bwp-syntax-block clearfix"> 
                 <div class="bwp-syntax-toolbar">
                  <div class="bwp-syntax-control">
                   <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                  </div>
                 </div> 
                 <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                  <table class="java">
                   <tbody>
                    <tr class="li1">
                     <td class="ln"><pre class="de1">1
</pre></td>
                     <td class="de1"><pre class="de1">&nbsp; <span class="kw1">return</span> <span class="kw1">new</span> UsernamePasswordAuthenticationToken<span class="br0">(</span>user, password, authorities<span class="br0">)</span><span class="sy0">;</span></pre></td>
                    </tr>
                   </tbody>
                  </table>
                 </div> 
                 <div class="bwp-syntax-source">
                  <pre class="no-parse">  return new UsernamePasswordAuthenticationToken(user, password, authorities);</pre>
                 </div>
                </div> 
                <p>Authorization will be done by Spring using the Roles passed to this token.</p> 
                <p>Thanks!!</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=110749#respond" onclick="return addComment.moveForm( &quot;comment-110749&quot;, &quot;110749&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-even depth-1" id="li-comment-103756"> 
           <article id="comment-103756" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">Ankit Agarwal</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103756" class="post-date-section"><time datetime="2016-11-07T00:05:22+00:00">November 7, 2016 at 12:05 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>This is misleading information. on your security xml in above post, you didn’t mention tag but on your downloaded code, you had included it. </p> 
              <p>Please avoid such mistakes.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103756#respond" onclick="return addComment.moveForm( &quot;comment-103756&quot;, &quot;103756&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Ankit Agarwal">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-103762"> 
             <article id="comment-103762" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103762" class="post-date-section"><time datetime="2016-11-07T03:51:48+00:00">November 7, 2016 at 3:51 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Can you tell me which tag you are talking about ?<br> If you just say tag,i cant understand anything, if you tell me exact piece of code i can correct it after verifying the same.</p> 
                <p>In download code there is a login form tag in security xml , if you are talking about that, then you are wrong, that is only for using custom login form which is an extra piece of code used for another article.</p> 
                <p>Please tell me the details where you are finding discrepancy.</p> 
                <p>Thank you!!</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103762#respond" onclick="return addComment.moveForm( &quot;comment-103762&quot;, &quot;103762&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-odd thread-alt depth-1" id="li-comment-103544"> 
           <article id="comment-103544" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">Sameer</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103544" class="post-date-section"><time datetime="2016-10-30T12:14:56+00:00">October 30, 2016 at 12:14 pm</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hi,</p> 
              <p>I am trying to authenticate my JAX-RS rest APIs using spring authentication . I have created spring filter chain proxy referring this link here <a href="http://shazsterblog.blogspot.in/2014/07/spring-security-custom-filterchainproxy.html" rel="nofollow">http://shazsterblog.blogspot.in/2014/07/spring-security-custom-filterchainproxy.html</a>. I want to have basic authentication for my APIs. I don’t know where to specify basic authentication configuration. I have created CustomAuthenticationProvider and CustomUserDetailsService. When I hit any service URL it says 403 – Access Denied and when I hit /login the request return 200. How do I implement my login service and how to specify the session timeout. Please help me with this.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103544#respond" onclick="return addComment.moveForm( &quot;comment-103544&quot;, &quot;103544&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Sameer">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-103597"> 
             <article id="comment-103597" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103597" class="post-date-section"><time datetime="2016-11-01T15:02:39+00:00">November 1, 2016 at 3:02 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Hi, </p> 
                <p>If you want to store the credentials for basic authentication in xml you can put it in the xml file as explained in this post <a href="http://javainsimpleway.com/spring-security-hello-world-project/" rel="nofollow">http://javainsimpleway.com/spring-security-hello-world-project/</a> or if you want to get it from DB then you can use this link <a href="http://javainsimpleway.com/spring-security-using-database-authentication/" rel="nofollow">http://javainsimpleway.com/spring-security-using-database-authentication/</a><br> Then hit the service, it will prompt for authentication and then provide the same credentials.</p> 
                <p>for session timeout after 15 minutes, you can put below config in web.xml</p> 
                <div class="bwp-syntax-block clearfix"> 
                 <div class="bwp-syntax-toolbar">
                  <div class="bwp-syntax-control">
                   <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                  </div>
                 </div> 
                 <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                  <table class="java">
                   <tbody>
                    <tr class="li1">
                     <td class="ln"><pre class="de1">1
2
3
4
</pre></td>
                     <td class="de1"><pre class="de1"><span class="sy0">&lt;</span>session <span class="sy0">-</span>config<span class="sy0">&gt;</span>
&nbsp; &nbsp; <span class="sy0">&lt;</span> session<span class="sy0">-</span>timeout<span class="sy0">&gt;</span><span class="nu0">15</span><span class="sy0">&lt;</span> <span class="sy0">/</span>session<span class="sy0">-</span>timeout<span class="sy0">&gt;</span>
<span class="sy0">&lt;</span> <span class="sy0">/</span>session<span class="sy0">-</span>config<span class="sy0">&gt;</span>
<span class="sy0">&lt;/</span>session<span class="sy0">&gt;</span></pre></td>
                    </tr>
                   </tbody>
                  </table>
                 </div> 
                 <div class="bwp-syntax-source">
                  <pre class="no-parse">&lt;session -config&gt;
    &lt; session-timeout&gt;15&lt; /session-timeout&gt;
&lt; /session-config&gt;
&lt;/session&gt;</pre>
                 </div>
                </div> 
                <p>Thank you!!</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103597#respond" onclick="return addComment.moveForm( &quot;comment-103597&quot;, &quot;103597&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-even depth-1" id="li-comment-103042"> 
           <article id="comment-103042" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">iliyas</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103042" class="post-date-section"><time datetime="2016-10-13T06:38:09+00:00">October 13, 2016 at 6:38 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>nice post,But i want to store roles(like admin,sec user,manage,corp user etc.) in database and based on login i want to fetch that roles from db and display to user in terms of menus</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103042#respond" onclick="return addComment.moveForm( &quot;comment-103042&quot;, &quot;103042&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to iliyas">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-103052"> 
             <article id="comment-103052" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103052" class="post-date-section"><time datetime="2016-10-13T16:03:33+00:00">October 13, 2016 at 4:03 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Thanks Iliyas!!</p> 
                <p>I am just trying to understand your requirement.</p> 
                <p>When the user provides login credentials and click on login, you need to fetch all the roles of the logged in user and display it in the Menu.</p> 
                <p>Please correct me If my understanding is incorrect,but assuming its correct, you need to get the roles from below API<br> Collection&lt; ? extends GrantedAuthority&gt; authorities = (Collection&lt; ? extends GrantedAuthority&gt;) SecurityContextHolder.getContext().getAuthentication().getAuthorities();<br> and use it wherever you want.</p> 
                <p>you can see below lines in HomeController.java in this article</p> 
                <div class="bwp-syntax-block clearfix"> 
                 <div class="bwp-syntax-toolbar">
                  <div class="bwp-syntax-control">
                   <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                  </div>
                 </div> 
                 <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                  <table class="java">
                   <tbody>
                    <tr class="li1">
                     <td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td>
                     <td class="de1"><pre class="de1"><span class="kw3">Object</span> principal <span class="sy0">=</span> SecurityContextHolder.<span class="me1">getContext</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getAuthentication</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getPrincipal</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; CustomUser user<span class="sy0">=</span><span class="kw2">null</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>principal <span class="kw1">instanceof</span> CustomUser<span class="br0">)</span> <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; user <span class="sy0">=</span> <span class="br0">(</span><span class="br0">(</span>CustomUser<span class="br0">)</span>principal<span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw3">String</span> name <span class="sy0">=</span> user.<span class="me1">getUsername</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; model.<span class="me1">addAttribute</span><span class="br0">(</span><span class="st0">"username"</span>, name<span class="br0">)</span><span class="sy0">;</span></pre></td>
                    </tr>
                   </tbody>
                  </table>
                 </div> 
                 <div class="bwp-syntax-source">
                  <pre class="no-parse">Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal();
        CustomUser user=null;
        if (principal instanceof CustomUser) {
        user = ((CustomUser)principal);
        }
     
    String name = user.getUsername();
    model.addAttribute("username", name);</pre>
                 </div>
                </div> 
                <p>we are getting user name from principal and adding inside model attribute</p> 
                <p>Similalry you can get the roles from principal and add them inside model attribute using </p>
                <div class="bwp-syntax-block clearfix"> 
                 <div class="bwp-syntax-toolbar">
                  <div class="bwp-syntax-control">
                   <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                  </div>
                 </div> 
                 <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                  <table class="java">
                   <tbody>
                    <tr class="li1">
                     <td class="ln"><pre class="de1">1
</pre></td>
                     <td class="de1"><pre class="de1">model.<span class="me1">addAttribute</span><span class="br0">(</span><span class="st0">"authorities"</span>,principal.<span class="me1">getAuthorities</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span></pre></td>
                    </tr>
                   </tbody>
                  </table>
                 </div> 
                 <div class="bwp-syntax-source">
                  <pre class="no-parse">model.addAttribute("authorities",principal.getAuthorities());</pre>
                 </div>
                </div> 
                <p>and access them in JSP as below</p> 
                <div class="bwp-syntax-block clearfix"> 
                 <div class="bwp-syntax-toolbar">
                  <div class="bwp-syntax-control">
                   <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                  </div>
                 </div> 
                 <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                  <table class="java">
                   <tbody>
                    <tr class="li1">
                     <td class="ln"><pre class="de1">1
2
3
</pre></td>
                     <td class="de1"><pre class="de1"><span class="sy0">&lt;</span> c<span class="sy0">:</span><span class="kw1">forEach</span> items<span class="sy0">=</span><span class="st0">"${authorities}"</span> var<span class="sy0">=</span><span class="st0">"authority"</span><span class="sy0">&gt;</span>
$<span class="br0">{</span>authority.<span class="me1">authority</span><span class="br0">}</span>
<span class="sy0">&lt;</span> <span class="sy0">/</span>c<span class="sy0">:</span>forEach<span class="sy0">&gt;</span></pre></td>
                    </tr>
                   </tbody>
                  </table>
                 </div> 
                 <div class="bwp-syntax-source">
                  <pre class="no-parse">&lt; c:forEach items="${authorities}" var="authority"&gt;
${authority.authority}
&lt; /c:forEach&gt;</pre>
                 </div>
                </div> 
                <p>Thank you!!</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103052#respond" onclick="return addComment.moveForm( &quot;comment-103052&quot;, &quot;103052&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> 
             <ol class="children"> 
              <li class="comment even depth-3" id="li-comment-103109"> 
               <article id="comment-103109" class="comment clearfix"> 
                <header class="comment-meta comment-author vcard"> 
                 <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                 <div class="date-author clearfix"> 
                  <cite><b class="fn">Iliyas</b> </cite>
                  <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103109" class="post-date-section"><time datetime="2016-10-15T15:33:19+00:00">October 15, 2016 at 3:33 pm</time></a> 
                 </div> 
                </header>
                <!-- .comment-meta --> 
                <div class="comment-wrapper"> 
                 <section class="comment-content comment"> 
                  <p>I have mail my example project to your mail id .Please go through it and tell me what i need to customize in my project to get roles from database.Thank you.</p> 
                 </section>
                 <!-- .comment-content --> 
                 <div class="comment-reply"> 
                  <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103109#respond" onclick="return addComment.moveForm( &quot;comment-103109&quot;, &quot;103109&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Iliyas">Reply</a> 
                 </div>
                 <!-- .reply --> 
                </div> 
               </article>
               <!-- #comment-## --> 
               <ol class="children"> 
                <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-4" id="li-comment-103134"> 
                 <article id="comment-103134" class="comment clearfix"> 
                  <header class="comment-meta comment-author vcard"> 
                   <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                   <div class="date-author clearfix"> 
                    <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                    <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103134" class="post-date-section"><time datetime="2016-10-16T18:15:07+00:00">October 16, 2016 at 6:15 pm</time></a> 
                   </div> 
                  </header>
                  <!-- .comment-meta --> 
                  <div class="comment-wrapper"> 
                   <section class="comment-content comment"> 
                    <p>I did not get access to your project code and requested for access.</p> 
                   </section>
                   <!-- .comment-content --> 
                   <div class="comment-reply"> 
                    <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103134#respond" onclick="return addComment.moveForm( &quot;comment-103134&quot;, &quot;103134&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                   </div>
                   <!-- .reply --> 
                  </div> 
                 </article>
                 <!-- #comment-## --> 
                 <ol class="children"> 
                  <li class="comment even depth-5" id="li-comment-103153"> 
                   <article id="comment-103153" class="comment clearfix"> 
                    <header class="comment-meta comment-author vcard"> 
                     <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                     <div class="date-author clearfix"> 
                      <cite><b class="fn">Iliyas</b> </cite>
                      <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103153" class="post-date-section"><time datetime="2016-10-17T16:15:42+00:00">October 17, 2016 at 4:15 pm</time></a> 
                     </div> 
                    </header>
                    <!-- .comment-meta --> 
                    <div class="comment-wrapper"> 
                     <section class="comment-content comment"> 
                      <p>i have shared you through google drive .Please confirm and reply back.Thank you</p> 
                     </section>
                     <!-- .comment-content --> 
                     <div class="comment-reply"> 
                      <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103153#respond" onclick="return addComment.moveForm( &quot;comment-103153&quot;, &quot;103153&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Iliyas">Reply</a> 
                     </div>
                     <!-- .reply --> 
                    </div> 
                   </article>
                   <!-- #comment-## --> 
                   <ol class="children"> 
                    <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-6" id="li-comment-103155"> 
                     <article id="comment-103155" class="comment clearfix"> 
                      <header class="comment-meta comment-author vcard"> 
                       <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                       <div class="date-author clearfix"> 
                        <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                        <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103155" class="post-date-section"><time datetime="2016-10-17T17:31:22+00:00">October 17, 2016 at 5:31 pm</time></a> 
                       </div> 
                      </header>
                      <!-- .comment-meta --> 
                      <div class="comment-wrapper"> 
                       <section class="comment-content comment"> 
                        <p>I have checked your code.</p> 
                        <p>You have MainController in your project.</p> 
                        <p>So add below code in that controller</p> 
                        <div class="bwp-syntax-block clearfix"> 
                         <div class="bwp-syntax-toolbar">
                          <div class="bwp-syntax-control">
                           <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                          </div>
                         </div> 
                         <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                          <table class="java">
                           <tbody>
                            <tr class="li1">
                             <td class="ln"><pre class="de1">1
</pre></td>
                             <td class="de1"><pre class="de1">model.<span class="me1">addAttribute</span><span class="br0">(</span><span class="st0">"authorities"</span>, SecurityContextHolder.<span class="me1">getContext</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getAuthentication</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getPrincipal</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">getAuthorities</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span></pre></td>
                            </tr>
                           </tbody>
                          </table>
                         </div> 
                         <div class="bwp-syntax-source">
                          <pre class="no-parse">model.addAttribute("authorities", SecurityContextHolder.getContext().getAuthentication().getPrincipal().getAuthorities());</pre>
                         </div>
                        </div> 
                        <p>and add below code in your jsp wherever you want to display ex hello.jsp</p> 
                        <div class="bwp-syntax-block clearfix"> 
                         <div class="bwp-syntax-toolbar">
                          <div class="bwp-syntax-control">
                           <a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a>
                          </div>
                         </div> 
                         <div class="bwp-syntax-wrapper clearfix bwp-syntax-simple">
                          <table class="java">
                           <tbody>
                            <tr class="li1">
                             <td class="ln"><pre class="de1">1
2
3
</pre></td>
                             <td class="de1"><pre class="de1"><span class="sy0">&lt;</span> c<span class="sy0">:</span><span class="kw1">forEach</span> items<span class="sy0">=</span><span class="st0">"${authorities}"</span> var<span class="sy0">=</span><span class="st0">"authority"</span><span class="sy0">&gt;</span>
$<span class="br0">{</span>authority.<span class="me1">authority</span><span class="br0">}</span>
<span class="sy0">&lt;</span> <span class="sy0">/</span>c<span class="sy0">:</span>forEach<span class="sy0">&gt;</span></pre></td>
                            </tr>
                           </tbody>
                          </table>
                         </div> 
                         <div class="bwp-syntax-source">
                          <pre class="no-parse">&lt; c:forEach items="${authorities}" var="authority"&gt;
${authority.authority}
&lt; /c:forEach&gt;</pre>
                         </div>
                        </div> 
                       </section>
                       <!-- .comment-content --> 
                       <div class="comment-reply"> 
                        <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103155#respond" onclick="return addComment.moveForm( &quot;comment-103155&quot;, &quot;103155&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                       </div>
                       <!-- .reply --> 
                      </div> 
                     </article>
                     <!-- #comment-## --> 
                     <ol class="children"> 
                      <li class="comment even depth-7" id="li-comment-103180"> 
                       <article id="comment-103180" class="comment clearfix"> 
                        <header class="comment-meta comment-author vcard"> 
                         <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                         <div class="date-author clearfix"> 
                          <cite><b class="fn">iliyas</b> </cite>
                          <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103180" class="post-date-section"><time datetime="2016-10-18T11:46:00+00:00">October 18, 2016 at 11:46 am</time></a> 
                         </div> 
                        </header>
                        <!-- .comment-meta --> 
                        <div class="comment-wrapper"> 
                         <section class="comment-content comment"> 
                          <p>At the time of login first username and password is validate then based on userid&gt;&gt; roles and privileges(roles are interms of comma seperated like AB,BC,CD etc in single column) of that user get selected ,and based on database roles values menu should be display .Only that menu items are enable which exists in database ,if not then that menu link should be disable.So how i can achieve this requirement.Hope i will get expected solution.Thank you.</p> 
                         </section>
                         <!-- .comment-content --> 
                         <div class="comment-reply"> 
                          <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103180#respond" onclick="return addComment.moveForm( &quot;comment-103180&quot;, &quot;103180&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to iliyas">Reply</a> 
                         </div>
                         <!-- .reply --> 
                        </div> 
                       </article>
                       <!-- #comment-## --> 
                       <ol class="children"> 
                        <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-8" id="li-comment-103191"> 
                         <article id="comment-103191" class="comment clearfix"> 
                          <header class="comment-meta comment-author vcard"> 
                           <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                           <div class="date-author clearfix"> 
                            <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                            <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103191" class="post-date-section"><time datetime="2016-10-18T15:30:00+00:00">October 18, 2016 at 3:30 pm</time></a> 
                           </div> 
                          </header>
                          <!-- .comment-meta --> 
                          <div class="comment-wrapper"> 
                           <section class="comment-content comment"> 
                            <p>In my above previous reply, you can find the solution of how to get the roles and display them in JSP.</p> 
                            <p>You just need to put them in menu using html div and css code.</p> 
                            <p>enable the menu using jquery if roles &gt; 0 else disable it using jquery.</p> 
                           </section>
                           <!-- .comment-content --> 
                           <div class="comment-reply"> 
                            <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103191#respond" onclick="return addComment.moveForm( &quot;comment-103191&quot;, &quot;103191&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                           </div>
                           <!-- .reply --> 
                          </div> 
                         </article>
                         <!-- #comment-## --> 
                         <ol class="children"> 
                          <li class="comment even depth-9" id="li-comment-103192"> 
                           <article id="comment-103192" class="comment clearfix"> 
                            <header class="comment-meta comment-author vcard"> 
                             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                             <div class="date-author clearfix"> 
                              <cite><b class="fn">Iliyas</b> </cite>
                              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103192" class="post-date-section"><time datetime="2016-10-18T16:36:08+00:00">October 18, 2016 at 4:36 pm</time></a> 
                             </div> 
                            </header>
                            <!-- .comment-meta --> 
                            <div class="comment-wrapper"> 
                             <section class="comment-content comment"> 
                              <p>Thanks a lot Karibasappa ,I will go through this and get back to you.</p> 
                             </section>
                             <!-- .comment-content --> 
                             <div class="comment-reply"> 
                              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103192#respond" onclick="return addComment.moveForm( &quot;comment-103192&quot;, &quot;103192&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Iliyas">Reply</a> 
                             </div>
                             <!-- .reply --> 
                            </div> 
                           </article>
                           <!-- #comment-## --> 
                           <ol class="children"> 
                            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-10" id="li-comment-103195"> 
                             <article id="comment-103195" class="comment clearfix"> 
                              <header class="comment-meta comment-author vcard"> 
                               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                               <div class="date-author clearfix"> 
                                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103195" class="post-date-section"><time datetime="2016-10-18T18:43:26+00:00">October 18, 2016 at 6:43 pm</time></a> 
                               </div> 
                              </header>
                              <!-- .comment-meta --> 
                              <div class="comment-wrapper"> 
                               <section class="comment-content comment"> 
                                <p>You are welcome!!</p> 
                               </section>
                               <!-- .comment-content --> 
                               <div class="comment-reply"> 
                               </div>
                               <!-- .reply --> 
                              </div> 
                             </article>
                             <!-- #comment-## --> </li>
                            <!-- #comment-## --> 
                            <li class="comment even depth-10" id="li-comment-103242"> 
                             <article id="comment-103242" class="comment clearfix"> 
                              <header class="comment-meta comment-author vcard"> 
                               <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                               <div class="date-author clearfix"> 
                                <cite><b class="fn">iliyas</b> </cite>
                                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103242" class="post-date-section"><time datetime="2016-10-20T11:21:19+00:00">October 20, 2016 at 11:21 am</time></a> 
                               </div> 
                              </header>
                              <!-- .comment-meta --> 
                              <div class="comment-wrapper"> 
                               <section class="comment-content comment"> 
                                <p>I want to use filter for intercept url as shown below.</p> 
                                <p> 
                                 <!-- Authentication Manger config --></p> 
                                <p>how to customize “securityMetadataSource” to fetch roles from db.Thank you</p> 
                               </section>
                               <!-- .comment-content --> 
                               <div class="comment-reply"> 
                               </div>
                               <!-- .reply --> 
                              </div> 
                             </article>
                             <!-- #comment-## --> </li>
                            <!-- #comment-## --> 
                           </ol>
                           <!-- .children --> </li>
                          <!-- #comment-## --> 
                         </ol>
                         <!-- .children --> </li>
                        <!-- #comment-## --> 
                       </ol>
                       <!-- .children --> </li>
                      <!-- #comment-## --> 
                     </ol>
                     <!-- .children --> </li>
                    <!-- #comment-## --> 
                   </ol>
                   <!-- .children --> </li>
                  <!-- #comment-## --> 
                 </ol>
                 <!-- .children --> </li>
                <!-- #comment-## --> 
               </ol>
               <!-- .children --> </li>
              <!-- #comment-## --> 
             </ol>
             <!-- .children --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-102728"> 
           <article id="comment-102728" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">magicalne</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-102728" class="post-date-section"><time datetime="2016-09-28T07:55:37+00:00">September 28, 2016 at 7:55 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>when username is not found , i think throw “UsernameNotFoundException” is better.<br> btw, thanks bro</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=102728#respond" onclick="return addComment.moveForm( &quot;comment-102728&quot;, &quot;102728&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to magicalne">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-2" id="li-comment-102732"> 
             <article id="comment-102732" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-102732" class="post-date-section"><time datetime="2016-09-28T09:45:02+00:00">September 28, 2016 at 9:45 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Completely agree with you, we should do that.</p> 
                <p>I have just not focused on Exception modularity in this article but good point.</p> 
                <p>Thanks!!</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=102732#respond" onclick="return addComment.moveForm( &quot;comment-102732&quot;, &quot;102732&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
            <li class="comment odd alt depth-2" id="li-comment-103274"> 
             <article id="comment-103274" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Iliyas</b> </cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-103274" class="post-date-section"><time datetime="2016-10-21T02:07:31+00:00">October 21, 2016 at 2:07 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p> 
                 <!-- Authentication Manger config --></p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=103274#respond" onclick="return addComment.moveForm( &quot;comment-103274&quot;, &quot;103274&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Iliyas">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-even depth-1" id="li-comment-101503"> 
           <article id="comment-101503" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">jidh</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-101503" class="post-date-section"><time datetime="2016-07-22T02:20:20+00:00">July 22, 2016 at 2:20 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hi KB, I liked your post, i have similar integration with siteminder .. i need to read groupmembership header also part of my request for the roles . can you please share some details how to achieve it ?</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=101503#respond" onclick="return addComment.moveForm( &quot;comment-101503&quot;, &quot;101503&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to jidh">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-101506"> 
             <article id="comment-101506" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-101506" class="post-date-section"><time datetime="2016-07-22T06:08:26+00:00">July 22, 2016 at 6:08 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Hi Jidh,Thanks !!</p> 
                <p>SiteMinder comes with the filter called “RequestHeaderAuthenticationFilter” which receives only “User”from the request header.</p> 
                <p>To add anything else into the header and to get it read from the site minder filter,we have to write our own filter class which can extend the “RequestHeaderAuthenticationFilter”.</p> 
                <p>Inside our own filter , write a logic which will read the group membership from the header.</p> 
                <p>Inject this custom filter in the place where we inject existing filter.</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=101506#respond" onclick="return addComment.moveForm( &quot;comment-101506&quot;, &quot;101506&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-odd thread-alt depth-1" id="li-comment-101354"> 
           <article id="comment-101354" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">Anusha</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-101354" class="post-date-section"><time datetime="2016-07-12T11:51:14+00:00">July 12, 2016 at 11:51 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>I was looking for looking for a tutorial on this for a very long time and this somehow hadn’t shown up anywhere. It’s just what I needed and helped me immensely. Thank you very much! ?</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=101354#respond" onclick="return addComment.moveForm( &quot;comment-101354&quot;, &quot;101354&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Anusha">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt depth-2" id="li-comment-101355"> 
             <article id="comment-101355" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-101355" class="post-date-section"><time datetime="2016-07-12T12:42:25+00:00">July 12, 2016 at 12:42 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Thanks and happy learning ?</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=101355#respond" onclick="return addComment.moveForm( &quot;comment-101355&quot;, &quot;101355&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment byuser comment-author-karibasappagc bypostauthor even thread-even depth-1" id="li-comment-97338"> 
           <article id="comment-97338" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="karibasappagc" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">karibasappagc</b> <span></span></cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97338" class="post-date-section"><time datetime="2016-02-28T15:54:13+00:00">February 28, 2016 at 3:54 pm</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>I hope you got it working now after sending the modified files.</p> 
              <p>Thank you.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97338#respond" onclick="return addComment.moveForm( &quot;comment-97338&quot;, &quot;97338&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to karibasappagc">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment odd alt depth-2" id="li-comment-100812"> 
             <article id="comment-100812" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://1.gravatar.com/avatar/438399fcb113a181e1f346b4b6c14295?s=50&amp;d=http%3A%2F%2Fjavainsimpleway.com%2Fwp-content%2Fplugins%2Fwp-user-avatar%2Fimages%2Fwpua-96x96.png&amp;r=g" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">Jake</b> </cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-100812" class="post-date-section"><time datetime="2016-06-22T06:58:24+00:00">June 22, 2016 at 6:58 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Hi, </p> 
                <p>I have an exact the same issue with Agung.<br> Can you please teach me how you solved his issue?</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=100812#respond" onclick="return addComment.moveForm( &quot;comment-100812&quot;, &quot;100812&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Jake">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> 
             <ol class="children"> 
              <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-3" id="li-comment-100813"> 
               <article id="comment-100813" class="comment clearfix"> 
                <header class="comment-meta comment-author vcard"> 
                 <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                 <div class="date-author clearfix"> 
                  <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                  <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-100813" class="post-date-section"><time datetime="2016-06-22T07:41:02+00:00">June 22, 2016 at 7:41 am</time></a> 
                 </div> 
                </header>
                <!-- .comment-meta --> 
                <div class="comment-wrapper"> 
                 <section class="comment-content comment"> 
                  <p>Hi Jake , Thanks for reading it!!</p> 
                  <p>His issue was with web.xml where he missed importing some config files.</p> 
                  <p>Please send the error which you are facing along with web.xml and spring config files , will check it and let you know.</p> 
                 </section>
                 <!-- .comment-content --> 
                 <div class="comment-reply"> 
                  <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=100813#respond" onclick="return addComment.moveForm( &quot;comment-100813&quot;, &quot;100813&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                 </div>
                 <!-- .reply --> 
                </div> 
               </article>
               <!-- #comment-## --> 
               <ol class="children"> 
                <li class="comment odd alt depth-4" id="li-comment-100816"> 
                 <article id="comment-100816" class="comment clearfix"> 
                  <header class="comment-meta comment-author vcard"> 
                   <img src="http://1.gravatar.com/avatar/438399fcb113a181e1f346b4b6c14295?s=50&amp;d=http%3A%2F%2Fjavainsimpleway.com%2Fwp-content%2Fplugins%2Fwp-user-avatar%2Fimages%2Fwpua-96x96.png&amp;r=g" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                   <div class="date-author clearfix"> 
                    <cite><b class="fn">Jake</b> </cite>
                    <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-100816" class="post-date-section"><time datetime="2016-06-22T11:00:41+00:00">June 22, 2016 at 11:00 am</time></a> 
                   </div> 
                  </header>
                  <!-- .comment-meta --> 
                  <div class="comment-wrapper"> 
                   <section class="comment-content comment"> 
                    <p>Thanks a ton. Would you send me your email address please.</p> 
                   </section>
                   <!-- .comment-content --> 
                   <div class="comment-reply"> 
                    <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=100816#respond" onclick="return addComment.moveForm( &quot;comment-100816&quot;, &quot;100816&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Jake">Reply</a> 
                   </div>
                   <!-- .reply --> 
                  </div> 
                 </article>
                 <!-- #comment-## --> 
                 <ol class="children"> 
                  <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-5" id="li-comment-100820"> 
                   <article id="comment-100820" class="comment clearfix"> 
                    <header class="comment-meta comment-author vcard"> 
                     <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                     <div class="date-author clearfix"> 
                      <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                      <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-100820" class="post-date-section"><time datetime="2016-06-22T12:16:41+00:00">June 22, 2016 at 12:16 pm</time></a> 
                     </div> 
                    </header>
                    <!-- .comment-meta --> 
                    <div class="comment-wrapper"> 
                     <section class="comment-content comment"> 
                      <p>sure… its <a href="mailto:karibasappagc@gmail.com">karibasappagc@gmail.com</a></p> 
                     </section>
                     <!-- .comment-content --> 
                     <div class="comment-reply"> 
                      <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=100820#respond" onclick="return addComment.moveForm( &quot;comment-100820&quot;, &quot;100820&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                     </div>
                     <!-- .reply --> 
                    </div> 
                   </article>
                   <!-- #comment-## --> </li>
                  <!-- #comment-## --> 
                 </ol>
                 <!-- .children --> </li>
                <!-- #comment-## --> 
                <li class="comment odd alt depth-4" id="li-comment-100836"> 
                 <article id="comment-100836" class="comment clearfix"> 
                  <header class="comment-meta comment-author vcard"> 
                   <img src="http://1.gravatar.com/avatar/438399fcb113a181e1f346b4b6c14295?s=50&amp;d=http%3A%2F%2Fjavainsimpleway.com%2Fwp-content%2Fplugins%2Fwp-user-avatar%2Fimages%2Fwpua-96x96.png&amp;r=g" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
                   <div class="date-author clearfix"> 
                    <cite><b class="fn">Jake</b> </cite>
                    <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-100836" class="post-date-section"><time datetime="2016-06-23T04:40:56+00:00">June 23, 2016 at 4:40 am</time></a> 
                   </div> 
                  </header>
                  <!-- .comment-meta --> 
                  <div class="comment-wrapper"> 
                   <section class="comment-content comment"> 
                    <p>an email sent sir.</p> 
                   </section>
                   <!-- .comment-content --> 
                   <div class="comment-reply"> 
                    <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=100836#respond" onclick="return addComment.moveForm( &quot;comment-100836&quot;, &quot;100836&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Jake">Reply</a> 
                   </div>
                   <!-- .reply --> 
                  </div> 
                 </article>
                 <!-- #comment-## --> 
                 <ol class="children"> 
                  <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-5" id="li-comment-100837"> 
                   <article id="comment-100837" class="comment clearfix"> 
                    <header class="comment-meta comment-author vcard"> 
                     <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="Karibasappa G C (KB)" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
                     <div class="date-author clearfix"> 
                      <cite><b class="fn">Karibasappa G C (KB)</b> <span></span></cite>
                      <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-100837" class="post-date-section"><time datetime="2016-06-23T04:45:35+00:00">June 23, 2016 at 4:45 am</time></a> 
                     </div> 
                    </header>
                    <!-- .comment-meta --> 
                    <div class="comment-wrapper"> 
                     <section class="comment-content comment"> 
                      <p>ya , I checked and replied you !!</p> 
                     </section>
                     <!-- .comment-content --> 
                     <div class="comment-reply"> 
                      <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=100837#respond" onclick="return addComment.moveForm( &quot;comment-100837&quot;, &quot;100837&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to Karibasappa G C (KB)">Reply</a> 
                     </div>
                     <!-- .reply --> 
                    </div> 
                   </article>
                   <!-- #comment-## --> </li>
                  <!-- #comment-## --> 
                 </ol>
                 <!-- .children --> </li>
                <!-- #comment-## --> 
               </ol>
               <!-- .children --> </li>
              <!-- #comment-## --> 
             </ol>
             <!-- .children --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-97295"> 
           <article id="comment-97295" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">agung</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97295" class="post-date-section"><time datetime="2016-02-27T18:53:24+00:00">February 27, 2016 at 6:53 pm</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>thanks you very much for the answer , but it appears an error like this</p> 
              <p>Severe: Exception while invoking class com.sun.enterprise.web.WebApplication start method<br> java.lang.Exception: java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: org.springframework.beans.factory.BeanCreationException: Error creating bean with name ‘org.springframework.security.filterChains’: Cannot resolve reference to bean ‘org.springframework.security.web.DefaultSecurityFilterChain#0’ while setting bean property ‘sourceList’ with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name ‘org.springframework.security.web.DefaultSecurityFilterChain#0’: Cannot resolve reference to bean ‘org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#0’ while setting constructor argument with key [3]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name ‘org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#0’: Cannot resolve reference to bean ‘org.springframework.security.authentication.ProviderManager#0’ while setting bean property ‘authenticationManager’; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name ‘org.springframework.security.authentication.ProviderManager#0’: Cannot resolve reference to bean ‘org.springframework.security.config.authentication.AuthenticationManagerFactoryBean#0’ while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name ‘org.springframework.security.config.authentication.AuthenticationManagerFactoryBean#0’: FactoryBean threw exception on object creation; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name ‘org.springframework.security.authenticationManager’: Cannot resolve reference to bean ‘customAuthenticationProvider’ while setting constructor argument with key [0]; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named ‘customAuthenticationProvider’ is defined<br> at com.sun.enterprise.web.WebApplication.start(WebApplication.java:138)<br> at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)<br> at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)<br> at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)<br> at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)<br> at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)<br> at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)<br> at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)<br> at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)<br> at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)<br> at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)<br> at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)<br> at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)<br> at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)<br> at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)<br> at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)<br> at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)<br> at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)<br> at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)<br> at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)<br> at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)<br> at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)<br> at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)<br> at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)<br> at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)<br> at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)<br> at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)<br> at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)<br> at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)<br> at com.sun.grizzly.ContextTask.run(ContextTask.java:71)<br> at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)<br> at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)<br> at java.lang.Thread.run(Thread.java:745)</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97295#respond" onclick="return addComment.moveForm( &quot;comment-97295&quot;, &quot;97295&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to agung">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> </li>
          <!-- #comment-## --> 
          <li class="comment byuser comment-author-karibasappagc bypostauthor even thread-even depth-1" id="li-comment-97292"> 
           <article id="comment-97292" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="karibasappagc" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">karibasappagc</b> <span></span></cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97292" class="post-date-section"><time datetime="2016-02-27T17:30:45+00:00">February 27, 2016 at 5:30 pm</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hi Agung,</p> 
              <p>As per my observation, you have defined the bean customAuthenticationProvider twice,once using @Component annotation in the CustomAuthenticationProvider class and other one is inside spring security xml as below</p> 
              <p>&lt; beans:bean id="customAuthenticationProvider" class="id.co.iconpln.authentication.CustomAuthenticationProvider"&gt;</p> 
              <p>always XML bean definition takes priority than annotation one which is the issue i think.</p> 
              <p>Can you please remove the above bean declaration from the spring security config file.</p> 
              <p>Let me know if that helps, if not send me complete stack trace.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97292#respond" onclick="return addComment.moveForm( &quot;comment-97292&quot;, &quot;97292&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to karibasappagc">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> </li>
          <!-- #comment-## --> 
          <li class="comment byuser comment-author-karibasappagc bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-97235"> 
           <article id="comment-97235" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="karibasappagc" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">karibasappagc</b> <span></span></cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97235" class="post-date-section"><time datetime="2016-02-26T14:02:21+00:00">February 26, 2016 at 2:02 pm</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Hi Agung,</p> 
              <p>Thanks for reading !!</p> 
              <p>You are getting NULL pointer exception, there is a chance that the object which you are injecting could be NULL.</p> 
              <p>Please check whether the below CustomUserService you are injecting is defined as spring bean</p> 
              <p>@Autowired<br> private CustomUserService userService;</p> 
              <p>Can you post or email me your CustomUserService class and CustomAuthenticationProvider , i will have a look into it.</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97235#respond" onclick="return addComment.moveForm( &quot;comment-97235&quot;, &quot;97235&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to karibasappagc">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment even depth-2" id="li-comment-97267"> 
             <article id="comment-97267" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">agung</b> </cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97267" class="post-date-section"><time datetime="2016-02-27T05:13:03+00:00">February 27, 2016 at 5:13 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>thank you for replying , I really appreciate it , I ‘ll send an email, but I do not know your email , can you tell me your email</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97267#respond" onclick="return addComment.moveForm( &quot;comment-97267&quot;, &quot;97267&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to agung">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
            <li class="comment odd alt depth-2" id="li-comment-97278"> 
             <article id="comment-97278" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">agung</b> </cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97278" class="post-date-section"><time datetime="2016-02-27T11:56:35+00:00">February 27, 2016 at 11:56 am</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>thank you for replying , I really appreciate it</p> 
                <p>this my class CustomAuthenticationProvider<br> import ….<br> @Component<br> public class CustomAuthenticationProvider implements AuthenticationProvider {</p> 
                <p> @Autowired<br> private CustomUserService userService;</p> 
                <p> public Authentication authenticate(Authentication authentication) throws AuthenticationException {</p> 
                <p> String username = authentication.getName();<br> String password = (String) authentication.getCredentials();</p> 
                <p> CustomUser user = userService.loadUserByUsername(username);</p> 
                <p> if (user == null || !user.getUsername().equalsIgnoreCase(username)){<br> throw new BadCredentialsException(“Username not found.”);<br> }</p> 
                <p> if (!password.equals(user.getPassword())) {<br> throw new BadCredentialsException(“Wrong password.”);<br> }</p> 
                <p> Collection authorities = user.getAuthorities();</p> 
                <p> return new UsernamePasswordAuthenticationToken(user, password, authorities);<br> }</p> 
                <p> public boolean supports(Class arg0) {<br> return true;<br> }</p> 
                <p>}</p> 
                <p>and this my custom user service<br> @Service<br> public class CustomUserService implements UserDetailsService {</p> 
                <p> @Autowired<br> private UserDAOImpl userDao;</p> 
                <p> public CustomUser loadUserByUsername(String username) throws UsernameNotFoundException {<br> return userDao.loadUserByUsername(username);<br> }<br> }</p> 
                <p>i already send my script and my sturcture in email</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97278#respond" onclick="return addComment.moveForm( &quot;comment-97278&quot;, &quot;97278&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to agung">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
          <li class="comment even thread-even depth-1" id="li-comment-97219"> 
           <article id="comment-97219" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://javainsimpleway.com/wp-content/plugins/wp-user-avatar/images/wpua-96x96.png" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">agung</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-97219" class="post-date-section"><time datetime="2016-02-26T06:38:52+00:00">February 26, 2016 at 6:38 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>thanks for your post,</p> 
              <p>im trying implement but i have problem like this</p> 
              <p>java.lang.NullPointerException<br> at CustomAuthenticationProvider.authenticate(CustomAuthenticationProvider.java:32)</p> 
              <p>CustomUser user = userService.loadUserByUsername(username); &lt;– this line</p> 
              <p>HTTP Status 500 –</p> 
              <p>type Exception report</p> 
              <p>message</p> 
              <p>descriptionThe server encountered an internal error () that prevented it from fulfilling this request.</p> 
              <p>exception</p> 
              <p>java.lang.NullPointerException</p> 
              <p>note The full stack traces of the exception and its root causes are available in the GlassFish Server Open Source Edition 3.1.2.2 logs.<br> GlassFish Server Open Source Edition 3.1.2.2</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=97219#respond" onclick="return addComment.moveForm( &quot;comment-97219&quot;, &quot;97219&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to agung">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> </li>
          <!-- #comment-## --> 
          <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-95795"> 
           <article id="comment-95795" class="comment clearfix"> 
            <header class="comment-meta comment-author vcard"> 
             <img src="http://2.gravatar.com/avatar/b341ed1c3bc26f38567ca5278142b1e5?s=50&amp;d=http%3A%2F%2Fjavainsimpleway.com%2Fwp-content%2Fplugins%2Fwp-user-avatar%2Fimages%2Fwpua-96x96.png&amp;r=g" width="50" height="50" alt="" class="avatar avatar-50wp-user-avatar wp-user-avatar-50 alignnone photo avatar-default"> 
             <div class="date-author clearfix"> 
              <cite><b class="fn">grad</b> </cite>
              <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-95795" class="post-date-section"><time datetime="2016-01-28T11:30:57+00:00">January 28, 2016 at 11:30 am</time></a> 
             </div> 
            </header>
            <!-- .comment-meta --> 
            <div class="comment-wrapper"> 
             <section class="comment-content comment"> 
              <p>Thank you very much for your post!<br> But, if I want to add an extra field to login page? For example pinCode?</p> 
             </section>
             <!-- .comment-content --> 
             <div class="comment-reply"> 
              <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=95795#respond" onclick="return addComment.moveForm( &quot;comment-95795&quot;, &quot;95795&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to grad">Reply</a> 
             </div>
             <!-- .reply --> 
            </div> 
           </article>
           <!-- #comment-## --> 
           <ol class="children"> 
            <li class="comment byuser comment-author-karibasappagc bypostauthor even depth-2" id="li-comment-95809"> 
             <article id="comment-95809" class="comment clearfix"> 
              <header class="comment-meta comment-author vcard"> 
               <img src="http://javainsimpleway.com/wp-content/uploads/2016/05/kb-Copy-compressed-150x150.jpg" width="50" height="50" alt="karibasappagc" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 alignnone photo"> 
               <div class="date-author clearfix"> 
                <cite><b class="fn">karibasappagc</b> <span></span></cite>
                <a href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/#comment-95809" class="post-date-section"><time datetime="2016-01-28T15:37:05+00:00">January 28, 2016 at 3:37 pm</time></a> 
               </div> 
              </header>
              <!-- .comment-meta --> 
              <div class="comment-wrapper"> 
               <section class="comment-content comment"> 
                <p>Since, I am using default login page provided by Spring,we can not achieve it as it is.</p> 
                <p>But we can add any number of fields in the custom login page and achieve this.</p> 
                <p>Please refer this post for the same ,there i have added only 2 fields , but yes we can add as many fields as we want. <a href="http://javainsimpleway.com/spring/spring-security-using-custom-login-form/" rel="nofollow">http://javainsimpleway.com/spring/spring-security-using-custom-login-form/</a></p> 
                <p>But for this , we need to write custom authentication provider as explained in this post.</p> 
                <p>I will try to write a new post for the same.</p> 
                <p>Thanks for this.</p> 
               </section>
               <!-- .comment-content --> 
               <div class="comment-reply"> 
                <a rel="nofollow" class="comment-reply-link" href="http://javainsimpleway.com/spring-security-using-custom-authentication-provider/?replytocom=95809#respond" onclick="return addComment.moveForm( &quot;comment-95809&quot;, &quot;95809&quot;, &quot;respond&quot;, &quot;520&quot; )" aria-label="Reply to karibasappagc">Reply</a> 
               </div>
               <!-- .reply --> 
              </div> 
             </article>
             <!-- #comment-## --> </li>
            <!-- #comment-## --> 
           </ol>
           <!-- .children --> </li>
          <!-- #comment-## --> 
         </ol>
         <!-- .commentlist --> 
         <div id="respond" class="comment-respond"> 
          <h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/spring-security-using-custom-authentication-provider/#respond" style="display:none;">Cancel Reply</a></small></h3> 
          <form action="http://javainsimpleway.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"> 
           <li><label class="last"> Message </label><textarea id="comment" name="comment" rows="6" cols="1" aria-required="true" placeholder="Message"></textarea></li>
           <p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes: <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code lang=""&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre lang="" extra=""&gt; </code></p>
           <ul>
            <li><label>Name*</label><input id="author" class="add" name="author" type="text" value="" size="30"></li> 
            <li><label>Email*</label><input id="email" class="add" name="email" type="text" value="" size="30"></li> 
            <li><label>Phone </label><input id="phone" class="add" name="phone" type="text" value="" size="30"></li> 
            <p class="cptch_block"><span class="cptch_title">Please answer this simple challenge to post your valuable comment<span class="required"> *</span></span><span class="cptch_wrap"> <label class="cptch_label" for="cptch_input_45"> <span class="cptch_span"><input id="cptch_input_45" class="cptch_input cptch_wp_comments" type="text" autocomplete="off" name="cptch_number" value="" maxlength="2" size="2" aria-required="true" required style="margin-bottom:0;display:inline;font-size: 12px;width: 40px;"></span> <span class="cptch_span">&nbsp;+&nbsp;</span> <span class="cptch_span">four</span> <span class="cptch_span">&nbsp;=&nbsp;</span> <span class="cptch_span">11</span> <input type="hidden" name="cptch_result" value="HzI="> <input type="hidden" name="cptch_time" value="1505675799"> <input type="hidden" name="cptch_form" value="wp_comments"> </label><span class="cptch_reload_button_wrap hide-if-no-js"> 
               <noscript> 
                <style type="text/css">
							.hide-if-no-js {
								display: none !important;
							}
						</style> 
               </noscript> <span class="cptch_reload_button dashicons dashicons-update"></span> </span></span></p>
            <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="520" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"> </p>  
           </ul>
          </form>
         </div>
         <!-- #respond --> 
        </div>
        <!-- #comments .comments-area --> 
       </div> 
      </section> 
      <!--<aside class="col-sm-4 col-lg-2 sidebar sidebar-full">
        	   
    </aside>--> 
     </div> 
    </div> 
   </div> 
   <!--Content Section Ends Here--> 
   <!-- Footer Section Starts Here --> 
   <footer id="footer"> 
    <div class="container"> 
     <div class="row"> 
      <div class="col-sm-12"> 
       <div class="footer-logo"> 
        <a href="http://javainsimpleway.com"><img src="http://javainsimpleway.com/wp-content/uploads/2016/09/logo_final-footer.jpg" alt="Java Guide" title="Java Guide"></a> 
       </div> 
       <div class="footer-desc"> 
        <p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
         <!-- javainsimpleway_ad4 --> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9157887158094484" data-ad-slot="7088143459" data-ad-format="auto"></ins> <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p> 
       </div> 
       <div class="footer-copy-right"> 
        <span>Copyright © 2017 :</span> 
        <a href="">Java Guide</a> 
        <span id="wen_login_link" class="menu-item wen-login-link"><a class="fancybox" href="http://javainsimpleway.com/wp-login.php" title="Login">Log in</a></span> 
       </div> 
      </div> 
     </div> 
    </div> 
   </footer> 
   <!--Footer Section Ends Here --> 
   <script>
	jQuery('a[href^="#"]').on('click',function (e) {
	    e.preventDefault();
	    
	    var target = this.hash;
	    var $target = jQuery(target);

	   jQuery('html, body').stop().animate({
	        'scrollTop': $target.offset().top
	    }, 900, 'swing', function () {
	        window.location.hash = target;
	        jQuery('.banner').css('margin-top','100px');
	    });
	});
	
</script> 
  </div> 
  <!-- Wrapper Ends Here --> 
  <!--Ad Injection:footer--> 
  <div style="padding-bottom:3px;">
   <center>
    <script type="text/javascript">
  var vglnk = { key: '0f802cfa67acbdaf2d1d827ab6ec186b' };

  (function(d, t) {
    var s = d.createElement(t); s.type = 'text/javascript'; s.async = true;
    s.src = '//cdn.viglink.com/api/vglnk.js';
    var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);
  }(document, 'script'));
</script>
   </center>
  </div>
  <div id="qJ77GipZm9UR" class="YcnlXb2PJUx9" style="background:#dddddd;color:#8224e3;max-width:720px;z-index:9999999; "></div> 
  <script type="text/javascript">/* <![CDATA[ */var anOptions ={"anOptionChoice":"2","anOptionStats":"1","anOptionAdsSelectors":"","anOptionCookie":"2","anOptionCookieLife":"30","anPageRedirect":"","anPermalink":"undefined","anOptionModalEffect":"fadeAndPop","anOptionModalspeed":"350","anOptionModalclose":false,"anOptionModalOverlay":"rgba( 0,0,0,0.8 )","anAlternativeActivation":false,"anAlternativeElement":"","anAlternativeText":"<p><strong>AdBlock detected!<\/strong><\/p>\n<p>Please add <a title=\"http:\/\/themeisle.com\/\" href=\"themeisle.com\" target=\"_blank\">www.themeisle.com<\/a> to your adblocking whitelist or disable your adblocking software.<\/p>\n","anAlternativeClone":"2","anAlternativeProperties":"","anOptionModalShowAfter":0,"anPageMD5":"","anSiteID":0,"modalHTML":"<div class=\"YcnlXb2PJUx9-default\">\n\t<h1 style=\"\">Adblocker detected! Please consider reading this notice.<\/h1>\n\t<p>We've detected that you are using AdBlocker or some other AdBlocking software which is preventing the page from fully loading.<\/p>\n<p><strong>Please add <a title=\"Java Guide\" href=\"http:\/\/javainsimpleway.com\" target=\"_blank\">javainsimpleway.com<\/a> to your AdBlocking whitelist or disable your AdBlocking software to support this site.<strong><\/p>\n<p>Procedure for whitelisting this site from adblocker<br \/>\nClick the\u00a0AdBlock button\u00a0and select\u00a0Don't run on pages on this domain.<\/p>\n<p>Thank you for your cooperation!!<\/p>\n<\/div>\n"}/* ]]> */</script>
  <div id="adsense" class="an-sponsored" style="position:absolute; z-index:-1; height:1px; width:1px; visibility: hidden; top: -1px; left: 0;">
   <img class="an-advert-banner" alt="sponsored" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
  </div> 
  <script type="text/javascript"><!--
wpa2a.targets=[
{title:"Spring Security using Custom Authentication Provider",url:"http://javainsimpleway.com/spring-security-using-custom-authentication-provider/"}];
wpa2a.html_done=true;if(wpa2a.script_ready&&!wpa2a.done)wpa2a.init();wpa2a.script_load();
//--></script> 
  <script type="text/javascript">
      if (jQuery("ul li.page_item:has(ul.children)").length > 0) {
        jQuery("ul li.page_item:has(ul.children)").hover(function () {
          jQuery(this).children("a").removeAttr('href');
          jQuery(this).children("a").css('cursor', 'default');
          jQuery(this).children("a").click(function () {
            return false;
          });
        });
      }	else if (jQuery("ul li.menu-item:has(ul.sub-menu)").length > 0) {
        jQuery("ul li.menu-item:has(ul.sub-menu)").hover(function () {
          jQuery(this).children("a").removeAttr('href');
          jQuery(this).children("a").css('cursor', 'default');
          jQuery(this).children("a").click(function () {
            return false;
          });
        });
      }
    </script> 
  <script>window._popup_data = {"ajaxurl":"http:\/\/javainsimpleway.com\/wp-admin\/admin-ajax.php","do":"get_data","ajax_data":{"orig_request_uri":"\/spring-security-using-custom-authentication-provider\/"}};</script>
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/responsive-attention-box/js/alert.js?ver=1.0"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/code-highlight/js/run_prettify.js?ver=4.5.3"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/contact-form-7/includes/js/jquery.form.min.js?ver=3.51.0-2014.06.20"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var _wpcf7 = {"loaderUrl":"http:\/\/javainsimpleway.com\/wp-content\/plugins\/contact-form-7\/images\/ajax-loader.gif","recaptchaEmpty":"Please verify that you are not a robot.","sending":"Sending ..."};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=4.4.1"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/modernizr.custom.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/jquery.flexslider.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/bootstrap.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/easing.js?ver=4.5.3"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-includes/js/comment-reply.min.js?ver=4.5.3"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/options/less.js"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var nicebird = {"color":"#ab1b42","sticky_header":"yes","global_font":"'Open Sans', sans-serif","heading_font":"'Droid Serif', serif"};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/options/options.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/masonry.pkgd.min.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/image-load.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/classie.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/animOnScroll.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/jquery-plugin-countdown.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/jquery.countdown.js"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var nbCustom = {"underConstruction":"November 02, 2016 09:19:00"};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/nb-custom.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/metabox.js"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/jquery.infinitescroll.js"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var nbPagination = {"loadingImg":"","loadingText":"Loading the next set of posts...","donetext":"No More Posts For Now."};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/themes/nicebird/assets/js/nb.infinitescroll.js"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var ajax_object = {"ajaxurl":"http:\/\/javainsimpleway.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/uploads/2I3RAEoDZJ5K/5HJFs7FII9NT.js?ver=2.0.9"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/wordpress-popup/js/public.min.js?ver=4.5.3"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-includes/js/jquery/ui/effect.min.js?ver=1.11.4"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-includes/js/jquery/ui/effect-blind.min.js?ver=1.11.4"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var stbUserOptions = {"mode":"css","cssOptions":{"roundedCorners":true,"mbottom":10,"imgHide":"http:\/\/javainsimpleway.com\/wp-content\/stb-themes\/stb-light\/minus.png","imgShow":"http:\/\/javainsimpleway.com\/wp-content\/stb-themes\/stb-light\/plus.png","strHide":"Hide","strShow":"Show"}};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/wp-special-textboxes/js/wstb.min.js?ver=5.4.98"></script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-includes/js/wp-embed.min.js?ver=4.5.3"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var cptch_vars = {"nonce":"5d47d88010","ajaxurl":"http:\/\/javainsimpleway.com\/wp-admin\/admin-ajax.php","enlarge":"1"};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://javainsimpleway.com/wp-content/plugins/captcha/js/front_end_script.js?ver=4.5.3"></script>   
 </body>
</html>