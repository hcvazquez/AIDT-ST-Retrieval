<!doctype html>
<html lang="en" dir="ltr" class="client-nojs">
 <head> 
  <meta charset="UTF-8"> 
  <title>SCORM 1.2 player in the Mobile app - MoodleDocs</title> 
  <script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script> 
  <script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"SCORM_1.2_player_in_the_Mobile_app","wgTitle":"SCORM 1.2 player in the Mobile app","wgCurRevisionId":49405,"wgRevisionId":49405,"wgArticleId":5400,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"SCORM_1.2_player_in_the_Mobile_app","wgRelevantArticleId":5400,"wgRequestId":"a015e6be104582c91122621a","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script> 
  <link rel="stylesheet" href="/dev/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor&amp;only=styles&amp;skin=moodledocs"> 
  <link rel="stylesheet" href="/dev/skins/moodledocs/devdocs.css?305" media="screen">
  <link rel="stylesheet" href="/dev/skins/moodledocs/sitebar/sitebar-dev.css?305" media="screen">
  <link rel="stylesheet" href="/dev/skins/moodledocs/bootstrap-responsive.min.css?305">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:400,300&amp;amp;subset=latin,cyrillic-ext,greek-ext,greek,vietnamese,latin-ext,cyrillic"> 
  <meta name="ResourceLoaderDynamicStyles" content=""> 
  <script async src="/dev/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=moodledocs"></script> 
  <meta name="generator" content="MediaWiki 1.27.2"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <link rel="shortcut icon" href="/favicon-dev.ico"> 
  <link rel="search" type="application/opensearchdescription+xml" href="/dev/opensearch_desc.php" title="MoodleDocs&nbsp;dev&nbsp;(Development)"> 
  <link rel="EditURI" type="application/rsd+xml" href="https://docs.moodle.org/dev/api.php?action=rsd"> 
  <link rel="copyright" href="https://docs.moodle.org/dev/License"> 
  <link rel="alternate" type="application/atom+xml" title="MoodleDocs Atom feed" href="/dev/index.php?title=Special:RecentChanges&amp;feed=atom"> 
 </head> 
 <body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-SCORM_1_2_player_in_the_Mobile_app rootpage-SCORM_1_2_player_in_the_Mobile_app skin-moodledocs action-view"> 
  <div id="moodlesitestopnavbar"> 
   <div class="navbar-container"> 
    <a class="sitelogo" href="https://moodle.org/"> <img alt="Moodle.org" width="96" height="25" src="/dev/skins/moodledocs/sitebar/pix/logo.png"> </a> 
    <ul> 
     <li class="home"> <a href="https://moodle.org"><span>Home</span><span class="placeholder"></span></a> </li> 
     <li class="documentation"> <a href="https://docs.moodle.org"><span>Documentation</span><span class="placeholder"></span></a> </li> 
     <li class="download"> <a href="https://download.moodle.org"><span>Downloads</span><span class="placeholder"></span></a> </li> 
     <li class="demo"> <a href="https://moodle.org/demo"><span>Demo</span><span class="placeholder"></span></a> </li> 
     <li class="tracker"> <a href="https://tracker.moodle.org"><span>Tracker</span><span class="placeholder"></span></a> </li> 
     <li class="development"> <a href="https://docs.moodle.org/dev/Main_Page"><span>Development</span><span class="placeholder"></span></a> </li> 
     <li class="translation"> <a href="https://lang.moodle.org"><span>Translation</span><span class="placeholder"></span></a> </li> 
     <li class="moodlenet"> <a href="https://moodle.net"><span>Moodle.net</span><span class="placeholder"></span></a> </li> 
     <li class="search"> <a href="https://moodle.org/public/search/"><span>Search</span><span class="placeholder"></span></a> </li> 
    </ul> 
   </div> 
   <div style="clear:both"></div> 
  </div> 
  <div id="page"> 
   <div id="moodlelogo"></div> 
   <div id="moodlenavbar" class="navbar clearfix" dir="LTR">
    <div class="breadcrumb">
     <h2 class="accesshide">You are here</h2>
     <ul>
      <li class="first"><a href="/dev/">Main Page</a></li>
      <li>&nbsp;? SCORM 1.2 player in the Mobile app</li>
     </ul>
    </div>
   </div> 
   <div id="globalWrapper" class="container-fluid"> 
    <div id="column-content" class="has-sideblock"> 
     <div id="content"> 
      <a id="top"></a> 
      <h1 id="firstHeading" class="firstHeading">SCORM 1.2 player in the Mobile app</h1> 
      <div id="bodyContent"> 
       <div id="contentSub"></div> 
       <div id="jump-to-nav">
        Jump to: 
        <a href="#column-one">navigation</a>, 
        <a href="#searchInput">search</a>
       </div> 
       <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
        <div class="sideblock"> 
         <table class="infobox"> 
          <tbody>
           <tr> 
            <th> <b>SCORM 1.2 player in the Mobile app</b> </th>
           </tr> 
           <tr> 
            <td> Project state </td> 
            <td> Finished </td>
           </tr> 
           <tr> 
            <td> Tracker issue </td> 
            <td> <a rel="nofollow" class="external free" href="https://tracker.moodle.org/browse/MOBILE-938">https://tracker.moodle.org/browse/MOBILE-938</a> </td>
           </tr> 
           <tr> 
            <td> Discussion </td> 
            <td> <a rel="nofollow" class="external free" href="https://moodle.org/mod/forum/discuss.php?d=326798">https://moodle.org/mod/forum/discuss.php?d=326798</a> </td>
           </tr> 
           <tr> 
            <td> Assignee </td> 
            <td> {{{assignee}}} </td>
           </tr> 
          </tbody>
         </table> 
        </div> 
        <p><br> For user documentation please refer to <a rel="nofollow" class="external free" href="https://docs.moodle.org/en/Moodle_Mobile_SCORM_player">https://docs.moodle.org/en/Moodle_Mobile_SCORM_player</a> </p> 
        <div id="toc" class="toc">
         <div id="toctitle">
          <h2>Contents</h2>
         </div> 
         <ul> 
          <li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li> 
          <li class="toclevel-1 tocsection-2"><a href="#Technical_Overview"><span class="tocnumber">2</span> <span class="toctext">Technical Overview</span></a></li> 
          <li class="toclevel-1 tocsection-3"><a href="#Moodle_requirements"><span class="tocnumber">3</span> <span class="toctext">Moodle requirements</span></a> 
           <ul> 
            <li class="toclevel-2 tocsection-4"><a href="#SCORM_module_changes"><span class="tocnumber">3.1</span> <span class="toctext">SCORM module changes</span></a></li> 
            <li class="toclevel-2 tocsection-5"><a href="#New_external_functions"><span class="tocnumber">3.2</span> <span class="toctext">New external functions</span></a></li> 
           </ul> </li> 
          <li class="toclevel-1 tocsection-6"><a href="#Moodle_Mobile_requirements"><span class="tocnumber">4</span> <span class="toctext">Moodle Mobile requirements</span></a> 
           <ul> 
            <li class="toclevel-2 tocsection-7"><a href="#SCORM_player"><span class="tocnumber">4.1</span> <span class="toctext">SCORM player</span></a></li> 
            <li class="toclevel-2 tocsection-8"><a href="#Moodle_Mobile_SCORM_addon"><span class="tocnumber">4.2</span> <span class="toctext">Moodle Mobile SCORM addon</span></a></li> 
           </ul> </li> 
          <li class="toclevel-1 tocsection-9"><a href="#Use_cases"><span class="tocnumber">5</span> <span class="toctext">Use cases</span></a> 
           <ul> 
            <li class="toclevel-2 tocsection-10"><a href="#Online"><span class="tocnumber">5.1</span> <span class="toctext">Online</span></a></li> 
           </ul> </li> 
          <li class="toclevel-1 tocsection-11"><a href="#Offline_support"><span class="tocnumber">6</span> <span class="toctext">Offline support</span></a> 
           <ul> 
            <li class="toclevel-2 tocsection-12"><a href="#Approach_1:_Data_merging"><span class="tocnumber">6.1</span> <span class="toctext">Approach 1: Data merging</span></a></li> 
            <li class="toclevel-2 tocsection-13"><a href="#Approach_2:_Independent_attempts:"><span class="tocnumber">6.2</span> <span class="toctext">Approach 2: Independent attempts:</span></a></li> 
            <li class="toclevel-2 tocsection-14"><a href="#All_the_possible_cases"><span class="tocnumber">6.3</span> <span class="toctext">All the possible cases</span></a></li> 
            <li class="toclevel-2 tocsection-15"><a href="#Synchronization_cases"><span class="tocnumber">6.4</span> <span class="toctext">Synchronization cases</span></a></li> 
           </ul> </li> 
         </ul> 
        </div> 
        <h2><span class="mw-headline" id="Introduction">Introduction</span></h2> 
        <p>SCORM module support in the mobile app is one of the most requested features by users, specifically, the ability to play SCORM packages offline in the mobile app including synchronization of the tracking data once the device is online again. </p>
        <p>In this document we are going to do a brief analysis about what will be needed to implement in both the Mobile app and Moodle code to add support to play SCORM packages. </p>
        <p><b>Moodle Mobile</b> </p>
        <p>The current Moodle Mobile app is an HTML 5 application that uses other common web technologies. It is a client application that uses REST protocol web services to send and get information from the Moodle installation. Recently, we have started working on another version of this Moodle Mobile app using Ionic framework with AngularJs to overcome the current mobile application’s technical problems. </p>
        <p><b>What is SCORM?</b> </p>
        <p>SCORM stands for Sharable Content Object Reference Model. It is a common standard introduced by Advanced Distributed Learning. Those standards facilitate the use of SCORM based content in any management system without any hassle. SCORM consists of two main parts: Run Time Environment and Content Aggregation Model. </p>
        <p><i>Run Time Environment</i> </p>
        <p>This describes how the content of the SCORM package should behave when it is loaded by a learning management instance. In this project, we will mainly tackle this section. The run time environment consists of 8 main functions that facilitates the access to the LMS. </p>
        <p><i>Content Aggregation Model</i> </p>
        <p>This describes how a person who is creating SCORM packages should package that content according to the SCORM standards. </p>
        <p>The 8 main functions in the run time environment need to be implemented as a Javascript API. Since we are doing this project using AngularJs, this should be done by fixing it to an Angular Module. This Angular module will have all the necessary controllers and services to handle communication between an external SCORM package and the Moodle site. </p>
        <p><b>Functionalities</b> </p>
        <p>The minimum functionalities to be supported would be: </p> 
        <ul>
         <li> Support for SCORM 1.2 packages only</li> 
         <li> Support for zip SCORM packages only (no alternative methods for adding SCORM contents)</li> 
         <li> Complete support for the SCORM 1.2 API runtime</li> 
         <li> Support for playing packages offline</li>
        </ul> 
        <h2><span class="mw-headline" id="Technical_Overview">Technical Overview</span></h2> 
        <p>There are currently several Javascript SCORM players with basic support for SCORM 1.2: </p> 
        <ul>
         <li> <a rel="nofollow" class="external free" href="http://www.scormpool.com/">http://www.scormpool.com/</a></li> 
         <li> <a rel="nofollow" class="external free" href="https://github.com/skfriese/simple-scorm-api">https://github.com/skfriese/simple-scorm-api</a></li> 
         <li> <a rel="nofollow" class="external free" href="https://bitbucket.org/jugger0/tsp">https://bitbucket.org/jugger0/tsp</a></li>
        </ul> 
        <p>The aim of this project is to improve and package inside an AngularJS module one of those players and include it in the official Moodle Mobile app. We are talking about AngularJS because the new version of the official Mobile app (Moodle Mobile 2) will be build using the Ionic framework that is based in AngularJS </p>
        <p>In order to be able to support playing SCORM files from a Moodle site in the app, we need to develop new code in both Moodle and Moodle Mobile and also do some changes in the current code: </p>
        <p><b>In Moodle:</b> </p>
        <p>A new set of external functions in the SCORM module to be used as Web Services by the app in order to: </p> 
        <ul>
         <li> Retrieve a list of all the SCORM modules inside a course</li> 
         <li> Retrieve tracking information from a particular user in a SCORM package (e.g. list of attempts, current attempt status, etc..)</li> 
         <li> Send tracking information of a particular user in an existing SCORM package</li> 
         <li> Some modifications in the current SCORM module (described below) to allow teachers to choose if they want make a SCORM module available to mobile users and then allow downloading full SCORM packages.</li>
        </ul> 
        <p><b>In Moodle Mobile:</b> </p> 
        <ul>
         <li> A generic AngularJS SCORM player module that should be able to parse the imsmanifest.xml file, display the SCORM and navigation TOC and implement a local SCORM runtime</li> 
         <li> A new addon for the SCORM module that will contain the AngularJS SCORM player and will perform tasks like downloading the SCORM zip package, retrieving the SCO tracking information from Moodle and synchronizing the results.</li>
        </ul> 
        <h2><span class="mw-headline" id="Moodle_requirements">Moodle requirements</span></h2> 
        <h3><span class="mw-headline" id="SCORM_module_changes">SCORM module changes</span></h3> 
        <p>In order to make possible to play SCORM packages in online and offline modes, the Mobile app needs to download the complete zip SCORM package and extract to the local sdcard/storage system. </p>
        <p>This means that we need to add support to downloading the zip packages via the SCORM pluginfile callback, but this presents some problems: </p>
        <p>There are several ways for adding SCORM packages into a course, we are going to support only zip packages uploaded and those downloaded via URL to a zip (filesystem repositories won’t be supported either). </p>
        <p>Privacy/security: Sometimes, teachers or administrators don’t want to share the complete zip packages, we will need a new SCORM module setting called “Allow to download complete SCORM packages” or something similar so a teacher can disable the zip packages download at any time. For existing packages this option should be disabled, but for new it should enabled by default. </p>
        <p>Package size: Sometimes SCORM packages are huge; the storage capacity in mobile devices is limited so it will be necessary to detect the zip package and the free space available in the device </p>
        <p>The Mobile app will notify the user if the SCORM package is supported, checking if the package was uploaded or downloaded via URL, if the “Allow to download complete SCORM packages” is enabled, and if there is enough free space in the device. </p>
        <p>Why is it mandatory to download the complete zip SCORM package? </p> 
        <ul>
         <li> The app does not support SSO to Moodle, so it won’t be possible just to embed the SCORM player into an iframe</li> 
         <li> We can try to parse the imsmanifest.xml and then display in an iframe the requested files pointing to the Moodle pluginfile.php file, but this presents two problems:</li> 
         <li> We’ll need to parse/pre-process all the HTML files to fix the links to point to <a rel="nofollow" class="external free" href="http://yourmoodle.com/webservice/pluginfile.php/zz/yy/file.html?token=authtoken">http://yourmoodle.com/webservice/pluginfile.php/zz/yy/file.html?token=authtoken</a></li> 
         <li> We will be sending lots of requests to the Web Server, exposing the authentication token (since it’s needed to validate the user credentials)</li>
        </ul> 
        <h3><span class="mw-headline" id="New_external_functions">New external functions</span></h3> 
        <p><b>mod_scorm_get_scorms_by_courses</b> </p>
        <p>Parameters: list of course ids </p>
        <p>Returns: A list of SCORM packages module settings in the specified courses, including only the settings the user may see (according to his permissions). </p>
        <p>This external function will also return information like the size of the zip package and a md5 hash to detect if the package has been updated. </p>
        <p>Via this external function, we will be able to check if the SCORM package can be downloaded and played in the app. </p>
        <p><b>mod_scorm_get_scorm_attempts</b> </p>
        <p>Parameters: scormid and userid Returns: A list containing information of all the attempts done by the specified user id </p>
        <p>This will be used to know the current attempt status for the user (last attempt, etc..) </p>
        <p><b>mod_scorm_get_scorm_scoes</b> </p>
        <p>Parameters: scormid </p>
        <p>Returns a list of scoes inside the specified scorm </p>
        <p><b>mod_scorm_get_scorm_user_data</b> </p>
        <p>Parameters: userid, attempt </p>
        <p>Returns all the user tracks for all the scorm scoes (including objectives and interactions) </p>
        <p>This will be used for preparing the API runtime data </p>
        <p><b>mod_scorm_insert_scorm_track</b> </p>
        <p>Parameters: scoid, userid, attempt, element, value </p>
        <p>Inserts track information about a SCO </p>
        <p>Returns: true or false (success or not) </p>
        <p><br> </p> 
        <h2><span class="mw-headline" id="Moodle_Mobile_requirements">Moodle Mobile requirements</span></h2> 
        <h3><span class="mw-headline" id="SCORM_player">SCORM player</span></h3> 
        <p>The SCORM player will be an AngularJS module integrated in a Mobile app addon. It will be responsible for: </p> 
        <ul>
         <li> Parsing the imsmanifest.xml file in order to display the available Organizations and Structures inside the package.</li> 
         <li> Displaying a basic SCORM player with a basic menu tree.</li> 
         <li> Implementing a basic runtime support in order to retrieve the SCOs tracking information (including objectives and interactions) and sending tracking information too.</li>
        </ul> 
        <p>The SCORM player will be an agnostic AngularJS player that will communicate with the Mobile app SCORM add-on via the SCORM runtime. </p> 
        <h3><span class="mw-headline" id="Moodle_Mobile_SCORM_addon">Moodle Mobile SCORM addon</span></h3> 
        <p>A new addon for the SCORM module that will contain the AngularJS SCORM player and will perform the following tasks: </p> 
        <ul>
         <li> Downloading and synchronizing the SCORM zip package</li> 
         <li> Unzipping the package into the device persistent storage</li> 
         <li> Populating the SCORM SCO’s default tracking information </li> 
         <li> Storing and synchronizing tracking information with Moodle via Web Service</li>
        </ul> 
        <p>In order to do that, the SCORM player (AngularJS module) will have to communicate with the addon via the API runtime (functions LMSInitialize, LMSGetValue, LMSSetValue) </p> 
        <h2><span class="mw-headline" id="Use_cases">Use cases</span></h2> 
        <h3><span class="mw-headline" id="Online">Online</span></h3> 
        <p><b>Scenario:</b> </p> 
        <ul>
         <li> A teacher has created a Moodle course including 3 SCORM packages: two packages uploaded via zip and a second package pointing to a imsmanifest.xml file via URL. One of the uploaded packages is around 250MB, the other one around 20MB</li> 
         <li> The teacher has allowed the two uploaded packages to be accessed via the Mobile app.</li> 
         <li> A student opens the course using the Mobile app. He can see listed the 3 SCORM packages, but when he tries to open the linked package he gets a warning message saying that this SCORM package is not compatible with the app.</li> 
         <li> When he tries to open the SCORM package (the one that is around 250MB) he gets a new warning about the size of the SCORM and the current free space (300MB), therefore the user cannot download this package.</li> 
         <li> Finally, he tries to open the last SCORM package, and he sees that this package is compatible with the device. When the user opens the package in the app, the following happens:</li>
        </ul> 
        <ul>
         <li>
          <ul>
           <li> The app checks if the package was already downloaded, if so, it checks if the checksum is still valid; if it’s not, it downloads the package again.</li> 
           <li> If the package was not downloaded, the app downloads it.</li> 
           <li> The app via the mod_scorm_get_scorm_attempts WS tries to resolve the current attempt for the user (resume, start a new one)</li> 
           <li> The app then retrieves the list of SCOes inside the package via mod_scorm_get_scorm_scoes, and the SCORM SCOes default data via mod_scorm_get_scorm_default_values</li> 
           <li> When this information is ready, the app launches the player that via LMSInitialize will initialize the first SCO data</li> 
           <li> The student does some activities inside the SCORM and some information is stored via LMSSetValue. Once he has finished (or every time LMSCommit happens or iv scorm-&gt;autocommit is enabled), the information is stored in Moodle via the mod_scorm_insert_scorm_track Web Service</li>
          </ul></li>
        </ul> 
        <h2><span class="mw-headline" id="Offline_support">Offline support</span></h2> 
        <p>First of all, to be clear, SCORM is a standard that wasn’t designed to work offline and synchronize data. One of the reasons forcing ADL to sponsor xAPI (Tincan API) was the impossibility of working in offline scenarios with SCORM (see <a rel="nofollow" class="external free" href="http://scorm.com/project-tin-can-phase-3-tracking-offlinelong-running-content/">http://scorm.com/project-tin-can-phase-3-tracking-offlinelong-running-content/</a>). </p>
        <p>With this premise—SCORM not being suitable for offline mode—we needed to lower our expectations. We needed to do something simple that also works for 90% of the cases. </p>
        <p>So basically we came up with two approaches for implementing SCORM offline: </p> 
        <h3><span class="mw-headline" id="Approach_1:_Data_merging">Approach 1: Data merging</span></h3> 
        <p>This is the most complex approach that basically would work merging data between the online and offline mode. We currently can’t implement this approach because the Web Services does not return data like the time a track entry was created or modified. </p>
        <p>Merging data is very dangerous because in some cases the SCORMS developers use different elements of the specs to store data that must be synchronized (suspend_data and lesson_status, for example). We did an initial study of all the possible cases and we found it very complex to implement something that works for the final user. </p> 
        <h3><span class="mw-headline" id="Approach_2:_Independent_attempts:">Approach 2: Independent attempts:</span></h3> 
        <p>This approach profits from the self-contained characteristic of Moodle attempts. </p>
        <p>Moodle attempts are independent, this approach have the following considerations: </p> 
        <ul>
         <li> If the user is ONLINE he can continue and start new attempts that automatically will be synchronized with Moodle (real time)</li> 
         <li> If the user is Offline, the user can:</li> 
         <li> Start new offline attempts (if the previous online or offline attempts are finished).</li> 
         <li> Continue existing offline attempts.</li> 
         <li> Continue existing online attempts. In this case, since the online cached data could be outdated, we’d ask the user if he wants to start a new offline attempt or continue with the online one. * If the user chooses to continue an online attempt but our cached data doesn't matches Moodle data when synchronizing, a new attempt will be created.</li> 
         <li> If the user is Online and he switches to Offline: same as continuing online attempts, we’ll ask the user what to do (in this case we take a snapshot of the data to compare to the remote data, when we try to synchronize if the data don’t match we’ll be creating a new attempt)</li>
        </ul> 
        <p>Using this approach forces us to have a strong and clever synchronization process, This process should be able to analyze all the possible scenarios to check if it can synchronize data or not. </p>
        <p><b>Some cases:</b> </p> 
        <ul>
         <li> Moodle Web all attempts finished and Moodle Mobile one attempt pending to be synchronized: In this case, the process should check if we’ve reached the attempts limit</li> 
         <li> Moodle Web last attempt not finished and Moodle Mobile one attempt pending to be synchronized: In this case we cannot synchronize, we should advise the user to finish the Moodle attempt</li> 
         <li> Moodle Web last attempt not finished and Moodle Mobile same attempt continued: Compare the snapshot, if it matches it means that the user hasn’t modified anything in Moodle web so we can synchronize the data. If the snapshot doesn’t match with Moodle web’s data, create a new offline attempt that will be synchronized when the Moodle Web attempt is finished. </li> 
         <li> Moodle web last attempt not finished and Moodle Mobile last attempt not finished (different attempts). The user is online, in this case the user must finish the offline attempt</li>
        </ul> 
        <h3><span class="mw-headline" id="All_the_possible_cases">All the possible cases</span></h3> 
        <p><i>Case 1: SCORM in Moodle Web does not have attempts</i> </p>
        <p>User is offline </p>
        <p>There aren't attempts not synchronized </p>
        <p>Get the attempts count ( 0 if not cache available) </p>
        <p>Check the attempt limit number </p>
        <p>Get SCOES </p>
        <p>TOC: Create empty </p>
        <p>User start a new attempt </p>
        <p>Save attempt tracks </p>
        <p>If the user leaves, we try to synchronize if he is online, if we synchronize we fetch all the required data for the next execution get_user_data, get_scoes_track </p>
        <p><br> <i>Case 2: SCORM in Moodle Web have attempts</i> </p>
        <p>User is offline </p>
        <p>get_attempts_count is 0 </p>
        <p>There aren't attempts not synchronized </p>
        <p>Same case that above </p>
        <p><br> <i>Case 3: SCORM in Moodle Web have attempts</i> </p>
        <p>User is offline </p>
        <p>The last attempt is finished </p>
        <p>There aren't attempts not synchronized </p>
        <p>Same case that above, except for the TOC that is cached (last attempt) but not the player TOC that will be empty </p>
        <p><br> <i>Case 4: SCORM in Moodle Web have attempts</i> </p>
        <p>User is offline </p>
        <p>Last cached attempt is not finished </p>
        <p>There aren't attempts not synchronized </p>
        <p>New attempt always or continue the attempt? </p>
        <p>Ask the user, because if he continues and we cannot synchronize the continued attempt will become a new attempt </p>
        <p><br> <i>Case 5: User is offline</i> </p>
        <p>The last offline attempt not sync is finished </p>
        <p>There are attempts not sync </p>
        <p>Start new attempt, and then Case 3 </p>
        <p><br> <i>Case 6: User is offline</i> </p>
        <p>The last offline attempt not sync is not finished </p>
        <p>There are attempts not sync </p>
        <p>Continue the attempt </p>
        <p>Index TOC with offline data </p>
        <p>Same TOC for player </p>
        <p>When the user finishes, try to sync </p>
        <p><br> <i>Case 7: User is online</i> </p>
        <p>Then go offline </p>
        <p>Try to sync the current SCORM </p>
        <p>Make an snapshot, ask the user to continue the attempt or start a new offline attempt </p>
        <p>Try to sync </p>
        <p><br> <i>Case 8: User is offline</i> </p>
        <p>Then go online </p>
        <p>Try to sync, we sync when the TOC change also. Sync is complex, operations are not atomic </p>
        <p><br> <i>Case 9: User is online</i> </p>
        <p>Offline attempt not finished </p>
        <p>Online attempt not finished </p>
        <p>Force to finish the off-line? (ask Gavin-Martin) </p>
        <p><br> <i>Case 10: User is online</i> </p>
        <p>Offline attempt finished </p>
        <p>Online attempt not finished </p>
        <p>Sync process will do, we need to display to the user a list of not-synchronized attempts </p>
        <p><br> </p> 
        <h3><span class="mw-headline" id="Synchronization_cases">Synchronization cases</span></h3> 
        <p>When the app tries to synchronize a SCORM it can find these cases: </p>
        <p>1- SCORM only has online attempts. Nothing to sync. </p>
        <p>2- SCORM only has offline attempts. Send them all to Moodle (without surpassing max attempts). </p>
        <p>3- SCORM has online completed attempts and new offline attempts (consecutive to the online ones). Send the offline attempts as new attempts (without surpassing max attempts). </p>
        <p>4- SCORM has online completed attempts and new offline attempts NOT consecutive (the offline attempts were created over a cached version or similar case). Modify offline attempts numbers to place them after the online attempts and send them to Moodle (without surpassing max attempts). </p>
        <p>5- SCORM has an online incomplete attempt that has been continued in offline. Compare snapshots: </p>
        <p>5.1- If snapshots match (attempt hasn’t been modified in Moodle), send offline data. </p>
        <p>5.2- If snapshots don’t match, convert offline attempt into a new attempt. After this conversion we will end up with one of the following cases: 3, 4 or 6. If max attempts has been reached then the offline attempt will be discarded. </p>
        <p>6- SCORM has new offline attempts created over an online completed attempt, but we receive a new online incomplete attempt. The last offline attempt can be completed or not. User has to finish the online attempt before we can send the offline attempts (the offline attempts will be created AFTER the online one without surpassing max attempts). </p> 
       </div>
       <div class="printfooter">
         Retrieved from "
        <a dir="ltr" href="https://docs.moodle.org/dev/index.php?title=SCORM_1.2_player_in_the_Mobile_app&amp;oldid=49405">https://docs.moodle.org/dev/index.php?title=SCORM_1.2_player_in_the_Mobile_app&amp;oldid=49405</a>"
       </div> 
       <div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div> 
       <div class="visualClear"></div> 
      </div> 
     </div>
    </div> 
    <div id="column-one" class="row-fluid"> 
     <div id="p-cactions" class="portlet"> 
      <h5>Views</h5> 
      <div class="pBody"> 
       <ul>
        <li id="ca-nstab-main" class="selected"><a href="/dev/SCORM_1.2_player_in_the_Mobile_app" title="View the content page [c]" accesskey="c">Page</a></li>
        <li id="ca-talk" class="new"><a href="/dev/index.php?title=Talk:SCORM_1.2_player_in_the_Mobile_app&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
        <li id="ca-viewsource"><a href="/dev/index.php?title=SCORM_1.2_player_in_the_Mobile_app&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e">View source</a></li>
        <li id="ca-history"><a href="/dev/index.php?title=SCORM_1.2_player_in_the_Mobile_app&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
       </ul> 
      </div> 
     </div> 
     <div class="portlet" id="p-personal"> 
      <h5>Personal tools</h5> 
      <div class="pBody"> 
       <ul>
        <li><a href="/dev/index.php?title=Special:UserLogin&amp;returnto=SCORM+1.2+player+in+the+Mobile+app">Log in</a></li>
       </ul> 
      </div> 
     </div> 
     <div class="portlet bottom-portlet span6" id="p-navigation"> 
      <h5>Navigation</h5> 
      <div class="pBody"> 
       <ul> 
        <li id="n-mainpage-description"><a href="/dev/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li> 
        <li id="n-recentchanges"><a href="/dev/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li> 
        <li id="n-Moodle-Docs-3.3"><a href="https://docs.moodle.org/33/en">Moodle Docs 3.3</a></li> 
        <li id="n-Docs-overview"><a href="https://docs.moodle.org/overview/">Docs overview</a></li> 
       </ul> 
      </div> 
     </div> 
     <div class="portlet bottom-portlet span6" id="p-tb"> 
      <h5>Tools</h5> 
      <div class="pBody"> 
       <ul> 
        <li id="t-whatlinkshere"><a href="/dev/Special:WhatLinksHere/SCORM_1.2_player_in_the_Mobile_app" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li> 
        <li id="t-recentchangeslinked"><a href="/dev/Special:RecentChangesLinked/SCORM_1.2_player_in_the_Mobile_app" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li> 
        <li id="t-specialpages"><a href="/dev/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li> 
        <li id="t-print"><a href="/dev/index.php?title=SCORM_1.2_player_in_the_Mobile_app&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li> 
        <li id="t-permalink"><a href="/dev/index.php?title=SCORM_1.2_player_in_the_Mobile_app&amp;oldid=49405" title="Permanent link to this revision of the page">Permanent link</a></li> 
       </ul> 
      </div> 
     </div> 
     <div id="p-search" role="search"> 
      <h3><label for="searchInput">Search</label></h3> 
      <form action="/dev/index.php" id="searchform"> 
       <div id="simpleSearch"> 
        <input name="search" placeholder="Search" title="Search MoodleDocs [f]" accesskey="f" id="searchInput"> 
        <button type="submit" name="button" title="Search the pages for this text" id="searchButton"><img src="/dev/skins/moodledocs/images/search-ltr.png?305" alt="Search" width="12" height="13"></button> 
        <input type="hidden" name="title" value="Special:Search"> 
       </div> 
      </form> 
     </div> 
    </div> 
    <div class="visualClear"></div> 
    <div id="footer"> 
     <div id="f-poweredbyico"> 
      <a href="//www.mediawiki.org/"><img src="/dev/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/dev/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /dev/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a> 
     </div> 
     <ul id="f-list"> 
      <li id="lastmod"> This page was last modified on 3 February 2016, at 19:10.</li> 
      <li id="copyright">Content is available under <a class="external" rel="nofollow" href="https://docs.moodle.org/dev/License">GNU General Public License</a> unless otherwise noted.</li> 
      <li id="privacy"><a href="/dev/MoodleDocs:Privacy_policy" title="MoodleDocs:Privacy policy">Privacy policy</a></li> 
      <li id="about"><a href="/dev/MoodleDocs:About" title="MoodleDocs:About">About the Dev docs</a></li> 
      <li id="disclaimer"><a href="/dev/MoodleDocs:General_disclaimer" title="MoodleDocs:General disclaimer">Disclaimers</a></li> 
     </ul> 
    </div> 
   </div> 
   <script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.moodledocs.bootstrap"]);});</script>
   <script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":50});});</script> 
   <div id="moodlesitelink"></div> 
  </div> 
  <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script>
  <script type="text/javascript">try {var pageTracker = _gat._getTracker("UA-72764-4");pageTracker._trackPageview();} catch(err) {}</script> 
 </body>
</html>