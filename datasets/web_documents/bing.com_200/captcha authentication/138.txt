<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head> 
  <!-- LOCALIZATION RELATED INFORMATION --> 
  <meta name="LOC_PROJ_ID" content="WLPF8.1"> 
  <meta name="LOC_OWNER" content="BEAJ"> 
  <meta name="LOC_STATUS" content="READY!"> 
  <meta name="LOC_COMMENT" content="LOC_COMMENT"> 
  <meta name="LOC_US_REV" content="40"> 
  <meta name="LOC_US_CHANGE" content="716380"> 
  <meta name="LOC_US_SRCFILE" content="//depot/docs/olympic/fm/security/SSL_client.fm"> 
  <!-- LOCALIZATION RELATED INFORMATION --> 
  <title>Using SSL Authentication in Java Clients

</title> 
  <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
  <meta http-equiv="pragma" content="no-cache"> 
  <meta http-equiv="Content-Language" content="en-us"> 
  <meta name="description" content="BEA WebLogic Server Documentation"> 
  <meta name="keywords" content="WebLogic Server"> 
  <style type="text/css" media="all">@import "../styles.css";</style> 
  <style type="text/css" media="all">@import "../edocs.css";</style> 
  <script language="Javascript" src="floatwin.js" type="text/javascript"></script> 
  <!-- This script opens a new small floating window and puts TOC<i>&lt;name&gt;</i>.html and IX<i>&lt;name&gt;</i>.html files in it and sets a generic popup window code to enable the display of some viewlets in the WebLogic Platform Tour. --> 
  <script language="JavaScript1.1" src="../search.js" type="text/javascript"></script> 
  <!-- This script is not for online documents. It is only used by the QuestAgent Java Applet for CD search indexes. --> 
  <script language="Javascript" src="/global_resources/js/banner.js" type="text/javascript"></script> 
  <!-- This script outputs the google search form. --> 
  <script language="Javascript1.1" src="../copyright.js" type="text/javascript"></script> 
  <!-- This script outputs the correct copyright date and link to copyright page.--> 
  <script>var w=window;if(w.performance||w.mozPerformance||w.msPerformance||w.webkitPerformance){var d=document;AKSB=w.AKSB||{},AKSB.q=AKSB.q||[],AKSB.mark=AKSB.mark||function(e,_){AKSB.q.push(["mark",e,_||(new Date).getTime()])},AKSB.measure=AKSB.measure||function(e,_,t){AKSB.q.push(["measure",e,_,t||(new Date).getTime()])},AKSB.done=AKSB.done||function(e){AKSB.q.push(["done",e])},AKSB.mark("firstbyte",(new Date).getTime()),AKSB.prof={custid:"322179",ustr:"",originlat:"0",clientrtt:"26",ghostip:"190.98.152.119",ipv6:false,pct:"10",clientip:"152.170.26.191",requestid:"1a3389a",region:"26252",protocol:"",blver:13,akM:"dscx",akN:"ae",akTT:"O",akTX:"1",akTI:"1a3389a",ai:"206465",ra:"false",pmgn:"",pmgi:"",pmp:"",qc:""},function(e){var _=d.createElement("script");_.async="async",_.src=e;var t=d.getElementsByTagName("script"),t=t[t.length-1];t.parentNode.insertBefore(_,t)}(("https:"===d.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/aksb.min.js")}</script> 
 </head> 
 <body> 
  <a name="1058669"></a> 
  <div class="hide">
   <a href="#wrap" title="Skip navigation" accesskey="2">Skip navigation</a>.
  </div> 
  <script language="Javascript1.1" type="text/javascript">
Banner();
</script> 
  <noscript>
   This script outputs the google search URL required for search on edocs documentation.
  </noscript> 
  <!-- page contents --> 
  <!-- breadcrumbs --> 
  <p class="breadcrumb"> <a href="http://www.oracle.com/technology/documentation/index.html">eDocs Home</a> &gt; <a href="../index.html">BEA WebLogic Server 8.1 Documentation</a> &gt; <a href="index.html">Programming WebLogic Security</a> &gt; Using SSL Authentication in Java Clients </p> 
  <!-- breadcrumbs END --> 
  <a name="wrap"></a> 
  <div id="wrap"> 
   <!-- page title --> 
   <p class="booktitle">Programming WebLogic Security</p> 
   <!-- page title end --> 
   <!-- Doc Nav --> 
   <table border="0" cellspacing="0" cellpadding="6"> 
    <tbody>
     <tr> 
      <td>&nbsp;</td> 
      <td> <a href="fat_client.html"><img src="../images/doc_nav_prev.gif" width="35" height="44" alt="Previous" title="Previous" border="0"></a> </td> 
      <td> </td>
      <td><a href="ejb_client.html"><img src="../images/doc_nav_next.gif" width="44" height="44" alt="Next" title="Next" border="0"></a></td> 
      <td><img src="../images/doc_nav_dots.gif" width="5" height="44" border="0" alt="vertical dots separating previous/next from contents/index/pdf"></td> 
      <td><a href="javascript:OpenWindowToc();" onmouseover="window.status='Table of Contents'; return true" onfocus="window.status='Table of Contents'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open TOC in new window"><img src="../images/doc_nav_contents.gif" width="52" height="44" alt="Contents" title="Contents" border="0"></a> </td> 
      <td><a href="javascript:OpenWindowIndex();" onmouseover="window.status='Index'; return true" onfocus="window.status='Index'; return true" onmouseout="window.status=''; return true" onblur="window.status=''; return true" title="Open Index in a new window"><img src="../images/doc_nav_index.gif" alt="Index" title="Index" border="0" width="34" height="44"></a> </td> 
      <td><a href="../pdf/security.pdf" target="pdf"><img src="../images/doc_nav_pdf.gif" width="59" height="44" alt="View as PDF" title="View as PDF" border="0"></a></td> 
      <td>&nbsp;</td> 
      <td><a href="http://www.adobe.com/products/acrobat/alternate.html" target="_blank"><img src="../images/get_reader.gif" width="52" height="44" alt="Get Adobe Reader" title="Get Adobe Reader" border="0"></a></td> 
     </tr> 
    </tbody>
   </table> 
   <!-- Doc Nav End --> 
   <!-- CONTENT --> 
   <h1 class="chaphead"><a name="1058669"></a>Using SSL Authentication in Java Clients</h1> 
   <p><a name="1029234"></a>The following topics are covered in this section:</p> 
   <ul type="square">
    <li type="square"><a name="1029238"></a><a href="SSL_client.html#1042206">JSSE and WebLogic Server</a></li> 
    <li type="square"><a name="1055267"></a><a href="SSL_client.html#1054842">Using JNDI Authentication</a></li> 
    <li type="square"><a name="1032637"></a><a href="SSL_client.html#1046390">SSL Certificate Authentication Development Environment</a></li> 
    <li type="square"><a name="1052628"></a><a href="SSL_client.html#1029580">Writing Applications that Use SSL</a></li> 
    <li type="square"><a name="1054458"></a><a href="SSL_client.html#1052653">SSL Client Code Examples</a></li> 
   </ul>
   <p>&nbsp;</p> 
   <hr noshade> 
   <h1 class="head1"><a name="1042206"></a><a name="fat_client_01"></a>JSSE and WebLogic Server</h1> 
   <p><a name="1042207"></a>JSSE is a set of packages that support and implement the SSL and TLS v1 protocols, making those capabilities programmatically available. BEA WebLogic Server provides Secure Sockets Layer (SSL) support for encrypting data transmitted between WebLogic Server clients and servers, Java clients, Web browsers, and other servers.</p> 
   <p><a name="1056843"></a>WebLogic Server's Java Secure Socket Extension (JSSE) implementation can be used by WebLogic clients, but is not required. Other JSSE implementations can be used for their client-side code outside the server as well.</p> 
   <p><a name="1061730"></a>The following restrictions apply when using SSL in WebLogic server-side applications:</p> 
   <ul type="square">
    <li type="square"><a name="1061733"></a>The use of other (third-party) JSSE implementations to develop WebLogic server applications is not supported. The SSL implementation that WebLogic Server uses is static to the server configuration and is not replaceable by customer applications. You cannot plug different JSSE implementations into WebLogic Server to have it use those implementations for SSL.</li> 
    <li type="square"><a name="1061797"></a>The WebLogic implementation of JSSE does support JCE Cryptographic Service Providers (CSPs), however, due to the inconsistent provider support for JCE, BEA cannot guarantee that untested providers will work out of the box. BEA has tested WebLogic Server with the following providers:</li> 
    <ul type="disc">
     <li type="disc"><a name="1061916"></a>The default JCE provider (SunJCE provider) that is included with JDK 1.4.1.</li> 
     <li type="disc"><a name="1061921"></a>The nCipher JCE provider. </li> 
    </ul>
    <dl>
     <dt>
      <p class="listpara"><a name="1061923"></a>Other providers may work with WebLogic Server, but an untested provider is not likely to work out of the box. For more information on using the JCE providers supported by WebLogic Server, see <a href="../secmanage/ssl.html#configureSSL">Configuring SSL</a> in <em>Managing WebLogic Security</em>.</p> 
     </dt>
    </dl>
   </ul> 
   <p><a name="1049798"></a>WebLogic Server uses the HTTPS port for SSL. Only SSL can be used on that port. SSL encrypts the data transmitted between the client and WebLogic Server so that the username and password do not flow in clear text.</p> 
   <p><strong><a name="1054675"></a>Note: </strong> In order to implement security in a WebLogic client, you must install the WebLogic Server software distribution kit on the Java client.</p> 
   <p>&nbsp;</p> 
   <hr noshade> 
   <h1 class="head1"><a name="1054842"></a>Using JNDI Authentication</h1> 
   <p><a name="1054843"></a>Java clients use the Java Naming and Directory Interface (JNDI) to pass credentials to WebLogic Server. A Java client establishes a connection with WebLogic Server by getting a JNDI <code style="font-family: courier">InitialContext</code>. The Java client then uses the <code style="font-family: courier">InitialContext</code> to look up the resources it needs in the WebLogic Server JNDI tree.</p> 
   <p><strong><a name="1054850"></a>Note: </strong> JAAS is the preferred method of authentication, however, the Authentication provider's LoginModule only supports username and password authentication. Thus, for client certificate authentication (also referred to as two-way SSL authentication), you should use JNDI. To use JAAS for client certificate authentication, you must write a custom Authentication provider whose LoginModule does certificate authentication. </p> 
   <p><a name="1054851"></a>To specify a user and the user's credentials, set the JNDI properties listed in the <a href="SSL_client.html#1054958">Table&nbsp;4-1</a>.</p> 
   <p><a name="1054988"></a> <a name="fat_client_05"></a></p>
   <div class="tblmargin"> 
    <p class="tabletitle"><a name="1054958"></a>Table 4-1 JNDI Properties Used for Authentication&nbsp;</p>
    <table border="1" bordercolorlight="#FFFFFF" bordercolordark="#000000" cellpadding="3" cellspacing="0">  
     <tbody>
      <tr bgcolor="#CCCCCC"> 
       <th align="left" valign="top" scope="col"> <p class="cellheading"><a name="1054962"></a>Property</p> </th> 
       <th align="left" valign="top" scope="col"> <p class="cellheading"><a name="1054964"></a>Meaning</p> </th> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1054966"></a><code style="font-family: courier">INITIAL_CONTEXT_FACTORY</code></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1054971"></a>Provides an entry point into the WebLogic Server environment. The class <a href="../javadocs/weblogic/jndi/WLInitialContextFactory.html">weblogic.jndi.WLInitialContextFactory</a> is the JNDI SPI for WebLogic Server.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1054978"></a><code style="font-family: courier">PROVIDER_URL</code></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1054980"></a>Specifies the host and port of the WebLogic Server that provides the name service. For example:<code style="font-family: courier"> t3s://weblogic:7002</code>.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1054982"></a><code style="font-family: courier">SECURITY_PRINCIPAL</code></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1054984"></a>Specifies the identity of the user when that user authenticates to the default (active) security realm.</p> </td> 
      </tr> 
     </tbody>
    </table> 
   </div> 
   <p></p> 
   <br>&nbsp; 
   <p><a name="1055994"></a>These properties are stored in a hash table that is passed to the <code style="font-family: courier">InitialContext </code>constructor. Notice the use of t3s, which is a WebLogic Server proprietary version of SSL. t3s uses encryption to protect the connection and communication between WebLogic Server and the Java client.</p> 
   <p><a name="1061484"></a><a href="SSL_client.html#1055143">Listing&nbsp;4-1</a> demonstrates how to use one-way SSL certificate authentication in a Java client. For a two-SSL authentication code example, see <a href="SSL_client.html#1033907">Listing&nbsp;4-5</a>.</p> 
   <p class="codetitle"><a name="1055143"></a>Listing 4-1 Example of One-Way SSL Authentication Using JNDI</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1055468"></a>...<br>Hashtable env = new Hashtable();<br>      env.put(Context.INITIAL_CONTEXT_FACTORY,<br>              "weblogic.jndi.WLInitialContextFactory");<br>      env.put(Context.PROVIDER_URL, "t3s://weblogic:7002");<br>      env.put(Context.SECURITY_PRINCIPAL, "javaclient");<br>      env.put(Context.SECURITY_CREDENTIALS, "javaclientpassword");<br>      ctx = new InitialContext(env);</code></pre>
   </blockquote> 
   <p><strong><a name="1064218"></a>Note: </strong> For information on JNDI contexts and threads and how to avoid potential JNDI context problems, see <a href="../jndi/jndi.html#jndicontext">JNDI Contexts and Threads</a> and <a href="../jndi/jndi.html#contextproblems">How to Avoid JNDI Context Problems</a> in the <em>Programming WebLogic JNDI</em>. </p> 
   <p>&nbsp;</p> 
   <hr noshade> 
   <h1 class="head1"><a name="1046390"></a>SSL Certificate Authentication Development Environment</h1> 
   <p><a name="1046394"></a>The following topics are covered in this section:</p> 
   <ul type="square">
    <li type="square"><a name="1049914"></a><a href="SSL_client.html#1046397">SSL Authentication APIs</a></li> 
    <li type="square"><a name="1049922"></a><a href="SSL_client.html#1050013">SSL Client Application Components</a></li> 
   </ul>
   <h2 class="head2"><a name="1046397"></a>SSL Authentication APIs</h2> 
   <p><a name="1046453"></a>To implement Java clients that use SSL authentication on WebLogic Server, you use a combination of Java SDK 1.3 application programming interfaces (APIs) and WebLogic APIs. </p> 
   <p><a name="1046457"></a><a href="SSL_client.html#1047125">Table&nbsp;4-2</a> lists and describes the Java SDK APIs packages used to implement certificate authentication. The information in <a href="SSL_client.html#1047125">Table&nbsp;4-2</a> is taken from the Java SDK API documentation and annotated to add WebLogic Server specific information. For more information on the Java SDK APIs, see the Javadocs at <a href="http://java.sun.com/j2se/1.4.1/docs/api/index.html">http://java.sun.com/j2se/1.4.1/docs/api/index.html</a> and http://java.sun.com/j2ee/1.4/docs/api/index.html.</p> 
   <p><a name="1046601"></a><a href="SSL_client.html#1049934">Table&nbsp;4-3</a> lists and describes the WebLogic APIs used to implement certificate authentication. For more information, see <a href="../javadocs/index.html">Javadocs for WebLogic Classes</a>.</p> 
   <p><a name="1047151"></a> </p>
   <div class="tblmargin"> 
    <p class="tabletitle"><a name="1047125"></a>Table 4-2 Java SDK Certificate APIs&nbsp;</p>
    <table border="1" bordercolorlight="#FFFFFF" bordercolordark="#000000" cellpadding="3" cellspacing="0">  
     <tbody>
      <tr bgcolor="#CCCCCC"> 
       <th align="left" valign="top" scope="col"> <p class="cellheading"><a name="1047129"></a>Java SDK Certificate APIs</p> </th> 
       <th align="left" valign="top" scope="col"> <p class="cellheading"><a name="1047131"></a>Description</p> </th> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1051810"></a><a href="http://java.sun.com/j2se/1.4/docs/api/index.html">javax.crypto</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1051812"></a>This package provides the classes and interfaces for cryptographic operations. The cryptographic operations defined in this package include encryption, key generation and key agreement, and Message Authentication Code (MAC) generation. </p> <p class="table"><a name="1051813"></a>Support for encryption includes symmetric, asymmetric, block, and stream ciphers. This package also supports secure streams and sealed objects. </p> <p class="table"><a name="1051814"></a>Many classes provided in this package are provider-based (see the <code style="font-family: courier">java.security.Provider</code> class). The class itself defines a programming interface to which applications may be written. The implementations themselves may then be written by independent third-party vendors and plugged in seamlessly as needed. Therefore, application developers may take advantage of any number of provider-based implementations without having to add or rewrite code. </p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1051817"></a><a href="http://java.sun.com/j2se/1.4/docs/api/index.html">javax.net</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1051819"></a>This package provides classes for networking applications. These classes include factories for creating sockets. Using socket factories you can encapsulate socket creation and configuration behavior.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1051822"></a><a href="http://java.sun.com/j2se/1.4/docs/api/index.html">javax.net.SSL</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1051824"></a>While the classes and interfaces in this package are supported by WebLogic Server, BEA recommends that you use the <code style="font-family: courier">weblogic.security.SSL</code> package when you use SSL with WebLogic Server.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052049"></a><a href="http://java.sun.com/j2se/1.4.1/docs/api/index.html">java.security.cert</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052051"></a>This package provides classes and interfaces for parsing and managing certificates, certificate revocation lists (CRLs), and certification paths. It contains support for X.509 v3 certificates and X.509 v2 CRLs. </p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052324"></a><a href="http://java.sun.com/j2se/1.4.1/docs/api/index.html">java.security.KeyStore</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052326"></a>This class represents an in-memory collection of keys and certificates. It is used to manage two types of keystore entries:</p> 
        <ul class="smallindent">
         <li type="square"><p class="table"><a name="1052327"></a>Key Entry </p></li>
        </ul> 
        <dl>
         <dt>
          <p class="celllistpara"><a name="1052328"></a>This type of keystore entry holds very sensitive cryptographic key information, which is stored in a protected format to prevent unauthorized access. </p>
         </dt>
         <dt>
          <p class="celllistpara"><a name="1052329"></a>Typically, a key stored in this type of entry is a secret key, or a private key accompanied by the certificate chain for the corresponding public key. </p>
         </dt>
         <dt>
          <p class="celllistpara"><a name="1052330"></a>Private keys and certificate chains are used by a given entity for self-authentication. Applications for this authentication include software distribution organizations which sign JAR files as part of releasing and/or licensing software. </p>
         </dt>
        </dl>
        <ul class="smallindent">
         <li type="square"><p class="table"><a name="1052331"></a>Trusted Certificate Entry </p></li>
        </ul> 
        <dl>
         <dt>
          <p class="celllistpara"><a name="1052332"></a>This type of entry contains a single public key certificate belonging to another party. It is called a trusted certificate because the keystore owner trusts that the public key in the certificate indeed belongs to the identity identified by the subject (owner) of the certificate. </p>
         </dt>
         <dt>
          <p class="celllistpara"><a name="1052333"></a>This type of entry can be used to authenticate other parties. </p>
         </dt>
        </dl> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052336"></a><a href="http://java.sun.com/j2se/1.4.1/docs/api/index.html">java.security.PrivateKey</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052338"></a>A private key. This interface contains no methods or constants. It merely serves to group (and provide type safety for) all private key interfaces. </p> <p class="cellnote"><a name="1063834"></a><strong>Note: </strong> The specialized private key interfaces extend this interface. For example, see the <code style="font-family: courier">DSAPrivateKey</code> interface in <code style="font-family: courier">java.security.interfaces</code>.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052558"></a><a href="http://java.sun.com/j2se/1.4.1/docs/api/index.html">java.security.Provider</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1052560"></a>This class represents a "Cryptographic Service Provider" for the Java Security API, where a provider implements some or all parts of Java Security, including:</p> 
        <ul class="smallindent">
         <li type="square"><p class="table"><a name="1052561"></a>Algorithms (such as DSA, RSA, MD5 or SHA-1).</p></li>
        </ul> 
        <ul class="smallindent">
         <li type="square"><p class="table"><a name="1052562"></a>Key generation, conversion, and management facilities (such as for algorithm-specific keys).</p></li>
        </ul> <p class="table"><a name="1052563"></a>Each provider has a name and a version number, and is configured in each runtime it is installed in. </p> <p class="table"><a name="1052564"></a>To supply implementations of cryptographic services, a team of developers or a third-party vendor writes the implementation code and creates a subclass of the <code style="font-family: courier">Provider</code> class.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047133"></a>javax.servlet.http.<br>HttpServletRequest</p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047135"></a>This interface extends the <code style="font-family: courier">ServletRequest</code> interface to provide request information for HTTP servlets.</p> <p class="table"><a name="1047136"></a>The servlet container creates an <code style="font-family: courier">HttpServletRequest</code> object and passes it as an argument to the servlet's service methods (<code style="font-family: courier">doGet</code>, <code style="font-family: courier">doPost</code>, and so on.).</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047138"></a>javax.servlet.http.<br>HttpServletResponse</p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047140"></a>This interface extends the <code style="font-family: courier">ServletResponse</code> interface to provide HTTP-specific functionality in sending a response. For example, it has methods to access HTTP headers and cookies.</p> <p class="table"><a name="1047141"></a>The servlet container creates an <code style="font-family: courier">HttpServletRequest</code> object and passes it as an argument to the servlet's service methods (<code style="font-family: courier">doGet</code>, <code style="font-family: courier">doPost</code>, and so on.).</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047143"></a>javax.servlet.<br>ServletOutputStream</p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047145"></a>This class provides an output stream for sending binary data to the client. A <code style="font-family: courier">ServletOutputStream</code> object is normally retrieved via the <code style="font-family: courier">ServletResponse.getOutputStream()</code> method.</p> <p class="table"><a name="1047146"></a>This is an abstract class that the servlet container implements. Subclasses of this class must implement the <code style="font-family: courier">java.io.OutputStream.write(int)</code> method. </p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047148"></a>javax.servlet.<br>ServletResponse</p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1047150"></a>This class defines an object to assist a servlet in sending a response to the client. The servlet container creates a <code style="font-family: courier">ServletResponse</code> object and passes it as an argument to the servlet's service methods (<code style="font-family: courier">doGet</code>, <code style="font-family: courier">doPost</code>, and so on.). </p> </td> 
      </tr> 
     </tbody>
    </table> 
   </div> 
   <p></p> 
   <br>&nbsp; 
   <p><a name="1049962"></a> </p>
   <div class="tblmargin"> 
    <p class="tabletitle"><a name="1049934"></a>Table 4-3 WebLogic Certificate APIs&nbsp;</p>
    <table border="1" bordercolorlight="#FFFFFF" bordercolordark="#000000" cellpadding="3" cellspacing="0">  
     <tbody>
      <tr bgcolor="#CCCCCC"> 
       <th align="left" valign="top" scope="col"> <p class="cellheading"><a name="1049938"></a>WebLogic Certificate APIs</p> </th> 
       <th align="left" valign="top" scope="col"> <p class="cellheading"><a name="1049940"></a>Description</p> </th> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1056263"></a><a href="../javadocs/index.html">weblogic.net.http.<br>HttpsURLConnection</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1056266"></a>This class is used to represent a Hyper-Text Transfer Protocol with SSL (HTTPS) connection to a remote object. This class is used to make an outbound SSL connection from a WebLogic Server acting as a client to another WebLogic Server.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049942"></a><a href="../javadocs/index.html">weblogic.security.SSL.<br>HostnameVerifierJSSE</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049944"></a>This interface provides a callback mechanism so that implementers of this interface can supply a policy for handling the case where the host that's being connected to and the server name from the certificate <code style="font-family: courier">SubjectDN</code> must match.</p> <p class="table"><a name="1049945"></a>To specify an instance of this interface to be used by the server, set the class for the custom host name verifier in the Client Attributes fields that are located on the Advanced Options pane under the Keystore &amp; SSL tab for the server (for example, <code style="font-family: courier">myserver</code>).</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049947"></a><a href="../javadocs/index.html">weblogic.security.SSL.<br>TrustManagerJSSE</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049949"></a>This interface permits the user to override certain validation errors in the peer's certificate chain and allow the handshake to continue. This interface also permits the user to perform additional validation on the peer certificate chain and interrupt the handshake if need be. </p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049951"></a><a href="../javadocs/index.html">weblogic.security.SSL.<br></a>SSLContext</p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049953"></a>This class holds all of the state information shared across all sockets created under that context.</p> </td> 
      </tr> 
      <tr> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049955"></a><a href="../javadocs/index.html">weblogic.security.SSL.<br>SSLSocketFactory</a></p> </td> 
       <td align="left" valign="top" scope="row"> <p class="table"><a name="1049957"></a>This class delegates requests to create SSL sockets to the <code style="font-family: courier">SSLSocketFactory</code>.</p> </td> 
      </tr> 
     </tbody>
    </table> 
   </div> 
   <p></p> 
   <br>&nbsp; 
   <h2 class="head2"><a name="1050013"></a>SSL Client Application Components</h2> 
   <p><a name="1050014"></a>At a minimum, an SSL client application comprises the following components:</p> 
   <ul type="square">
    <li type="square"><a name="1050015"></a>Java client</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1050016"></a>Typically, a Java client performs these functions:</p> 
     </dt>
    </dl>
    <ul type="disc">
     <li type="disc"><a name="1055491"></a>Initializes an <code style="font-family: courier">SSLContext</code> with client identity, a <code style="font-family: courier">HostnameVerifierJSSE</code>, a <code style="font-family: courier">TrustManagerJSSE</code>, and a <code style="font-family: courier">HandshakeCompletedListener</code>.</li> 
     <li type="disc"><a name="1055492"></a>Creates a keystore and retrieves the private key and certificate chain</li> 
     <li type="disc"><a name="1055493"></a>Uses an SSLSocketFactory</li> 
     <li type="disc"><a name="1055494"></a>Uses HTTPS to connect to a JSP served by an instance of WebLogic Server </li> 
    </ul>
    <li type="square"><a name="1050023"></a>HostnameVerifier</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1051033"></a>The HostnameVerifier implements the <code style="font-family: courier">weblogic.security.SSL.HostnameVerifierJSSE interface</code>. It provides a callback mechanism so that implementers of this interface can supply a policy for handling the case where the host that is being connected to and the server name from the certificate Subject Distinguished Name (SubjectDN) must match.</p> 
     </dt>
    </dl>
    <li type="square"><a name="1050168"></a>HandshakeCompletedListener</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1050568"></a>The HandshakeCompletedListener implements the <code style="font-family: courier">javax.net.ssl.HandshakeCompletedListener</code> interface. It defines how the SSL client receives notifications about the completion of an SSL handshake on a given SSL connection. It also defines the number of times an SSL handshake takes place on a given SSL connection.</p> 
     </dt>
    </dl>
    <li type="square"><a name="1050470"></a>TrustManager</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1050471"></a>The TrustManager implements the <code style="font-family: courier">weblogic.security.SSL.TrustManagerJSSE</code> interface. It builds a certificate path to a trusted root and returns true if it can be validated and is trusted for client SSL authentication.</p> 
     </dt>
    </dl>
    <li type="square"><a name="1050175"></a><code style="font-family: courier">ant</code> build script (<code style="font-family: courier">build.xml</code>)</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1050176"></a>This script compiles all the files required for the application and deploys them to the WebLogic Server applications directories.</p> 
     </dt>
    </dl>
   </ul> 
   <p><a name="1050177"></a>For a complete working SSL authentication client that implements the components described here, see the SSLClient sample application in the <em>SAMPLES_HOME</em><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory provided with WebLogic Server.</p> 
   <p><a name="1052879"></a>For more information on JSSE authentication, see Sun's <em>Java Secure Socket Extension (JSSE) 1.0.3 API User's Guide</em> available at <a href="http://java.sun.com/products/jsse/doc/guide/API_users_guide.html">http://java.sun.com/products/jsse/doc/guide/API_users_guide.html</a>.</p> 
   <p>&nbsp;</p> 
   <hr noshade> 
   <h1 class="head1"><a name="1029580"></a>Writing Applications that Use SSL</h1> 
   <p><a name="1029581"></a>This section covers the following topics:</p> 
   <ul type="square">
    <li type="square"><a name="1029588"></a><a href="SSL_client.html#1033777">Communicating Securely From WebLogic Server to Other WebLogic Servers</a></li> 
    <li type="square"><a name="1033826"></a><a href="SSL_client.html#1029618"></a><a href="SSL_client.html#1029618">Writing SSL Clients</a></li> 
    <li type="square"><a name="1029595"></a><a href="SSL_client.html#1029618"></a><a href="SSL_client.html#1029705">Using Two-Way SSL Authentication</a></li> 
    <li type="square"><a name="1039141"></a><a href="SSL_client.html#1033891">Two-Way SSL Authentication with JNDI</a></li> 
    <li type="square"><a name="1029599"></a><a href="SSL_client.html#1029783">Using a Custom Host Name Verifier</a></li> 
    <li type="square"><a name="1029603"></a><a href="SSL_client.html#1029824">Using a Trust Manager</a></li> 
    <li type="square"><a name="1029607"></a><a href="SSL_client.html#1046261">Using an SSLContext</a></li> 
    <li type="square"><a name="1029611"></a><a href="SSL_client.html#1029877">Using an SSL Server Socket Factory</a></li> 
    <li type="square"><a name="1029615"></a><a href="SSL_client.html#1029889">Using URLs to Make Outbound SSL Connections</a></li> 
   </ul>
   <h2 class="head2"><a name="1033777"></a><a name="fat_client_0601"></a>Communicating Securely From WebLogic Server to Other WebLogic Servers</h2> 
   <p><a name="1033778"></a>You can use a URL object to make an outbound SSL connection from a WebLogic Server instance acting as a client to another WebLogic Server instance. The <code style="font-family: courier">weblogic.net.http.HttpsURLConnection</code> class provides a way to specify the security context information for a client, including the digital certificate and private key of the client.</p> 
   <p><a name="1033779"></a>The <code style="font-family: courier">weblogic.net.http.HttpsURLConnection</code> class provides methods for determining the negotiated cipher suite, getting/setting a host name verifier, getting the server's certificate chain, and getting/setting an <code style="font-family: courier">SSLSocketFactory</code> in order to create new SSL sockets.</p> 
   <p><a name="1033780"></a>The SSLClient code example uses the <code style="font-family: courier">weblogic.net.http.HttpsURLConnection</code> class to make an outbound SSL connection. The SSLClient code example is available in the <code style="font-family: courier">examples.security.sslclient </code>package in the <em>SAMPLES_HOME</em><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory. </p> 
   <h2 class="head2"><a name="1029618"></a><a name="fat_client_0602"></a>Writing SSL Clients</h2> 
   <p><a name="1029619"></a>This section describes, by way of example, how to write various types of SSL clients. Examples of the following types of SSL clients are provided:</p> 
   <ul type="square">
    <li type="square"><a name="1029623"></a><a href="SSL_client.html#1041146">SSLClient Sample</a></li> 
    <li type="square"><a name="1029627"></a><a href="SSL_client.html#1029656">SSLSocketClient Sample</a></li> 
    <li type="square"><a name="1029631"></a><a href="SSL_client.html#1029685">SSLClientServlet Sample</a></li> 
   </ul> 
   <p><a name="1043056"></a><em>SSL Client License Requirement:</em> Any stand-alone Java client that uses WebLogic SSL classes (<a href="../javadocs/index.html">weblogic.security.SSL</a>) to invoke an Enterprise JavaBean (EJB) must use the BEA license file. When you run your client application, set the following system properties on the command line:</p> 
   <ul type="square">
    <li type="square"><a name="1043057"></a><code style="font-family: courier; font-style: italic">bea.home</code><code style="font-family: courier">=</code><code style="font-family: courier; font-style: italic">license_file_directory</code></li> 
    <li type="square"><a name="1043058"></a><code style="font-family: courier">java.protocol.handler.pkgs=com.certicom.net.ssl </code></li> 
   </ul> 
   <p><a name="1043059"></a>Where <code style="font-family: courier; font-style: italic">license_file_directory</code> refers to the directory that contains the BEA license file (<code style="font-family: courier">license.bea</code>). Here is an example of a run command that uses the default location of the license file (<code style="font-family: courier">c:\bea</code>):</p> 
   <p><a name="1043060"></a><code style="font-family: courier">java -Dbea.home=c:\bea \<br> -Djava.protocol.handler.pkgs=com.certicom.net.ssl my_app</code></p> 
   <h3 class="head3"><a name="1041146"></a><a name="fat_client_0603"></a>SSLClient Sample</h3> 
   <p><a name="1043165"></a>The SSLClient sample demonstrates how to use the WebLogic SSL library to make outgoing SSL connections using <code style="font-family: courier">URL</code> and <code style="font-family: courier">URLConnection</code> objects. It shows both how to do this from a stand-alone application as well as from a servlet in WebLogic Server.</p> 
   <p><strong><a name="1029640"></a>Note: </strong> When making an outgoing SSL connection, a WebLogic Server instance uses the server's certificate. When communicating to either the same or another WebLogic Server instance with two-way SSL, the originating server's certificate will be verified against the client root CA list in the receiving WebLogic Server instance.</p> 
   <p><a name="1029644"></a><a href="SSL_client.html#1043515">Listing&nbsp;4-2</a> shows a sample SSLClient. This code is taken from the <code style="font-family: courier">SSLClient.java</code> file located at <em>SAMPLES_HOME</em><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code>.</p> 
   <p class="codetitle"><a name="1043515"></a>Listing 4-2 SSL Client Sample Code</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1043832"></a>package examples.security.sslclient;<br><br>import java.io.File;<br>import java.net.URL;<br>import java.io.IOException;<br>import java.io.InputStream;<br>import java.io.FileInputStream;<br>import java.io.OutputStream;<br>import java.io.PrintStream;<br>import java.util.Hashtable;<br>import java.security.Provider;<br>import javax.naming.NamingException;<br>import javax.naming.Context;<br>import javax.naming.InitialContext;<br>import javax.servlet.ServletOutputStream;<br>import weblogic.net.http.*;<br>import weblogic.jndi.Environment;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1043852"></a>/** SSLClient is a short example of how to use the SSL library of <br> * WebLogic to make outgoing SSL connections. It shows both how to<br> * do this from a stand-alone application as well as from within <br> * WebLogic (in a Servlet).<br> *<br> *    Be careful to notice that the WebLogic Server, when making an<br> *    outgoing SSL connection, will use that instance of the server's<br> *    certificate. When communicating to either the same or another<br> *    WebLogic Server with two-way SSL, the originating server's<br> *    certificate will be verified against the client root CA list in<br> *    the receiving WebLogic Server.<br> *<br> * @author Copyright (c) 1999-2002 by BEA Systems, Inc. All Rights Reserved.<br> */</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1043866"></a>public class SSLClient {<br>  public void SSLClient() {}<br>  public static void main (String [] argv)<br>    throws IOException {<br>    if ((!((argv.length == 4) || (argv.length == 5))) ||<br>        (!(argv[0].equals("wls")))<br>        ) {<br>      System.out.println("example: java SSLClient wls<br>                  server2.weblogic.com 80 443 /examplesWebApp/SnoopServlet.jsp");<br>      System.exit(-1);<br>    }</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1043879"></a>    try {<br>      System.out.println("----");<br>      if (argv.length == 5) {<br>        if (argv[0].equals("wls"))<br>          wlsURLConnect(argv[1], argv[2], argv[3], argv[4], System.out);<br>      } else {  // for null query, default page returned...<br>        if (argv[0].equals("wls"))<br>          wlsURLConnect(argv[1], argv[2], argv[3], null, System.out);<br>      }<br>      System.out.println("----");<br>    } catch (Exception e) {<br>      e.printStackTrace();<br>      printSecurityProviders(System.out);<br>      System.out.println("----");<br>    }<br>  }<br>  private static void printOut(String outstr, OutputStream stream) {<br>    if (stream instanceof PrintStream) {<br>      ((PrintStream)stream).print(outstr);<br>      return;<br>    } else if (stream instanceof ServletOutputStream) {<br>      try {<br>        ((ServletOutputStream)stream).print(outstr);<br>        return;<br>      } catch (IOException ioe) {<br>        System.out.println(" IOException: "+ioe.getMessage());<br>      }<br>    }<br>    System.out.print(outstr);<br>  }<br>  private static void printSecurityProviders(OutputStream stream) {<br>    StringBuffer outstr = new StringBuffer();<br>    outstr.append(" JDK Protocol Handlers and Security Providers:\n");<br>    outstr.append("   java.protocol.handler.pkgs - ");<br>    outstr.append(System.getProperties().getProperty(<br>                                        "java.protocol.handler.pkgs"));<br>    outstr.append("\n");<br>    Provider[] provs = java.security.Security.getProviders();<br>    for (int i=0; i&lt;provs.length; i++)<br>        outstr.append("   provider[" + i + "] - " + provs[i].getName() +<br>                      " - " + provs[i].getInfo() + "\n");<br>    outstr.append("\n");<br>    printOut(outstr.toString(), stream);<br>  }<br>  private static void tryConnection(java.net.HttpURLConnection connection,<br>                                    OutputStream stream)<br>    throws IOException {<br>      connection.connect();<br>      String responseStr = "\t\t" +<br>                           connection.getResponseCode() + " -- " +<br>                           connection.getResponseMessage() + "\n\t\t" +<br>                           connection.getContent().getClass().getName() + "\n";<br>      connection.disconnect();<br>      printOut(responseStr, stream);<br>  }<br>  /*<br>   * This method contains an example of how to use the URL and<br>   *  URLConnection objects to create a new SSL connection, using<br>   *  WebLogic SSL client classes.<br>   */<br>  public static void wlsURLConnect(String host, String port,<br>                                   String sport, String query,<br>                                   OutputStream out) {<br>    try {<br>      if (query == null)<br>        query = "/examplesWebApp/index.jsp";<br>      // The following protocol registration is taken care of in the<br>      //  normal startup sequence of WebLogic. It can be turned off<br>      //  using the console SSL panel.<br>      //<br>      // We duplicate it here as a proof of concept in a stand alone<br>      //  java application. Using the URL object for a new connection<br>      //  inside of WebLogic would work as expected.<br>      java.util.Properties p = System.getProperties();<br>      String s = p.getProperty("java.protocol.handler.pkgs");<br>      if (s == null) {<br>        s = "weblogic.net";<br>      } else if (s.indexOf("weblogic.net") == -1) {<br>        s += "|weblogic.net";<br>      }<br>      p.put("java.protocol.handler.pkgs", s);<br>      System.setProperties(p);<br>      printSecurityProviders(out);<br>      // end of protocol registration<br>      printOut(" Trying a new HTTP connection using WLS client classes -<br>                \n\thttp://" + host + ":" + port + query + "\n", out);<br>      URL wlsUrl = null;<br>      try {<br>        wlsUrl = new URL("http", host, Integer.valueOf(port).intValue(), query);<br>        weblogic.net.http.HttpURLConnection connection =<br>          new weblogic.net.http.HttpURLConnection(wlsUrl);<br>        tryConnection(connection, out);<br>      } catch (Exception e) {<br>        printOut(e.getMessage(), out);<br>        e.printStackTrace();<br>        printSecurityProviders(System.out);<br>        System.out.println("----");<br>      }<br>      printOut(" Trying a new HTTPS connection using WLS client classes -<br>                 \n\thttps://" + host + ":" + sport + query + "\n", out);<br>      wlsUrl = new URL("https", host, Integer.valueOf(sport).intValue(), query);<br>      weblogic.net.http.HttpsURLConnection sconnection =<br>        new weblogic.net.http.HttpsURLConnection(wlsUrl);</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1044003"></a>     // Only when you have configured a two-way SSL connection, i.e.<br>     // Client Certs Requested and Enforced is selected in Two Way Client Cert<br>     // Behavior field in the Server Attributes<br>     // that are located on the Advanced Options pane under Keystore &amp; SSL<br>     // tab on the server, the following private key and the client cert chain<br>     // is used.</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1044007"></a>      File ClientKeyFile  = new File ("clientkey.pem");<br>      File ClientCertsFile  = new File ("client2certs.pem");<br>      if (!ClientKeyFile.exists() || !ClientCertsFile.exists())<br>{<br>   System.out.println("Error : clientkey.pem/client2certs.pem <br>                          is not present in this directory.");<br>   System.out.println("To create it run - ant createmycerts.");<br>   System.exit(0);<br>}<br>      InputStream [] ins = new InputStream[2];<br>      ins[0] = new FileInputStream("client2certs.pem");<br>      ins[1] = new FileInputStream("clientkey.pem");<br>      String pwd = "clientkey";<br>      sconnection.loadLocalIdentity(ins[0], ins[1], pwd.toCharArray());<br>      tryConnection(sconnection, out);<br>    } catch (Exception ioe) {<br>      printOut(ioe.getMessage(), out);<br>      ioe.printStackTrace();<br>    }<br>  }<br>}</code></pre>
   </blockquote> 
   <h3 class="head3"><a name="1029656"></a><a name="fat_client_0604"></a>SSLSocketClient Sample</h3> 
   <p><a name="1029658"></a>The SSLSocketClient sample demonstrates how to use SSL sockets to go directly to the secure port to connect to a JSP served by an instance of WebLogic Server and display the results of that connection. It shows how to implement the following functions:</p> 
   <ul type="square">
    <li type="square"><a name="1029659"></a>Initializing an <code style="font-family: courier">SSLContext</code> with client identity, a <code style="font-family: courier">HostnameVerifierJSSE</code>, and a <code style="font-family: courier">TrustManagerJSSE</code> </li> 
    <li type="square"><a name="1029660"></a>Creating a keystore and retrieving the private key and certificate chain</li> 
    <li type="square"><a name="1029661"></a>Using an <code style="font-family: courier">SSLSocketFactory</code></li> 
    <li type="square"><a name="1029662"></a>Using HTTPS to connect to a JSP served by WebLogic Server </li> 
    <li type="square"><a name="1029663"></a>Implementing the <code style="font-family: courier">javax.net.ssl.HandshakeCompletedListener</code> interface</li> 
    <li type="square"><a name="1029664"></a>Creating a dummy implementation of the <code style="font-family: courier">weblogic.security.SSL.HostnameVerifierJSSE</code> class to verify that the server the example connects to is running on the desired host </li> 
   </ul> 
   <p><a name="1029668"></a><a href="SSL_client.html#1029670">Listing&nbsp;4-3</a> shows a sample SSLSocketClient. This code taken from the <code style="font-family: courier">SSLSocketClient.java</code> file located at <code style="font-family: courier">SAMPLES_HOME\server\examples\src\examples\security\sslclient</code>.</p> 
   <p class="codetitle"><a name="1029670"></a>Listing 4-3 SSLSocketClient Sample Code</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029671"></a>package examples.security.sslclient;<br><br>import java.io.File;<br>import java.io.IOException;<br>import java.io.InputStream;<br>import java.io.OutputStream;<br>import java.io.FileInputStream;<br>import java.util.Hashtable;<br>import java.security.KeyStore;<br>import java.security.PrivateKey;<br>import java.security.cert.Certificate;<br>import weblogic.security.SSL.HostnameVerifierJSSE;<br>import weblogic.security.SSL.SSLContext;<br>import javax.net.ssl.SSLSocket;<br>import javax.net.ssl.SSLSession;<br>import weblogic.security.SSL.SSLSocketFactory;<br>import weblogic.security.SSL.TrustManagerJSSE;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029673"></a>  /**<br>  * A Java client demonstrates connecting to a JSP served by WebLogic Server<br>  * using the secure port and displays the results of the connection.<br>  *<br>  * @author Copyright (c) 1999-2002 by BEA Systems, Inc. All Rights Reserved.<br>  */</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029674"></a>public class SSLSocketClient {<br>  public void SSLSocketClient() {}<br>  public static void main (String [] argv)<br>    throws IOException {<br>    if ((argv.length &lt; 2) || (argv.length &gt; 3)) {<br>      System.out.println("usage:   java SSLSocketClient host sslport<br>                                     &lt;HostnameVerifierJSSE&gt;");<br>      System.out.println("example: java SSLSocketClient server2.weblogic.com 443<br>                                     MyHVClassName");<br>      System.exit(-1);<br>    }<br>    try {<br>      System.out.println("\nhttps://" + argv[0] + ":" + argv[1]);<br>      System.out.println(" Creating the SSLContext");<br>      SSLContext sslCtx = SSLContext.getInstance("https");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029676"></a>      File KeyStoreFile  = new File ("mykeystore");<br>      if (!KeyStoreFile.exists())<br>{<br>   System.out.println("Keystore Error : mykeystore is not present in this<br>                          directory.");<br>   System.out.println("To create it run - ant createmykeystore.");<br>   System.exit(0);<br>}</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029677"></a>      System.out.println(" Initializing the SSLContext with client\n" +<br>                         "  identity (certificates and private key),\n" +<br>                         "  HostnameVerifierJSSE, AND NulledTrustManager");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029678"></a>     // Open the keystore, retrieve the private key, and certificate chain<br>      KeyStore ks = KeyStore.getInstance("jks");<br>      ks.load(new FileInputStream("mykeystore"), null);<br>      PrivateKey key = (PrivateKey)ks.getKey("mykey", "testkey".toCharArray());<br>      Certificate [] certChain = ks.getCertificateChain("mykey");<br>      sslCtx.loadLocalIdentity(certChain, key);</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029679"></a>      HostnameVerifierJSSE hVerifier = null;<br>      if (argv.length &lt; 3)<br>        hVerifier = new NulledHostnameVerifier();<br>      else<br>        hVerifier = (HostnameVerifierJSSE) Class.forName(argv[2]).newInstance();<br>      sslCtx.setHostnameVerifierJSSE(hVerifier);<br>      TrustManagerJSSE tManager = new NulledTrustManager();<br>      sslCtx.setTrustManagerJSSE(tManager);<br>      System.out.println(" Creating new SSLSocketFactory with SSLContext");<br>      SSLSocketFactory sslSF = (SSLSocketFactory) sslCtx.getSocketFactoryJSSE();<br>      System.out.println(" Creating and opening new SSLSocket with<br>                              SSLSocketFactory");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029680"></a>      // using createSocket(String hostname, int port)<br>      SSLSocket sslSock = (SSLSocket) sslSF.createSocket(argv[0],<br>                                                         new Integer(argv[1]).intValue());<br>      System.out.println(" SSLSocket created");<br>      sslSock.addHandshakeCompletedListener(new MyListener());<br>      OutputStream out = sslSock.getOutputStream();</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029681"></a>      // Send a simple HTTP request<br>      String req = "GET /examplesWebApp/ShowDate.jsp HTTP/1.0\r\n\r\n";<br>      out.write(req.getBytes());</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029682"></a>      // Retrieve the InputStream and read the HTTP result, displaying<br>      // it on the console<br>      InputStream    in = sslSock.getInputStream();<br>      byte buf[] = new byte[1024];<br>      try<br>      {<br>        while (true)<br>        {<br>          int amt = in.read(buf);<br>          if (amt == -1) break;<br>          System.out.write(buf, 0, amt);<br>        }<br>      }<br>      catch (IOException e)<br>      {<br>        return;<br>      }<br>      sslSock.close();<br>      System.out.println(" SSLSocket closed");<br>    } catch (Exception e) {<br>      e.printStackTrace();<br>    }<br>  }<br>}</code></pre>
   </blockquote> 
   <h3 class="head3"><a name="1029685"></a><a name="fat_client_0605"></a>SSLClientServlet Sample</h3> 
   <p><a name="1029687"></a>The SSLClientServlet sample is a simple servlet wrapper of the SSLClient sample.</p> 
   <p><a name="1029691"></a><a href="SSL_client.html#1029693">Listing&nbsp;4-4</a> shows a sample SSLClientServlet. This code taken from the <code style="font-family: courier">SSLSClientServlet.java</code> file located at <code style="font-family: courier">SAMPLES_HOME\server\examples\src\examples\security\sslclient</code>.</p> 
   <p class="codetitle"><a name="1029693"></a>Listing 4-4 SSLClientServlet Sample Code</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029694"></a>package examples.security.sslclient;<br><br>import java.io.IOException;<br>import java.io.InputStream;<br>import java.io.OutputStream;<br>import java.util.Enumeration;<br>import javax.servlet.*;<br>import javax.servlet.http.*;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029696"></a>/**<br> * SSLClientServlet is a simple servlet wrapper of<br> * examples.security.sslclient.SSLClient.<br> * <br> * @see SSLClient<br> * @author Copyright (c) 1999-2002 by BEA Systems, Inc. All Rights Reserved.<br> */</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029697"></a>public class SSLClientServlet extends HttpServlet {<br>  public void service(HttpServletRequest request, HttpServletResponse response) <br>    throws ServletException, IOException {<br>    response.setContentType("text/html");<br>    response.setHeader("Pragma", "no-cache"); // HTTP 1.0<br>    response.setHeader("Cache-Control", "no-cache"); // HTTP 1.1<br>    ServletOutputStream out = response.getOutputStream();</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029698"></a>    out.println("&lt;br&gt;&lt;h2&gt;ssl client test&lt;/h2&gt;&lt;br&gt;&lt;hr&gt;");<br>    String[] target = request.getParameterValues("url");<br>    try {</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029699"></a>      out.println("&lt;h3&gt;wls ssl client classes&lt;/h3&gt;&lt;br&gt;");<br>      out.println("java SSLClient wls localhost 7001 7002<br>                       /examplesWebApp/SnoopServlet.jsp&lt;br&gt;");<br>      out.println("&lt;pre&gt;");<br>      SSLClient.wlsURLConnect("localhost", "7001", "7002",<br>                                  "/examplesWebApp/SnoopServlet.jsp", out);<br>      out.println("&lt;/pre&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029700"></a>    } catch (IOException ioe) {<br>      out.println("&lt;br&gt;&lt;pre&gt; "+ioe.getMessage()+"&lt;/pre&gt;");<br>      ioe.printStackTrace();<br>    }<br>  }<br>}</code></pre>
   </blockquote> 
   <h2 class="head2"><a name="1029705"></a><a name="fat_client_0606"></a>Using Two-Way SSL Authentication</h2> 
   <p><a name="1029709"></a>When using certificate authentication, WebLogic Server sends a digital certificate to the requesting client. The client examines the digital certificate to ensure that it is authentic, has not expired, and matches the WebLogic Server instance that presented it.</p> 
   <p><a name="1029714"></a>With two-way SSL authentication (a form of mutual authentication), the requesting client also presents a digital certificate to WebLogic Server. When the instance of WebLogic Server is configured for two-way SSL authentication, requesting clients are required to present digital certificates from a specified set of certificate authorities. WebLogic Server accepts only digital certificates that are signed by root certificates from the specified trusted certificate authorities.</p> 
   <p><a name="1039162"></a>For information on how to configure WebLogic Server for two-way SSL authentication, see the <a href="../secmanage/ssl.html#configureSSL">Configuring SSL</a> in <em><a href="../secmanage/index.html">Managing WebLogic Security</a></em>.</p> 
   <p><a name="1039165"></a>The following sections describe the different ways two-way SSL authentication can be implemented in WebLogic Server.</p> 
   <ul type="square">
    <li type="square"><a name="1052677"></a><a href="SSL_client.html#1033891">Two-Way SSL Authentication with JNDI</a></li> 
    <li type="square"><a name="1052684"></a><a href="SSL_client.html#1029726">Using Two-Way SSL Authentication Between WebLogic Server Instances</a></li> 
    <li type="square"><a name="1052693"></a><a href="SSL_client.html#1064202">Using Two-Way SSL Authentication with Servlets</a></li> 
   </ul>
   <h3 class="head3"><a name="1033891"></a><a name="fat_client_0607"></a>Two-Way SSL Authentication with JNDI</h3> 
   <p><a name="1033892"></a>When using JNDI for two-way SSL authentication in a Java client, use the <code style="font-family: courier">setSSLClientCertificate()</code> method of the WebLogic JNDI <code style="font-family: courier">Environment</code> class. This method sets a private key and chain of X.509 digital certificates for client authentication. </p> 
   <p><a name="1063635"></a>To pass digital certificates to JNDI, create an array of <code style="font-family: courier">InputStreams</code> opened on files containing DER-encoded digital certificates and set the array in the JNDI hash table. The first element in the array must contain an <code style="font-family: courier">InputStream</code> opened on the Java client's private key file. The second element must contain an <code style="font-family: courier">InputStream</code> opened on the Java client's digital certificate file. (This file contains the public key for the Java client.) Additional elements may contain the digital certificates of the root certificate authority and the signer of any digital certificates in a certificate chain. A certificate chain allows WebLogic Server to authenticate the digital certificate of the Java client if that digital certificate was not directly issued by a certificate authority registered for the Java client in the WebLogic Server keystore file. </p> 
   <p><a name="1033898"></a>You can use the <a href="../javadocs/weblogic/security/PEMInputStream.html">weblogic.security.PEMInputStream</a> class to read digital certificates stored in Privacy Enhanced Mail (PEM) files. This class provides a filter that decodes the base 64-encoded DER certificate into a PEM file.</p> 
   <p><a name="1033902"></a><a href="SSL_client.html#1033907">Listing&nbsp;4-5</a> demonstrates how to use two-way SSL authentication in a Java client.</p> 
   <p class="codetitle"><a name="1033907"></a>Listing 4-5 Example of a Two-Way SSL Authentication Client That Uses JNDI</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061585"></a>import javax.naming.Context;<br>import javax.naming.InitialContext;<br>import javax.naming.NamingException;<br>import weblogic.jndi.Environment;<br>import weblogic.security.PEMInputStream;<br>import java.io.InputStream;<br>import java.io.FileInputStream;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061586"></a>public class SSLJNDIClient <br>{ <br>  public static void main(String[] args) throws Exception<br>  {<br>    Context context = null;<br>    try {<br>      Environment env = new Environment();</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061588"></a>      // set connection parameters<br>      env.setProviderUrl("t3s://localhost:7002");      <br>      // The next two set methodes are optional if you are using<br>      // a UserNameMapper interface.<br>      env.setSecurityPrincipal("system");<br>      env.setSecurityCredentials("weblogic");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061600"></a>      InputStream key = new FileInputStream("certs/demokey.pem");<br>      InputStream cert = new FileInputStream("certs/democert.pem");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061601"></a>      // wrap input streams if key/cert are in pem files<br>      key = new PEMInputStream(key);<br>      cert = new PEMInputStream(cert);</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061602"></a>      env.setSSLClientCertificate(new InputStream[] { key, cert});</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061973"></a>      env.setInitialContextFactory(Environment.<br>                  DEFAULT_INITIAL_CONTEXT_FACTORY); <br>      context = env.getInitialContext();</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1061990"></a><code style="font-family: courier"> Object myEJB = (Object) context.lookup("myEJB");<br></code>    }<br>    finally {<br>      if (context != null) context.close();<br>    }<br>  }<br>}</code></pre>
   </blockquote> 
   <p><a name="1033911"></a>When the JNDI <code style="font-family: courier">getInitialContext()</code> method is called, the Java client and WebLogic Server execute mutual authentication in the same way that a Web browser performs mutual authentication to get a secure Web server connection. An exception is thrown if the digital certificates cannot be validated or if the Java client's digital certificate cannot be authenticated in the default (active) security realm. The authenticated user object is stored on the Java client's server thread and is used for checking the permissions governing the Java client's access to any protected WebLogic resources.</p> 
   <p><a name="1033918"></a>When you use<strong> </strong>the WebLogic JNDI <code style="font-family: courier">Environment</code> class, you must create a new <code style="font-family: courier">Environment</code> object for each call to the <code style="font-family: courier">getInitialContext()</code> method. Once you specify a <code style="font-family: courier">User</code> object and security credentials, both the user and their associated credentials remain set in the <code style="font-family: courier">Environment</code> object. If you try to reset them and then call the JNDI <code style="font-family: courier">getInitialContext()</code> method, the original user and credentials are used. </p> 
   <p><a name="1033922"></a>When you use two-way SSL authentication from a Java client, WebLogic Server gets a unique Java Virtual Machine (JVM) ID for each client JVM so that the connection between the Java client and WebLogic Server is constant. Unless the connection times out from lack of activity, it persists as long as the JVM for the Java client continues to execute. The only way a Java client can negotiate a new SSL connection reliably is by stopping its JVM and running another instance of the JVM.</p> 
   <p><a name="1061498"></a>The code in <a href="SSL_client.html#1033907">Listing&nbsp;4-5</a> generates a call to the WebLogic Identity Assertion provider that implements the <code style="font-family: courier">weblogic.security.providers.authentication.UserNameMapper</code> interface. The class that implements the <code style="font-family: courier">UserNameMapper</code> interface returns a user object if the digital certificate is valid. WebLogic Server stores this authenticated user object on the Java client's thread in WebLogic Server and uses it for subsequent authorization requests when the thread attempts to use WebLogic resources protected by the default (active) security realm.</p> 
   <p><strong><a name="1061505"></a>Note: </strong> The implementation of the <code style="font-family: courier">weblogic.security.providers.authentication.UserNameMapper</code> interface must be specified in your <code style="font-family: courier">CLASSPATH</code>.<a name="fat_client_06"></a></p> 
   <p><a name="1039901"></a>If you have not configured an Identity Assertion provider that performs certificate-based authentication, a Java client running in a JVM with an SSL connection can change the WebLogic Server user identity by creating a new JNDI <code style="font-family: courier">InitialContext</code> and supplying a new user name and password in the JNDI <code style="font-family: courier">SECURITY_PRINCIPAL</code> and <code style="font-family: courier">SECURITY_CREDENTIALS</code> properties. Any digital certificates passed by the Java client after the SSL connection is made are not used. The new WebLogic Server user continues to use the SSL connection negotiated with the initial user's digital certificate. </p> 
   <p><a name="1064590"></a>If you have configured an Identity Assertion provider that performs certificate-based authentication, WebLogic Server passes the digital certificate from the Java client to the class that implements the <code style="font-family: courier">UserNameMapper</code> interface and the <code style="font-family: courier">UserNameMapper</code> class maps the digital certificate to a WebLogic Server user name. Therefore, if you want to set a new user identity when you use the certificate-based identity assertion, you cannot change the identity. This is because the digital certificate is processed only at the time of the first connection request from the JVM for each <code style="font-family: courier">Environment</code>.</p> 
   <p><strong><a name="1064597"></a>Caution: </strong> Restriction: Multiple, concurrent, user logins to WebLogic Server from a single client JVM when using two-way SSL and JNDI is not supported. If multiple logins are executed on different threads, the results are undeterminable and might result in one user's requests being executed on another user's login, thereby allowing one user to access another user's data. WebLogic Server does not support multiple, concurrent, certificate-based logins from a single client JVM. For information on JNDI contexts and threads and how to avoid potential JNDI context problems, see <a href="../jndi/jndi.html#jndicontext">JNDI Contexts and Threads</a> and <a href="../jndi/jndi.html#contextproblems">How to Avoid JNDI Context Problems</a> in <em>Programming WebLogic JNDI</em>. </p> 
   <h3 class="head3"><a name="1062188"></a>Writin<a name="user_name_mapper"></a>g a User Name Mapper</h3> 
   <p><a name="1062189"></a>When using 2-way SSL, WebLogic Server verifies the digital certificate of the Web browser or Java client when establishing an SSL connection. However, the digital certificate does not identify the Web browser or Java client as a user in the WebLogic Server security realm. If the Web browser or Java client requests a WebLogic Server resource protected by a security policy, WebLogic Server requires the Web browser or Java client to have an identity. To handle this requirement, the WebLogic Identity Assertion provider allows you to enable a user name mapper that maps the digital certificate of a Web browser or Java client to a user in a WebLogic Server security realm. The user name mapper must be an implementation the <code style="font-family: courier">weblogic.security.providers.authentication.UserNameMapper</code> interface.</p> 
   <p><a name="1062260"></a>In this release of WebLogic Server, you have the option of the using the default implementation of the <code style="font-family: courier">weblogic.security.providers.authentication.UserNameMapper</code> interface, <code style="font-family: courier">DefaultUserNameMapperImpl</code>, or developing your own implementation.</p> 
   <p><a name="1062191"></a>The WebLogic Identity Assertion provider can call the implementation of the <code style="font-family: courier">UserNameMapper</code> interface for the following types of identity assertion token types:</p> 
   <ul type="square">
    <li type="square"><a name="1062192"></a>X.509 digital certificates passed via the SSL handshake</li> 
    <li type="square"><a name="1062193"></a>X.509 digital certificates passed via CSIv2</li> 
    <li type="square"><a name="1062194"></a>X.501 distinguished names passed via CSIv2</li> 
   </ul> 
   <p><a name="1063527"></a>If you need to map different types of certificates, you need write your own implementation of the <code style="font-family: courier">UserNameMapper</code> interface.</p> 
   <p><a name="1063528"></a>To implement a <code style="font-family: courier">UserNameMapper</code> interface that maps a digital certificate to a user name, write a <code style="font-family: courier">UserNameMapper</code> class that performs the following operations:</p> 
   <ol> 
    <div class="lists"> 
     <li value="1"><a name="1063353"></a>Instantiates the <code style="font-family: courier">UserNameMapper</code> implementation class. </li> 
    </div>
    <div class="lists"> 
     <li value="2"><a name="1063369"></a>Creates the <code style="font-family: courier">UserNameMapper</code> interface implementation.</li> 
    </div>
    <div class="lists"> 
     <li value="3"><a name="1063511"></a>Uses the <code style="font-family: courier">mapCertificateToUserName()</code> method to map a certificate to a user name based on a certificate chain presented by the client.</li> 
    </div>
    <div class="lists"> 
     <li value="4"><a name="1063546"></a>Maps a string attribute type to the corresponding <code style="font-family: courier">Attribute Value Assertion</code> field type.</li> 
    </div>
   </ol> 
   <h3 class="head3"><a name="1029726"></a><a name="fat_client_0608"></a>Using Two-Way SSL Authentication Between WebLogic Server Instances</h3> 
   <p><a name="1029727"></a>You can use two-way SSL authentication in server-to-server communication in which one WebLogic Server instance is acting as the client of another WebLogic Server instance. Using two-way SSL authentication in server-to-server communication enables you to have dependable, highly-secure connections, even without the more common client/server environment.</p> 
   <p><a name="1029731"></a><a href="SSL_client.html#1029733">Listing&nbsp;4-6</a> shows an example of how to establish a secure connection from a servlet running in one instance of WebLogic Server to a second WebLogic Server instance called <code style="font-family: courier">server2.weblogic.com</code>.</p> 
   <p class="codetitle"><a name="1029733"></a>Listing 4-6 Establishing a Secure Connection to Another WebLogic Server Instance</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029734"></a>FileInputStream [] f = new FileInputStream[3]; <br>   f[0]= new FileInputStream("demokey.pem");<br>   f[1]= new FileInputStream("democert.pem");<br>   f[2]= new FileInputStream("ca.pem");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029735"></a>Environment e = new Environment ();<br>e.setProviderURL("t3s://server2.weblogic.com:443");<br>e.setSSLClientCertificate(f);<br>e.setSSLServerName("server2.weblogic.com");<br>e.setSSLRootCAFingerprints("ac45e2d1ce492252acc27ee5c345ef26");</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029736"></a><br>e.setInitialContextFactory<br>	("weblogic.jndi.WLInitialContextFactory");<br>Context ctx = new InitialContext(e.getProperties())</code></pre>
   </blockquote> 
   <p><a name="1029742"></a>In <a href="SSL_client.html#1029733">Listing&nbsp;4-6</a>, the WebLogic JNDI <code style="font-family: courier">Environment</code> class creates a hash table to store the following parameters:</p> 
   <ul type="square">
    <li type="square"><a name="1029747"></a><code style="font-family: courier">setProviderURL</code>specifies the URL of the WebLogic Server instance acting as the SSL server. The WebLogic Server instance acting as SSL client calls this method. The URL specifies the t3s protocol which is a WebLogic Server proprietary protocol built on the SSL protocol. The SSL protocol protects the connection and communication between the two WebLogic Servers instances.</li> 
    <li type="square"><a name="1064179"></a><code style="font-family: courier">setSSLClientCertificate</code>specifies a certificate chain to use for the SSL connection. You use this method to specify an input stream array that consists of a private key (which is the first input stream in the array) and a chain of X.509 certificates (which make up the remaining input streams in the array). Each certificate in the chain of certificates is the issuer of the certificate preceding it in the chain.</li> 
    <li type="square"><a name="1064197"></a><code style="font-family: courier">setSSLServerName</code>specifies the name of the WebLogic Server instance acting as the SSL server. When the SSL server presents its digital certificate to the server acting as the SSL client, the name specified using the <code style="font-family: courier">setSSLServerName</code> method is compared to the common name field in the digital certificate. In order for hostname verification to succeed, the names must match. This parameter is used to prevent man-in-the-middle attacks.</li> 
    <li type="square"><a name="1064206"></a><code style="font-family: courier">setSSLRootCAFingerprint</code>specifies digital codes that represent a set of trusted certificate authorities. The root certificate in the certificate chain received from the WebLogic Server instance acting as the SSL server has to match one of the fingerprints specified with this method to be trusted. This parameter is used to prevent man-in-the-middle attacks. </li> 
   </ul>
   <p><strong><a name="1064336"></a>Note: </strong> For information on JNDI contexts and threads and how to avoid potential JNDI context problems, see <a href="../jndi/jndi.html#jndicontext">JNDI Contexts and Threads</a> and <a href="../jndi/jndi.html#contextproblems">How to Avoid JNDI Context Problems</a> in the <em>Programming WebLogic JNDI</em>. </p> 
   <h3 class="head3"><a name="1064202"></a><a name="fat_client_0609"></a>Using Two-Way SSL Authentication with Servlets</h3> 
   <p><a name="1064447"></a>To authenticate Java clients in a servlet (or any other server-side Java class), you must check whether the client presented a digital certificate and if so, whether the certificate was issued by a trusted certificate authority. The servlet developer is responsible for asking whether the Java client has a valid digital certificate. When developing servlets with the WebLogic Servlet API, you must access information about the SSL connection through the<code style="font-family: courier"> getAttribute()</code> method of the <code style="font-family: courier">HTTPServletRequest</code> object. </p> 
   <p><a name="1029761"></a>The following attributes are supported in WebLogic Server servlets:</p> 
   <ul type="square">
    <li type="square"><a name="1029763"></a><code style="font-family: courier">javax.servlet.request.X509Certificate<br> java.security.cert.X509Certificate []</code>returns an array of the X.509 certificate. </li> 
    <li type="square"><a name="1029765"></a><code style="font-family: courier">javax.servlet.request.cipher_suite</code>returns a string representing the cipher suite used by HTTPS.</li> 
    <li type="square"><a name="1029767"></a><code style="font-family: courier">javax.servlet.request.key_size</code> returns an integer (0, 40, 56, 128, 168) representing the bit size of the symmetric (bulk encryption) key algorithm. </li> 
    <li type="square"><a name="1029769"></a><code style="font-family: courier">weblogic.servlet.request.SSLSession<br></code> <code style="font-family: courier">javax.net.ssl.SSLSession</code>returns the SSL session object that contains the cipher suite and the dates on which the object was created and last used.</li> 
   </ul> 
   <p><a name="1029771"></a>You have access to the user information defined in the digital certificates. When you get the <code style="font-family: courier">javax.servlet.request.X509Certificate</code> attribute, it is an array of the <code style="font-family: courier">java.security.cert</code> X.509 certificate. You simply cast the array to that and examine the certificates.</p> 
   <p><a name="1029775"></a>A digital certificate includes information, such as the following:</p> 
   <ul type="square">
    <li type="square"><a name="1029776"></a>The name of the subject (holder, owner) and other identification information required to verify the unique identity of the subject, such as the uniform resource locator (URL) of the Web server using the digital certificate, or an individual user's e-mail address</li> 
    <li type="square"><a name="1029778"></a>The subject's public key</li> 
    <li type="square"><a name="1029779"></a>The name of the certificate authority that issued the digital certificate</li> 
    <li type="square"><a name="1029780"></a>A serial number</li> 
    <li type="square"><a name="1029781"></a>The validity period (or lifetime) of the digital certificate (as defined by a start date and an end date) </li> 
   </ul>
   <h2 class="head2"><a name="1029783"></a><a name="fat_client_0610"></a>Using a Custom Host Name Verifier</h2> 
   <p><a name="1029784"></a>A host name verifier validates that the host to which an SSL connection is made is the intended or authorized party. A host name verifier is useful when a WebLogic client or a WebLogic Server instance is acting as an SSL client to another application server. It helps prevent man-in-the-middle attacks.</p> 
   <p><strong><a name="1063742"></a>Note: </strong> In this release of WebLogic Server, the demonstration digital certificates are generated during installation so they do contain the hostname of the system on which the WebLogic Server software installed. Therefore, you should leave host name verification on when using the demonstration certificates for development or testing purposes.</p> 
   <p><a name="1029785"></a>By default, WebLogic Server, as a function of the SSL handshake, compares the common name in the Subject's Distinguished Name (SubjectDN) of the SSL server's digital certificate with the host name of the SSL server used to initiate the SSL connection. If these names do not match, the SSL connection is dropped.</p> 
   <p><a name="1029788"></a>The dropping of the SSL connection is caused by the SSL client, which validates the host name of the server against the digital certificate of the server. If anything but the default behavior is desired, you can either turn off host name verification or register a custom host name verifier. Turning off host name verification leaves the SSL connections vulnerable to man-in-the-middle attacks. </p> 
   <p><a name="1029795"></a>You can turn off host name verification in the following ways:</p> 
   <ul type="square">
    <li type="square"><a name="1029796"></a>In the Administration Console, specify None in the Hostname Verification field that is located on the Advanced Options pane under the Keystore &amp; SSL tab for the server (for example, <code style="font-family: courier">myserver</code>).</li> 
    <li type="square"><a name="1029797"></a>On the command line of the SSL client, enter the following argument:</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1029798"></a><code style="font-family: courier">-Dweblogic.security.SSL.ignoreHostnameVerification=true</code></p> 
     </dt>
    </dl>
   </ul> 
   <p><a name="1029800"></a>You can write a custom host name verifier. The <code style="font-family: courier">weblogic.security.SSL.HostnameVerifierJSSE</code> interface provides a callback mechanism so that you can define a policy for handling the case where the server name that is being connected to does not match the server name in the SubjectDN of the server's digital certificate. </p> 
   <p><a name="1029802"></a>To use a custom host name verifier, create a class that implements the <code style="font-family: courier">weblogic.security.SSL.HostnameVerifierJSSE</code> interface and define the methods that capture information about the server's security identity.</p> 
   <p><strong><a name="1029804"></a>Note: </strong> This interface takes new style certificates and replaces the <code style="font-family: courier">weblogic.security.SSL.HostnameVerifier</code> interface, which is deprecated in this release of WebLogic Server.</p> 
   <p><a name="1029807"></a>Before you can use a custom host name verifier, you need to specify the class for your implementation in the following ways:</p> 
   <ul type="square">
    <li type="square"><a name="1029808"></a>In the Administration Console, specify the class for the custom host name verifier in the Client Attributes fields that are located on the Advanced Options pane under the Keystore &amp; SSL tab for the server (for example, <code style="font-family: courier">myserver</code>).</li> 
    <li type="square"><a name="1029809"></a>On the command line, enter the following argument:</li> 
    <dl>
     <dt>
      <p class="listpara"><a name="1029810"></a><code style="font-family: courier">-Dweblogic.security.SSL.HostnameVerifierJSSE=</code><code style="font-family: courier; font-style: italic">hostnameverifier</code></p> 
     </dt>
     <dt>
      <p class="listpara"><a name="1029811"></a>where <code style="font-family: courier; font-style: italic">hostnameverifier</code> is the name of the class that implements the custom host name verifier.</p> 
     </dt>
    </dl>
   </ul> 
   <p><a name="1029816"></a>An example of a custom host name verifier (see <a href="SSL_client.html#1029818">Listing&nbsp;4-7</a>) is available in the SSLclient code located in the <code style="font-family: courier; font-style: italic">SAMPLES_HOME</code><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory. This code example contains a <code style="font-family: courier">NulledHostnameVerifier</code> class which always returns true for the comparison. This sample allows the WebLogic SSL client to connect to any SSL server regardless of the server's host name and digital certificate SubjectDN comparison.</p> 
   <p class="codetitle"><a name="1029818"></a>Listing 4-7 Host Name Verifier Sample Code</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029819"></a>package examples.security.sslclient;<br>/**<br> * HostnameVerifierJSSE provides a callback mechanism so that<br> * implementers of this interface can supply a policy for handling<br> * the case where the host that's being connected to and the server<br> * name from the certificate SubjectDN must match.<br> *<br> * This is a null version of that class to show the WebLogic SSL<br> * client classes without major problems. For example, in this case,<br> * the client code connects to a server at 'localhost' but the<br> * democertificate's SubjectDN CommonName is 'bea.com' and the<br> * default WebLogic HostnameVerifierJSSE does a String.equals() on<br> * those two hostnames.<br> *<br> * @see HostnameVerifier#verify<br> * @author Copyright (c) 1999-2002 by BEA Systems, Inc. All Rights<br> * Reserved.<br> */</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029821"></a>public class NulledHostnameVerifier implements<br>                     weblogic.security.SSL.HostnameVerifierJSSE {<br>  public boolean verify(String urlHostname, String certHostname) {<br>    return true;<br>  }<br>}</code></pre>
   </blockquote> 
   <h2 class="head2"><a name="1029824"></a><a name="fat_client_0611"></a>Using a Trust Manager</h2> 
   <p><a name="1029826"></a>The <code style="font-family: courier">weblogic.security.SSL.TrustManagerJSSE</code> interface allows you to override validation errors in a peer's digital certificate and continue the SSL handshake. You can also use the interface to discontinue an SSL handshake by performing additional validation on a server's digital certificate chain.</p> 
   <p><strong><a name="1029830"></a>Note: </strong> This interface takes new style certificates and replaces the <code style="font-family: courier">weblogic.security.SSL.TrustManager</code> interface, which is deprecated in this release of WebLogic Server.</p> 
   <p><a name="1029832"></a>When an SSL client connects to an instance of WebLogic Server, the server presents its digital certificate chain to the client for authentication. That chain could contain an invalid digital certificate. The SSL specification says that the client should drop the SSL connection upon discovery of an invalid certificate. Web browsers, however, ask the user whether to ignore the invalid certificate and continue up the chain to determine if it is possible to authenticate the SSL server with any of the remaining certificates in the certificate chain. You can use the <code style="font-family: courier">TrustManagerJSSE</code> interface to eliminate this inconsistent practice by controlling when to continue or discontinue an SSL connection. Using a trust manager, you can perform custom checks before continuing an SSL connection. For example, you can use a trust manager to specify that only users from specific localities, such as towns, states, or countries, or users with other special attributes, are allowed to gain access via the SSL connection. </p> 
   <p><a name="1029840"></a>Use the <code style="font-family: courier">weblogic.security.SSL.TrustManagerJSSE</code> interface to create a trust manager. The interface contains a set of error codes for certificate verification. You can also perform additional validation on the peer certificate and interrupt the SSL handshake if need be. After a digital certificate has been verified, the <code style="font-family: courier">weblogic.security.SSL.TrustManagerJSSE</code> interface uses a callback function to override the result of verifying the digital certificate. You can associate an instance of a trust manager with an SSL context through the <code style="font-family: courier">setTrustManagerJSSE()</code> method. </p> 
   <p><a name="1057773"></a>The <code style="font-family: courier">weblogic.security.SSL.TrustManagerJSSE</code> interface conforms to the JSSE specification. You can only set up a trust manger programmatically; its use cannot be defined through the Administration Console or on the command-line.</p> 
   <p><strong><a name="1057818"></a>Note: </strong> Depending on the checks performed, use of a trust manager may potentially impact performance.</p> 
   <p><a name="1029846"></a>An example of a trust manager (see <a href="SSL_client.html#1029849">Listing&nbsp;4-8</a>) is available in the SSLClient code example located in the <code style="font-family: courier">SAMPLES_HOME\server\examples\src\examples\security\sslclient</code> directory.</p> 
   <p class="codetitle"><a name="1029849"></a>Listing 4-8 TrustManager Code Example</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029850"></a><code style="font-family: courier">package examples.security.sslclient;<br><br>import weblogic.security.SSL.TrustManagerJSSE;<br>import javax.security.cert.X509Certificate;</code></code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029851"></a><code style="font-family: courier">public class NulledTrustManagerJSSE implements TrustManagerJSSE{ </code></code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029852"></a>  public boolean certificateCallback(X509Certificate[] o, int validateErr) {<br>    System.out.println(" --- Do Not Use In Production ---\n" + "  By using this " + <br>                     "NulledTrustManager, the trust in the server's identity "+<br>                     "is completely lost.\n --------------------------------");<br>    for (int i=0; i&lt;o.length; i++)<br>      System.out.println(" certificate " + i + " -- " + o[i].toString());<br>    return true;<br>  }<br>}</code></pre>
   </blockquote> 
   <p><a name="1029855"></a>The SSLSocketClient example uses the custom trust manager shown above. The SSLSocketClient shows how to set up a new SSL connection by using an SSL context with the trust manager. This example is also located in the <code style="font-family: courier; font-style: italic">SAMPLES_HOME</code><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory.</p> 
   <h2 class="head2"><a name="1053877"></a>Using a Handshake Completed Listener</h2> 
   <p><a name="1064155"></a>The <code style="font-family: courier">javax.net.ssl.HandshakeCompletedListener</code> interface defines how the SSL client receives notifications about the completion of an SSL protocol handshake on a given SSL connection. It also defines the number of times an SSL handshake takes place on a given SSL connection. <a href="SSL_client.html#1054427">Listing&nbsp;4-9</a> shows a HandshakeCompletedListener interface code example. This example is also located in the <code style="font-family: courier; font-style: italic">SAMPLES_HOME</code><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory.</p> 
   <p class="codetitle"><a name="1054427"></a>Listing 4-9 HandshakeCompletedListener Code Example</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1054428"></a>package examples.security.sslclient;<br><br>import java.io.File;<br>import java.io.IOException;<br>import java.io.InputStream;<br>import java.io.OutputStream;<br>import java.io.FileInputStream;<br>import java.util.Hashtable;<br>import javax.net.ssl.HandshakeCompletedListener;<br>import javax.net.ssl.SSLSession;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1053970"></a>  public class MyListener implements HandshakeCompletedListener<br>  {<br>    public void handshakeCompleted(javax.net.ssl.<br>                                     HandshakeCompletedEvent event)<br>    {<br>      SSLSession session = event.getSession();<br>      System.out.println("Handshake Completed with peer " +<br>                           session.getPeerHost());<br>      System.out.println("   cipher: " + session.getCipherSuite());<br>      javax.security.cert.X509Certificate[] certs = null;<br>      try<br>      {<br>        certs = session.getPeerCertificateChain();<br>      }<br>      catch (javax.net.ssl.SSLPeerUnverifiedException puv)<br>      {<br>        certs = null;<br>      }<br>      if  (certs != null)<br>      {<br>        System.out.println("   peer certificates:");<br>        for (int z=0; z&lt;certs.length; z++) System.out.<br>                 println("certs["+z+"]: " + certs[z]);<br>      }<br>      else<br>      {<br>        System.out.println("No peer certificates presented");<br>      }<br>    }<br>  }</code></pre>
   </blockquote> 
   <h2 class="head2"><a name="1046261"></a><a name="fat_client_0612"></a>Using an SSLContext</h2> 
   <p><a name="1046263"></a>The <code style="font-family: courier">SSLContext</code> class is used to programmatically configure SSL and retain SSL session information. For example, all sockets that are created by socket factories provided by the <code style="font-family: courier">SSLContext</code> class can agree on session state by using the handshake protocol associated with the SSL context. Each instance can be configured with the keys, certificate chains, and trusted root certificate authorities that it needs to perform authentication. These sessions are cached so that other sockets created under the same SSL context can potentially reuse them later. For more information on session caching see <a href="../secmanage/ssl.html#ssl_session_behavior">SSL Session Behavior</a> in <em>Managing WebLogic Security</em>. To associate an instance of a trust manager class with its SSL context, use the <code style="font-family: courier">weblogic.security.SSL.SSLContext.setTrustManagerJSSE()</code> method.</p> 
   <p><a name="1029864"></a>You can only set up an SSL context programmatically; not by using the Administration Console or the command line. A Java <code style="font-family: courier">new</code> expression or the <code style="font-family: courier">getInstance()</code> method of the <code style="font-family: courier">SSLContext</code> class can create an <code style="font-family: courier">SSLContext</code> object. The <code style="font-family: courier">getInstance()</code> method is static and it generates a new <code style="font-family: courier">SSLContext</code> object that implements the specified secure socket protocol. An example of using the <code style="font-family: courier">SSLContext</code> class is provided in the SSLSocketClient sample in the <code style="font-family: courier">SAMPLES_HOME\server\examples\src\examples\security\sslclient</code> directory. This example (see <a href="SSL_client.html#1029670">Listing&nbsp;4-3</a>) shows how to create a new SSL socket factory that will create a new SSL socket using <code style="font-family: courier">SSLContext</code>.</p> 
   <p><a name="1029869"></a><a href="SSL_client.html#1029871">Listing&nbsp;4-10</a> shows a sample instantiation using the <code style="font-family: courier">getInstance()</code> method.</p> 
   <p class="codetitle"><a name="1029871"></a>Listing 4-10 SSL Context Code Example</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029872"></a>import weblogic.security.SSL.SSLContext;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029873"></a>SSLcontext sslctx = SSLContext.getInstance ("https")</code></pre>
   </blockquote> 
   <h2 class="head2"><a name="1029877"></a><a name="fat_client_0613"></a>Using an SSL Server Socket Factory</h2> 
   <p><a name="1057914"></a>Instances of the <code style="font-family: courier">SSLServerSocketFactory</code> class create and return SSL sockets. This class extends <code style="font-family: courier">javax.net.SocketFactory</code>.</p> 
   <p><a name="1057927"></a><a href="SSL_client.html#1057920">Listing&nbsp;4-11</a> shows a sample instantiation of this class. <a href="SSL_client.html#1029670">Listing&nbsp;4-3</a> shows a code example that uses the <code style="font-family: courier">SSLServerSocketFactory</code> class. This code example is taken from the <code style="font-family: courier">SSLSocketClient.java</code> file located at <code style="font-family: courier">SAMPLES_HOME\server\examples\src\examples\security\sslclient</code>.</p> 
   <p class="codetitle"><a name="1057920"></a>Listing 4-11 SSLServerSocketFactory Code Example</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029885"></a>import weblogic.security.SSL.SSLSocketFactory;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029886"></a>  SSLSocketFactory sslSF = (SSLSocketFactory) sslCtx.getSocketFactoryJSSE();</code></pre>
   </blockquote> 
   <h2 class="head2"><a name="1029889"></a><a name="fat_client_0614"></a>Using URLs to Make Outbound SSL Connections</h2> 
   <p><a name="1063953"></a>You can use a <code style="font-family: courier">URL</code> object to make an outbound SSL connection from a WebLogic Server instance acting as a client to another WebLogic Server instance. WebLogic Server supports both one-way and two-way SSL authentication for outbound SSL connections.</p> 
   <p><a name="1063954"></a>For one-way SSL authentication, you use the <code style="font-family: courier">java.net.URL</code>, <code style="font-family: courier">java.net.URLConnection</code>, and <code style="font-family: courier">java.net.HTTPURLConnection</code> classes to make outbound SSL connections using <code style="font-family: courier">URL</code> objects. <a href="SSL_client.html#1056328">Listing&nbsp;4-12</a> shows a <code style="font-family: courier">simpleURL</code> class that supports both HTTP and HTTPS URLs and that only uses these Java classes (that is, no WebLogic classes are required). To use the <code style="font-family: courier">simpleURL</code> class for one-way SSL authentication (HTTPS) on WebLogic Server, all that is required is that "<code style="font-family: courier">weblogic.net</code>" be defined in the system property for <code style="font-family: courier">java.protocols.handler.pkgs</code>.</p> 
   <p><strong><a name="1063961"></a>Note: </strong> Because the <code style="font-family: courier">simpleURL</code> sample shown in <a href="SSL_client.html#1056328">Listing&nbsp;4-12</a> defaults trust and hostname checking, this sample requires that you connect to a real Web server that is trusted and that passes hostname checking by default. Otherwise, you must override trust and hostname checking on the command line.</p> 
   <p class="codetitle"><a name="1056328"></a>Listing 4-12 One-Way SSL Authentication URL Outbound SSL Connection Class That Uses Java Classes Only</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1056366"></a>import java.net.URL;<br>import java.net.URLConnection;<br>import java.net.HttpURLConnection;<br>import java.io.IOException;</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1056371"></a>public class simpleURL<br>{<br>   public static void main (String [] argv)<br>   {<br>     if (argv.length != 1)<br>     {<br>       System.out.println("Please provide a URL to connect to");<br>       System.exit(-1);<br>     }<br>     setupHandler();<br>     connectToURL(argv[0]);<br>   }</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1056384"></a>   private static void setupHandler()<br>   {<br>     java.util.Properties p = System.getProperties();<br>     String s = p.getProperty("java.protocol.handler.pkgs");<br>     if (s == null)<br>       s = "weblogic.net";<br>     else if (s.indexOf("weblogic.net") == -1)<br>       s += "|weblogic.net";<br>     p.put("java.protocol.handler.pkgs", s);<br>     System.setProperties(p);<br>   }</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1056396"></a>   private static void connectToURL(String theURLSpec)<br>   {<br>     try<br>     {<br>       URL theURL = new URL(theURLSpec);<br>       URLConnection urlConnection = theURL.openConnection();<br>       HttpURLConnection connection = null;<br>       if (!(urlConnection instanceof HttpURLConnection))<br>       {<br>         System.out.println("The URL is not using HTTP/HTTPS: " +<br>                              theURLSpec);<br>         return;<br>       }<br>       connection = (HttpURLConnection) urlConnection;<br>       connection.connect();<br>       String responseStr = "\t\t" +<br>              connection.getResponseCode() + " -- " +<br>              connection.getResponseMessage() + "\n\t\t" +<br>                   connection.getContent().getClass().getName() + "\n";<br>       connection.disconnect();<br>       System.out.println(responseStr);<br>     }<br>     catch (IOException ioe)<br>     {<br>       System.out.println("Failure processing URL: " + theURLSpec);<br>       ioe.printStackTrace();<br>     }<br>   }<br>}</code></pre>
   </blockquote> 
   <p><a name="1056658"></a>For two-way SSL authentication, the <code style="font-family: courier">weblogic.net.http.HttpsURLConnection</code> class provides a way to specify the security context information for a client, including the digital certificate and private key of the client. Instances of this class represent an HTTPS connection to a remote object.</p> 
   <p><a name="1056661"></a>The SSLClient code example demonstrates using the WebLogic <code style="font-family: courier">URL</code> object to make an outbound SSL connection (see <a href="SSL_client.html#1029902">Listing&nbsp;4-13</a>). The code example shown in <a href="SSL_client.html#1029902">Listing&nbsp;4-13</a> is excerpted from the <code style="font-family: courier">SSLClient.java</code> file in the <em>SAMPLES_HOME</em><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory. </p> 
   <p class="codetitle"><a name="1029902"></a>Listing 4-13 WebLogic Two-Way SSL Authentication URL Outbound SSL Connection Code Example</p> 
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1029903"></a>wlsUrl = new URL("https", host, Integer.valueOf(sport).intValue(),<br>                 query);<br>weblogic.net.http.HttpsURLConnection sconnection =<br>         new weblogic.net.http.HttpsURLConnection(wlsUrl);</code></pre>
   </blockquote>
   <blockquote>
    <pre><code style="font-family: courier; font-size: 10pt"><a name="1063636"></a>InputStream [] ins = new InputStream[2];<br>      ins[0] = new FileInputStream("client2certs.pem");<br>      ins[1] = new FileInputStream("clientkey.pem");<br>      String pwd = "clientkey";<br>      sconnection.loadLocalIdentity(ins[0], ins[1], pwd.toCharArray());</code></pre>
   </blockquote> 
   <p>&nbsp;</p> 
   <hr noshade> 
   <h1 class="head1"><a name="1052653"></a>SSL Client Code Examples</h1> 
   <p><a name="1052654"></a>A complete working SSL authentication sample is provided with the WebLogic Server product. The sample is located in the <em>SAMPLES_HOME</em><code style="font-family: courier">\server\examples\src\examples\security\sslclient</code> directory. For a description of the sample and instructions on how to build, configure, and run this sample, see the <code style="font-family: courier">package.html</code> file in the sample directory. You can modify this code example and reuse it.</p> 
   <p><a name="1027803"></a></p> 
  </div> 
  <!-- BACK TO TOP --> 
  <p>&nbsp;</p> 
  <table cellspacing="5" cellpadding="5" border="0"> 
   <tbody>
    <tr> 
     <td align="left" valign="middle" width="125"><a href="#wrap"><img border="0" src="../images/_.gif" width="1" height="1" alt="Skip navigation bar"></a> &nbsp;<a href="SSL_client.html"><img src="../images/backtop.gif" width="90" height="25" alt="Back to Top" title="Back to Top" border="0"></a> </td> 
     <td align="left" valign="middle" width="85"> <a href="fat_client.html"><img src="../images/prevtop.gif" width="82" height="25" alt="Previous" title="Previous" border="0"></a> </td> 
     <td align="left" valign="middle" width="85"> <a href="ejb_client.html"><img src="../images/nexttop.gif" width="66" height="25" alt="Next" title="Next" border="0"></a> </td> 
    </tr> 
   </tbody>
  </table> 
  <br> 
  <!-- BACK TO TOP end --> 
  <!-- FOOTER begin --> 
  <div id="footer"> 
   <a href="http://www.bea.com/contact/index.shtml">Contact BEA</a>&nbsp;|&nbsp; 
   <a href="mailto:docsupport@bea.com">Feedback</a>&nbsp;|&nbsp; 
   <a href="http://www.bea.com/framework.jsp?CNT=privacy.htm&amp;FP=/content/legal/">Privacy</a> &nbsp;|&nbsp; 
   <script language="Javascript1.1" type="text/javascript">
Copyright();
</script> 
   <noscript>
    <a href="http://www.oracle.com/html/copyright.html"> BEA Systems</a>
   </noscript> 
  </div> 
  <!-- FOOTER end -->   
 </body>
</html>